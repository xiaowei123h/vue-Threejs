{"version":3,"sources":["webpack:///./src/components/jsm/loaders/TGALoader.js","webpack:///./src/components/jsm/loaders/ColladaLoader.js","webpack:///./src/components/jsm/libs/tween.module.min.js","webpack:///src/views/loader/webglLoaderColladaKnematics.vue","webpack:///./src/views/loader/webglLoaderColladaKnematics.vue?f4ab","webpack:///./src/views/loader/webglLoaderColladaKnematics.vue","webpack:///./node_modules/process/browser.js"],"names":["TGALoader","manager","Loader","call","this","prototype","Object","assign","create","constructor","load","url","onLoad","onProgress","onError","scope","texture","Texture","loader","FileLoader","setResponseType","setPath","path","setWithCredentials","withCredentials","buffer","image","parse","needsUpdate","undefined","TGA_TYPE_NO_DATA","TGA_TYPE_INDEXED","TGA_TYPE_RGB","TGA_TYPE_GREY","TGA_TYPE_RLE_INDEXED","TGA_TYPE_RLE_RGB","TGA_TYPE_RLE_GREY","TGA_ORIGIN_MASK","TGA_ORIGIN_SHIFT","TGA_ORIGIN_BL","TGA_ORIGIN_BR","TGA_ORIGIN_UL","TGA_ORIGIN_UR","length","console","error","content","Uint8Array","offset","header","id_length","colormap_type","image_type","colormap_index","colormap_length","colormap_size","origin","width","height","pixel_size","flags","tgaCheckHeader","use_rle","use_pal","use_grey","canvas","OffscreenCanvas","document","createElement","context","getContext","imageData","createImageData","result","data","pixel_data","pixel_total","palettes","subarray","c","count","i","shift","pixels","set","tgaParse","palette","x_start","y_start","x_step","y_step","x_end","y_end","color","x","y","tgaGetImageDataGrey8bits","tgaGetImageDataGrey16bits","colormap","tgaGetImageData8bits","tgaGetImageData16bits","tgaGetImageData24bits","tgaGetImageData32bits","getTgaRGBA","putImageData","__webpack_require__","d","__webpack_exports__","ColladaLoader_ColladaLoader","ColladaLoader","LoaderUtils","extractUrlBase","setRequestHeader","requestHeader","text","e","itemError","options","convertUpAxis","value","warn","getElementsByTagName","xml","name","array","childNodes","l","child","nodeName","push","parseStrings","parts","trim","split","Array","parseFloats","parseFloat","parseInts","parseInt","parseId","substring","isEmpty","object","keys","parseLibrary","libraryName","parser","library","elements","buildLibrary","builder","build","getBuild","parseAnimationSampler","inputs","nodeType","id","getAttribute","semantic","parseAnimationChannel","sid","arraySyntax","indexOf","memberSyntax","member","indices","replace","sampler","buildAnimation","tracks","channels","samplers","sources","target","hasOwnProperty","channel","inputId","INPUT","outputId","OUTPUT","createKeyframeTracks","buildAnimationChannel","getAnimation","animations","inputSource","outputSource","time","stride","il","j","jl","node","nodes","object3D","getNode","transform","transforms","defaultMatrix","matrix","clone","transpose","index","keyframes","sort","a","b","transformAnimationData","prepareAnimationData","uuid","position","Vector3","scale","quaternion","Quaternion","animation","times","positionData","quaternionData","scaleData","keyframe","fromArray","decompose","z","w","VectorKeyframeTrack","QuaternionKeyframeTrack","property","defaultValue","empty","prev","next","getPrev","getNext","interpolate","createMissingKeyframes","key","buildAnimationClip","duration","end","start","animationTracks","AnimationClip","getAnimationClip","clips","parseSkin","bindShapeMatrix","textContent","parseSource","joints","parseJoints","vertexWeights","parseVertexWeights","vcount","v","buildController","geometry","geometries","skin","weights","jointOffset","JOINT","weightOffset","WEIGHT","jointSource","inverseSource","INV_BIND_MATRIX","jointCount","vertexSkinData","skinIndex","weightId","skinWeight","weight","descending","bindMatrix","Matrix4","identity","boneInverse","buildSkin","skinIndices","skinWeights","buildImage","init_from","getImage","images","parseEffectProfileCOMMON","surfaces","parseEffectNewparam","technique","parseEffectTechnique","extra","parseEffectExtra","parseEffectSurface","parseEffectSampler","source","type","parameters","parseEffectParameters","parseEffectParameter","opaque","parseEffectParameterTexture","parseEffectParameterTextureExtra","parseEffectParameterTextureExtraTechnique","toUpperCase","parseEffectExtraTechnique","buildEffect","buildMaterial","material","effect","effects","profile","MeshPhongMaterial","MeshLambertMaterial","MeshBasicMaterial","getTexture","textureObject","extension","slice","lastIndexOf","toLowerCase","tgaLoader","textureLoader","getTextureLoader","wrapS","wrapU","RepeatWrapping","ClampToEdgeWrapping","wrapT","wrapV","offsetU","offsetV","repeat","repeatU","repeatV","parameter","map","specular","specularMap","normalMap","lightMap","float","shininess","emissive","emissiveMap","transparent","transparency","opacity","double_sided","side","DoubleSide","getMaterial","materials","parseCameraOptics","parseCameraTechnique","parseCameraParameters","buildCamera","camera","optics","PerspectiveCamera","yfov","aspect_ratio","znear","zfar","ymag","xmag","aspectRatio","OrthographicCamera","getCamera","cameras","parseLightTechnique","parseLightParameters","Color","falloffAngle","f","distance","Math","sqrt","buildLight","light","DirectionalLight","PointLight","SpotLight","AmbientLight","copy","getLight","lights","accessor","parseGeometryVertices","parseGeometryPrimitive","primitive","hasUV","inputname","max","p","checkUVCoordinates","primitives","uvsNeedsFix","buildGeometry","vertices","groupedPrimitives","groupPrimitives","primitiveType","buildGeometryType","normal","uv","uv2","BufferGeometry","materialKeys","g","vc","addGroup","input","prevLength","buildGeometryData","setAttribute","Float32BufferAttribute","pushVector","sourceStride","sourceArray","k","kl","getGeometry","buildKinematicsModel","parseKinematicsTechniqueCommon","parseKinematicsJoint","links","parseKinematicsLink","parseKinematicsJointParameter","axis","limits","min","static","zeroPosition","middlePosition","attachments","parseKinematicsAttachment","parseKinematicsTransform","joint","pop","obj","angle","MathUtils","degToRad","parsePhysicsRigidBody","parsePhysicsTechniqueCommon","inertia","mass","parseKinematicsBindJointAxis","param","tmpJointIndex","jointIndex","substr","buildKinematicsScene","vector","parseNode","instanceCameras","instanceControllers","instanceLights","instanceGeometries","instanceNodes","parseNodeInstance","multiply","makeTranslation","makeRotationAxis","log","hasNode","skeletons","instances","instance","symbol","buildSkeleton","boneData","sortedBoneData","skeleton","buildBoneHierarchy","visualScenes","children","bone","processed","bones","boneInverses","Skeleton","root","traverse","isBone","buildNode","objects","instanceCamera","controller","controllers","newObjects","buildObjects","isSkinnedMesh","bind","normalizeSkinWeights","instanceLight","Bone","Group","add","fallbackMaterial","resolveMaterialBinding","instanceMaterials","LineBasicMaterial","skinning","attributes","LineSegments","Line","SkinnedMesh","Mesh","buildVisualScene","group","getVisualScene","scene","Scene","DOMParser","parseFromString","collada","parserError","errorText","errorElement","stack","Node","TEXT_NODE","apply","parserErrorToText","version","asset","unit","hasAttribute","parseAssetUnit","upAxis","parseAssetUpAxis","parseAsset","TextureLoader","resourcePath","setCrossOrigin","crossOrigin","kinematics","kinematicsModels","physicsModels","kinematicsScenes","parseAnimation","hasChildren","generateUUID","mesh","element","prepareNodes","rigidBodies","bindJointAxis","setupAnimations","kinematicsModelId","kinematicsSceneId","visualSceneId","kinematicsModel","kinematicsScene","getKinematicsScene","visualScene","jointMap","targetElement","querySelector","parentVisualElement","parentElement","connect","m0","getJointValue","jointData","setJointValue","visualElement","visualElementName","buildTransformList","setupKinematics","parseScene","setFromEuler","Euler","PI","multiplyScalar","_Group","_tweens","_tweensAddedDuringUpdate","getAll","t","removeAll","getId","remove","update","n","TWEEN","now","r","_isPlaying","_nextId","nextId","self","process","hrtime","performance","Date","getTime","Tween","_object","_valuesStart","_valuesEnd","_valuesStartRepeat","_duration","_repeat","_repeatDelayTime","_yoyo","_reversed","_delayTime","_startTime","_easingFunction","Easing","Linear","None","_interpolationFunction","Interpolation","_chainedTweens","_onStartCallback","_onStartCallbackFired","_onUpdateCallback","_onCompleteCallback","_onStopCallback","_group","_id","isPlaying","to","concat","stop","stopChainedTweens","delay","repeatDelay","yoyo","easing","interpolation","chain","arguments","onStart","onUpdate","onComplete","onStop","charAt","isFinite","s","o","u","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","cos","sin","Exponential","pow","Circular","Elastic","Back","Bounce","floor","Utils","Bezier","Bernstein","CatmullRom","Factorial","define","module","exports","_typeof","webglLoaderColladaKnematics","container","stats","renderer","particleLight","dae","kinematicsTween","tweenParameters","mounted","_this","isMesh","flatShading","updateMatrix","init","animate","methods","getElementsByClassName","appendChild","$THREE","$webglInnerWidth","window","innerHeight","grid","GridHelper","SphereBufferGeometry","HemisphereLight","pointLight","WebGLRenderer","setPixelRatio","devicePixelRatio","setSize","domElement","$Stats","dom","style","left","setupTween","addEventListener","onWindowResize","_this2","randInt","prop","old","tween_module_min","setTimeout","$onWindowResize","requestAnimationFrame","render","timer","lookAt","loader_webglLoaderColladaKnematics","$createElement","_self","_c","_m","staticRenderFns","_h","staticClass","attrs","href","rel","_v","Component","normalizeComponent","ssrContext","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","len","run","marker","runClearTimeout","Item","noop","nextTick","args","title","browser","env","argv","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask"],"mappings":"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","file":"static/js/1.151a22a544964aedc6ab.js","sourcesContent":["import {\r\n\tFileLoader,\r\n\tLoader,\r\n\tTexture\r\n} from \"@/components/build/three.module.js\";\r\n\r\nvar TGALoader = function ( manager ) {\r\n\r\n\tLoader.call( this, manager );\r\n\r\n};\r\n\r\nTGALoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\tconstructor: TGALoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar texture = new Texture();\r\n\r\n\t\tvar loader = new FileLoader( this.manager );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.setWithCredentials( this.withCredentials );\r\n\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\ttexture.image = scope.parse( buffer );\r\n\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\tif ( onLoad !== undefined ) {\r\n\r\n\t\t\t\tonLoad( texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t\treturn texture;\r\n\r\n\t},\r\n\r\n\tparse: function ( buffer ) {\r\n\r\n\t\t// reference from vthibault, https://github.com/vthibault/roBrowser/blob/master/src/Loaders/Targa.js\r\n\r\n\t\tfunction tgaCheckHeader( header ) {\r\n\r\n\t\t\tswitch ( header.image_type ) {\r\n\r\n\t\t\t\t// check indexed type\r\n\r\n\t\t\t\tcase TGA_TYPE_INDEXED:\r\n\t\t\t\tcase TGA_TYPE_RLE_INDEXED:\r\n\t\t\t\t\tif ( header.colormap_length > 256 || header.colormap_size !== 24 || header.colormap_type !== 1 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid type colormap data for indexed type.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t// check colormap type\r\n\r\n\t\t\t\tcase TGA_TYPE_RGB:\r\n\t\t\t\tcase TGA_TYPE_GREY:\r\n\t\t\t\tcase TGA_TYPE_RLE_RGB:\r\n\t\t\t\tcase TGA_TYPE_RLE_GREY:\r\n\t\t\t\t\tif ( header.colormap_type ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid type colormap data for colormap type.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t// What the need of a file without data ?\r\n\r\n\t\t\t\tcase TGA_TYPE_NO_DATA:\r\n\t\t\t\t\tconsole.error( 'THREE.TGALoader: No data.' );\r\n\r\n\t\t\t\t\t// Invalid type ?\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid type \"%s\".', header.image_type );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// check image width and height\r\n\r\n\t\t\tif ( header.width <= 0 || header.height <= 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid image size.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// check image pixel size\r\n\r\n\t\t\tif ( header.pixel_size !== 8 && header.pixel_size !== 16 &&\r\n\t\t\t\theader.pixel_size !== 24 && header.pixel_size !== 32 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid pixel size \"%s\".', header.pixel_size );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// parse tga image buffer\r\n\r\n\t\tfunction tgaParse( use_rle, use_pal, header, offset, data ) {\r\n\r\n\t\t\tvar pixel_data,\r\n\t\t\t\tpixel_size,\r\n\t\t\t\tpixel_total,\r\n\t\t\t\tpalettes;\r\n\r\n\t\t\tpixel_size = header.pixel_size >> 3;\r\n\t\t\tpixel_total = header.width * header.height * pixel_size;\r\n\r\n\t\t\t // read palettes\r\n\r\n\t\t\t if ( use_pal ) {\r\n\r\n\t\t\t\t palettes = data.subarray( offset, offset += header.colormap_length * ( header.colormap_size >> 3 ) );\r\n\r\n\t\t\t }\r\n\r\n\t\t\t // read RLE\r\n\r\n\t\t\t if ( use_rle ) {\r\n\r\n\t\t\t\t pixel_data = new Uint8Array( pixel_total );\r\n\r\n\t\t\t\tvar c, count, i;\r\n\t\t\t\tvar shift = 0;\r\n\t\t\t\tvar pixels = new Uint8Array( pixel_size );\r\n\r\n\t\t\t\twhile ( shift < pixel_total ) {\r\n\r\n\t\t\t\t\tc = data[ offset ++ ];\r\n\t\t\t\t\tcount = ( c & 0x7f ) + 1;\r\n\r\n\t\t\t\t\t// RLE pixels\r\n\r\n\t\t\t\t\tif ( c & 0x80 ) {\r\n\r\n\t\t\t\t\t\t// bind pixel tmp array\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < pixel_size; ++ i ) {\r\n\r\n\t\t\t\t\t\t\tpixels[ i ] = data[ offset ++ ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// copy pixel array\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < count; ++ i ) {\r\n\r\n\t\t\t\t\t\t\tpixel_data.set( pixels, shift + i * pixel_size );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tshift += pixel_size * count;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// raw pixels\r\n\r\n\t\t\t\t\t\tcount *= pixel_size;\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < count; ++ i ) {\r\n\r\n\t\t\t\t\t\t\tpixel_data[ shift + i ] = data[ offset ++ ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tshift += count;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t } else {\r\n\r\n\t\t\t\t// raw pixels\r\n\r\n\t\t\t\tpixel_data = data.subarray(\r\n\t\t\t\t\t offset, offset += ( use_pal ? header.width * header.height : pixel_total )\r\n\t\t\t\t);\r\n\r\n\t\t\t }\r\n\r\n\t\t\t return {\r\n\t\t\t\tpixel_data: pixel_data,\r\n\t\t\t\tpalettes: palettes\r\n\t\t\t };\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData8bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image, palettes ) {\r\n\r\n\t\t\tvar colormap = palettes;\r\n\t\t\tvar color, i = 0, x, y;\r\n\t\t\tvar width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i ++ ) {\r\n\r\n\t\t\t\t\tcolor = image[ i ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = 255;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = colormap[ ( color * 3 ) + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = colormap[ ( color * 3 ) + 1 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = colormap[ ( color * 3 ) + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData16bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tvar color, i = 0, x, y;\r\n\t\t\tvar width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 2 ) {\r\n\r\n\t\t\t\t\tcolor = image[ i + 0 ] + ( image[ i + 1 ] << 8 ); // Inversed ?\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = ( color & 0x7C00 ) >> 7;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = ( color & 0x03E0 ) >> 2;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = ( color & 0x001F ) >> 3;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = ( color & 0x8000 ) ? 0 : 255;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData24bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tvar i = 0, x, y;\r\n\t\t\tvar width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 3 ) {\r\n\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = 255;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = image[ i + 1 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = image[ i + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData32bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tvar i = 0, x, y;\r\n\t\t\tvar width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 4 ) {\r\n\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = image[ i + 1 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = image[ i + 2 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = image[ i + 3 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageDataGrey8bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tvar color, i = 0, x, y;\r\n\t\t\tvar width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i ++ ) {\r\n\r\n\t\t\t\t\tcolor = image[ i ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = color;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = color;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = color;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = 255;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageDataGrey16bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tvar i = 0, x, y;\r\n\t\t\tvar width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 2 ) {\r\n\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = image[ i + 1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getTgaRGBA( data, width, height, image, palette ) {\r\n\r\n\t\t\tvar x_start,\r\n\t\t\t\ty_start,\r\n\t\t\t\tx_step,\r\n\t\t\t\ty_step,\r\n\t\t\t\tx_end,\r\n\t\t\t\ty_end;\r\n\r\n\t\t\tswitch ( ( header.flags & TGA_ORIGIN_MASK ) >> TGA_ORIGIN_SHIFT ) {\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\tcase TGA_ORIGIN_UL:\r\n\t\t\t\t\tx_start = 0;\r\n\t\t\t\t\tx_step = 1;\r\n\t\t\t\t\tx_end = width;\r\n\t\t\t\t\ty_start = 0;\r\n\t\t\t\t\ty_step = 1;\r\n\t\t\t\t\ty_end = height;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TGA_ORIGIN_BL:\r\n\t\t\t\t\tx_start = 0;\r\n\t\t\t\t\tx_step = 1;\r\n\t\t\t\t\tx_end = width;\r\n\t\t\t\t\ty_start = height - 1;\r\n\t\t\t\t\ty_step = - 1;\r\n\t\t\t\t\ty_end = - 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TGA_ORIGIN_UR:\r\n\t\t\t\t\tx_start = width - 1;\r\n\t\t\t\t\tx_step = - 1;\r\n\t\t\t\t\tx_end = - 1;\r\n\t\t\t\t\ty_start = 0;\r\n\t\t\t\t\ty_step = 1;\r\n\t\t\t\t\ty_end = height;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TGA_ORIGIN_BR:\r\n\t\t\t\t\tx_start = width - 1;\r\n\t\t\t\t\tx_step = - 1;\r\n\t\t\t\t\tx_end = - 1;\r\n\t\t\t\t\ty_start = height - 1;\r\n\t\t\t\t\ty_step = - 1;\r\n\t\t\t\t\ty_end = - 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( use_grey ) {\r\n\r\n\t\t\t\tswitch ( header.pixel_size ) {\r\n\r\n\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\ttgaGetImageDataGrey8bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 16:\r\n\t\t\t\t\t\ttgaGetImageDataGrey16bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Format not supported.' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tswitch ( header.pixel_size ) {\r\n\r\n\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\ttgaGetImageData8bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image, palette );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 16:\r\n\t\t\t\t\t\ttgaGetImageData16bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 24:\r\n\t\t\t\t\t\ttgaGetImageData24bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 32:\r\n\t\t\t\t\t\ttgaGetImageData32bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Format not supported.' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Load image data according to specific method\r\n\t\t\t// var func = 'tgaGetImageData' + (use_grey ? 'Grey' : '') + (header.pixel_size) + 'bits';\r\n\t\t\t// func(data, y_start, y_step, y_end, x_start, x_step, x_end, width, image, palette );\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\t// TGA constants\r\n\r\n\t\tvar TGA_TYPE_NO_DATA = 0,\r\n\t\t\tTGA_TYPE_INDEXED = 1,\r\n\t\t\tTGA_TYPE_RGB = 2,\r\n\t\t\tTGA_TYPE_GREY = 3,\r\n\t\t\tTGA_TYPE_RLE_INDEXED = 9,\r\n\t\t\tTGA_TYPE_RLE_RGB = 10,\r\n\t\t\tTGA_TYPE_RLE_GREY = 11,\r\n\r\n\t\t\tTGA_ORIGIN_MASK = 0x30,\r\n\t\t\tTGA_ORIGIN_SHIFT = 0x04,\r\n\t\t\tTGA_ORIGIN_BL = 0x00,\r\n\t\t\tTGA_ORIGIN_BR = 0x01,\r\n\t\t\tTGA_ORIGIN_UL = 0x02,\r\n\t\t\tTGA_ORIGIN_UR = 0x03;\r\n\r\n\t\tif ( buffer.length < 19 ) console.error( 'THREE.TGALoader: Not enough data to contain header.' );\r\n\r\n\t\tvar content = new Uint8Array( buffer ),\r\n\t\t\toffset = 0,\r\n\t\t\theader = {\r\n\t\t\t\tid_length: content[ offset ++ ],\r\n\t\t\t\tcolormap_type: content[ offset ++ ],\r\n\t\t\t\timage_type: content[ offset ++ ],\r\n\t\t\t\tcolormap_index: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\tcolormap_length: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\tcolormap_size: content[ offset ++ ],\r\n\t\t\t\torigin: [\r\n\t\t\t\t\tcontent[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\t\tcontent[ offset ++ ] | content[ offset ++ ] << 8\r\n\t\t\t\t],\r\n\t\t\t\twidth: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\theight: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\tpixel_size: content[ offset ++ ],\r\n\t\t\t\tflags: content[ offset ++ ]\r\n\t\t\t};\r\n\r\n\t\t// check tga if it is valid format\r\n\r\n\t\ttgaCheckHeader( header );\r\n\r\n\t\tif ( header.id_length + offset > buffer.length ) {\r\n\r\n\t\t\tconsole.error( 'THREE.TGALoader: No data.' );\r\n\r\n\t\t}\r\n\r\n\t\t// skip the needn't data\r\n\r\n\t\toffset += header.id_length;\r\n\r\n\t\t// get targa information about RLE compression and palette\r\n\r\n\t\tvar use_rle = false,\r\n\t\t\tuse_pal = false,\r\n\t\t\tuse_grey = false;\r\n\r\n\t\tswitch ( header.image_type ) {\r\n\r\n\t\t\tcase TGA_TYPE_RLE_INDEXED:\r\n\t\t\t\tuse_rle = true;\r\n\t\t\t\tuse_pal = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_INDEXED:\r\n\t\t\t\tuse_pal = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_RLE_RGB:\r\n\t\t\t\tuse_rle = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_RGB:\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_RLE_GREY:\r\n\t\t\t\tuse_rle = true;\r\n\t\t\t\tuse_grey = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_GREY:\r\n\t\t\t\tuse_grey = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar useOffscreen = typeof OffscreenCanvas !== 'undefined';\r\n\r\n\t\tvar canvas = useOffscreen ? new OffscreenCanvas( header.width, header.height ) : document.createElement( 'canvas' );\r\n\t\tcanvas.width = header.width;\r\n\t\tcanvas.height = header.height;\r\n\r\n\t\tvar context = canvas.getContext( '2d' );\r\n\t\tvar imageData = context.createImageData( header.width, header.height );\r\n\r\n\t\tvar result = tgaParse( use_rle, use_pal, header, offset, content );\r\n\t\tgetTgaRGBA( imageData.data, header.width, header.height, result.pixel_data, result.palettes );\r\n\r\n\t\tcontext.putImageData( imageData, 0, 0 );\r\n\r\n\t\treturn canvas;\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { TGALoader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/loaders/TGALoader.js","import {\r\n\tAmbientLight,\r\n\tAnimationClip,\r\n\tBone,\r\n\tBufferGeometry,\r\n\tClampToEdgeWrapping,\r\n\tColor,\r\n\tDirectionalLight,\r\n\tDoubleSide,\r\n\tEuler,\r\n\tFileLoader,\r\n\tFloat32BufferAttribute,\r\n\tGroup,\r\n\tLine,\r\n\tLineBasicMaterial,\r\n\tLineSegments,\r\n\tLoader,\r\n\tLoaderUtils,\r\n\tMathUtils,\r\n\tMatrix4,\r\n\tMesh,\r\n\tMeshBasicMaterial,\r\n\tMeshLambertMaterial,\r\n\tMeshPhongMaterial,\r\n\tOrthographicCamera,\r\n\tPerspectiveCamera,\r\n\tPointLight,\r\n\tQuaternion,\r\n\tQuaternionKeyframeTrack,\r\n\tRepeatWrapping,\r\n\tScene,\r\n\tSkeleton,\r\n\tSkinnedMesh,\r\n\tSpotLight,\r\n\tTextureLoader,\r\n\tVector3,\r\n\tVectorKeyframeTrack\r\n} from \"@/components/build/three.module.js\";\r\nimport { TGALoader } from \"../loaders/TGALoader.js\";\r\n\r\nvar ColladaLoader = function ( manager ) {\r\n\r\n\tLoader.call( this, manager );\r\n\r\n};\r\n\r\nColladaLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\tconstructor: ColladaLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\r\n\r\n\t\tvar loader = new FileLoader( scope.manager );\r\n\t\tloader.setPath( scope.path );\r\n\t\tloader.setRequestHeader( scope.requestHeader );\r\n\t\tloader.setWithCredentials( scope.withCredentials );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tonLoad( scope.parse( text, path ) );\r\n\r\n\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\tif ( onError ) {\r\n\r\n\t\t\t\t\tonError( e );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( e );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\toptions: {\r\n\r\n\t\tset convertUpAxis( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.' );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tparse: function ( text, path ) {\r\n\r\n\t\tfunction getElementsByTagName( xml, name ) {\r\n\r\n\t\t\t// Non recursive xml.getElementsByTagName() ...\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar childNodes = xml.childNodes;\r\n\r\n\t\t\tfor ( var i = 0, l = childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeName === name ) {\r\n\r\n\t\t\t\t\tarray.push( child );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseStrings( text ) {\r\n\r\n\t\t\tif ( text.length === 0 ) return [];\r\n\r\n\t\t\tvar parts = text.trim().split( /\\s+/ );\r\n\t\t\tvar array = new Array( parts.length );\r\n\r\n\t\t\tfor ( var i = 0, l = parts.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ] = parts[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseFloats( text ) {\r\n\r\n\t\t\tif ( text.length === 0 ) return [];\r\n\r\n\t\t\tvar parts = text.trim().split( /\\s+/ );\r\n\t\t\tvar array = new Array( parts.length );\r\n\r\n\t\t\tfor ( var i = 0, l = parts.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ] = parseFloat( parts[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseInts( text ) {\r\n\r\n\t\t\tif ( text.length === 0 ) return [];\r\n\r\n\t\t\tvar parts = text.trim().split( /\\s+/ );\r\n\t\t\tvar array = new Array( parts.length );\r\n\r\n\t\t\tfor ( var i = 0, l = parts.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tarray[ i ] = parseInt( parts[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseId( text ) {\r\n\r\n\t\t\treturn text.substring( 1 );\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateId() {\r\n\r\n\t\t\treturn 'three_default_' + ( count ++ );\r\n\r\n\t\t}\r\n\r\n\t\tfunction isEmpty( object ) {\r\n\r\n\t\t\treturn Object.keys( object ).length === 0;\r\n\r\n\t\t}\r\n\r\n\t\t// asset\r\n\r\n\t\tfunction parseAsset( xml ) {\r\n\r\n\t\t\treturn {\r\n\t\t\t\tunit: parseAssetUnit( getElementsByTagName( xml, 'unit' )[ 0 ] ),\r\n\t\t\t\tupAxis: parseAssetUpAxis( getElementsByTagName( xml, 'up_axis' )[ 0 ] )\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseAssetUnit( xml ) {\r\n\r\n\t\t\tif ( ( xml !== undefined ) && ( xml.hasAttribute( 'meter' ) === true ) ) {\r\n\r\n\t\t\t\treturn parseFloat( xml.getAttribute( 'meter' ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn 1; // default 1 meter\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseAssetUpAxis( xml ) {\r\n\r\n\t\t\treturn xml !== undefined ? xml.textContent : 'Y_UP';\r\n\r\n\t\t}\r\n\r\n\t\t// library\r\n\r\n\t\tfunction parseLibrary( xml, libraryName, nodeName, parser ) {\r\n\r\n\t\t\tvar library = getElementsByTagName( xml, libraryName )[ 0 ];\r\n\r\n\t\t\tif ( library !== undefined ) {\r\n\r\n\t\t\t\tvar elements = getElementsByTagName( library, nodeName );\r\n\r\n\t\t\t\tfor ( var i = 0; i < elements.length; i ++ ) {\r\n\r\n\t\t\t\t\tparser( elements[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildLibrary( data, builder ) {\r\n\r\n\t\t\tfor ( var name in data ) {\r\n\r\n\t\t\t\tvar object = data[ name ];\r\n\t\t\t\tobject.build = builder( data[ name ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// get\r\n\r\n\t\tfunction getBuild( data, builder ) {\r\n\r\n\t\t\tif ( data.build !== undefined ) return data.build;\r\n\r\n\t\t\tdata.build = builder( data );\r\n\r\n\t\t\treturn data.build;\r\n\r\n\t\t}\r\n\r\n\t\t// animation\r\n\r\n\t\tfunction parseAnimation( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsources: {},\r\n\t\t\t\tsamplers: {},\r\n\t\t\t\tchannels: {}\r\n\t\t\t};\r\n\r\n\t\t\tvar hasChildren = false;\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tvar id;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'source':\r\n\t\t\t\t\t\tid = child.getAttribute( 'id' );\r\n\t\t\t\t\t\tdata.sources[ id ] = parseSource( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'sampler':\r\n\t\t\t\t\t\tid = child.getAttribute( 'id' );\r\n\t\t\t\t\t\tdata.samplers[ id ] = parseAnimationSampler( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'channel':\r\n\t\t\t\t\t\tid = child.getAttribute( 'target' );\r\n\t\t\t\t\t\tdata.channels[ id ] = parseAnimationChannel( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'animation':\r\n\t\t\t\t\t\t// hierarchy of related animations\r\n\t\t\t\t\t\tparseAnimation( child );\r\n\t\t\t\t\t\thasChildren = true;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log( child );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasChildren === false ) {\r\n\r\n\t\t\t\t// since 'id' attributes can be optional, it's necessary to generate a UUID for unqiue assignment\r\n\r\n\t\t\t\tlibrary.animations[ xml.getAttribute( 'id' ) || MathUtils.generateUUID() ] = data;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseAnimationSampler( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tinputs: {},\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'input':\r\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\r\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\r\n\t\t\t\t\t\tdata.inputs[ semantic ] = id;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseAnimationChannel( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tvar target = xml.getAttribute( 'target' );\r\n\r\n\t\t\t// parsing SID Addressing Syntax\r\n\r\n\t\t\tvar parts = target.split( '/' );\r\n\r\n\t\t\tvar id = parts.shift();\r\n\t\t\tvar sid = parts.shift();\r\n\r\n\t\t\t// check selection syntax\r\n\r\n\t\t\tvar arraySyntax = ( sid.indexOf( '(' ) !== - 1 );\r\n\t\t\tvar memberSyntax = ( sid.indexOf( '.' ) !== - 1 );\r\n\r\n\t\t\tif ( memberSyntax ) {\r\n\r\n\t\t\t\t//  member selection access\r\n\r\n\t\t\t\tparts = sid.split( '.' );\r\n\t\t\t\tsid = parts.shift();\r\n\t\t\t\tdata.member = parts.shift();\r\n\r\n\t\t\t} else if ( arraySyntax ) {\r\n\r\n\t\t\t\t// array-access syntax. can be used to express fields in one-dimensional vectors or two-dimensional matrices.\r\n\r\n\t\t\t\tvar indices = sid.split( '(' );\r\n\t\t\t\tsid = indices.shift();\r\n\r\n\t\t\t\tfor ( var i = 0; i < indices.length; i ++ ) {\r\n\r\n\t\t\t\t\tindices[ i ] = parseInt( indices[ i ].replace( /\\)/, '' ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata.indices = indices;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdata.id = id;\r\n\t\t\tdata.sid = sid;\r\n\r\n\t\t\tdata.arraySyntax = arraySyntax;\r\n\t\t\tdata.memberSyntax = memberSyntax;\r\n\r\n\t\t\tdata.sampler = parseId( xml.getAttribute( 'source' ) );\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildAnimation( data ) {\r\n\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tvar channels = data.channels;\r\n\t\t\tvar samplers = data.samplers;\r\n\t\t\tvar sources = data.sources;\r\n\r\n\t\t\tfor ( var target in channels ) {\r\n\r\n\t\t\t\tif ( channels.hasOwnProperty( target ) ) {\r\n\r\n\t\t\t\t\tvar channel = channels[ target ];\r\n\t\t\t\t\tvar sampler = samplers[ channel.sampler ];\r\n\r\n\t\t\t\t\tvar inputId = sampler.inputs.INPUT;\r\n\t\t\t\t\tvar outputId = sampler.inputs.OUTPUT;\r\n\r\n\t\t\t\t\tvar inputSource = sources[ inputId ];\r\n\t\t\t\t\tvar outputSource = sources[ outputId ];\r\n\r\n\t\t\t\t\tvar animation = buildAnimationChannel( channel, inputSource, outputSource );\r\n\r\n\t\t\t\t\tcreateKeyframeTracks( animation, tracks );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn tracks;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getAnimation( id ) {\r\n\r\n\t\t\treturn getBuild( library.animations[ id ], buildAnimation );\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildAnimationChannel( channel, inputSource, outputSource ) {\r\n\r\n\t\t\tvar node = library.nodes[ channel.id ];\r\n\t\t\tvar object3D = getNode( node.id );\r\n\r\n\t\t\tvar transform = node.transforms[ channel.sid ];\r\n\t\t\tvar defaultMatrix = node.matrix.clone().transpose();\r\n\r\n\t\t\tvar time, stride;\r\n\t\t\tvar i, il, j, jl;\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\t// the collada spec allows the animation of data in various ways.\r\n\t\t\t// depending on the transform type (matrix, translate, rotate, scale), we execute different logic\r\n\r\n\t\t\tswitch ( transform ) {\r\n\r\n\t\t\t\tcase 'matrix':\r\n\r\n\t\t\t\t\tfor ( i = 0, il = inputSource.array.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\ttime = inputSource.array[ i ];\r\n\t\t\t\t\t\tstride = i * outputSource.stride;\r\n\r\n\t\t\t\t\t\tif ( data[ time ] === undefined ) data[ time ] = {};\r\n\r\n\t\t\t\t\t\tif ( channel.arraySyntax === true ) {\r\n\r\n\t\t\t\t\t\t\tvar value = outputSource.array[ stride ];\r\n\t\t\t\t\t\t\tvar index = channel.indices[ 0 ] + 4 * channel.indices[ 1 ];\r\n\r\n\t\t\t\t\t\t\tdata[ time ][ index ] = value;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tfor ( j = 0, jl = outputSource.stride; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tdata[ time ][ j ] = outputSource.array[ stride + j ];\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'translate':\r\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'scale':\r\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar keyframes = prepareAnimationData( data, defaultMatrix );\r\n\r\n\t\t\tvar animation = {\r\n\t\t\t\tname: object3D.uuid,\r\n\t\t\t\tkeyframes: keyframes\r\n\t\t\t};\r\n\r\n\t\t\treturn animation;\r\n\r\n\t\t}\r\n\r\n\t\tfunction prepareAnimationData( data, defaultMatrix ) {\r\n\r\n\t\t\tvar keyframes = [];\r\n\r\n\t\t\t// transfer data into a sortable array\r\n\r\n\t\t\tfor ( var time in data ) {\r\n\r\n\t\t\t\tkeyframes.push( { time: parseFloat( time ), value: data[ time ] } );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// ensure keyframes are sorted by time\r\n\r\n\t\t\tkeyframes.sort( ascending );\r\n\r\n\t\t\t// now we clean up all animation data, so we can use them for keyframe tracks\r\n\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\t\ttransformAnimationData( keyframes, i, defaultMatrix.elements[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn keyframes;\r\n\r\n\t\t\t// array sort function\r\n\r\n\t\t\tfunction ascending( a, b ) {\r\n\r\n\t\t\t\treturn a.time - b.time;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar position = new Vector3();\r\n\t\tvar scale = new Vector3();\r\n\t\tvar quaternion = new Quaternion();\r\n\r\n\t\tfunction createKeyframeTracks( animation, tracks ) {\r\n\r\n\t\t\tvar keyframes = animation.keyframes;\r\n\t\t\tvar name = animation.name;\r\n\r\n\t\t\tvar times = [];\r\n\t\t\tvar positionData = [];\r\n\t\t\tvar quaternionData = [];\r\n\t\t\tvar scaleData = [];\r\n\r\n\t\t\tfor ( var i = 0, l = keyframes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar keyframe = keyframes[ i ];\r\n\r\n\t\t\t\tvar time = keyframe.time;\r\n\t\t\t\tvar value = keyframe.value;\r\n\r\n\t\t\t\tmatrix.fromArray( value ).transpose();\r\n\t\t\t\tmatrix.decompose( position, quaternion, scale );\r\n\r\n\t\t\t\ttimes.push( time );\r\n\t\t\t\tpositionData.push( position.x, position.y, position.z );\r\n\t\t\t\tquaternionData.push( quaternion.x, quaternion.y, quaternion.z, quaternion.w );\r\n\t\t\t\tscaleData.push( scale.x, scale.y, scale.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( positionData.length > 0 ) tracks.push( new VectorKeyframeTrack( name + '.position', times, positionData ) );\r\n\t\t\tif ( quaternionData.length > 0 ) tracks.push( new QuaternionKeyframeTrack( name + '.quaternion', times, quaternionData ) );\r\n\t\t\tif ( scaleData.length > 0 ) tracks.push( new VectorKeyframeTrack( name + '.scale', times, scaleData ) );\r\n\r\n\t\t\treturn tracks;\r\n\r\n\t\t}\r\n\r\n\t\tfunction transformAnimationData( keyframes, property, defaultValue ) {\r\n\r\n\t\t\tvar keyframe;\r\n\r\n\t\t\tvar empty = true;\r\n\t\t\tvar i, l;\r\n\r\n\t\t\t// check, if values of a property are missing in our keyframes\r\n\r\n\t\t\tfor ( i = 0, l = keyframes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tkeyframe = keyframes[ i ];\r\n\r\n\t\t\t\tif ( keyframe.value[ property ] === undefined ) {\r\n\r\n\t\t\t\t\tkeyframe.value[ property ] = null; // mark as missing\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tempty = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( empty === true ) {\r\n\r\n\t\t\t\t// no values at all, so we set a default value\r\n\r\n\t\t\t\tfor ( i = 0, l = keyframes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tkeyframe = keyframes[ i ];\r\n\r\n\t\t\t\t\tkeyframe.value[ property ] = defaultValue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// filling gaps\r\n\r\n\t\t\t\tcreateMissingKeyframes( keyframes, property );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction createMissingKeyframes( keyframes, property ) {\r\n\r\n\t\t\tvar prev, next;\r\n\r\n\t\t\tfor ( var i = 0, l = keyframes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar keyframe = keyframes[ i ];\r\n\r\n\t\t\t\tif ( keyframe.value[ property ] === null ) {\r\n\r\n\t\t\t\t\tprev = getPrev( keyframes, i, property );\r\n\t\t\t\t\tnext = getNext( keyframes, i, property );\r\n\r\n\t\t\t\t\tif ( prev === null ) {\r\n\r\n\t\t\t\t\t\tkeyframe.value[ property ] = next.value[ property ];\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( next === null ) {\r\n\r\n\t\t\t\t\t\tkeyframe.value[ property ] = prev.value[ property ];\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tinterpolate( keyframe, prev, next, property );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getPrev( keyframes, i, property ) {\r\n\r\n\t\t\twhile ( i >= 0 ) {\r\n\r\n\t\t\t\tvar keyframe = keyframes[ i ];\r\n\r\n\t\t\t\tif ( keyframe.value[ property ] !== null ) return keyframe;\r\n\r\n\t\t\t\ti --;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getNext( keyframes, i, property ) {\r\n\r\n\t\t\twhile ( i < keyframes.length ) {\r\n\r\n\t\t\t\tvar keyframe = keyframes[ i ];\r\n\r\n\t\t\t\tif ( keyframe.value[ property ] !== null ) return keyframe;\r\n\r\n\t\t\t\ti ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tfunction interpolate( key, prev, next, property ) {\r\n\r\n\t\t\tif ( ( next.time - prev.time ) === 0 ) {\r\n\r\n\t\t\t\tkey.value[ property ] = prev.value[ property ];\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tkey.value[ property ] = ( ( key.time - prev.time ) * ( next.value[ property ] - prev.value[ property ] ) / ( next.time - prev.time ) ) + prev.value[ property ];\r\n\r\n\t\t}\r\n\r\n\t\t// animation clips\r\n\r\n\t\tfunction parseAnimationClip( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'id' ) || 'default',\r\n\t\t\t\tstart: parseFloat( xml.getAttribute( 'start' ) || 0 ),\r\n\t\t\t\tend: parseFloat( xml.getAttribute( 'end' ) || 0 ),\r\n\t\t\t\tanimations: []\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'instance_animation':\r\n\t\t\t\t\t\tdata.animations.push( parseId( child.getAttribute( 'url' ) ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.clips[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildAnimationClip( data ) {\r\n\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tvar name = data.name;\r\n\t\t\tvar duration = ( data.end - data.start ) || - 1;\r\n\t\t\tvar animations = data.animations;\r\n\r\n\t\t\tfor ( var i = 0, il = animations.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar animationTracks = getAnimation( animations[ i ] );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = animationTracks.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\ttracks.push( animationTracks[ j ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn new AnimationClip( name, duration, tracks );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getAnimationClip( id ) {\r\n\r\n\t\t\treturn getBuild( library.clips[ id ], buildAnimationClip );\r\n\r\n\t\t}\r\n\r\n\t\t// controller\r\n\r\n\t\tfunction parseController( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'skin':\r\n\t\t\t\t\t\t// there is exactly one skin per controller\r\n\t\t\t\t\t\tdata.id = parseId( child.getAttribute( 'source' ) );\r\n\t\t\t\t\t\tdata.skin = parseSkin( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'morph':\r\n\t\t\t\t\t\tdata.id = parseId( child.getAttribute( 'source' ) );\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Morph target animation not supported yet.' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.controllers[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseSkin( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsources: {}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'bind_shape_matrix':\r\n\t\t\t\t\t\tdata.bindShapeMatrix = parseFloats( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'source':\r\n\t\t\t\t\t\tvar id = child.getAttribute( 'id' );\r\n\t\t\t\t\t\tdata.sources[ id ] = parseSource( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'joints':\r\n\t\t\t\t\t\tdata.joints = parseJoints( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'vertex_weights':\r\n\t\t\t\t\t\tdata.vertexWeights = parseVertexWeights( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseJoints( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tinputs: {}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'input':\r\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\r\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\r\n\t\t\t\t\t\tdata.inputs[ semantic ] = id;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseVertexWeights( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tinputs: {}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'input':\r\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\r\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\r\n\t\t\t\t\t\tvar offset = parseInt( child.getAttribute( 'offset' ) );\r\n\t\t\t\t\t\tdata.inputs[ semantic ] = { id: id, offset: offset };\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'vcount':\r\n\t\t\t\t\t\tdata.vcount = parseInts( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'v':\r\n\t\t\t\t\t\tdata.v = parseInts( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildController( data ) {\r\n\r\n\t\t\tvar build = {\r\n\t\t\t\tid: data.id\r\n\t\t\t};\r\n\r\n\t\t\tvar geometry = library.geometries[ build.id ];\r\n\r\n\t\t\tif ( data.skin !== undefined ) {\r\n\r\n\t\t\t\tbuild.skin = buildSkin( data.skin );\r\n\r\n\t\t\t\t// we enhance the 'sources' property of the corresponding geometry with our skin data\r\n\r\n\t\t\t\tgeometry.sources.skinIndices = build.skin.indices;\r\n\t\t\t\tgeometry.sources.skinWeights = build.skin.weights;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn build;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildSkin( data ) {\r\n\r\n\t\t\tvar BONE_LIMIT = 4;\r\n\r\n\t\t\tvar build = {\r\n\t\t\t\tjoints: [], // this must be an array to preserve the joint order\r\n\t\t\t\tindices: {\r\n\t\t\t\t\tarray: [],\r\n\t\t\t\t\tstride: BONE_LIMIT\r\n\t\t\t\t},\r\n\t\t\t\tweights: {\r\n\t\t\t\t\tarray: [],\r\n\t\t\t\t\tstride: BONE_LIMIT\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tvar sources = data.sources;\r\n\t\t\tvar vertexWeights = data.vertexWeights;\r\n\r\n\t\t\tvar vcount = vertexWeights.vcount;\r\n\t\t\tvar v = vertexWeights.v;\r\n\t\t\tvar jointOffset = vertexWeights.inputs.JOINT.offset;\r\n\t\t\tvar weightOffset = vertexWeights.inputs.WEIGHT.offset;\r\n\r\n\t\t\tvar jointSource = data.sources[ data.joints.inputs.JOINT ];\r\n\t\t\tvar inverseSource = data.sources[ data.joints.inputs.INV_BIND_MATRIX ];\r\n\r\n\t\t\tvar weights = sources[ vertexWeights.inputs.WEIGHT.id ].array;\r\n\t\t\tvar stride = 0;\r\n\r\n\t\t\tvar i, j, l;\r\n\r\n\t\t\t// procces skin data for each vertex\r\n\r\n\t\t\tfor ( i = 0, l = vcount.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar jointCount = vcount[ i ]; // this is the amount of joints that affect a single vertex\r\n\t\t\t\tvar vertexSkinData = [];\r\n\r\n\t\t\t\tfor ( j = 0; j < jointCount; j ++ ) {\r\n\r\n\t\t\t\t\tvar skinIndex = v[ stride + jointOffset ];\r\n\t\t\t\t\tvar weightId = v[ stride + weightOffset ];\r\n\t\t\t\t\tvar skinWeight = weights[ weightId ];\r\n\r\n\t\t\t\t\tvertexSkinData.push( { index: skinIndex, weight: skinWeight } );\r\n\r\n\t\t\t\t\tstride += 2;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// we sort the joints in descending order based on the weights.\r\n\t\t\t\t// this ensures, we only procced the most important joints of the vertex\r\n\r\n\t\t\t\tvertexSkinData.sort( descending );\r\n\r\n\t\t\t\t// now we provide for each vertex a set of four index and weight values.\r\n\t\t\t\t// the order of the skin data matches the order of vertices\r\n\r\n\t\t\t\tfor ( j = 0; j < BONE_LIMIT; j ++ ) {\r\n\r\n\t\t\t\t\tvar d = vertexSkinData[ j ];\r\n\r\n\t\t\t\t\tif ( d !== undefined ) {\r\n\r\n\t\t\t\t\t\tbuild.indices.array.push( d.index );\r\n\t\t\t\t\t\tbuild.weights.array.push( d.weight );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tbuild.indices.array.push( 0 );\r\n\t\t\t\t\t\tbuild.weights.array.push( 0 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// setup bind matrix\r\n\r\n\t\t\tif ( data.bindShapeMatrix ) {\r\n\r\n\t\t\t\tbuild.bindMatrix = new Matrix4().fromArray( data.bindShapeMatrix ).transpose();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbuild.bindMatrix = new Matrix4().identity();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// process bones and inverse bind matrix data\r\n\r\n\t\t\tfor ( i = 0, l = jointSource.array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar name = jointSource.array[ i ];\r\n\t\t\t\tvar boneInverse = new Matrix4().fromArray( inverseSource.array, i * inverseSource.stride ).transpose();\r\n\r\n\t\t\t\tbuild.joints.push( { name: name, boneInverse: boneInverse } );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn build;\r\n\r\n\t\t\t// array sort function\r\n\r\n\t\t\tfunction descending( a, b ) {\r\n\r\n\t\t\t\treturn b.weight - a.weight;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getController( id ) {\r\n\r\n\t\t\treturn getBuild( library.controllers[ id ], buildController );\r\n\r\n\t\t}\r\n\r\n\t\t// image\r\n\r\n\t\tfunction parseImage( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tinit_from: getElementsByTagName( xml, 'init_from' )[ 0 ].textContent\r\n\t\t\t};\r\n\r\n\t\t\tlibrary.images[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildImage( data ) {\r\n\r\n\t\t\tif ( data.build !== undefined ) return data.build;\r\n\r\n\t\t\treturn data.init_from;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getImage( id ) {\r\n\r\n\t\t\tvar data = library.images[ id ];\r\n\r\n\t\t\tif ( data !== undefined ) {\r\n\r\n\t\t\t\treturn getBuild( data, buildImage );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t find image with ID:', id );\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\t// effect\r\n\r\n\t\tfunction parseEffect( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'profile_COMMON':\r\n\t\t\t\t\t\tdata.profile = parseEffectProfileCOMMON( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.effects[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectProfileCOMMON( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsurfaces: {},\r\n\t\t\t\tsamplers: {}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'newparam':\r\n\t\t\t\t\t\tparseEffectNewparam( child, data );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'technique':\r\n\t\t\t\t\t\tdata.technique = parseEffectTechnique( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'extra':\r\n\t\t\t\t\t\tdata.extra = parseEffectExtra( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectNewparam( xml, data ) {\r\n\r\n\t\t\tvar sid = xml.getAttribute( 'sid' );\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'surface':\r\n\t\t\t\t\t\tdata.surfaces[ sid ] = parseEffectSurface( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'sampler2D':\r\n\t\t\t\t\t\tdata.samplers[ sid ] = parseEffectSampler( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectSurface( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'init_from':\r\n\t\t\t\t\t\tdata.init_from = child.textContent;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectSampler( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'source':\r\n\t\t\t\t\t\tdata.source = child.textContent;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectTechnique( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'constant':\r\n\t\t\t\t\tcase 'lambert':\r\n\t\t\t\t\tcase 'blinn':\r\n\t\t\t\t\tcase 'phong':\r\n\t\t\t\t\t\tdata.type = child.nodeName;\r\n\t\t\t\t\t\tdata.parameters = parseEffectParameters( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectParameters( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'emission':\r\n\t\t\t\t\tcase 'diffuse':\r\n\t\t\t\t\tcase 'specular':\r\n\t\t\t\t\tcase 'bump':\r\n\t\t\t\t\tcase 'ambient':\r\n\t\t\t\t\tcase 'shininess':\r\n\t\t\t\t\tcase 'transparency':\r\n\t\t\t\t\t\tdata[ child.nodeName ] = parseEffectParameter( child );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'transparent':\r\n\t\t\t\t\t\tdata[ child.nodeName ] = {\r\n\t\t\t\t\t\t\topaque: child.getAttribute( 'opaque' ),\r\n\t\t\t\t\t\t\tdata: parseEffectParameter( child )\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectParameter( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'color':\r\n\t\t\t\t\t\tdata[ child.nodeName ] = parseFloats( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'float':\r\n\t\t\t\t\t\tdata[ child.nodeName ] = parseFloat( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'texture':\r\n\t\t\t\t\t\tdata[ child.nodeName ] = { id: child.getAttribute( 'texture' ), extra: parseEffectParameterTexture( child ) };\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectParameterTexture( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\ttechnique: {}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'extra':\r\n\t\t\t\t\t\tparseEffectParameterTextureExtra( child, data );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectParameterTextureExtra( xml, data ) {\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'technique':\r\n\t\t\t\t\t\tparseEffectParameterTextureExtraTechnique( child, data );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectParameterTextureExtraTechnique( xml, data ) {\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'repeatU':\r\n\t\t\t\t\tcase 'repeatV':\r\n\t\t\t\t\tcase 'offsetU':\r\n\t\t\t\t\tcase 'offsetV':\r\n\t\t\t\t\t\tdata.technique[ child.nodeName ] = parseFloat( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'wrapU':\r\n\t\t\t\t\tcase 'wrapV':\r\n\r\n\t\t\t\t\t\t// some files have values for wrapU/wrapV which become NaN via parseInt\r\n\r\n\t\t\t\t\t\tif ( child.textContent.toUpperCase() === 'TRUE' ) {\r\n\r\n\t\t\t\t\t\t\tdata.technique[ child.nodeName ] = 1;\r\n\r\n\t\t\t\t\t\t} else if ( child.textContent.toUpperCase() === 'FALSE' ) {\r\n\r\n\t\t\t\t\t\t\tdata.technique[ child.nodeName ] = 0;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tdata.technique[ child.nodeName ] = parseInt( child.textContent );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectExtra( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'technique':\r\n\t\t\t\t\t\tdata.technique = parseEffectExtraTechnique( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseEffectExtraTechnique( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'double_sided':\r\n\t\t\t\t\t\tdata[ child.nodeName ] = parseInt( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildEffect( data ) {\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getEffect( id ) {\r\n\r\n\t\t\treturn getBuild( library.effects[ id ], buildEffect );\r\n\r\n\t\t}\r\n\r\n\t\t// material\r\n\r\n\t\tfunction parseMaterial( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'name' )\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'instance_effect':\r\n\t\t\t\t\t\tdata.url = parseId( child.getAttribute( 'url' ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.materials[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getTextureLoader( image ) {\r\n\r\n\t\t\tvar loader;\r\n\r\n\t\t\tvar extension = image.slice( ( image.lastIndexOf( '.' ) - 1 >>> 0 ) + 2 ); // http://www.jstips.co/en/javascript/get-file-extension/\r\n\t\t\textension = extension.toLowerCase();\r\n\r\n\t\t\tswitch ( extension ) {\r\n\r\n\t\t\t\tcase 'tga':\r\n\t\t\t\t\tloader = tgaLoader;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tloader = textureLoader;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn loader;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildMaterial( data ) {\r\n\r\n\t\t\tvar effect = getEffect( data.url );\r\n\t\t\tvar technique = effect.profile.technique;\r\n\t\t\tvar extra = effect.profile.extra;\r\n\r\n\t\t\tvar material;\r\n\r\n\t\t\tswitch ( technique.type ) {\r\n\r\n\t\t\t\tcase 'phong':\r\n\t\t\t\tcase 'blinn':\r\n\t\t\t\t\tmaterial = new MeshPhongMaterial();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'lambert':\r\n\t\t\t\t\tmaterial = new MeshLambertMaterial();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tmaterial = new MeshBasicMaterial();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.name = data.name || '';\r\n\r\n\t\t\tfunction getTexture( textureObject ) {\r\n\r\n\t\t\t\tvar sampler = effect.profile.samplers[ textureObject.id ];\r\n\t\t\t\tvar image = null;\r\n\r\n\t\t\t\t// get image\r\n\r\n\t\t\t\tif ( sampler !== undefined ) {\r\n\r\n\t\t\t\t\tvar surface = effect.profile.surfaces[ sampler.source ];\r\n\t\t\t\t\timage = getImage( surface.init_from );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530).' );\r\n\t\t\t\t\timage = getImage( textureObject.id );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// create texture if image is avaiable\r\n\r\n\t\t\t\tif ( image !== null ) {\r\n\r\n\t\t\t\t\tvar loader = getTextureLoader( image );\r\n\r\n\t\t\t\t\tif ( loader !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar texture = loader.load( image );\r\n\r\n\t\t\t\t\t\tvar extra = textureObject.extra;\r\n\r\n\t\t\t\t\t\tif ( extra !== undefined && extra.technique !== undefined && isEmpty( extra.technique ) === false ) {\r\n\r\n\t\t\t\t\t\t\tvar technique = extra.technique;\r\n\r\n\t\t\t\t\t\t\ttexture.wrapS = technique.wrapU ? RepeatWrapping : ClampToEdgeWrapping;\r\n\t\t\t\t\t\t\ttexture.wrapT = technique.wrapV ? RepeatWrapping : ClampToEdgeWrapping;\r\n\r\n\t\t\t\t\t\t\ttexture.offset.set( technique.offsetU || 0, technique.offsetV || 0 );\r\n\t\t\t\t\t\t\ttexture.repeat.set( technique.repeatU || 1, technique.repeatV || 1 );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\ttexture.wrapS = RepeatWrapping;\r\n\t\t\t\t\t\t\ttexture.wrapT = RepeatWrapping;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn texture;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Loader for texture %s not found.', image );\r\n\r\n\t\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t create texture with ID:', textureObject.id );\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar parameters = technique.parameters;\r\n\r\n\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\tvar parameter = parameters[ key ];\r\n\r\n\t\t\t\tswitch ( key ) {\r\n\r\n\t\t\t\t\tcase 'diffuse':\r\n\t\t\t\t\t\tif ( parameter.color ) material.color.fromArray( parameter.color );\r\n\t\t\t\t\t\tif ( parameter.texture ) material.map = getTexture( parameter.texture );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'specular':\r\n\t\t\t\t\t\tif ( parameter.color && material.specular ) material.specular.fromArray( parameter.color );\r\n\t\t\t\t\t\tif ( parameter.texture ) material.specularMap = getTexture( parameter.texture );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'bump':\r\n\t\t\t\t\t\tif ( parameter.texture ) material.normalMap = getTexture( parameter.texture );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ambient':\r\n\t\t\t\t\t\tif ( parameter.texture ) material.lightMap = getTexture( parameter.texture );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'shininess':\r\n\t\t\t\t\t\tif ( parameter.float && material.shininess ) material.shininess = parameter.float;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'emission':\r\n\t\t\t\t\t\tif ( parameter.color && material.emissive ) material.emissive.fromArray( parameter.color );\r\n\t\t\t\t\t\tif ( parameter.texture ) material.emissiveMap = getTexture( parameter.texture );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar transparent = parameters[ 'transparent' ];\r\n\t\t\tvar transparency = parameters[ 'transparency' ];\r\n\r\n\t\t\t// <transparency> does not exist but <transparent>\r\n\r\n\t\t\tif ( transparency === undefined && transparent ) {\r\n\r\n\t\t\t\ttransparency = {\r\n\t\t\t\t\tfloat: 1\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// <transparent> does not exist but <transparency>\r\n\r\n\t\t\tif ( transparent === undefined && transparency ) {\r\n\r\n\t\t\t\ttransparent = {\r\n\t\t\t\t\topaque: 'A_ONE',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tcolor: [ 1, 1, 1, 1 ]\r\n\t\t\t\t\t} };\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( transparent && transparency ) {\r\n\r\n\t\t\t\t// handle case if a texture exists but no color\r\n\r\n\t\t\t\tif ( transparent.data.texture ) {\r\n\r\n\t\t\t\t\t// we do not set an alpha map (see #13792)\r\n\r\n\t\t\t\t\tmaterial.transparent = true;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar color = transparent.data.color;\r\n\r\n\t\t\t\t\tswitch ( transparent.opaque ) {\r\n\r\n\t\t\t\t\t\tcase 'A_ONE':\r\n\t\t\t\t\t\t\tmaterial.opacity = color[ 3 ] * transparency.float;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'RGB_ZERO':\r\n\t\t\t\t\t\t\tmaterial.opacity = 1 - ( color[ 0 ] * transparency.float );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'A_ZERO':\r\n\t\t\t\t\t\t\tmaterial.opacity = 1 - ( color[ 3 ] * transparency.float );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'RGB_ONE':\r\n\t\t\t\t\t\t\tmaterial.opacity = color[ 0 ] * transparency.float;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Invalid opaque type \"%s\" of transparent tag.', transparent.opaque );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( material.opacity < 1 ) material.transparent = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( extra !== undefined && extra.technique !== undefined && extra.technique.double_sided === 1 ) {\r\n\r\n\t\t\t\tmaterial.side = DoubleSide;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getMaterial( id ) {\r\n\r\n\t\t\treturn getBuild( library.materials[ id ], buildMaterial );\r\n\r\n\t\t}\r\n\r\n\t\t// camera\r\n\r\n\t\tfunction parseCamera( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'name' )\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'optics':\r\n\t\t\t\t\t\tdata.optics = parseCameraOptics( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.cameras[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseCameraOptics( xml ) {\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'technique_common':\r\n\t\t\t\t\t\treturn parseCameraTechnique( child );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {};\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseCameraTechnique( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'perspective':\r\n\t\t\t\t\tcase 'orthographic':\r\n\r\n\t\t\t\t\t\tdata.technique = child.nodeName;\r\n\t\t\t\t\t\tdata.parameters = parseCameraParameters( child );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseCameraParameters( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'xfov':\r\n\t\t\t\t\tcase 'yfov':\r\n\t\t\t\t\tcase 'xmag':\r\n\t\t\t\t\tcase 'ymag':\r\n\t\t\t\t\tcase 'znear':\r\n\t\t\t\t\tcase 'zfar':\r\n\t\t\t\t\tcase 'aspect_ratio':\r\n\t\t\t\t\t\tdata[ child.nodeName ] = parseFloat( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildCamera( data ) {\r\n\r\n\t\t\tvar camera;\r\n\r\n\t\t\tswitch ( data.optics.technique ) {\r\n\r\n\t\t\t\tcase 'perspective':\r\n\t\t\t\t\tcamera = new PerspectiveCamera(\r\n\t\t\t\t\t\tdata.optics.parameters.yfov,\r\n\t\t\t\t\t\tdata.optics.parameters.aspect_ratio,\r\n\t\t\t\t\t\tdata.optics.parameters.znear,\r\n\t\t\t\t\t\tdata.optics.parameters.zfar\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'orthographic':\r\n\t\t\t\t\tvar ymag = data.optics.parameters.ymag;\r\n\t\t\t\t\tvar xmag = data.optics.parameters.xmag;\r\n\t\t\t\t\tvar aspectRatio = data.optics.parameters.aspect_ratio;\r\n\r\n\t\t\t\t\txmag = ( xmag === undefined ) ? ( ymag * aspectRatio ) : xmag;\r\n\t\t\t\t\tymag = ( ymag === undefined ) ? ( xmag / aspectRatio ) : ymag;\r\n\r\n\t\t\t\t\txmag *= 0.5;\r\n\t\t\t\t\tymag *= 0.5;\r\n\r\n\t\t\t\t\tcamera = new OrthographicCamera(\r\n\t\t\t\t\t\t- xmag, xmag, ymag, - ymag, // left, right, top, bottom\r\n\t\t\t\t\t\tdata.optics.parameters.znear,\r\n\t\t\t\t\t\tdata.optics.parameters.zfar\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tcamera = new PerspectiveCamera();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcamera.name = data.name || '';\r\n\r\n\t\t\treturn camera;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getCamera( id ) {\r\n\r\n\t\t\tvar data = library.cameras[ id ];\r\n\r\n\t\t\tif ( data !== undefined ) {\r\n\r\n\t\t\t\treturn getBuild( data, buildCamera );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t find camera with ID:', id );\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\t// light\r\n\r\n\t\tfunction parseLight( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'technique_common':\r\n\t\t\t\t\t\tdata = parseLightTechnique( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.lights[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseLightTechnique( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'directional':\r\n\t\t\t\t\tcase 'point':\r\n\t\t\t\t\tcase 'spot':\r\n\t\t\t\t\tcase 'ambient':\r\n\r\n\t\t\t\t\t\tdata.technique = child.nodeName;\r\n\t\t\t\t\t\tdata.parameters = parseLightParameters( child );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseLightParameters( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'color':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tdata.color = new Color().fromArray( array );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'falloff_angle':\r\n\t\t\t\t\t\tdata.falloffAngle = parseFloat( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'quadratic_attenuation':\r\n\t\t\t\t\t\tvar f = parseFloat( child.textContent );\r\n\t\t\t\t\t\tdata.distance = f ? Math.sqrt( 1 / f ) : 0;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildLight( data ) {\r\n\r\n\t\t\tvar light;\r\n\r\n\t\t\tswitch ( data.technique ) {\r\n\r\n\t\t\t\tcase 'directional':\r\n\t\t\t\t\tlight = new DirectionalLight();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'point':\r\n\t\t\t\t\tlight = new PointLight();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'spot':\r\n\t\t\t\t\tlight = new SpotLight();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'ambient':\r\n\t\t\t\t\tlight = new AmbientLight();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.parameters.color ) light.color.copy( data.parameters.color );\r\n\t\t\tif ( data.parameters.distance ) light.distance = data.parameters.distance;\r\n\r\n\t\t\treturn light;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getLight( id ) {\r\n\r\n\t\t\tvar data = library.lights[ id ];\r\n\r\n\t\t\tif ( data !== undefined ) {\r\n\r\n\t\t\t\treturn getBuild( data, buildLight );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconsole.warn( 'THREE.ColladaLoader: Couldn\\'t find light with ID:', id );\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\t// geometry\r\n\r\n\t\tfunction parseGeometry( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'name' ),\r\n\t\t\t\tsources: {},\r\n\t\t\t\tvertices: {},\r\n\t\t\t\tprimitives: []\r\n\t\t\t};\r\n\r\n\t\t\tvar mesh = getElementsByTagName( xml, 'mesh' )[ 0 ];\r\n\r\n\t\t\t// the following tags inside geometry are not supported yet (see https://github.com/mrdoob/three.js/pull/12606): convex_mesh, spline, brep\r\n\t\t\tif ( mesh === undefined ) return;\r\n\r\n\t\t\tfor ( var i = 0; i < mesh.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = mesh.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tvar id = child.getAttribute( 'id' );\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'source':\r\n\t\t\t\t\t\tdata.sources[ id ] = parseSource( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'vertices':\r\n\t\t\t\t\t\t// data.sources[ id ] = data.sources[ parseId( getElementsByTagName( child, 'input' )[ 0 ].getAttribute( 'source' ) ) ];\r\n\t\t\t\t\t\tdata.vertices = parseGeometryVertices( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'polygons':\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Unsupported primitive type: ', child.nodeName );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'lines':\r\n\t\t\t\t\tcase 'linestrips':\r\n\t\t\t\t\tcase 'polylist':\r\n\t\t\t\t\tcase 'triangles':\r\n\t\t\t\t\t\tdata.primitives.push( parseGeometryPrimitive( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log( child );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.geometries[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseSource( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tarray: [],\r\n\t\t\t\tstride: 3\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'float_array':\r\n\t\t\t\t\t\tdata.array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'Name_array':\r\n\t\t\t\t\t\tdata.array = parseStrings( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'technique_common':\r\n\t\t\t\t\t\tvar accessor = getElementsByTagName( child, 'accessor' )[ 0 ];\r\n\r\n\t\t\t\t\t\tif ( accessor !== undefined ) {\r\n\r\n\t\t\t\t\t\t\tdata.stride = parseInt( accessor.getAttribute( 'stride' ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseGeometryVertices( xml ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tdata[ child.getAttribute( 'semantic' ) ] = parseId( child.getAttribute( 'source' ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseGeometryPrimitive( xml ) {\r\n\r\n\t\t\tvar primitive = {\r\n\t\t\t\ttype: xml.nodeName,\r\n\t\t\t\tmaterial: xml.getAttribute( 'material' ),\r\n\t\t\t\tcount: parseInt( xml.getAttribute( 'count' ) ),\r\n\t\t\t\tinputs: {},\r\n\t\t\t\tstride: 0,\r\n\t\t\t\thasUV: false\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'input':\r\n\t\t\t\t\t\tvar id = parseId( child.getAttribute( 'source' ) );\r\n\t\t\t\t\t\tvar semantic = child.getAttribute( 'semantic' );\r\n\t\t\t\t\t\tvar offset = parseInt( child.getAttribute( 'offset' ) );\r\n\t\t\t\t\t\tvar set = parseInt( child.getAttribute( 'set' ) );\r\n\t\t\t\t\t\tvar inputname = ( set > 0 ? semantic + set : semantic );\r\n\t\t\t\t\t\tprimitive.inputs[ inputname ] = { id: id, offset: offset };\r\n\t\t\t\t\t\tprimitive.stride = Math.max( primitive.stride, offset + 1 );\r\n\t\t\t\t\t\tif ( semantic === 'TEXCOORD' ) primitive.hasUV = true;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'vcount':\r\n\t\t\t\t\t\tprimitive.vcount = parseInts( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'p':\r\n\t\t\t\t\t\tprimitive.p = parseInts( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn primitive;\r\n\r\n\t\t}\r\n\r\n\t\tfunction groupPrimitives( primitives ) {\r\n\r\n\t\t\tvar build = {};\r\n\r\n\t\t\tfor ( var i = 0; i < primitives.length; i ++ ) {\r\n\r\n\t\t\t\tvar primitive = primitives[ i ];\r\n\r\n\t\t\t\tif ( build[ primitive.type ] === undefined ) build[ primitive.type ] = [];\r\n\r\n\t\t\t\tbuild[ primitive.type ].push( primitive );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn build;\r\n\r\n\t\t}\r\n\r\n\t\tfunction checkUVCoordinates( primitives ) {\r\n\r\n\t\t\tvar count = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = primitives.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar primitive = primitives[ i ];\r\n\r\n\t\t\t\tif ( primitive.hasUV === true ) {\r\n\r\n\t\t\t\t\tcount ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( count > 0 && count < primitives.length ) {\r\n\r\n\t\t\t\tprimitives.uvsNeedsFix = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildGeometry( data ) {\r\n\r\n\t\t\tvar build = {};\r\n\r\n\t\t\tvar sources = data.sources;\r\n\t\t\tvar vertices = data.vertices;\r\n\t\t\tvar primitives = data.primitives;\r\n\r\n\t\t\tif ( primitives.length === 0 ) return {};\r\n\r\n\t\t\t// our goal is to create one buffer geometry for a single type of primitives\r\n\t\t\t// first, we group all primitives by their type\r\n\r\n\t\t\tvar groupedPrimitives = groupPrimitives( primitives );\r\n\r\n\t\t\tfor ( var type in groupedPrimitives ) {\r\n\r\n\t\t\t\tvar primitiveType = groupedPrimitives[ type ];\r\n\r\n\t\t\t\t// second, ensure consistent uv coordinates for each type of primitives (polylist,triangles or lines)\r\n\r\n\t\t\t\tcheckUVCoordinates( primitiveType );\r\n\r\n\t\t\t\t// third, create a buffer geometry for each type of primitives\r\n\r\n\t\t\t\tbuild[ type ] = buildGeometryType( primitiveType, sources, vertices );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn build;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildGeometryType( primitives, sources, vertices ) {\r\n\r\n\t\t\tvar build = {};\r\n\r\n\t\t\tvar position = { array: [], stride: 0 };\r\n\t\t\tvar normal = { array: [], stride: 0 };\r\n\t\t\tvar uv = { array: [], stride: 0 };\r\n\t\t\tvar uv2 = { array: [], stride: 0 };\r\n\t\t\tvar color = { array: [], stride: 0 };\r\n\r\n\t\t\tvar skinIndex = { array: [], stride: 4 };\r\n\t\t\tvar skinWeight = { array: [], stride: 4 };\r\n\r\n\t\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\t\tvar materialKeys = [];\r\n\r\n\t\t\tvar start = 0;\r\n\r\n\t\t\tfor ( var p = 0; p < primitives.length; p ++ ) {\r\n\r\n\t\t\t\tvar primitive = primitives[ p ];\r\n\t\t\t\tvar inputs = primitive.inputs;\r\n\r\n\t\t\t\t// groups\r\n\r\n\t\t\t\tvar count = 0;\r\n\r\n\t\t\t\tswitch ( primitive.type ) {\r\n\r\n\t\t\t\t\tcase 'lines':\r\n\t\t\t\t\tcase 'linestrips':\r\n\t\t\t\t\t\tcount = primitive.count * 2;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'triangles':\r\n\t\t\t\t\t\tcount = primitive.count * 3;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'polylist':\r\n\r\n\t\t\t\t\t\tfor ( var g = 0; g < primitive.count; g ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar vc = primitive.vcount[ g ];\r\n\r\n\t\t\t\t\t\t\tswitch ( vc ) {\r\n\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\tcount += 3; // single triangle\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t\tcount += 6; // quad, subdivided into two triangles\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\tcount += ( vc - 2 ) * 3; // polylist with more than four vertices\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Unknow primitive type:', primitive.type );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.addGroup( start, count, p );\r\n\t\t\t\tstart += count;\r\n\r\n\t\t\t\t// material\r\n\r\n\t\t\t\tif ( primitive.material ) {\r\n\r\n\t\t\t\t\tmaterialKeys.push( primitive.material );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// geometry data\r\n\r\n\t\t\t\tfor ( var name in inputs ) {\r\n\r\n\t\t\t\t\tvar input = inputs[ name ];\r\n\r\n\t\t\t\t\tswitch ( name )\t{\r\n\r\n\t\t\t\t\t\tcase 'VERTEX':\r\n\t\t\t\t\t\t\tfor ( var key in vertices ) {\r\n\r\n\t\t\t\t\t\t\t\tvar id = vertices[ key ];\r\n\r\n\t\t\t\t\t\t\t\tswitch ( key ) {\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'POSITION':\r\n\t\t\t\t\t\t\t\t\t\tvar prevLength = position.array.length;\r\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, position.array );\r\n\t\t\t\t\t\t\t\t\t\tposition.stride = sources[ id ].stride;\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( sources.skinWeights && sources.skinIndices ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources.skinIndices, input.offset, skinIndex.array );\r\n\t\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources.skinWeights, input.offset, skinWeight.array );\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// see #3803\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( primitive.hasUV === false && primitives.uvsNeedsFix === true ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tvar count = ( position.array.length - prevLength ) / position.stride;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < count; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// fill missing uv coordinates\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tuv.array.push( 0, 0 );\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'NORMAL':\r\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, normal.array );\r\n\t\t\t\t\t\t\t\t\t\tnormal.stride = sources[ id ].stride;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'COLOR':\r\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, color.array );\r\n\t\t\t\t\t\t\t\t\t\tcolor.stride = sources[ id ].stride;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'TEXCOORD':\r\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, uv.array );\r\n\t\t\t\t\t\t\t\t\t\tuv.stride = sources[ id ].stride;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'TEXCOORD1':\r\n\t\t\t\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ id ], input.offset, uv2.array );\r\n\t\t\t\t\t\t\t\t\t\tuv.stride = sources[ id ].stride;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Semantic \"%s\" not handled in geometry build process.', key );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'NORMAL':\r\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, normal.array );\r\n\t\t\t\t\t\t\tnormal.stride = sources[ input.id ].stride;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'COLOR':\r\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, color.array );\r\n\t\t\t\t\t\t\tcolor.stride = sources[ input.id ].stride;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'TEXCOORD':\r\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, uv.array );\r\n\t\t\t\t\t\t\tuv.stride = sources[ input.id ].stride;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'TEXCOORD1':\r\n\t\t\t\t\t\t\tbuildGeometryData( primitive, sources[ input.id ], input.offset, uv2.array );\r\n\t\t\t\t\t\t\tuv2.stride = sources[ input.id ].stride;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// build geometry\r\n\r\n\t\t\tif ( position.array.length > 0 ) geometry.setAttribute( 'position', new Float32BufferAttribute( position.array, position.stride ) );\r\n\t\t\tif ( normal.array.length > 0 ) geometry.setAttribute( 'normal', new Float32BufferAttribute( normal.array, normal.stride ) );\r\n\t\t\tif ( color.array.length > 0 ) geometry.setAttribute( 'color', new Float32BufferAttribute( color.array, color.stride ) );\r\n\t\t\tif ( uv.array.length > 0 ) geometry.setAttribute( 'uv', new Float32BufferAttribute( uv.array, uv.stride ) );\r\n\t\t\tif ( uv2.array.length > 0 ) geometry.setAttribute( 'uv2', new Float32BufferAttribute( uv2.array, uv2.stride ) );\r\n\r\n\t\t\tif ( skinIndex.array.length > 0 ) geometry.setAttribute( 'skinIndex', new Float32BufferAttribute( skinIndex.array, skinIndex.stride ) );\r\n\t\t\tif ( skinWeight.array.length > 0 ) geometry.setAttribute( 'skinWeight', new Float32BufferAttribute( skinWeight.array, skinWeight.stride ) );\r\n\r\n\t\t\tbuild.data = geometry;\r\n\t\t\tbuild.type = primitives[ 0 ].type;\r\n\t\t\tbuild.materialKeys = materialKeys;\r\n\r\n\t\t\treturn build;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildGeometryData( primitive, source, offset, array ) {\r\n\r\n\t\t\tvar indices = primitive.p;\r\n\t\t\tvar stride = primitive.stride;\r\n\t\t\tvar vcount = primitive.vcount;\r\n\r\n\t\t\tfunction pushVector( i ) {\r\n\r\n\t\t\t\tvar index = indices[ i + offset ] * sourceStride;\r\n\t\t\t\tvar length = index + sourceStride;\r\n\r\n\t\t\t\tfor ( ; index < length; index ++ ) {\r\n\r\n\t\t\t\t\tarray.push( sourceArray[ index ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar sourceArray = source.array;\r\n\t\t\tvar sourceStride = source.stride;\r\n\r\n\t\t\tif ( primitive.vcount !== undefined ) {\r\n\r\n\t\t\t\tvar index = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, l = vcount.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar count = vcount[ i ];\r\n\r\n\t\t\t\t\tif ( count === 4 ) {\r\n\r\n\t\t\t\t\t\tvar a = index + stride * 0;\r\n\t\t\t\t\t\tvar b = index + stride * 1;\r\n\t\t\t\t\t\tvar c = index + stride * 2;\r\n\t\t\t\t\t\tvar d = index + stride * 3;\r\n\r\n\t\t\t\t\t\tpushVector( a ); pushVector( b ); pushVector( d );\r\n\t\t\t\t\t\tpushVector( b ); pushVector( c ); pushVector( d );\r\n\r\n\t\t\t\t\t} else if ( count === 3 ) {\r\n\r\n\t\t\t\t\t\tvar a = index + stride * 0;\r\n\t\t\t\t\t\tvar b = index + stride * 1;\r\n\t\t\t\t\t\tvar c = index + stride * 2;\r\n\r\n\t\t\t\t\t\tpushVector( a ); pushVector( b ); pushVector( c );\r\n\r\n\t\t\t\t\t} else if ( count > 4 ) {\r\n\r\n\t\t\t\t\t\tfor ( var k = 1, kl = ( count - 2 ); k <= kl; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar a = index + stride * 0;\r\n\t\t\t\t\t\t\tvar b = index + stride * k;\r\n\t\t\t\t\t\t\tvar c = index + stride * ( k + 1 );\r\n\r\n\t\t\t\t\t\t\tpushVector( a ); pushVector( b ); pushVector( c );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tindex += stride * count;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += stride ) {\r\n\r\n\t\t\t\t\tpushVector( i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getGeometry( id ) {\r\n\r\n\t\t\treturn getBuild( library.geometries[ id ], buildGeometry );\r\n\r\n\t\t}\r\n\r\n\t\t// kinematics\r\n\r\n\t\tfunction parseKinematicsModel( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\r\n\t\t\t\tjoints: {},\r\n\t\t\t\tlinks: []\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'technique_common':\r\n\t\t\t\t\t\tparseKinematicsTechniqueCommon( child, data );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.kinematicsModels[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildKinematicsModel( data ) {\r\n\r\n\t\t\tif ( data.build !== undefined ) return data.build;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getKinematicsModel( id ) {\r\n\r\n\t\t\treturn getBuild( library.kinematicsModels[ id ], buildKinematicsModel );\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseKinematicsTechniqueCommon( xml, data ) {\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'joint':\r\n\t\t\t\t\t\tdata.joints[ child.getAttribute( 'sid' ) ] = parseKinematicsJoint( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'link':\r\n\t\t\t\t\t\tdata.links.push( parseKinematicsLink( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseKinematicsJoint( xml ) {\r\n\r\n\t\t\tvar data;\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'prismatic':\r\n\t\t\t\t\tcase 'revolute':\r\n\t\t\t\t\t\tdata = parseKinematicsJointParameter( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseKinematicsJointParameter( xml, data ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsid: xml.getAttribute( 'sid' ),\r\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\r\n\t\t\t\taxis: new Vector3(),\r\n\t\t\t\tlimits: {\r\n\t\t\t\t\tmin: 0,\r\n\t\t\t\t\tmax: 0\r\n\t\t\t\t},\r\n\t\t\t\ttype: xml.nodeName,\r\n\t\t\t\tstatic: false,\r\n\t\t\t\tzeroPosition: 0,\r\n\t\t\t\tmiddlePosition: 0\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'axis':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tdata.axis.fromArray( array );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'limits':\r\n\t\t\t\t\t\tvar max = child.getElementsByTagName( 'max' )[ 0 ];\r\n\t\t\t\t\t\tvar min = child.getElementsByTagName( 'min' )[ 0 ];\r\n\r\n\t\t\t\t\t\tdata.limits.max = parseFloat( max.textContent );\r\n\t\t\t\t\t\tdata.limits.min = parseFloat( min.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// if min is equal to or greater than max, consider the joint static\r\n\r\n\t\t\tif ( data.limits.min >= data.limits.max ) {\r\n\r\n\t\t\t\tdata.static = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// calculate middle position\r\n\r\n\t\t\tdata.middlePosition = ( data.limits.min + data.limits.max ) / 2.0;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseKinematicsLink( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsid: xml.getAttribute( 'sid' ),\r\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\r\n\t\t\t\tattachments: [],\r\n\t\t\t\ttransforms: []\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'attachment_full':\r\n\t\t\t\t\t\tdata.attachments.push( parseKinematicsAttachment( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'matrix':\r\n\t\t\t\t\tcase 'translate':\r\n\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\tdata.transforms.push( parseKinematicsTransform( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseKinematicsAttachment( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tjoint: xml.getAttribute( 'joint' ).split( '/' ).pop(),\r\n\t\t\t\ttransforms: [],\r\n\t\t\t\tlinks: []\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'link':\r\n\t\t\t\t\t\tdata.links.push( parseKinematicsLink( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'matrix':\r\n\t\t\t\t\tcase 'translate':\r\n\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\tdata.transforms.push( parseKinematicsTransform( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseKinematicsTransform( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\ttype: xml.nodeName\r\n\t\t\t};\r\n\r\n\t\t\tvar array = parseFloats( xml.textContent );\r\n\r\n\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\tcase 'matrix':\r\n\t\t\t\t\tdata.obj = new Matrix4();\r\n\t\t\t\t\tdata.obj.fromArray( array ).transpose();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'translate':\r\n\t\t\t\t\tdata.obj = new Vector3();\r\n\t\t\t\t\tdata.obj.fromArray( array );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\t\t\t\t\tdata.obj = new Vector3();\r\n\t\t\t\t\tdata.obj.fromArray( array );\r\n\t\t\t\t\tdata.angle = MathUtils.degToRad( array[ 3 ] );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\t// physics\r\n\r\n\t\tfunction parsePhysicsModel( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\r\n\t\t\t\trigidBodies: {}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'rigid_body':\r\n\t\t\t\t\t\tdata.rigidBodies[ child.getAttribute( 'name' ) ] = {};\r\n\t\t\t\t\t\tparsePhysicsRigidBody( child, data.rigidBodies[ child.getAttribute( 'name' ) ] );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.physicsModels[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parsePhysicsRigidBody( xml, data ) {\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'technique_common':\r\n\t\t\t\t\t\tparsePhysicsTechniqueCommon( child, data );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parsePhysicsTechniqueCommon( xml, data ) {\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'inertia':\r\n\t\t\t\t\t\tdata.inertia = parseFloats( child.textContent );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'mass':\r\n\t\t\t\t\t\tdata.mass = parseFloats( child.textContent )[ 0 ];\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// scene\r\n\r\n\t\tfunction parseKinematicsScene( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tbindJointAxis: []\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'bind_joint_axis':\r\n\t\t\t\t\t\tdata.bindJointAxis.push( parseKinematicsBindJointAxis( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.kinematicsScenes[ parseId( xml.getAttribute( 'url' ) ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseKinematicsBindJointAxis( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\ttarget: xml.getAttribute( 'target' ).split( '/' ).pop()\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'axis':\r\n\t\t\t\t\t\tvar param = child.getElementsByTagName( 'param' )[ 0 ];\r\n\t\t\t\t\t\tdata.axis = param.textContent;\r\n\t\t\t\t\t\tvar tmpJointIndex = data.axis.split( 'inst_' ).pop().split( 'axis' )[ 0 ];\r\n\t\t\t\t\t\tdata.jointIndex = tmpJointIndex.substr( 0, tmpJointIndex.length - 1 );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildKinematicsScene( data ) {\r\n\r\n\t\t\tif ( data.build !== undefined ) return data.build;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getKinematicsScene( id ) {\r\n\r\n\t\t\treturn getBuild( library.kinematicsScenes[ id ], buildKinematicsScene );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setupKinematics() {\r\n\r\n\t\t\tvar kinematicsModelId = Object.keys( library.kinematicsModels )[ 0 ];\r\n\t\t\tvar kinematicsSceneId = Object.keys( library.kinematicsScenes )[ 0 ];\r\n\t\t\tvar visualSceneId = Object.keys( library.visualScenes )[ 0 ];\r\n\r\n\t\t\tif ( kinematicsModelId === undefined || kinematicsSceneId === undefined ) return;\r\n\r\n\t\t\tvar kinematicsModel = getKinematicsModel( kinematicsModelId );\r\n\t\t\tvar kinematicsScene = getKinematicsScene( kinematicsSceneId );\r\n\t\t\tvar visualScene = getVisualScene( visualSceneId );\r\n\r\n\t\t\tvar bindJointAxis = kinematicsScene.bindJointAxis;\r\n\t\t\tvar jointMap = {};\r\n\r\n\t\t\tfor ( var i = 0, l = bindJointAxis.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar axis = bindJointAxis[ i ];\r\n\r\n\t\t\t\t// the result of the following query is an element of type 'translate', 'rotate','scale' or 'matrix'\r\n\r\n\t\t\t\tvar targetElement = collada.querySelector( '[sid=\"' + axis.target + '\"]' );\r\n\r\n\t\t\t\tif ( targetElement ) {\r\n\r\n\t\t\t\t\t// get the parent of the transform element\r\n\r\n\t\t\t\t\tvar parentVisualElement = targetElement.parentElement;\r\n\r\n\t\t\t\t\t// connect the joint of the kinematics model with the element in the visual scene\r\n\r\n\t\t\t\t\tconnect( axis.jointIndex, parentVisualElement );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction connect( jointIndex, visualElement ) {\r\n\r\n\t\t\t\tvar visualElementName = visualElement.getAttribute( 'name' );\r\n\t\t\t\tvar joint = kinematicsModel.joints[ jointIndex ];\r\n\r\n\t\t\t\tvisualScene.traverse( function ( object ) {\r\n\r\n\t\t\t\t\tif ( object.name === visualElementName ) {\r\n\r\n\t\t\t\t\t\tjointMap[ jointIndex ] = {\r\n\t\t\t\t\t\t\tobject: object,\r\n\t\t\t\t\t\t\ttransforms: buildTransformList( visualElement ),\r\n\t\t\t\t\t\t\tjoint: joint,\r\n\t\t\t\t\t\t\tposition: joint.zeroPosition\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar m0 = new Matrix4();\r\n\r\n\t\t\tkinematics = {\r\n\r\n\t\t\t\tjoints: kinematicsModel && kinematicsModel.joints,\r\n\r\n\t\t\t\tgetJointValue: function ( jointIndex ) {\r\n\r\n\t\t\t\t\tvar jointData = jointMap[ jointIndex ];\r\n\r\n\t\t\t\t\tif ( jointData ) {\r\n\r\n\t\t\t\t\t\treturn jointData.position;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' doesn\\'t exist.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetJointValue: function ( jointIndex, value ) {\r\n\r\n\t\t\t\t\tvar jointData = jointMap[ jointIndex ];\r\n\r\n\t\t\t\t\tif ( jointData ) {\r\n\r\n\t\t\t\t\t\tvar joint = jointData.joint;\r\n\r\n\t\t\t\t\t\tif ( value > joint.limits.max || value < joint.limits.min ) {\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ').' );\r\n\r\n\t\t\t\t\t\t} else if ( joint.static ) {\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' is static.' );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tvar object = jointData.object;\r\n\t\t\t\t\t\t\tvar axis = joint.axis;\r\n\t\t\t\t\t\t\tvar transforms = jointData.transforms;\r\n\r\n\t\t\t\t\t\t\tmatrix.identity();\r\n\r\n\t\t\t\t\t\t\t// each update, we have to apply all transforms in the correct order\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < transforms.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar transform = transforms[ i ];\r\n\r\n\t\t\t\t\t\t\t\t// if there is a connection of the transform node with a joint, apply the joint value\r\n\r\n\t\t\t\t\t\t\t\tif ( transform.sid && transform.sid.indexOf( jointIndex ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tswitch ( joint.type ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'revolute':\r\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeRotationAxis( axis, MathUtils.degToRad( value ) ) );\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'prismatic':\r\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeTranslation( axis.x * value, axis.y * value, axis.z * value ) );\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Unknown joint type: ' + joint.type );\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tswitch ( transform.type ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'matrix':\r\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( transform.obj );\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'translate':\r\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeTranslation( transform.obj.x, transform.obj.y, transform.obj.z ) );\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'scale':\r\n\t\t\t\t\t\t\t\t\t\t\tmatrix.scale( transform.obj );\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\t\t\t\t\t\tmatrix.multiply( m0.makeRotationAxis( transform.obj, transform.angle ) );\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tobject.matrix.copy( matrix );\r\n\t\t\t\t\t\t\tobject.matrix.decompose( object.position, object.quaternion, object.scale );\r\n\r\n\t\t\t\t\t\t\tjointMap[ jointIndex ].position = value;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.log( 'THREE.ColladaLoader: ' + jointIndex + ' does not exist.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildTransformList( node ) {\r\n\r\n\t\t\tvar transforms = [];\r\n\r\n\t\t\tvar xml = collada.querySelector( '[id=\"' + node.id + '\"]' );\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'matrix':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tvar matrix = new Matrix4().fromArray( array ).transpose();\r\n\t\t\t\t\t\ttransforms.push( {\r\n\t\t\t\t\t\t\tsid: child.getAttribute( 'sid' ),\r\n\t\t\t\t\t\t\ttype: child.nodeName,\r\n\t\t\t\t\t\t\tobj: matrix\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'translate':\r\n\t\t\t\t\tcase 'scale':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tvar vector = new Vector3().fromArray( array );\r\n\t\t\t\t\t\ttransforms.push( {\r\n\t\t\t\t\t\t\tsid: child.getAttribute( 'sid' ),\r\n\t\t\t\t\t\t\ttype: child.nodeName,\r\n\t\t\t\t\t\t\tobj: vector\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tvar vector = new Vector3().fromArray( array );\r\n\t\t\t\t\t\tvar angle = MathUtils.degToRad( array[ 3 ] );\r\n\t\t\t\t\t\ttransforms.push( {\r\n\t\t\t\t\t\t\tsid: child.getAttribute( 'sid' ),\r\n\t\t\t\t\t\t\ttype: child.nodeName,\r\n\t\t\t\t\t\t\tobj: vector,\r\n\t\t\t\t\t\t\tangle: angle\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn transforms;\r\n\r\n\t\t}\r\n\r\n\t\t// nodes\r\n\r\n\t\tfunction prepareNodes( xml ) {\r\n\r\n\t\t\tvar elements = xml.getElementsByTagName( 'node' );\r\n\r\n\t\t\t// ensure all node elements have id attributes\r\n\r\n\t\t\tfor ( var i = 0; i < elements.length; i ++ ) {\r\n\r\n\t\t\t\tvar element = elements[ i ];\r\n\r\n\t\t\t\tif ( element.hasAttribute( 'id' ) === false ) {\r\n\r\n\t\t\t\t\telement.setAttribute( 'id', generateId() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar matrix = new Matrix4();\r\n\t\tvar vector = new Vector3();\r\n\r\n\t\tfunction parseNode( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'name' ) || '',\r\n\t\t\t\ttype: xml.getAttribute( 'type' ),\r\n\t\t\t\tid: xml.getAttribute( 'id' ),\r\n\t\t\t\tsid: xml.getAttribute( 'sid' ),\r\n\t\t\t\tmatrix: new Matrix4(),\r\n\t\t\t\tnodes: [],\r\n\t\t\t\tinstanceCameras: [],\r\n\t\t\t\tinstanceControllers: [],\r\n\t\t\t\tinstanceLights: [],\r\n\t\t\t\tinstanceGeometries: [],\r\n\t\t\t\tinstanceNodes: [],\r\n\t\t\t\ttransforms: {}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tif ( child.nodeType !== 1 ) continue;\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'node':\r\n\t\t\t\t\t\tdata.nodes.push( child.getAttribute( 'id' ) );\r\n\t\t\t\t\t\tparseNode( child );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'instance_camera':\r\n\t\t\t\t\t\tdata.instanceCameras.push( parseId( child.getAttribute( 'url' ) ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'instance_controller':\r\n\t\t\t\t\t\tdata.instanceControllers.push( parseNodeInstance( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'instance_light':\r\n\t\t\t\t\t\tdata.instanceLights.push( parseId( child.getAttribute( 'url' ) ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'instance_geometry':\r\n\t\t\t\t\t\tdata.instanceGeometries.push( parseNodeInstance( child ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'instance_node':\r\n\t\t\t\t\t\tdata.instanceNodes.push( parseId( child.getAttribute( 'url' ) ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'matrix':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tdata.matrix.multiply( matrix.fromArray( array ).transpose() );\r\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'translate':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tvector.fromArray( array );\r\n\t\t\t\t\t\tdata.matrix.multiply( matrix.makeTranslation( vector.x, vector.y, vector.z ) );\r\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tvar angle = MathUtils.degToRad( array[ 3 ] );\r\n\t\t\t\t\t\tdata.matrix.multiply( matrix.makeRotationAxis( vector.fromArray( array ), angle ) );\r\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'scale':\r\n\t\t\t\t\t\tvar array = parseFloats( child.textContent );\r\n\t\t\t\t\t\tdata.matrix.scale( vector.fromArray( array ) );\r\n\t\t\t\t\t\tdata.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'extra':\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.log( child );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasNode( data.id ) ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.', data.id );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlibrary.nodes[ data.id ] = data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseNodeInstance( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tid: parseId( xml.getAttribute( 'url' ) ),\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\tskeletons: []\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0; i < xml.childNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = xml.childNodes[ i ];\r\n\r\n\t\t\t\tswitch ( child.nodeName ) {\r\n\r\n\t\t\t\t\tcase 'bind_material':\r\n\t\t\t\t\t\tvar instances = child.getElementsByTagName( 'instance_material' );\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j < instances.length; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar instance = instances[ j ];\r\n\t\t\t\t\t\t\tvar symbol = instance.getAttribute( 'symbol' );\r\n\t\t\t\t\t\t\tvar target = instance.getAttribute( 'target' );\r\n\r\n\t\t\t\t\t\t\tdata.materials[ symbol ] = parseId( target );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'skeleton':\r\n\t\t\t\t\t\tdata.skeletons.push( parseId( child.textContent ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildSkeleton( skeletons, joints ) {\r\n\r\n\t\t\tvar boneData = [];\r\n\t\t\tvar sortedBoneData = [];\r\n\r\n\t\t\tvar i, j, data;\r\n\r\n\t\t\t// a skeleton can have multiple root bones. collada expresses this\r\n\t\t\t// situtation with multiple \"skeleton\" tags per controller instance\r\n\r\n\t\t\tfor ( i = 0; i < skeletons.length; i ++ ) {\r\n\r\n\t\t\t\tvar skeleton = skeletons[ i ];\r\n\r\n\t\t\t\tvar root;\r\n\r\n\t\t\t\tif ( hasNode( skeleton ) ) {\r\n\r\n\t\t\t\t\troot = getNode( skeleton );\r\n\t\t\t\t\tbuildBoneHierarchy( root, joints, boneData );\r\n\r\n\t\t\t\t} else if ( hasVisualScene( skeleton ) ) {\r\n\r\n\t\t\t\t\t// handle case where the skeleton refers to the visual scene (#13335)\r\n\r\n\t\t\t\t\tvar visualScene = library.visualScenes[ skeleton ];\r\n\t\t\t\t\tvar children = visualScene.children;\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < children.length; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar child = children[ j ];\r\n\r\n\t\t\t\t\t\tif ( child.type === 'JOINT' ) {\r\n\r\n\t\t\t\t\t\t\tvar root = getNode( child.id );\r\n\t\t\t\t\t\t\tbuildBoneHierarchy( root, joints, boneData );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.ColladaLoader: Unable to find root bone of skeleton with ID:', skeleton );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// sort bone data (the order is defined in the corresponding controller)\r\n\r\n\t\t\tfor ( i = 0; i < joints.length; i ++ ) {\r\n\r\n\t\t\t\tfor ( j = 0; j < boneData.length; j ++ ) {\r\n\r\n\t\t\t\t\tdata = boneData[ j ];\r\n\r\n\t\t\t\t\tif ( data.bone.name === joints[ i ].name ) {\r\n\r\n\t\t\t\t\t\tsortedBoneData[ i ] = data;\r\n\t\t\t\t\t\tdata.processed = true;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// add unprocessed bone data at the end of the list\r\n\r\n\t\t\tfor ( i = 0; i < boneData.length; i ++ ) {\r\n\r\n\t\t\t\tdata = boneData[ i ];\r\n\r\n\t\t\t\tif ( data.processed === false ) {\r\n\r\n\t\t\t\t\tsortedBoneData.push( data );\r\n\t\t\t\t\tdata.processed = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// setup arrays for skeleton creation\r\n\r\n\t\t\tvar bones = [];\r\n\t\t\tvar boneInverses = [];\r\n\r\n\t\t\tfor ( i = 0; i < sortedBoneData.length; i ++ ) {\r\n\r\n\t\t\t\tdata = sortedBoneData[ i ];\r\n\r\n\t\t\t\tbones.push( data.bone );\r\n\t\t\t\tboneInverses.push( data.boneInverse );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn new Skeleton( bones, boneInverses );\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildBoneHierarchy( root, joints, boneData ) {\r\n\r\n\t\t\t// setup bone data from visual scene\r\n\r\n\t\t\troot.traverse( function ( object ) {\r\n\r\n\t\t\t\tif ( object.isBone === true ) {\r\n\r\n\t\t\t\t\tvar boneInverse;\r\n\r\n\t\t\t\t\t// retrieve the boneInverse from the controller data\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < joints.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar joint = joints[ i ];\r\n\r\n\t\t\t\t\t\tif ( joint.name === object.name ) {\r\n\r\n\t\t\t\t\t\t\tboneInverse = joint.boneInverse;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( boneInverse === undefined ) {\r\n\r\n\t\t\t\t\t\t// Unfortunately, there can be joints in the visual scene that are not part of the\r\n\t\t\t\t\t\t// corresponding controller. In this case, we have to create a dummy boneInverse matrix\r\n\t\t\t\t\t\t// for the respective bone. This bone won't affect any vertices, because there are no skin indices\r\n\t\t\t\t\t\t// and weights defined for it. But we still have to add the bone to the sorted bone list in order to\r\n\t\t\t\t\t\t// ensure a correct animation of the model.\r\n\r\n\t\t\t\t\t\tboneInverse = new Matrix4();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tboneData.push( { bone: object, boneInverse: boneInverse, processed: false } );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildNode( data ) {\r\n\r\n\t\t\tvar objects = [];\r\n\r\n\t\t\tvar matrix = data.matrix;\r\n\t\t\tvar nodes = data.nodes;\r\n\t\t\tvar type = data.type;\r\n\t\t\tvar instanceCameras = data.instanceCameras;\r\n\t\t\tvar instanceControllers = data.instanceControllers;\r\n\t\t\tvar instanceLights = data.instanceLights;\r\n\t\t\tvar instanceGeometries = data.instanceGeometries;\r\n\t\t\tvar instanceNodes = data.instanceNodes;\r\n\r\n\t\t\t// nodes\r\n\r\n\t\t\tfor ( var i = 0, l = nodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tobjects.push( getNode( nodes[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// instance cameras\r\n\r\n\t\t\tfor ( var i = 0, l = instanceCameras.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar instanceCamera = getCamera( instanceCameras[ i ] );\r\n\r\n\t\t\t\tif ( instanceCamera !== null ) {\r\n\r\n\t\t\t\t\tobjects.push( instanceCamera.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// instance controllers\r\n\r\n\t\t\tfor ( var i = 0, l = instanceControllers.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar instance = instanceControllers[ i ];\r\n\t\t\t\tvar controller = getController( instance.id );\r\n\t\t\t\tvar geometries = getGeometry( controller.id );\r\n\t\t\t\tvar newObjects = buildObjects( geometries, instance.materials );\r\n\r\n\t\t\t\tvar skeletons = instance.skeletons;\r\n\t\t\t\tvar joints = controller.skin.joints;\r\n\r\n\t\t\t\tvar skeleton = buildSkeleton( skeletons, joints );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar object = newObjects[ j ];\r\n\r\n\t\t\t\t\tif ( object.isSkinnedMesh ) {\r\n\r\n\t\t\t\t\t\tobject.bind( skeleton, controller.skin.bindMatrix );\r\n\t\t\t\t\t\tobject.normalizeSkinWeights();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobjects.push( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// instance lights\r\n\r\n\t\t\tfor ( var i = 0, l = instanceLights.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar instanceLight = getLight( instanceLights[ i ] );\r\n\r\n\t\t\t\tif ( instanceLight !== null ) {\r\n\r\n\t\t\t\t\tobjects.push( instanceLight.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// instance geometries\r\n\r\n\t\t\tfor ( var i = 0, l = instanceGeometries.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar instance = instanceGeometries[ i ];\r\n\r\n\t\t\t\t// a single geometry instance in collada can lead to multiple object3Ds.\r\n\t\t\t\t// this is the case when primitives are combined like triangles and lines\r\n\r\n\t\t\t\tvar geometries = getGeometry( instance.id );\r\n\t\t\t\tvar newObjects = buildObjects( geometries, instance.materials );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tobjects.push( newObjects[ j ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// instance nodes\r\n\r\n\t\t\tfor ( var i = 0, l = instanceNodes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tobjects.push( getNode( instanceNodes[ i ] ).clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar object;\r\n\r\n\t\t\tif ( nodes.length === 0 && objects.length === 1 ) {\r\n\r\n\t\t\t\tobject = objects[ 0 ];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tobject = ( type === 'JOINT' ) ? new Bone() : new Group();\r\n\r\n\t\t\t\tfor ( var i = 0; i < objects.length; i ++ ) {\r\n\r\n\t\t\t\t\tobject.add( objects[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.name = ( type === 'JOINT' ) ? data.sid : data.name;\r\n\t\t\tobject.matrix.copy( matrix );\r\n\t\t\tobject.matrix.decompose( object.position, object.quaternion, object.scale );\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\r\n\t\tvar fallbackMaterial = new MeshBasicMaterial( { color: 0xff00ff } );\r\n\r\n\t\tfunction resolveMaterialBinding( keys, instanceMaterials ) {\r\n\r\n\t\t\tvar materials = [];\r\n\r\n\t\t\tfor ( var i = 0, l = keys.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar id = instanceMaterials[ keys[ i ] ];\r\n\r\n\t\t\t\tif ( id === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ColladaLoader: Material with key %s not found. Apply fallback material.', keys[ i ] );\r\n\t\t\t\t\tmaterials.push( fallbackMaterial );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmaterials.push( getMaterial( id ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn materials;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildObjects( geometries, instanceMaterials ) {\r\n\r\n\t\t\tvar objects = [];\r\n\r\n\t\t\tfor ( var type in geometries ) {\r\n\r\n\t\t\t\tvar geometry = geometries[ type ];\r\n\r\n\t\t\t\tvar materials = resolveMaterialBinding( geometry.materialKeys, instanceMaterials );\r\n\r\n\t\t\t\t// handle case if no materials are defined\r\n\r\n\t\t\t\tif ( materials.length === 0 ) {\r\n\r\n\t\t\t\t\tif ( type === 'lines' || type === 'linestrips' ) {\r\n\r\n\t\t\t\t\t\tmaterials.push( new LineBasicMaterial() );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tmaterials.push( new MeshPhongMaterial() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// regard skinning\r\n\r\n\t\t\t\tvar skinning = ( geometry.data.attributes.skinIndex !== undefined );\r\n\r\n\t\t\t\tif ( skinning ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tmaterials[ i ].skinning = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// choose between a single or multi materials (material array)\r\n\r\n\t\t\t\tvar material = ( materials.length === 1 ) ? materials[ 0 ] : materials;\r\n\r\n\t\t\t\t// now create a specific 3D object\r\n\r\n\t\t\t\tvar object;\r\n\r\n\t\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\t\tcase 'lines':\r\n\t\t\t\t\t\tobject = new LineSegments( geometry.data, material );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'linestrips':\r\n\t\t\t\t\t\tobject = new Line( geometry.data, material );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'triangles':\r\n\t\t\t\t\tcase 'polylist':\r\n\t\t\t\t\t\tif ( skinning ) {\r\n\r\n\t\t\t\t\t\t\tobject = new SkinnedMesh( geometry.data, material );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tobject = new Mesh( geometry.data, material );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobjects.push( object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn objects;\r\n\r\n\t\t}\r\n\r\n\t\tfunction hasNode( id ) {\r\n\r\n\t\t\treturn library.nodes[ id ] !== undefined;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getNode( id ) {\r\n\r\n\t\t\treturn getBuild( library.nodes[ id ], buildNode );\r\n\r\n\t\t}\r\n\r\n\t\t// visual scenes\r\n\r\n\t\tfunction parseVisualScene( xml ) {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tname: xml.getAttribute( 'name' ),\r\n\t\t\t\tchildren: []\r\n\t\t\t};\r\n\r\n\t\t\tprepareNodes( xml );\r\n\r\n\t\t\tvar elements = getElementsByTagName( xml, 'node' );\r\n\r\n\t\t\tfor ( var i = 0; i < elements.length; i ++ ) {\r\n\r\n\t\t\t\tdata.children.push( parseNode( elements[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlibrary.visualScenes[ xml.getAttribute( 'id' ) ] = data;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildVisualScene( data ) {\r\n\r\n\t\t\tvar group = new Group();\r\n\t\t\tgroup.name = data.name;\r\n\r\n\t\t\tvar children = data.children;\r\n\r\n\t\t\tfor ( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\t\tvar child = children[ i ];\r\n\r\n\t\t\t\tgroup.add( getNode( child.id ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn group;\r\n\r\n\t\t}\r\n\r\n\t\tfunction hasVisualScene( id ) {\r\n\r\n\t\t\treturn library.visualScenes[ id ] !== undefined;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getVisualScene( id ) {\r\n\r\n\t\t\treturn getBuild( library.visualScenes[ id ], buildVisualScene );\r\n\r\n\t\t}\r\n\r\n\t\t// scenes\r\n\r\n\t\tfunction parseScene( xml ) {\r\n\r\n\t\t\tvar instance = getElementsByTagName( xml, 'instance_visual_scene' )[ 0 ];\r\n\t\t\treturn getVisualScene( parseId( instance.getAttribute( 'url' ) ) );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setupAnimations() {\r\n\r\n\t\t\tvar clips = library.clips;\r\n\r\n\t\t\tif ( isEmpty( clips ) === true ) {\r\n\r\n\t\t\t\tif ( isEmpty( library.animations ) === false ) {\r\n\r\n\t\t\t\t\t// if there are animations but no clips, we create a default clip for playback\r\n\r\n\t\t\t\t\tvar tracks = [];\r\n\r\n\t\t\t\t\tfor ( var id in library.animations ) {\r\n\r\n\t\t\t\t\t\tvar animationTracks = getAnimation( id );\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = animationTracks.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\ttracks.push( animationTracks[ i ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tanimations.push( new AnimationClip( 'default', - 1, tracks ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( var id in clips ) {\r\n\r\n\t\t\t\t\tanimations.push( getAnimationClip( id ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// convert the parser error element into text with each child elements text\r\n\t\t// separated by new lines.\r\n\r\n\t\tfunction parserErrorToText( parserError ) {\r\n\r\n\t\t\tvar result = '';\r\n\t\t\tvar stack = [ parserError ];\r\n\r\n\t\t\twhile ( stack.length ) {\r\n\r\n\t\t\t\tvar node = stack.shift();\r\n\r\n\t\t\t\tif ( node.nodeType === Node.TEXT_NODE ) {\r\n\r\n\t\t\t\t\tresult += node.textContent;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tresult += '\\n';\r\n\t\t\t\t\tstack.push.apply( stack, node.childNodes );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result.trim();\r\n\r\n\t\t}\r\n\r\n\t\tif ( text.length === 0 ) {\r\n\r\n\t\t\treturn { scene: new Scene() };\r\n\r\n\t\t}\r\n\r\n\t\tvar xml = new DOMParser().parseFromString( text, 'application/xml' );\r\n\r\n\t\tvar collada = getElementsByTagName( xml, 'COLLADA' )[ 0 ];\r\n\r\n\t\tvar parserError = xml.getElementsByTagName( 'parsererror' )[ 0 ];\r\n\t\tif ( parserError !== undefined ) {\r\n\r\n\t\t\t// Chrome will return parser error with a div in it\r\n\r\n\t\t\tvar errorElement = getElementsByTagName( parserError, 'div' )[ 0 ];\r\n\t\t\tvar errorText;\r\n\r\n\t\t\tif ( errorElement ) {\r\n\r\n\t\t\t\terrorText = errorElement.textContent;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\terrorText = parserErrorToText( parserError );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconsole.error( 'THREE.ColladaLoader: Failed to parse collada file.\\n', errorText );\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\t// metadata\r\n\r\n\t\tvar version = collada.getAttribute( 'version' );\r\n\t\tconsole.log( 'THREE.ColladaLoader: File version', version );\r\n\r\n\t\tvar asset = parseAsset( getElementsByTagName( collada, 'asset' )[ 0 ] );\r\n\t\tvar textureLoader = new TextureLoader( this.manager );\r\n\t\ttextureLoader.setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar tgaLoader;\r\n\r\n\t\tif ( TGALoader ) {\r\n\r\n\t\t\ttgaLoader = new TGALoader( this.manager );\r\n\t\t\ttgaLoader.setPath( this.resourcePath || path );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar animations = [];\r\n\t\tvar kinematics = {};\r\n\t\tvar count = 0;\r\n\r\n\t\t//\r\n\r\n\t\tvar library = {\r\n\t\t\tanimations: {},\r\n\t\t\tclips: {},\r\n\t\t\tcontrollers: {},\r\n\t\t\timages: {},\r\n\t\t\teffects: {},\r\n\t\t\tmaterials: {},\r\n\t\t\tcameras: {},\r\n\t\t\tlights: {},\r\n\t\t\tgeometries: {},\r\n\t\t\tnodes: {},\r\n\t\t\tvisualScenes: {},\r\n\t\t\tkinematicsModels: {},\r\n\t\t\tphysicsModels: {},\r\n\t\t\tkinematicsScenes: {}\r\n\t\t};\r\n\r\n\t\tparseLibrary( collada, 'library_animations', 'animation', parseAnimation );\r\n\t\tparseLibrary( collada, 'library_animation_clips', 'animation_clip', parseAnimationClip );\r\n\t\tparseLibrary( collada, 'library_controllers', 'controller', parseController );\r\n\t\tparseLibrary( collada, 'library_images', 'image', parseImage );\r\n\t\tparseLibrary( collada, 'library_effects', 'effect', parseEffect );\r\n\t\tparseLibrary( collada, 'library_materials', 'material', parseMaterial );\r\n\t\tparseLibrary( collada, 'library_cameras', 'camera', parseCamera );\r\n\t\tparseLibrary( collada, 'library_lights', 'light', parseLight );\r\n\t\tparseLibrary( collada, 'library_geometries', 'geometry', parseGeometry );\r\n\t\tparseLibrary( collada, 'library_nodes', 'node', parseNode );\r\n\t\tparseLibrary( collada, 'library_visual_scenes', 'visual_scene', parseVisualScene );\r\n\t\tparseLibrary( collada, 'library_kinematics_models', 'kinematics_model', parseKinematicsModel );\r\n\t\tparseLibrary( collada, 'library_physics_models', 'physics_model', parsePhysicsModel );\r\n\t\tparseLibrary( collada, 'scene', 'instance_kinematics_scene', parseKinematicsScene );\r\n\r\n\t\tbuildLibrary( library.animations, buildAnimation );\r\n\t\tbuildLibrary( library.clips, buildAnimationClip );\r\n\t\tbuildLibrary( library.controllers, buildController );\r\n\t\tbuildLibrary( library.images, buildImage );\r\n\t\tbuildLibrary( library.effects, buildEffect );\r\n\t\tbuildLibrary( library.materials, buildMaterial );\r\n\t\tbuildLibrary( library.cameras, buildCamera );\r\n\t\tbuildLibrary( library.lights, buildLight );\r\n\t\tbuildLibrary( library.geometries, buildGeometry );\r\n\t\tbuildLibrary( library.visualScenes, buildVisualScene );\r\n\r\n\t\tsetupAnimations();\r\n\t\tsetupKinematics();\r\n\r\n\t\tvar scene = parseScene( getElementsByTagName( collada, 'scene' )[ 0 ] );\r\n\r\n\t\tif ( asset.upAxis === 'Z_UP' ) {\r\n\r\n\t\t\tscene.quaternion.setFromEuler( new Euler( - Math.PI / 2, 0, 0 ) );\r\n\r\n\t\t}\r\n\r\n\t\tscene.scale.multiplyScalar( asset.unit );\r\n\r\n\t\treturn {\r\n\t\t\tanimations: animations,\r\n\t\t\tkinematics: kinematics,\r\n\t\t\tlibrary: library,\r\n\t\t\tscene: scene\r\n\t\t};\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { ColladaLoader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/loaders/ColladaLoader.js","// tween.js 17.3.5 - https://github.com/tweenjs/tween.js\r\nvar _Group=function(){this._tweens={},this._tweensAddedDuringUpdate={}};_Group.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,n){var e=Object.keys(this._tweens);if(0===e.length)return!1;for(t=void 0!==t?t:TWEEN.now();0<e.length;){this._tweensAddedDuringUpdate={};for(var i=0;i<e.length;i++){var r=this._tweens[e[i]];r&&!1===r.update(t)&&(r._isPlaying=!1,n||delete this._tweens[e[i]])}e=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var TWEEN=new _Group;TWEEN.Group=_Group,TWEEN._nextId=0,TWEEN.nextId=function(){return TWEEN._nextId++},\"undefined\"==typeof self&&\"undefined\"!=typeof process&&process.hrtime?TWEEN.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:\"undefined\"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?TWEEN.now=self.performance.now.bind(self.performance):void 0!==Date.now?TWEEN.now=Date.now:TWEEN.now=function(){return(new Date).getTime()},TWEEN.Tween=function(t,n){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=TWEEN.Easing.Linear.None,this._interpolationFunction=TWEEN.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=n||TWEEN,this._id=TWEEN.nextId()},TWEEN.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,n){return this._valuesEnd=Object.create(t),void 0!==n&&(this._duration=n),this},duration:function(t){return this._duration=t,this},start:function(t){for(var n in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?\"string\"==typeof t?TWEEN.now()+parseFloat(t):t:TWEEN.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[n]instanceof Array){if(0===this._valuesEnd[n].length)continue;this._valuesEnd[n]=[this._object[n]].concat(this._valuesEnd[n])}void 0!==this._object[n]&&(this._valuesStart[n]=this._object[n],this._valuesStart[n]instanceof Array==!1&&(this._valuesStart[n]*=1),this._valuesStartRepeat[n]=this._valuesStart[n]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var t=0,n=this._chainedTweens.length;t<n;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var n,e,i;if(t<this._startTime)return!0;for(n in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),e=(t-this._startTime)/this._duration,e=0===this._duration||1<e?1:e,i=this._easingFunction(e),this._valuesEnd)if(void 0!==this._valuesStart[n]){var r=this._valuesStart[n]||0,a=this._valuesEnd[n];a instanceof Array?this._object[n]=this._interpolationFunction(a,i):(\"string\"==typeof a&&(a=\"+\"===a.charAt(0)||\"-\"===a.charAt(0)?r+parseFloat(a):parseFloat(a)),\"number\"==typeof a&&(this._object[n]=r+(a-r)*i))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1!==e)return!0;if(0<this._repeat){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if(\"string\"==typeof this._valuesEnd[n]&&(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo){var s=this._valuesStartRepeat[n];this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=s}this._valuesStart[n]=this._valuesStartRepeat[n]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,u=this._chainedTweens.length;o<u;o++)this._chainedTweens[o].start(this._startTime+this._duration);return!1}},TWEEN.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var n=2.5949095;return(t*=2)<1?t*t*((1+n)*t-n)*.5:.5*((t-=2)*t*((1+n)*t+n)+2)}},Bounce:{In:function(t){return 1-TWEEN.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*TWEEN.Easing.Bounce.In(2*t):.5*TWEEN.Easing.Bounce.Out(2*t-1)+.5}}},TWEEN.Interpolation={Linear:function(t,n){var e=t.length-1,i=e*n,r=Math.floor(i),a=TWEEN.Interpolation.Utils.Linear;return n<0?a(t[0],t[1],i):1<n?a(t[e],t[e-1],e-i):a(t[r],t[e<r+1?e:r+1],i-r)},Bezier:function(t,n){for(var e=0,i=t.length-1,r=Math.pow,a=TWEEN.Interpolation.Utils.Bernstein,s=0;s<=i;s++)e+=r(1-n,i-s)*r(n,s)*t[s]*a(i,s);return e},CatmullRom:function(t,n){var e=t.length-1,i=e*n,r=Math.floor(i),a=TWEEN.Interpolation.Utils.CatmullRom;return t[0]===t[e]?(n<0&&(r=Math.floor(i=e*(1+n))),a(t[(r-1+e)%e],t[r],t[(r+1)%e],t[(r+2)%e],i-r)):n<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):1<n?t[e]-(a(t[e],t[e],t[e-1],t[e-1],i-e)-t[e]):a(t[r?r-1:0],t[r],t[e<r+1?e:r+1],t[e<r+2?e:r+2],i-r)},Utils:{Linear:function(t,n,e){return(n-t)*e+t},Bernstein:function(t,n){var e=TWEEN.Interpolation.Utils.Factorial;return e(t)/e(n)/e(t-n)},Factorial:function(){var i=[1];return function(t){var n=1;if(i[t])return i[t];for(var e=t;1<e;e--)n*=e;return i[t]=n}}(),CatmullRom:function(t,n,e,i,r){var a=.5*(e-t),s=.5*(i-n),o=r*r;return(2*n-2*e+a+s)*(r*o)+(-3*n+3*e-2*a-s)*o+a*r+n}}},function(t){\"function\"==typeof define&&define.amd?define([],function(){return TWEEN}):\"undefined\"!=typeof module&&\"object\"==typeof exports?module.exports=TWEEN:void 0!==t&&(t.TWEEN=TWEEN)}(this);\r\nexport {TWEEN};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/libs/tween.module.min.js","<template>\r\n    <div class=\"webglLoaderColladaKnematics-container\">\r\n        <div id=\"info\">\r\n\t\t\t<a href=\"https://threejs.org\" target=\"_blank\" rel=\"noopener\">three.js</a> collada loader - kinematics<br/>\r\n\t\t\trobot from <a href=\"https://github.com/rdiankov/collada_robots\" target=\"_blank\" rel=\"noopener\">collada robots</a>\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { TWEEN } from '@/components/jsm/libs/tween.module.min.js'\r\nimport { ColladaLoader } from '@/components/jsm/loaders/ColladaLoader.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            container: null,\r\n            stats: null,\r\n            camera: null,\r\n            scene: null,\r\n            renderer: null,\r\n\t\t\tparticleLight: null,\r\n\t\t\tdae: null,\r\n\t\t\tkinematics: null,\r\n\t\t\tkinematicsTween: null,\r\n\t\t\ttweenParameters: {},\r\n\t\t\tloader: null,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.loader = new ColladaLoader()\r\n        // loader.load('./models/collada/kawada-hironx.dae', function (collada) {\r\n        this.loader.load('static/models/collada/abb_irb52_7_120.dae', (collada) => {\r\n            this.dae = collada.scene\r\n            this.dae.traverse(function (child) {\r\n                if (child.isMesh) {\r\n                    // model does not have normals\r\n                    child.material.flatShading = true\r\n                }\r\n            })\r\n            this.dae.scale.x = this.dae.scale.y = this.dae.scale.z = 10.0\r\n            this.dae.updateMatrix()\r\n            this.kinematics = collada.kinematics\r\n            this.init()\r\n            this.animate()\r\n        })\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.container = document.createElement('div')\r\n            document.getElementsByClassName('webglLoaderColladaKnematics-container')[0].appendChild(this.container)\r\n            this.camera = new this.$THREE.PerspectiveCamera(45, this.$webglInnerWidth / window.innerHeight, 1, 2000)\r\n            this.camera.position.set(2, 2, 3)\r\n            this.scene = new this.$THREE.Scene()\r\n            // Grid\r\n            var grid = new this.$THREE.GridHelper(20, 20, 0x888888, 0x444444)\r\n            this.scene.add(grid)\r\n            // Add the COLLADA\r\n            this.scene.add(this.dae)\r\n            this.particleLight = new this.$THREE.Mesh(new this.$THREE.SphereBufferGeometry(4, 8, 8), new this.$THREE.MeshBasicMaterial({ color: 0xffffff }))\r\n            this.scene.add(this.particleLight)\r\n            // Lights\r\n            var light = new this.$THREE.HemisphereLight(0xffeeee, 0x111122)\r\n            this.scene.add(light)\r\n            var pointLight = new this.$THREE.PointLight(0xffffff, 0.3)\r\n            this.particleLight.add(pointLight)\r\n            this.renderer = new this.$THREE.WebGLRenderer()\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            this.renderer.setSize(this.$webglInnerWidth, window.innerHeight)\r\n            this.container.appendChild(this.renderer.domElement)\r\n            this.stats = new this.$Stats()\r\n            this.stats.dom.style.left = '280px'\r\n            this.container.appendChild(this.stats.dom)\r\n            this.setupTween()\r\n            //\r\n            window.addEventListener('resize', this.onWindowResize, false)\r\n        },\r\n        setupTween() {\r\n            var duration = this.$THREE.MathUtils.randInt(1000, 5000)\r\n            var target = {}\r\n            for (var prop in this.kinematics.joints) {\r\n                if (this.kinematics.joints.hasOwnProperty(prop)) {\r\n                    if (! this.kinematics.joints[ prop ].static) {\r\n                        var joint = this.kinematics.joints[ prop ]\r\n                        var old = this.tweenParameters[ prop ]\r\n                        var position = old ? old : joint.zeroPosition\r\n                        this.tweenParameters[ prop ] = position\r\n                        target[ prop ] = this.$THREE.MathUtils.randInt(joint.limits.min, joint.limits.max)\r\n                    }\r\n                }\r\n            }\r\n            this.kinematicsTween = new TWEEN.Tween(this.tweenParameters).to(target, duration).easing(TWEEN.Easing.Quadratic.Out)\r\n            this.kinematicsTween.onUpdate((object) => {\r\n                for (var prop in this.kinematics.joints) {\r\n                    if (this.kinematics.joints.hasOwnProperty(prop)) {\r\n                        if (! this.kinematics.joints[ prop ].static) {\r\n                            this.kinematics.setJointValue(prop, object[ prop ])\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n            this.kinematicsTween.start()\r\n            setTimeout(this.setupTween, duration)\r\n        },\r\n        onWindowResize() {\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n        },\r\n        animate() {\r\n            requestAnimationFrame(this.animate)\r\n            this.render()\r\n            this.stats.update()\r\n            TWEEN.update()\r\n        },\r\n        render() {\r\n            var timer = Date.now() * 0.0001\r\n            this.camera.position.x = Math.cos(timer) * 20\r\n            this.camera.position.y = 10\r\n            this.camera.position.z = Math.sin(timer) * 20\r\n            this.camera.lookAt(0, 5, 0)\r\n            this.particleLight.position.x = Math.sin(timer * 4) * 3009\r\n            this.particleLight.position.y = Math.cos(timer * 5) * 4000\r\n            this.particleLight.position.z = Math.cos(timer * 4) * 3009\r\n            this.renderer.render(this.scene, this.camera)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglLoaderColladaKnematics-container {\r\n    width: 100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/loader/webglLoaderColladaKnematics.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglLoaderColladaKnematics-container\"},[_c('div',{attrs:{\"id\":\"info\"}},[_c('a',{attrs:{\"href\":\"https://threejs.org\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"three.js\")]),_vm._v(\" collada loader - kinematics\"),_c('br'),_vm._v(\"\\n\\t\\t\\trobot from \"),_c('a',{attrs:{\"href\":\"https://github.com/rdiankov/collada_robots\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"collada robots\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-112779d2\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/loader/webglLoaderColladaKnematics.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-112779d2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglLoaderColladaKnematics.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderColladaKnematics.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderColladaKnematics.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-112779d2\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglLoaderColladaKnematics.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-112779d2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/loader/webglLoaderColladaKnematics.vue\n// module id = null\n// module chunks = ","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/process/browser.js\n// module id = W2nU\n// module chunks = 1 4"],"sourceRoot":""}