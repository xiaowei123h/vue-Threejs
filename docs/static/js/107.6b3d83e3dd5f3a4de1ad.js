webpackJsonp([107],{q5Ct:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("QEtz"),s=i("wIBv"),r=i("qxm1"),o=i("6+nK"),a=function(e,t,i,n){o.BufferGeometry.call(this);var s=[],r=[],a=[],l=new o.Vector3,c=new o.Matrix4;c.makeRotationFromEuler(i),c.setPosition(t);var u=new o.Matrix4;function m(t,i,n){i.applyMatrix4(e.matrixWorld),i.applyMatrix4(u),n.transformDirection(e.matrixWorld),t.push(new h(i.clone(),n.clone()))}function d(e,t){for(var i=[],s=.5*Math.abs(n.dot(t)),r=0;r<e.length;r+=3){var o,a,h,l,c,u,m,d=e[r+0].position.dot(t)-s;switch(a=e[r+1].position.dot(t)-s>0,h=e[r+2].position.dot(t)-s>0,((o=d>0)?1:0)+(a?1:0)+(h?1:0)){case 0:i.push(e[r]),i.push(e[r+1]),i.push(e[r+2]);break;case 1:if(o&&(l=e[r+1],c=e[r+2],u=p(e[r],l,t,s),m=p(e[r],c,t,s)),a){l=e[r],c=e[r+2],u=p(e[r+1],l,t,s),m=p(e[r+1],c,t,s),i.push(u),i.push(c.clone()),i.push(l.clone()),i.push(c.clone()),i.push(u.clone()),i.push(m);break}h&&(l=e[r],c=e[r+1],u=p(e[r+2],l,t,s),m=p(e[r+2],c,t,s)),i.push(l.clone()),i.push(c.clone()),i.push(u),i.push(m),i.push(u.clone()),i.push(c.clone());break;case 2:o||(c=p(l=e[r].clone(),e[r+1],t,s),u=p(l,e[r+2],t,s),i.push(l),i.push(c),i.push(u)),a||(c=p(l=e[r+1].clone(),e[r+2],t,s),u=p(l,e[r],t,s),i.push(l),i.push(c),i.push(u)),h||(c=p(l=e[r+2].clone(),e[r],t,s),u=p(l,e[r+1],t,s),i.push(l),i.push(c),i.push(u))}}return i}function p(e,t,i,n){var s=e.position.dot(i)-n,r=s/(s-(t.position.dot(i)-n));return new h(new o.Vector3(e.position.x+r*(t.position.x-e.position.x),e.position.y+r*(t.position.y-e.position.y),e.position.z+r*(t.position.z-e.position.z)),new o.Vector3(e.normal.x+r*(t.normal.x-e.normal.x),e.normal.y+r*(t.normal.y-e.normal.y),e.normal.z+r*(t.normal.z-e.normal.z)))}u.copy(c).invert(),function(){var t,i=new o.BufferGeometry,h=[],u=new o.Vector3,p=new o.Vector3;e.geometry.isGeometry?i.fromGeometry(e.geometry):i.copy(e.geometry);var f=i.attributes.position,w=i.attributes.normal;if(null!==i.index){var E=i.index;for(t=0;t<E.count;t++)u.fromBufferAttribute(f,E.getX(t)),p.fromBufferAttribute(w,E.getX(t)),m(h,u,p)}else for(t=0;t<f.count;t++)u.fromBufferAttribute(f,t),p.fromBufferAttribute(w,t),m(h,u,p);for(h=d(h=d(h=d(h=d(h=d(h=d(h,l.set(1,0,0)),l.set(-1,0,0)),l.set(0,1,0)),l.set(0,-1,0)),l.set(0,0,1)),l.set(0,0,-1)),t=0;t<h.length;t++){var y=h[t];a.push(.5+y.position.x/n.x,.5+y.position.y/n.y),y.position.applyMatrix4(c),s.push(y.position.x,y.position.y,y.position.z),r.push(y.normal.x,y.normal.y,y.normal.z)}}(),this.setAttribute("position",new o.Float32BufferAttribute(s,3)),this.setAttribute("normal",new o.Float32BufferAttribute(r,3)),this.setAttribute("uv",new o.Float32BufferAttribute(a,2))};(a.prototype=Object.create(o.BufferGeometry.prototype)).constructor=a;var h=function(e,t){this.position=e,this.normal=t};h.prototype.clone=function(){return new this.constructor(this.position.clone(),this.normal.clone())};var l={data:function(){return{container:null,renderer:null,scene:null,camera:null,stats:null,mesh:null,raycaster:null,line:null,intersection:null,mouse:null,intersects:[],textureLoader:null,decalDiffuse:null,decalNormal:null,decalMaterial:null,decals:[],mouseHelper:null,position:null,orientation:null,size:null,params:null,gui:null}},mounted:function(){var e=this;this.container=document.getElementById("container"),this.intersection={intersects:!1,point:new this.$THREE.Vector3,normal:new this.$THREE.Vector3},this.mouse=new this.$THREE.Vector2,this.textureLoader=new this.$THREE.TextureLoader,this.decalDiffuse=this.textureLoader.load("static/textures/decal/decal-diffuse.png"),this.decalNormal=this.textureLoader.load("static/textures/decal/decal-normal.jpg"),this.decalMaterial=new this.$THREE.MeshPhongMaterial({specular:4473924,map:this.decalDiffuse,normalMap:this.decalNormal,normalScale:new this.$THREE.Vector2(1,1),shininess:30,transparent:!0,depthTest:!0,depthWrite:!1,polygonOffset:!0,polygonOffsetFactor:-4,wireframe:!1}),this.position=new this.$THREE.Vector3,this.orientation=new this.$THREE.Euler,this.size=new this.$THREE.Vector3(10,10,10),this.params={minScale:10,maxScale:20,rotate:!0,clear:function(){e.removeDecals()}},this.init()},beforeDestroy:function(){this.gui.destroy()},methods:{init:function(){var e=this;this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.container.appendChild(this.renderer.domElement),this.stats=new this.$Stats,this.stats.dom.style.left="280px",this.container.appendChild(this.stats.dom),this.scene=new this.$THREE.Scene,this.camera=new this.$THREE.PerspectiveCamera(45,this.$webglInnerWidth/window.innerHeight,1,1e3),this.camera.position.z=120,this.camera.target=new this.$THREE.Vector3;var t=new s.b(this.camera,this.renderer.domElement);t.minDistance=50,t.maxDistance=200,this.scene.add(new this.$THREE.AmbientLight(4469555));var i=new this.$THREE.DirectionalLight(16768460,1);i.position.set(1,.75,.5),this.scene.add(i);var r=new this.$THREE.DirectionalLight(13421823,1);r.position.set(-1,.75,-.5),this.scene.add(r);var o=new this.$THREE.BufferGeometry;o.setFromPoints([new this.$THREE.Vector3,new this.$THREE.Vector3]),this.line=new this.$THREE.Line(o,new this.$THREE.LineBasicMaterial),this.scene.add(this.line),this.loadLeePerrySmith(),this.raycaster=new this.$THREE.Raycaster,this.mouseHelper=new this.$THREE.Mesh(new this.$THREE.BoxBufferGeometry(1,1,10),new this.$THREE.MeshNormalMaterial),this.mouseHelper.visible=!1,this.scene.add(this.mouseHelper),window.addEventListener("resize",this.onWindowResize,!1);var a=!1;t.addEventListener("change",function(){a=!0}),window.addEventListener("pointerdown",function(){a=!1},!1),window.addEventListener("pointerup",function(t){!1===a&&(l(t.clientX,t.clientY),e.intersection.intersects&&e.shoot())}),window.addEventListener("pointermove",function(e){e.isPrimary&&l(e.clientX,e.clientY)});var h=this;function l(e,t){if(void 0!==h.mesh)if(h.mouse.x=(e-281)/h.$webglInnerWidth*2-1,h.mouse.y=-t/window.innerHeight*2+1,h.raycaster.setFromCamera(h.mouse,h.camera),h.raycaster.intersectObject(h.mesh,!1,h.intersects),h.intersects.length>0){var i=h.intersects[0].point;h.mouseHelper.position.copy(i),h.intersection.point.copy(i);var n=h.intersects[0].face.normal.clone();n.transformDirection(h.mesh.matrixWorld),n.multiplyScalar(10),n.add(h.intersects[0].point),h.intersection.normal.copy(h.intersects[0].face.normal),h.mouseHelper.lookAt(n);var s=h.line.geometry.attributes.position;s.setXYZ(0,i.x,i.y,i.z),s.setXYZ(1,n.x,n.y,n.z),s.needsUpdate=!0,h.intersection.intersects=!0,h.intersects.length=0}else h.intersection.intersects=!1}this.gui=new n.a,this.gui.add(this.params,"minScale",1,30),this.gui.add(this.params,"maxScale",1,30),this.gui.add(this.params,"rotate"),this.gui.add(this.params,"clear"),this.gui.open(),this.onWindowResize(),this.animate()},loadLeePerrySmith:function(){var e=this;(new r.a).load("static/models/gltf/LeePerrySmith/LeePerrySmith.glb",function(t){e.mesh=t.scene.children[0],e.mesh.material=new e.$THREE.MeshPhongMaterial({specular:1118481,map:e.textureLoader.load("static/models/gltf/LeePerrySmith/Map-COL.jpg"),specularMap:e.textureLoader.load("static/models/gltf/LeePerrySmith/Map-SPEC.jpg"),normalMap:e.textureLoader.load("static/models/gltf/LeePerrySmith/Infinite-Level_02_Tangent_SmoothUV.jpg"),shininess:25}),e.scene.add(e.mesh),e.mesh.scale.set(10,10,10)})},shoot:function(){this.position.copy(this.intersection.point),this.orientation.copy(this.mouseHelper.rotation),this.params.rotate&&(this.orientation.z=2*Math.random()*Math.PI);var e=this.params.minScale+Math.random()*(this.params.maxScale-this.params.minScale);this.size.set(e,e,e);var t=this.decalMaterial.clone();t.color.setHex(16777215*Math.random());var i=new this.$THREE.Mesh(new a(this.mesh,this.position,this.orientation,this.size),t);this.decals.push(i),this.scene.add(i)},removeDecals:function(){var e=this;this.decals.forEach(function(t){e.scene.remove(t)}),this.decals.length=0},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera),this.stats.update()}}},c={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglDecals-container"},[t("div",{attrs:{id:"container"}}),this._v(" "),t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" - decal splatter"),t("br"),this._v("\n\t\t\tclick to shoot\n\t\t")])])}]};var u=i("VU/8")(l,c,!1,function(e){i("z6in")},"data-v-b441a15c",null);t.default=u.exports},z6in:function(e,t){}});
//# sourceMappingURL=107.6b3d83e3dd5f3a4de1ad.js.map