{"version":3,"sources":["webpack:///./src/components/jsm/shaders/AfterimageShader.js","webpack:///./src/components/jsm/postprocessing/AfterimagePass.js","webpack:///src/views/postprocessing/webglPostprocessingAfterimage.vue","webpack:///./src/views/postprocessing/webglPostprocessingAfterimage.vue?ac74","webpack:///./src/views/postprocessing/webglPostprocessingAfterimage.vue"],"names":["AfterimageShader","uniforms","damp","value","tOld","tNew","vertexShader","join","fragmentShader","AfterimagePass","Pass","call","this","undefined","console","error","shader","UniformsUtils","clone","textureComp","WebGLRenderTarget","window","innerWidth","innerHeight","minFilter","LinearFilter","magFilter","NearestFilter","format","RGBAFormat","textureOld","shaderMaterial","ShaderMaterial","compFsQuad","FullScreenQuad","material","MeshBasicMaterial","copyFsQuad","prototype","Object","assign","create","constructor","render","renderer","writeBuffer","readBuffer","texture","setRenderTarget","map","renderToScreen","clear","temp","setSize","width","height","webglPostprocessingAfterimage","data","camera","scene","composer","mesh","afterimagePass","params","enable","gui","mounted","init","createGUI","animate","beforeDestroy","destroy","methods","$THREE","WebGLRenderer","setPixelRatio","devicePixelRatio","$webglInnerWidth","document","getElementsByClassName","appendChild","domElement","PerspectiveCamera","position","z","Scene","fog","Fog","geometry","BoxBufferGeometry","MeshNormalMaterial","Mesh","add","EffectComposer","addPass","RenderPass","AfterimagePass_AfterimagePass","addEventListener","onWindowResize","TESTING","i","dat_gui_module","name","step","$onWindowResize","rotation","x","y","requestAnimationFrame","postprocessing_webglPostprocessingAfterimage","_h","$createElement","_self","_c","staticClass","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/128.16ab8e0843197f1d8692.js","sourcesContent":["/**\r\n * Afterimage shader\r\n * I created this effect inspired by a demo on codepen:\r\n * https://codepen.io/brunoimbrizi/pen/MoRJaN?page=1&\r\n */\r\n\r\nvar AfterimageShader = {\r\n\r\n\tuniforms: {\r\n\r\n\t\t\"damp\": { value: 0.96 },\r\n\t\t\"tOld\": { value: null },\r\n\t\t\"tNew\": { value: null }\r\n\r\n\t},\r\n\r\n\tvertexShader: [\r\n\r\n\t\t\"varying vec2 vUv;\",\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\"\tvUv = uv;\",\r\n\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" ),\r\n\r\n\tfragmentShader: [\r\n\r\n\t\t\"uniform float damp;\",\r\n\r\n\t\t\"uniform sampler2D tOld;\",\r\n\t\t\"uniform sampler2D tNew;\",\r\n\r\n\t\t\"varying vec2 vUv;\",\r\n\r\n\t\t\"vec4 when_gt( vec4 x, float y ) {\",\r\n\r\n\t\t\"\treturn max( sign( x - y ), 0.0 );\",\r\n\r\n\t\t\"}\",\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\"\tvec4 texelOld = texture2D( tOld, vUv );\",\r\n\t\t\"\tvec4 texelNew = texture2D( tNew, vUv );\",\r\n\r\n\t\t\"\ttexelOld *= damp * when_gt( texelOld, 0.1 );\",\r\n\r\n\t\t\"\tgl_FragColor = max(texelNew, texelOld);\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" )\r\n\r\n};\r\n\r\nexport { AfterimageShader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/shaders/AfterimageShader.js","import {\r\n\tLinearFilter,\r\n\tMeshBasicMaterial,\r\n\tNearestFilter,\r\n\tRGBAFormat,\r\n\tShaderMaterial,\r\n\tUniformsUtils,\r\n\tWebGLRenderTarget\r\n} from \"@/components/build/three.module.js\";\r\nimport { Pass } from \"../postprocessing/Pass.js\";\r\nimport { AfterimageShader } from \"../shaders/AfterimageShader.js\";\r\n\r\nvar AfterimagePass = function ( damp ) {\r\n\r\n\tPass.call( this );\r\n\r\n\tif ( AfterimageShader === undefined )\r\n\t\tconsole.error( \"AfterimagePass relies on AfterimageShader\" );\r\n\r\n\tthis.shader = AfterimageShader;\r\n\r\n\tthis.uniforms = UniformsUtils.clone( this.shader.uniforms );\r\n\r\n\tthis.uniforms[ \"damp\" ].value = damp !== undefined ? damp : 0.96;\r\n\r\n\tthis.textureComp = new WebGLRenderTarget( window.innerWidth, window.innerHeight, {\r\n\r\n\t\tminFilter: LinearFilter,\r\n\t\tmagFilter: NearestFilter,\r\n\t\tformat: RGBAFormat\r\n\r\n\t} );\r\n\r\n\tthis.textureOld = new WebGLRenderTarget( window.innerWidth, window.innerHeight, {\r\n\r\n\t\tminFilter: LinearFilter,\r\n\t\tmagFilter: NearestFilter,\r\n\t\tformat: RGBAFormat\r\n\r\n\t} );\r\n\r\n\tthis.shaderMaterial = new ShaderMaterial( {\r\n\r\n\t\tuniforms: this.uniforms,\r\n\t\tvertexShader: this.shader.vertexShader,\r\n\t\tfragmentShader: this.shader.fragmentShader\r\n\r\n\t} );\r\n\r\n\tthis.compFsQuad = new Pass.FullScreenQuad( this.shaderMaterial );\r\n\r\n\tvar material = new MeshBasicMaterial();\r\n\tthis.copyFsQuad = new Pass.FullScreenQuad( material );\r\n\r\n};\r\n\r\nAfterimagePass.prototype = Object.assign( Object.create( Pass.prototype ), {\r\n\r\n\tconstructor: AfterimagePass,\r\n\r\n\trender: function ( renderer, writeBuffer, readBuffer ) {\r\n\r\n\t\tthis.uniforms[ \"tOld\" ].value = this.textureOld.texture;\r\n\t\tthis.uniforms[ \"tNew\" ].value = readBuffer.texture;\r\n\r\n\t\trenderer.setRenderTarget( this.textureComp );\r\n\t\tthis.compFsQuad.render( renderer );\r\n\r\n\t\tthis.copyFsQuad.material.map = this.textureComp.texture;\r\n\r\n\t\tif ( this.renderToScreen ) {\r\n\r\n\t\t\trenderer.setRenderTarget( null );\r\n\t\t\tthis.copyFsQuad.render( renderer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.setRenderTarget( writeBuffer );\r\n\r\n\t\t\tif ( this.clear ) renderer.clear();\r\n\r\n\t\t\tthis.copyFsQuad.render( renderer );\r\n\r\n\t\t}\r\n\r\n\t\t// Swap buffers.\r\n\t\tvar temp = this.textureOld;\r\n\t\tthis.textureOld = this.textureComp;\r\n\t\tthis.textureComp = temp;\r\n\t\t// Now textureOld contains the latest image, ready for the next frame.\r\n\r\n\t},\r\n\r\n\tsetSize: function ( width, height ) {\r\n\r\n\t\tthis.textureComp.setSize( width, height );\r\n\t\tthis.textureOld.setSize( width, height );\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { AfterimagePass };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/postprocessing/AfterimagePass.js","<template>\r\n    <div class=\"webglPostprocessingAfterimage-container\">\r\n        \r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { GUI } from '@/components/jsm/libs/dat.gui.module.js'\r\nimport { EffectComposer } from '@/components/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from '@/components/jsm/postprocessing/RenderPass.js'\r\nimport { AfterimagePass } from '@/components/jsm/postprocessing/AfterimagePass.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            camera: null,\r\n            scene: null,\r\n            renderer: null,\r\n            composer: null,\r\n\t\t\tmesh: null,\r\n\t\t\tafterimagePass: null,\r\n\t\t\tparams: {\r\n\t\t\t\tenable: true\r\n            },\r\n            gui: null,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.init();\r\n        this.createGUI();\r\n        this.animate();\r\n    },\r\n    beforeDestroy() {\r\n        this.gui.destroy()\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.renderer = new this.$THREE.WebGLRenderer();\r\n            this.renderer.setPixelRatio(window.devicePixelRatio);\r\n            this.renderer.setSize(this.$webglInnerWidth, window.innerHeight);\r\n            document.getElementsByClassName('webglPostprocessingAfterimage-container')[0].appendChild(this.renderer.domElement);\r\n            this.camera = new this.$THREE.PerspectiveCamera(70, this.$webglInnerWidth / window.innerHeight, 1, 1000);\r\n            this.camera.position.z = 400;\r\n            this.scene = new this.$THREE.Scene();\r\n            this.scene.fog = new this.$THREE.Fog(0x000000, 1, 1000);\r\n            var geometry = new this.$THREE.BoxBufferGeometry(150, 150, 150, 2, 2, 2);\r\n            var material = new this.$THREE.MeshNormalMaterial();\r\n            this.mesh = new this.$THREE.Mesh(geometry, material);\r\n            this.scene.add(this.mesh);\r\n            // postprocessing\r\n            this.composer = new EffectComposer(this.renderer);\r\n            this.composer.addPass(new RenderPass(this.scene, this.camera));\r\n            this.afterimagePass = new AfterimagePass();\r\n            this.composer.addPass(this.afterimagePass);\r\n            window.addEventListener('resize', this.onWindowResize, false);\r\n            if (typeof TESTING !== 'undefined') { for (var i = 0; i < 45; i ++) { this.render(); }; };\r\n        },\r\n        createGUI() {\r\n            this.gui = new GUI({ name: 'Damp setting' });\r\n            this.gui.add(this.afterimagePass.uniforms[ \"damp\" ], 'value', 0, 1).step(0.001);\r\n            this.gui.add(this.params, 'enable');\r\n        },\r\n        onWindowResize() {\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n            this.composer.setSize(window.innerWidth - 281, window.innerHeight);\r\n        },\r\n        render() {\r\n            this.mesh.rotation.x += 0.005;\r\n            this.mesh.rotation.y += 0.01;\r\n            if (this.params.enable) {\r\n                this.composer.render();\r\n            } else {\r\n                this.renderer.render(this.scene, this.camera);\r\n            }\r\n        },\r\n        animate() {\r\n            requestAnimationFrame(this.animate);\r\n            this.render();\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglPostprocessingAfterimage-container {\r\n    width: 100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/postprocessing/webglPostprocessingAfterimage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglPostprocessingAfterimage-container\"})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5d5e01f7\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/postprocessing/webglPostprocessingAfterimage.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5d5e01f7\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglPostprocessingAfterimage.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglPostprocessingAfterimage.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglPostprocessingAfterimage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5d5e01f7\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglPostprocessingAfterimage.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5d5e01f7\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/postprocessing/webglPostprocessingAfterimage.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}