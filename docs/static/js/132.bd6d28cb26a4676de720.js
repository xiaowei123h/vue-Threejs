webpackJsonp([132],{KQ9w:function(t,e){},ulp8:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("wIBv"),o={data:function(){return{container:null,stats:null,camera:null,controls:null,scene:null,renderer:null,textureLoader:null,clock:null,gravityConstant:-9.8,collisionConfiguration:null,dispatcher:null,broadphase:null,solver:null,softBodySolver:null,physicsWorld:null,rigidBodies:[],margin:.05,hinge:null,rope:null,transformAux1:null,armMovement:0}},mounted:function(){var t=this;this.clock=new this.$THREE.Clock,Ammo().then(function(e){Ammo=e,t.init(),t.animate()})},methods:{init:function(){this.initGraphics(),this.initPhysics(),this.createObjects(),this.initInput()},initGraphics:function(){this.container=document.getElementById("container"),this.camera=new this.$THREE.PerspectiveCamera(60,this.$webglInnerWidth/window.innerHeight,.2,2e3),this.scene=new this.$THREE.Scene,this.scene.background=new this.$THREE.Color(12571109),this.camera.position.set(-7,5,8),this.renderer=new this.$THREE.WebGLRenderer,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.container.appendChild(this.renderer.domElement),this.controls=new s.b(this.camera,this.renderer.domElement),this.controls.target.set(0,2,0),this.controls.update(),this.textureLoader=new this.$THREE.TextureLoader;var t=new this.$THREE.AmbientLight(4210752);this.scene.add(t);var e=new this.$THREE.DirectionalLight(16777215,1);e.position.set(-10,10,5),e.castShadow=!0;e.shadow.camera.left=-10,e.shadow.camera.right=10,e.shadow.camera.top=10,e.shadow.camera.bottom=-10,e.shadow.camera.near=2,e.shadow.camera.far=50,e.shadow.mapSize.x=1024,e.shadow.mapSize.y=1024,this.scene.add(e),this.stats=new this.$Stats,this.stats.dom.style.left="280px",this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",this.container.appendChild(this.stats.domElement),window.addEventListener("resize",this.onWindowResize,!1)},initPhysics:function(){this.collisionConfiguration=new Ammo.btSoftBodyRigidBodyCollisionConfiguration,this.dispatcher=new Ammo.btCollisionDispatcher(this.collisionConfiguration),this.broadphase=new Ammo.btDbvtBroadphase,this.solver=new Ammo.btSequentialImpulseConstraintSolver,this.softBodySolver=new Ammo.btDefaultSoftBodySolver,this.physicsWorld=new Ammo.btSoftRigidDynamicsWorld(this.dispatcher,this.broadphase,this.solver,this.collisionConfiguration,this.softBodySolver),this.physicsWorld.setGravity(new Ammo.btVector3(0,this.gravityConstant,0)),this.physicsWorld.getWorldInfo().set_m_gravity(new Ammo.btVector3(0,this.gravityConstant,0)),this.transformAux1=new Ammo.btTransform},createObjects:function(){var t=this,e=new this.$THREE.Vector3,i=new this.$THREE.Quaternion;e.set(0,-.5,0),i.set(0,0,0,1);var s=this.createParalellepiped(40,1,40,0,e,i,new this.$THREE.MeshPhongMaterial({color:16777215}));s.castShadow=!0,s.receiveShadow=!0,this.textureLoader.load("static/textures/grid.png",function(e){e.wrapS=t.$THREE.RepeatWrapping,e.wrapT=t.$THREE.RepeatWrapping,e.repeat.set(40,40),s.material.map=e,s.material.needsUpdate=!0});var o=new this.$THREE.Mesh(new this.$THREE.SphereBufferGeometry(.6,20,20),new this.$THREE.MeshPhongMaterial({color:2105376}));o.castShadow=!0,o.receiveShadow=!0;var r=new Ammo.btSphereShape(.6);r.setMargin(this.margin),e.set(-3,2,0),i.set(0,0,0,1),this.createRigidBody(o,r,1.2,e,i),o.userData.physicsBody.setFriction(.5);var n=1.2*-6*.5;e.set(0,.3,n),i.set(0,0,0,1);for(var a=0;a<8;a++){var h=a%2==1;e.z=n,h&&(e.z-=.3);for(var d=h?7:6,c=0;c<d;c++){var l=1.2,m=.5;!h||0!=c&&c!=d-1||(l*=.5,m*=.5);var p=this.createParalellepiped(.6,.6,l,m,e,i,this.createMaterial());p.castShadow=!0,p.receiveShadow=!0,e.z+=!h||0!=c&&c!=d-2?1.2:.75*1.2}e.y+=.6}var u=o.position.clone();u.y+=.6;var w=new this.$THREE.BufferGeometry,y=new this.$THREE.LineBasicMaterial({color:0}),v=[],f=[];for(c=0;c<11;c++)v.push(u.x,u.y+.4*c,u.z);for(c=0;c<10;c++)f.push(c,c+1);w.setIndex(new this.$THREE.BufferAttribute(new Uint16Array(f),1)),w.setAttribute("position",new this.$THREE.BufferAttribute(new Float32Array(v),3)),w.computeBoundingSphere(),this.rope=new this.$THREE.LineSegments(w,y),this.rope.castShadow=!0,this.rope.receiveShadow=!0,this.scene.add(this.rope);var g=new Ammo.btSoftBodyHelpers,E=new Ammo.btVector3(u.x,u.y,u.z),b=new Ammo.btVector3(u.x,u.y+4,u.z),A=g.CreateRope(this.physicsWorld.getWorldInfo(),E,b,9,0),R=A.get_m_cfg();R.set_viterations(10),R.set_piterations(10),A.setTotalMass(3,!1),Ammo.castObject(A,Ammo.btCollisionObject).getCollisionShape().setMargin(3*this.margin),this.physicsWorld.addSoftBody(A,1,-1),this.rope.userData.physicsBody=A,A.setActivationState(4);var S=u.y+4,B=new this.$THREE.MeshPhongMaterial({color:6316128});e.set(u.x,.1,u.z-3),i.set(0,0,0,1);var x=this.createParalellepiped(1,.2,1,0,e,i,B);x.castShadow=!0,x.receiveShadow=!0,e.set(u.x,.5*S,u.z-3);var T=this.createParalellepiped(.4,S,.4,0,e,i,B);T.castShadow=!0,T.receiveShadow=!0,e.set(u.x,S+.2,u.z-1.5);var $=this.createParalellepiped(.4,.4,3.4,2,e,i,B);$.castShadow=!0,$.receiveShadow=!0;A.appendAnchor(0,o.userData.physicsBody,!0,1),A.appendAnchor(10,$.userData.physicsBody,!0,1);var H=new Ammo.btVector3(0,.5*S,0),M=new Ammo.btVector3(0,-.2,-1.5),C=new Ammo.btVector3(0,1,0);this.hinge=new Ammo.btHingeConstraint(T.userData.physicsBody,$.userData.physicsBody,H,M,C,C,!0),this.physicsWorld.addConstraint(this.hinge,!0)},createParalellepiped:function(t,e,i,s,o,r,n){var a=new this.$THREE.Mesh(new this.$THREE.BoxBufferGeometry(t,e,i,1,1,1),n),h=new Ammo.btBoxShape(new Ammo.btVector3(.5*t,.5*e,.5*i));return h.setMargin(this.margin),this.createRigidBody(a,h,s,o,r),a},createRigidBody:function(t,e,i,s,o){t.position.copy(s),t.quaternion.copy(o);var r=new Ammo.btTransform;r.setIdentity(),r.setOrigin(new Ammo.btVector3(s.x,s.y,s.z)),r.setRotation(new Ammo.btQuaternion(o.x,o.y,o.z,o.w));var n=new Ammo.btDefaultMotionState(r),a=new Ammo.btVector3(0,0,0);e.calculateLocalInertia(i,a);var h=new Ammo.btRigidBodyConstructionInfo(i,n,e,a),d=new Ammo.btRigidBody(h);t.userData.physicsBody=d,this.scene.add(t),i>0&&(this.rigidBodies.push(t),d.setActivationState(4)),this.physicsWorld.addRigidBody(d)},createRandomColor:function(){return Math.floor(Math.random()*(1<<24))},createMaterial:function(){return new this.$THREE.MeshPhongMaterial({color:this.createRandomColor()})},initInput:function(){var t=this;window.addEventListener("keydown",function(e){switch(e.keyCode){case 81:t.armMovement=1;break;case 65:t.armMovement=-1}},!1),window.addEventListener("keyup",function(){t.armMovement=0},!1)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate),this.render(),this.stats.update()},render:function(){var t=this.clock.getDelta();this.updatePhysics(t),this.renderer.render(this.scene,this.camera)},updatePhysics:function(t){this.hinge.enableAngularMotor(!0,1.5*this.armMovement,50),this.physicsWorld.stepSimulation(t,10);for(var e=this.rope.userData.physicsBody,i=this.rope.geometry.attributes.position.array,s=i.length/3,o=e.get_m_nodes(),r=0,n=0;n<s;n++){var a=o.at(n).get_m_x();i[r++]=a.x(),i[r++]=a.y(),i[r++]=a.z()}this.rope.geometry.attributes.position.needsUpdate=!0;n=0;for(var h=this.rigidBodies.length;n<h;n++){var d=this.rigidBodies[n],c=d.userData.physicsBody.getMotionState();if(c){c.getWorldTransform(this.transformAux1);var l=this.transformAux1.getOrigin(),m=this.transformAux1.getRotation();d.position.set(l.x(),l.y(),l.z()),d.quaternion.set(m.x(),m.y(),m.z(),m.w())}}}}},r={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"physicsAmmoRope-container"},[e("div",{attrs:{id:"info"}},[this._v("Ammo.js physics soft body rope demo"),e("br"),this._v("Press Q or A to move the arm.")]),this._v(" "),e("div",{attrs:{id:"container"}})])}]};var n=i("VU/8")(o,r,!1,function(t){i("KQ9w")},"data-v-8d232ec8",null);e.default=n.exports}});
//# sourceMappingURL=132.bd6d28cb26a4676de720.js.map