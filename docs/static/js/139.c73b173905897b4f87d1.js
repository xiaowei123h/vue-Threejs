webpackJsonp([139],{"7E7K":function(e,t){},"8oAw":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("QEtz"),i=r("85s5"),s=r("Z9IJ"),a=r("6+nK"),c=r("Ah8h"),l={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","\tvec2 aspectcorrect = vec2( 1.0, aspect );","\tfloat viewZ = getViewZ( getDepth( vUv ) );","\tfloat factor = ( focus + viewZ );","\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","\tvec2 dofblur9 = dofblur * 0.9;","\tvec2 dofblur7 = dofblur * 0.7;","\tvec2 dofblur4 = dofblur * 0.4;","\tvec4 col = vec4( 0.0 );","\tcol += texture2D( tColor, vUv.xy );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","\tgl_FragColor = col / 41.0;","\tgl_FragColor.a = 1.0;","}"].join("\n")},n=function(e,t,r){c.a.call(this),this.scene=e,this.camera=t;var o=void 0!==r.focus?r.focus:1,i=void 0!==r.aspect?r.aspect:t.aspect,s=void 0!==r.aperture?r.aperture:.025,n=void 0!==r.maxblur?r.maxblur:1,u=r.width||window.innerWidth||1,h=r.height||window.innerHeight||1;this.renderTargetDepth=new a._108(u,h,{minFilter:a._38,magFilter:a._38}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new a._31,this.materialDepth.depthPacking=a._60,this.materialDepth.blending=a._41,void 0===l&&console.error("BokehPass relies on BokehShader");var v=l,d=a._101.clone(v.uniforms);d.tDepth.value=this.renderTargetDepth.texture,d.focus.value=o,d.aspect.value=i,d.aperture.value=s,d.maxblur.value=n,d.nearClip.value=t.near,d.farClip.value=t.far,this.materialBokeh=new a._79({defines:Object.assign({},v.defines),uniforms:d,vertexShader:v.vertexShader,fragmentShader:v.fragmentShader}),this.uniforms=d,this.needsSwap=!1,this.fsQuad=new c.a.FullScreenQuad(this.materialBokeh),this.oldClearColor=new a.r};n.prototype=Object.assign(Object.create(c.a.prototype),{constructor:n,render:function(e,t,r){this.scene.overrideMaterial=this.materialDepth,this.oldClearColor.copy(e.getClearColor());var o=e.getClearAlpha(),i=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=r.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this.oldClearColor),e.setClearAlpha(o),e.autoClear=i}});var u={data:function(){return{camera:null,scene:null,renderer:null,stats:null,singleMaterial:null,zmaterial:null,parameters:null,nobjects:null,cubeMaterial:null,mouseX:0,mouseY:0,windowHalfX:null,windowHalfY:null,width:null,height:null,materials:[],objects:[],postprocessing:{},gui:null}},mounted:function(){this.windowHalfX=this.$webglInnerWidth/2,this.windowHalfY=window.innerHeight/2,this.width=this.$webglInnerWidth,this.height=window.innerHeight,this.init(),this.animate()},beforeDestroy:function(){this.gui.destroy()},methods:{init:function(){var e=this,t=document.createElement("div");document.getElementsByClassName("webglPostprocessingDof-container")[0].appendChild(t),this.camera=new this.$THREE.PerspectiveCamera(70,this.width/this.height,1,3e3),this.camera.position.z=200,this.scene=new this.$THREE.Scene,this.renderer=new this.$THREE.WebGLRenderer,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),t.appendChild(this.renderer.domElement);var r="static/textures/cube/SwedishRoyalCastle/",i=[r+"px.jpg",r+"nx.jpg",r+"py.jpg",r+"ny.jpg",r+"pz.jpg",r+"nz.jpg"],s=(new this.$THREE.CubeTextureLoader).load(i);this.parameters={color:16716032,envMap:s},this.cubeMaterial=new this.$THREE.MeshBasicMaterial(this.parameters),this.singleMaterial=!1,this.singleMaterial&&(zmaterial=[this.cubeMaterial]);var a=new this.$THREE.SphereBufferGeometry(1,20,10);this.nobjects=1764;for(var c=0,l=0;l<14;l++)for(var n=0;n<9;n++)for(var u=0;u<14;u++){var h;this.singleMaterial?h=new this.$THREE.Mesh(a,zmaterial):(h=new this.$THREE.Mesh(a,new this.$THREE.MeshBasicMaterial(this.parameters)),this.materials[c]=h.material);var v=200*(l-7),d=200*(n-4.5),p=200*(u-7);h.position.set(v,d,p),h.scale.set(60,60,60),h.matrixAutoUpdate=!1,h.updateMatrix(),this.scene.add(h),this.objects.push(h),c++}this.initPostprocessing(),this.renderer.autoClear=!1,this.stats=new this.$Stats,this.stats.dom.style.left="280px",t.appendChild(this.stats.dom),t.style.touchAction="none",t.addEventListener("pointermove",this.onPointerMove,!1),window.addEventListener("resize",this.onWindowResize,!1);var f={focus:500,aperture:5,maxblur:.01},x=function(){e.postprocessing.bokeh.uniforms.focus.value=f.focus,e.postprocessing.bokeh.uniforms.aperture.value=1e-5*f.aperture,e.postprocessing.bokeh.uniforms.maxblur.value=f.maxblur};this.gui=new o.a,this.gui.add(f,"focus",10,3e3,10).onChange(x),this.gui.add(f,"aperture",0,10,.1).onChange(x),this.gui.add(f,"maxblur",0,.01,.001).onChange(x),this.gui.close(),x()},onPointerMove:function(e){!1!==e.isPrimary&&(this.mouseX=e.clientX-this.windowHalfX,this.mouseY=e.clientY-this.windowHalfY)},onWindowResize:function(){this.windowHalfX=window.innerWidth/2,this.windowHalfY=window.innerHeight/2,this.width=window.innerWidth-281,this.height=window.innerHeight,this.$onWindowResize(this.camera,this.renderer),this.postprocessing.composer.setSize(this.width,this.height)},initPostprocessing:function(){var e=new s.a(this.scene,this.camera),t=new n(this.scene,this.camera,{focus:1,aperture:.025,maxblur:.01,width:this.width,height:this.height}),r=new i.a(this.renderer);r.addPass(e),r.addPass(t),this.postprocessing.composer=r,this.postprocessing.bokeh=t},animate:function(){requestAnimationFrame(this.animate,this.renderer.domElement),this.stats.begin(),this.render(),this.stats.end()},render:function(){var e=5e-5*Date.now();if(this.camera.position.x+=.036*(this.mouseX-this.camera.position.x),this.camera.position.y+=.036*(-this.mouseY-this.camera.position.y),this.camera.lookAt(this.scene.position),!this.singleMaterial)for(var t=0;t<this.nobjects;t++){var r=360*(t/this.nobjects+e)%360/360;this.materials[t].color.setHSL(r,1,.5)}this.postprocessing.composer.render(.1)}}},h={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglPostprocessingDof-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" - webgl depth-of-field with bokeh example"),t("br"),this._v("\n\t\t\tshader by "),t("a",{attrs:{href:"http://artmartinsh.blogspot.com/2010/02/glsl-lens-blur-filter-with-bokeh.html"}},[this._v("Martins Upitis")])])])}]};var v=r("VU/8")(u,h,!1,function(e){r("7E7K")},"data-v-48ea0d0f",null);t.default=v.exports}});
//# sourceMappingURL=139.c73b173905897b4f87d1.js.map