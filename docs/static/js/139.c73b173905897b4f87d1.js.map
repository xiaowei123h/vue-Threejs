{"version":3,"sources":["webpack:///./src/components/jsm/shaders/BokehShader.js","webpack:///./src/components/jsm/postprocessing/BokehPass.js","webpack:///src/views/postprocessing/webglPostprocessingDof.vue","webpack:///./src/views/postprocessing/webglPostprocessingDof.vue?573f","webpack:///./src/views/postprocessing/webglPostprocessingDof.vue"],"names":["BokehShader","defines","DEPTH_PACKING","PERSPECTIVE_CAMERA","uniforms","tColor","value","tDepth","focus","aspect","aperture","maxblur","nearClip","farClip","vertexShader","join","fragmentShader","BokehPass","scene","camera","params","Pass","call","this","undefined","width","window","innerWidth","height","innerHeight","renderTargetDepth","WebGLRenderTarget","minFilter","NearestFilter","magFilter","texture","name","materialDepth","MeshDepthMaterial","depthPacking","RGBADepthPacking","blending","NoBlending","console","error","bokehShader","bokehUniforms","UniformsUtils","clone","near","far","materialBokeh","ShaderMaterial","Object","assign","needsSwap","fsQuad","FullScreenQuad","oldClearColor","Color","prototype","create","constructor","render","renderer","writeBuffer","readBuffer","overrideMaterial","copy","getClearColor","oldClearAlpha","getClearAlpha","oldAutoClear","autoClear","setClearColor","setClearAlpha","setRenderTarget","clear","renderToScreen","webglPostprocessingDof","data","stats","singleMaterial","zmaterial","parameters","nobjects","cubeMaterial","mouseX","mouseY","windowHalfX","windowHalfY","materials","objects","postprocessing","gui","mounted","$webglInnerWidth","init","animate","beforeDestroy","destroy","methods","_this","container","document","createElement","getElementsByClassName","appendChild","$THREE","PerspectiveCamera","position","z","Scene","WebGLRenderer","setPixelRatio","devicePixelRatio","setSize","domElement","path","urls","textureCube","CubeTextureLoader","load","color","envMap","MeshBasicMaterial","geo","SphereBufferGeometry","xgrid","count","i","j","k","mesh","Mesh","material","x","y","ygrid","zgrid","set","scale","matrixAutoUpdate","updateMatrix","add","push","initPostprocessing","$Stats","dom","style","left","touchAction","addEventListener","onPointerMove","onWindowResize","effectController","matChanger","bokeh","dat_gui_module","onChange","close","event","isPrimary","clientX","clientY","$onWindowResize","composer","renderPass","RenderPass","bokehPass","BokehPass_BokehPass","EffectComposer","addPass","requestAnimationFrame","begin","end","time","Date","now","lookAt","h","setHSL","postprocessing_webglPostprocessingDof","$createElement","_self","_c","_m","staticRenderFns","_h","staticClass","attrs","id","href","target","rel","_v","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/139.c73b173905897b4f87d1.js","sourcesContent":["/**\r\n * Depth-of-field shader with bokeh\r\n * ported from GLSL shader by Martins Upitis\r\n * http://artmartinsh.blogspot.com/2010/02/glsl-lens-blur-filter-with-bokeh.html\r\n */\r\n\r\nvar BokehShader = {\r\n\r\n\tdefines: {\r\n\t\t\"DEPTH_PACKING\": 1,\r\n\t\t\"PERSPECTIVE_CAMERA\": 1,\r\n\t},\r\n\r\n\tuniforms: {\r\n\r\n\t\t\"tColor\": { value: null },\r\n\t\t\"tDepth\": { value: null },\r\n\t\t\"focus\": { value: 1.0 },\r\n\t\t\"aspect\": { value: 1.0 },\r\n\t\t\"aperture\": { value: 0.025 },\r\n\t\t\"maxblur\": { value: 0.01 },\r\n\t\t\"nearClip\": { value: 1.0 },\r\n\t\t\"farClip\": { value: 1000.0 },\r\n\r\n\t},\r\n\r\n\tvertexShader: [\r\n\r\n\t\t\"varying vec2 vUv;\",\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\"\tvUv = uv;\",\r\n\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" ),\r\n\r\n\tfragmentShader: [\r\n\t\t\"#include <common>\",\r\n\r\n\t\t\"varying vec2 vUv;\",\r\n\r\n\t\t\"uniform sampler2D tColor;\",\r\n\t\t\"uniform sampler2D tDepth;\",\r\n\r\n\t\t\"uniform float maxblur;\", // max blur amount\r\n\t\t\"uniform float aperture;\", // aperture - bigger values for shallower depth of field\r\n\r\n\t\t\"uniform float nearClip;\",\r\n\t\t\"uniform float farClip;\",\r\n\r\n\t\t\"uniform float focus;\",\r\n\t\t\"uniform float aspect;\",\r\n\r\n\t\t\"#include <packing>\",\r\n\r\n\t\t\"float getDepth( const in vec2 screenPosition ) {\",\r\n\t\t\"\t#if DEPTH_PACKING == 1\",\r\n\t\t\"\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\",\r\n\t\t\"\t#else\",\r\n\t\t\"\treturn texture2D( tDepth, screenPosition ).x;\",\r\n\t\t\"\t#endif\",\r\n\t\t\"}\",\r\n\r\n\t\t\"float getViewZ( const in float depth ) {\",\r\n\t\t\"\t#if PERSPECTIVE_CAMERA == 1\",\r\n\t\t\"\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );\",\r\n\t\t\"\t#else\",\r\n\t\t\"\treturn orthographicDepthToViewZ( depth, nearClip, farClip );\",\r\n\t\t\"\t#endif\",\r\n\t\t\"}\",\r\n\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\"\tvec2 aspectcorrect = vec2( 1.0, aspect );\",\r\n\r\n\t\t\"\tfloat viewZ = getViewZ( getDepth( vUv ) );\",\r\n\r\n\t\t\"\tfloat factor = ( focus + viewZ );\", // viewZ is <= 0, so this is a difference equation\r\n\r\n\t\t\"\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );\",\r\n\r\n\t\t\"\tvec2 dofblur9 = dofblur * 0.9;\",\r\n\t\t\"\tvec2 dofblur7 = dofblur * 0.7;\",\r\n\t\t\"\tvec2 dofblur4 = dofblur * 0.4;\",\r\n\r\n\t\t\"\tvec4 col = vec4( 0.0 );\",\r\n\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );\",\r\n\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );\",\r\n\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );\",\r\n\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );\",\r\n\t\t\"\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );\",\r\n\r\n\t\t\"\tgl_FragColor = col / 41.0;\",\r\n\t\t\"\tgl_FragColor.a = 1.0;\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" )\r\n\r\n};\r\n\r\nexport { BokehShader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/shaders/BokehShader.js","import {\r\n\tColor,\r\n\tMeshDepthMaterial,\r\n\tNearestFilter,\r\n\tNoBlending,\r\n\tRGBADepthPacking,\r\n\tShaderMaterial,\r\n\tUniformsUtils,\r\n\tWebGLRenderTarget\r\n} from \"@/components/build/three.module.js\";\r\nimport { Pass } from \"../postprocessing/Pass.js\";\r\nimport { BokehShader } from \"../shaders/BokehShader.js\";\r\n\r\n/**\r\n * Depth-of-field post-process with bokeh shader\r\n */\r\n\r\nvar BokehPass = function ( scene, camera, params ) {\r\n\r\n\tPass.call( this );\r\n\r\n\tthis.scene = scene;\r\n\tthis.camera = camera;\r\n\r\n\tvar focus = ( params.focus !== undefined ) ? params.focus : 1.0;\r\n\tvar aspect = ( params.aspect !== undefined ) ? params.aspect : camera.aspect;\r\n\tvar aperture = ( params.aperture !== undefined ) ? params.aperture : 0.025;\r\n\tvar maxblur = ( params.maxblur !== undefined ) ? params.maxblur : 1.0;\r\n\r\n\t// render targets\r\n\r\n\tvar width = params.width || window.innerWidth || 1;\r\n\tvar height = params.height || window.innerHeight || 1;\r\n\r\n\tthis.renderTargetDepth = new WebGLRenderTarget( width, height, {\r\n\t\tminFilter: NearestFilter,\r\n\t\tmagFilter: NearestFilter\r\n\t} );\r\n\r\n\tthis.renderTargetDepth.texture.name = \"BokehPass.depth\";\r\n\r\n\t// depth material\r\n\r\n\tthis.materialDepth = new MeshDepthMaterial();\r\n\tthis.materialDepth.depthPacking = RGBADepthPacking;\r\n\tthis.materialDepth.blending = NoBlending;\r\n\r\n\t// bokeh material\r\n\r\n\tif ( BokehShader === undefined ) {\r\n\r\n\t\tconsole.error( \"BokehPass relies on BokehShader\" );\r\n\r\n\t}\r\n\r\n\tvar bokehShader = BokehShader;\r\n\tvar bokehUniforms = UniformsUtils.clone( bokehShader.uniforms );\r\n\r\n\tbokehUniforms[ \"tDepth\" ].value = this.renderTargetDepth.texture;\r\n\r\n\tbokehUniforms[ \"focus\" ].value = focus;\r\n\tbokehUniforms[ \"aspect\" ].value = aspect;\r\n\tbokehUniforms[ \"aperture\" ].value = aperture;\r\n\tbokehUniforms[ \"maxblur\" ].value = maxblur;\r\n\tbokehUniforms[ \"nearClip\" ].value = camera.near;\r\n\tbokehUniforms[ \"farClip\" ].value = camera.far;\r\n\r\n\tthis.materialBokeh = new ShaderMaterial( {\r\n\t\tdefines: Object.assign( {}, bokehShader.defines ),\r\n\t\tuniforms: bokehUniforms,\r\n\t\tvertexShader: bokehShader.vertexShader,\r\n\t\tfragmentShader: bokehShader.fragmentShader\r\n\t} );\r\n\r\n\tthis.uniforms = bokehUniforms;\r\n\tthis.needsSwap = false;\r\n\r\n\tthis.fsQuad = new Pass.FullScreenQuad( this.materialBokeh );\r\n\r\n\tthis.oldClearColor = new Color();\r\n\r\n};\r\n\r\nBokehPass.prototype = Object.assign( Object.create( Pass.prototype ), {\r\n\r\n\tconstructor: BokehPass,\r\n\r\n\trender: function ( renderer, writeBuffer, readBuffer/*, deltaTime, maskActive*/ ) {\r\n\r\n\t\t// Render depth into texture\r\n\r\n\t\tthis.scene.overrideMaterial = this.materialDepth;\r\n\r\n\t\tthis.oldClearColor.copy( renderer.getClearColor() );\r\n\t\tvar oldClearAlpha = renderer.getClearAlpha();\r\n\t\tvar oldAutoClear = renderer.autoClear;\r\n\t\trenderer.autoClear = false;\r\n\r\n\t\trenderer.setClearColor( 0xffffff );\r\n\t\trenderer.setClearAlpha( 1.0 );\r\n\t\trenderer.setRenderTarget( this.renderTargetDepth );\r\n\t\trenderer.clear();\r\n\t\trenderer.render( this.scene, this.camera );\r\n\r\n\t\t// Render bokeh composite\r\n\r\n\t\tthis.uniforms[ \"tColor\" ].value = readBuffer.texture;\r\n\t\tthis.uniforms[ \"nearClip\" ].value = this.camera.near;\r\n\t\tthis.uniforms[ \"farClip\" ].value = this.camera.far;\r\n\r\n\t\tif ( this.renderToScreen ) {\r\n\r\n\t\t\trenderer.setRenderTarget( null );\r\n\t\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t} else {\r\n\r\n\t\t\trenderer.setRenderTarget( writeBuffer );\r\n\t\t\trenderer.clear();\r\n\t\t\tthis.fsQuad.render( renderer );\r\n\r\n\t\t}\r\n\r\n\t\tthis.scene.overrideMaterial = null;\r\n\t\trenderer.setClearColor( this.oldClearColor );\r\n\t\trenderer.setClearAlpha( oldClearAlpha );\r\n\t\trenderer.autoClear = oldAutoClear;\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { BokehPass };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/postprocessing/BokehPass.js","<template>\r\n    <div class=\"webglPostprocessingDof-container\">\r\n        <div id=\"info\">\r\n\t\t\t<a href=\"https://threejs.org\" target=\"_blank\" rel=\"noopener\">three.js</a> - webgl depth-of-field with bokeh example<br/>\r\n\t\t\tshader by <a href=\"http://artmartinsh.blogspot.com/2010/02/glsl-lens-blur-filter-with-bokeh.html\">Martins Upitis</a>\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { GUI } from '@/components/jsm/libs/dat.gui.module.js'\r\nimport { EffectComposer } from '@/components/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from '@/components/jsm/postprocessing/RenderPass.js'\r\nimport { BokehPass } from '@/components/jsm/postprocessing/BokehPass.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            camera: null,\r\n            scene: null,\r\n            renderer: null,\r\n            stats: null,\r\n            singleMaterial: null,\r\n            zmaterial: null,\r\n            parameters: null,\r\n            nobjects: null,\r\n            cubeMaterial: null,\r\n            mouseX: 0,\r\n            mouseY: 0,\r\n\t\t\twindowHalfX: null,\r\n\t\t\twindowHalfY: null,\r\n\t\t\twidth: null,\r\n\t\t\theight: null,\r\n            materials: [],\r\n            objects: [],\r\n            postprocessing: {},\r\n            gui: null,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.windowHalfX = this.$webglInnerWidth / 2\r\n        this.windowHalfY = window.innerHeight / 2\r\n        this.width = this.$webglInnerWidth\r\n        this.height = window.innerHeight\r\n        this.init()\r\n\t\tthis.animate()\r\n    },\r\n    beforeDestroy() {\r\n        this.gui.destroy()\r\n    },\r\n    methods: {\r\n        init() {\r\n            var container = document.createElement('div')\r\n            document.getElementsByClassName('webglPostprocessingDof-container')[0].appendChild(container)\r\n            this.camera = new this.$THREE.PerspectiveCamera(70, this.width / this.height, 1, 3000)\r\n            this.camera.position.z = 200\r\n            this.scene = new this.$THREE.Scene()\r\n            this.renderer = new this.$THREE.WebGLRenderer()\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            this.renderer.setSize(this.width, this.height)\r\n            container.appendChild(this.renderer.domElement)\r\n            var path = 'static/textures/cube/SwedishRoyalCastle/'\r\n            var format = '.jpg'\r\n            var urls = [\r\n                path + 'px' + format, path + 'nx' + format,\r\n                path + 'py' + format, path + 'ny' + format,\r\n                path + 'pz' + format, path + 'nz' + format\r\n            ]\r\n            var textureCube = new this.$THREE.CubeTextureLoader().load(urls)\r\n            this.parameters = { color: 0xff1100, envMap: textureCube }\r\n            this.cubeMaterial = new this.$THREE.MeshBasicMaterial(this.parameters)\r\n            this.singleMaterial = false\r\n            if (this.singleMaterial) zmaterial = [ this.cubeMaterial ]\r\n            var geo = new this.$THREE.SphereBufferGeometry(1, 20, 10)\r\n            var xgrid = 14, ygrid = 9, zgrid = 14\r\n            this.nobjects = xgrid * ygrid * zgrid\r\n            var s = 60\r\n            var count = 0\r\n            for (var i = 0; i < xgrid; i ++) {\r\n                for (var j = 0; j < ygrid; j ++) {\r\n                    for (var k = 0; k < zgrid; k ++) {\r\n                        var mesh\r\n                        if (this.singleMaterial) {\r\n                            mesh = new this.$THREE.Mesh(geo, zmaterial)\r\n                        } else {\r\n                            mesh = new this.$THREE.Mesh(geo, new this.$THREE.MeshBasicMaterial(this.parameters))\r\n                            this.materials[ count ] = mesh.material\r\n                        }\r\n                        var x = 200 * (i - xgrid / 2)\r\n                        var y = 200 * (j - ygrid / 2)\r\n                        var z = 200 * (k - zgrid / 2)\r\n                        mesh.position.set(x, y, z)\r\n                        mesh.scale.set(s, s, s)\r\n                        mesh.matrixAutoUpdate = false\r\n                        mesh.updateMatrix()\r\n                        this.scene.add(mesh)\r\n                        this.objects.push(mesh)\r\n                        count ++\r\n                    }\r\n                }\r\n            }\r\n            this.initPostprocessing()\r\n            this.renderer.autoClear = false\r\n            this.stats = new this.$Stats()\r\n            this.stats.dom.style.left = '280px'\r\n            container.appendChild(this.stats.dom)\r\n            container.style.touchAction = 'none'\r\n            container.addEventListener('pointermove', this.onPointerMove, false)\r\n            window.addEventListener('resize', this.onWindowResize, false)\r\n            var effectController = {\r\n                focus: 500.0,\r\n                aperture: 5,\r\n                maxblur: 0.01\r\n            }\r\n            var matChanger = () => {\r\n                this.postprocessing.bokeh.uniforms[ \"focus\" ].value = effectController.focus\r\n                this.postprocessing.bokeh.uniforms[ \"aperture\" ].value = effectController.aperture * 0.00001\r\n                this.postprocessing.bokeh.uniforms[ \"maxblur\" ].value = effectController.maxblur\r\n            }\r\n            this.gui = new GUI()\r\n            this.gui.add(effectController, \"focus\", 10.0, 3000.0, 10).onChange(matChanger)\r\n            this.gui.add(effectController, \"aperture\", 0, 10, 0.1).onChange(matChanger)\r\n            this.gui.add(effectController, \"maxblur\", 0.0, 0.01, 0.001).onChange(matChanger)\r\n            this.gui.close()\r\n            matChanger()\r\n        },\r\n        onPointerMove(event) {\r\n            if (event.isPrimary === false) return\r\n            this.mouseX = event.clientX - this.windowHalfX\r\n            this.mouseY = event.clientY - this.windowHalfY\r\n        },\r\n        onWindowResize() {\r\n            this.windowHalfX = window.innerWidth / 2\r\n            this.windowHalfY = window.innerHeight / 2\r\n            this.width = window.innerWidth - 281\r\n            this.height = window.innerHeight\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n            this.postprocessing.composer.setSize(this.width, this.height)\r\n        },\r\n        initPostprocessing() {\r\n            var renderPass = new RenderPass(this.scene, this.camera)\r\n            var bokehPass = new BokehPass(this.scene, this.camera, {\r\n                focus: 1.0,\r\n                aperture: 0.025,\r\n                maxblur: 0.01,\r\n                width: this.width,\r\n                height: this.height\r\n            })\r\n            var composer = new EffectComposer(this.renderer)\r\n            composer.addPass(renderPass)\r\n            composer.addPass(bokehPass)\r\n            this.postprocessing.composer = composer\r\n            this.postprocessing.bokeh = bokehPass\r\n        },\r\n        animate() {\r\n            requestAnimationFrame(this.animate, this.renderer.domElement)\r\n            this.stats.begin()\r\n            this.render()\r\n            this.stats.end()\r\n        },\r\n        render() {\r\n            var time = Date.now() * 0.00005\r\n            this.camera.position.x += (this.mouseX - this.camera.position.x) * 0.036\r\n            this.camera.position.y += (- (this.mouseY) - this.camera.position.y) * 0.036\r\n            this.camera.lookAt(this.scene.position)\r\n            if (! this.singleMaterial) {\r\n                for (var i = 0; i < this.nobjects; i ++) {\r\n                    var h = (360 * (i / this.nobjects + time) % 360) / 360\r\n                    this.materials[ i ].color.setHSL(h, 1, 0.5)\r\n                }\r\n            }\r\n            this.postprocessing.composer.render(0.1)\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglPostprocessingDof-container {\r\n    width: 100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/postprocessing/webglPostprocessingDof.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglPostprocessingDof-container\"},[_c('div',{attrs:{\"id\":\"info\"}},[_c('a',{attrs:{\"href\":\"https://threejs.org\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"three.js\")]),_vm._v(\" - webgl depth-of-field with bokeh example\"),_c('br'),_vm._v(\"\\n\\t\\t\\tshader by \"),_c('a',{attrs:{\"href\":\"http://artmartinsh.blogspot.com/2010/02/glsl-lens-blur-filter-with-bokeh.html\"}},[_vm._v(\"Martins Upitis\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-48ea0d0f\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/postprocessing/webglPostprocessingDof.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-48ea0d0f\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglPostprocessingDof.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglPostprocessingDof.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglPostprocessingDof.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-48ea0d0f\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglPostprocessingDof.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-48ea0d0f\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/postprocessing/webglPostprocessingDof.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}