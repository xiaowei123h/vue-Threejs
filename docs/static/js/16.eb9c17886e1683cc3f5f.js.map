{"version":3,"sources":["webpack:///./src/components/jsm/nodes/core/Node.js","webpack:///./src/components/jsm/nodes/core/TempNode.js","webpack:///./src/components/jsm/nodes/core/InputNode.js","webpack:///./src/components/jsm/nodes/core/ConstNode.js","webpack:///./src/components/jsm/nodes/core/VarNode.js","webpack:///./src/components/jsm/nodes/core/StructNode.js","webpack:///./src/components/jsm/nodes/core/AttributeNode.js","webpack:///./src/components/jsm/nodes/core/NodeLib.js","webpack:///./src/components/jsm/nodes/core/FunctionNode.js","webpack:///./src/components/jsm/nodes/core/ExpressionNode.js","webpack:///./src/components/jsm/nodes/core/FunctionCallNode.js","webpack:///./src/components/jsm/nodes/core/NodeUtils.js","webpack:///./src/components/jsm/nodes/utils/ColorSpaceNode.js","webpack:///./src/components/jsm/nodes/core/NodeFrame.js","webpack:///./src/components/jsm/nodes/core/NodeUniform.js","webpack:///./src/components/jsm/nodes/inputs/Vector2Node.js","webpack:///./src/components/jsm/nodes/inputs/Vector3Node.js","webpack:///./src/components/jsm/nodes/inputs/Vector4Node.js","webpack:///./src/components/jsm/nodes/accessors/UVNode.js","webpack:///./src/components/jsm/nodes/inputs/FloatNode.js","webpack:///./src/components/jsm/nodes/inputs/TextureNode.js","webpack:///./src/components/jsm/nodes/accessors/PositionNode.js","webpack:///./src/components/jsm/nodes/accessors/NormalNode.js","webpack:///./src/components/jsm/nodes/accessors/ReflectNode.js","webpack:///./src/components/jsm/nodes/inputs/CubeTextureNode.js","webpack:///./src/components/jsm/nodes/math/OperatorNode.js","webpack:///./src/components/jsm/nodes/math/MathNode.js","webpack:///./src/components/jsm/nodes/misc/TextureCubeUVNode.js","webpack:///./src/components/jsm/nodes/misc/TextureCubeNode.js","webpack:///./src/components/jsm/nodes/core/NodeBuilder.js","webpack:///./src/components/jsm/nodes/inputs/BoolNode.js","webpack:///./src/components/jsm/nodes/inputs/IntNode.js","webpack:///./src/components/jsm/nodes/inputs/ColorNode.js","webpack:///./src/components/jsm/nodes/inputs/Matrix3Node.js","webpack:///./src/components/jsm/nodes/inputs/Matrix4Node.js","webpack:///./src/components/jsm/nodes/inputs/ScreenNode.js","webpack:///./src/components/jsm/nodes/inputs/ReflectorNode.js","webpack:///./src/components/jsm/nodes/inputs/PropertyNode.js","webpack:///./src/components/jsm/nodes/materials/nodes/RawNode.js","webpack:///./src/components/jsm/nodes/materials/NodeMaterial.js","webpack:///./src/components/jsm/nodes/inputs/RTTNode.js","webpack:///./src/components/jsm/nodes/accessors/ColorsNode.js","webpack:///./src/components/jsm/nodes/misc/BumpMapNode.js","webpack:///./src/components/jsm/nodes/accessors/CameraNode.js","webpack:///./src/components/jsm/nodes/accessors/LightNode.js","webpack:///./src/components/jsm/nodes/accessors/ResolutionNode.js","webpack:///./src/components/jsm/nodes/accessors/ScreenUVNode.js","webpack:///./src/components/jsm/nodes/math/CondNode.js","webpack:///./src/components/jsm/nodes/procedural/NoiseNode.js","webpack:///./src/components/jsm/nodes/procedural/CheckerNode.js","webpack:///./src/components/jsm/nodes/misc/NormalMapNode.js","webpack:///./src/components/jsm/nodes/utils/BypassNode.js","webpack:///./src/components/jsm/nodes/utils/JoinNode.js","webpack:///./src/components/jsm/nodes/effects/LuminanceNode.js","webpack:///./src/components/jsm/nodes/utils/SwitchNode.js","webpack:///./src/components/jsm/nodes/utils/TimerNode.js","webpack:///./src/components/jsm/nodes/utils/VelocityNode.js","webpack:///./src/components/jsm/nodes/utils/UVTransformNode.js","webpack:///./src/components/jsm/nodes/utils/MaxMIPLevelNode.js","webpack:///./src/components/jsm/nodes/utils/SpecularMIPLevelNode.js","webpack:///./src/components/jsm/nodes/utils/SubSlotNode.js","webpack:///./src/components/jsm/nodes/effects/BlurNode.js","webpack:///./src/components/jsm/nodes/effects/ColorAdjustmentNode.js","webpack:///./src/components/jsm/nodes/materials/nodes/BasicNode.js","webpack:///./src/components/jsm/nodes/materials/nodes/SpriteNode.js","webpack:///./src/components/jsm/nodes/materials/nodes/PhongNode.js","webpack:///./src/components/jsm/nodes/materials/nodes/StandardNode.js","webpack:///./src/components/jsm/nodes/materials/nodes/MeshStandardNode.js","webpack:///./src/components/jsm/nodes/materials/BasicNodeMaterial.js","webpack:///./src/components/jsm/nodes/materials/SpriteNodeMaterial.js","webpack:///./src/components/jsm/nodes/materials/PhongNodeMaterial.js","webpack:///./src/components/jsm/nodes/materials/StandardNodeMaterial.js","webpack:///./src/components/jsm/nodes/materials/MeshStandardNodeMaterial.js","webpack:///./src/components/jsm/nodes/postprocessing/NodePostProcessing.js","webpack:///./src/components/jsm/loaders/NodeMaterialLoader.js","webpack:///src/views/loader/webglLoaderNodes.vue","webpack:///./src/views/loader/webglLoaderNodes.vue?00e3","webpack:///./src/views/loader/webglLoaderNodes.vue","webpack:///./src/components/jsm/geometries/TeapotBufferGeometry.js"],"names":["Node","type","this","uuid","MathUtils","generateUUID","name","userData","TempNode","params","call","shared","undefined","unique","InputNode","readonly","prototype","constructor","isNode","hashProperties","analyze","builder","settings","analyzing","build","addFlow","slot","cache","context","clearVertexNodeCode","clearFragmentNodeCode","removeFlow","analyzeAndFlow","output","flow","result","code","clearNodeCode","extra","getType","data","getNodeData","appendDepsNode","nodes","indexOf","push","updateFrame","updaters","generate","getHash","prop","obj","hash","i","length","String","deps","outputLen","getTypeLength","outputMax","setName","getName","getJSONNode","meta","copy","source","JSON","parse","stringify","createJSONNode","isRootObject","nodeType","Error","toJSON","Object","create","ns","getShared","isUnique","getUnique","getUuid","getLabel","ignoreCache","getTemp","format","addNodeCode","setLabel","label","scope","tempVar","getVars","console","error","getTempVar","setReadonly","value","getReadonly","needsUpdate","generateReadonly","isShader","vertex","createVertexUniform","fragment","createFragmentUniform","declarationRegexp","ConstNode","src","useDefine","PI","VarNode","PI2","RECIPROCAL_PI","RECIPROCAL_PI2","LOG2","EPSILON","getTypeByFormat","match","charAt","include","varying","getVar","propertiesRegexp","StructNode","AttributeNode","getInputByName","inputs","declaration","exec","properties","getAttributeType","getConstructorFromLength","attribute","getAttribute","NodeLib","keywords","add","node","addKeyword","callback","remove","removeKeyword","get","getKeyword","getKeywordData","contains","containsKeyword","FunctionNode","includes","extensions","isMethod","isInterface","ExpressionNode","FunctionCallNode","func","setFunction","useKeywords","getIncludeByName","offset","ext","matches","isGlobal","reference","keyword","substring","index","qualifier","getFunction","inpt","param","join","LinearToLinear","GammaToLinear","LinearToGamma","sRGBToLinear","LinearTosRGB","RGBEToLinear","LinearToRGBE","RGBMToLinear","LinearToRGBM","RGBDToLinear","LinearToRGBD","cLogLuvM","LinearToLogLuv","cLogLuvInverseM","NodeUtils","elements","addShortcuts","applyShortcut","proxy","property","subProperty","set","val","proto","list","shortcuts","split","defineProperties","NodeFrame","time","id","NodeUniform","Vector2Node","x","y","Vector2","Vector3Node","z","Vector3","Vector4Node","w","Vector4","UVNode","FloatNode","ColorSpaceNode","input","method","LINEAR_TO_LINEAR","TextureNode","uv","bias","project","PositionNode","LOCAL","NormalNode","VIEW","ReflectNode","CUBE","CubeTextureNode","OperatorNode","a","b","op","MathNode","bOrMethod","cOrMethod","c","TextureCubeUVNode","TextureCubeNode","radianceNode","VECTOR","irradianceNode","WORLD","update","delta","setRenderer","renderer","setRenderTexture","renderTexture","updateNode","frameId","requires","uvIndex","Nodes","LogLuvToLinear","GAMMA_TO_LINEAR","LINEAR_TO_GAMMA","SRGB_TO_LINEAR","LINEAR_TO_SRGB","RGBE_TO_LINEAR","LINEAR_TO_RGBE","RGBM_TO_LINEAR","LINEAR_TO_RGBM","RGBD_TO_LINEAR","LINEAR_TO_RGBD","LINEAR_TO_LOG_LUV","LOG_LUV_TO_LINEAR","getEncodingComponents","encoding","LinearEncoding","sRGBEncoding","RGBEEncoding","RGBM7Encoding","RGBM16Encoding","RGBDEncoding","GammaEncoding","outputType","methodNode","factor","fromEncoding","components","fromDecoding","getTexture","tex","setTexture","addContext","colorSpace","getTextureEncodingFromMap","removeContext","PROJECTION","position","worldPosition","contextNormal","normal","worldNormal","NORMAL","SPHERE","viewNormal","viewNormalNode","roughnessNode","roughness","viewPosition","reflectVec","warn","shader","cubetex","ADD","SUB","MUL","DIV","isTypeMatrix","RAD","DEG","EXP","EXP2","LOG","SQRT","INV_SQRT","FLOOR","CEIL","NORMALIZE","FRACT","SATURATE","SIN","COS","TAN","ASIN","ACOS","ARCTAN","ABS","SIGN","LENGTH","NEGATE","INVERT","MIN","MAX","MOD","STEP","REFLECT","DISTANCE","DOT","CROSS","POW","MIX","CLAMP","REFRACT","SMOOTHSTEP","FACEFORWARD","getNumInputs","getInputType","al","bl","cl","inputType","numInputs","TextureCubeUVData","cubeUV_maxMipLevel","cubeUV_minMipLevel","cubeUV_maxTileSize","cubeUV_minTileSize","getFace","getUV","bilinearCubeUV","r0","v0","m0","roughnessToMip","texture","mipInt","colorSpaceTL","colorSpaceTR","colorSpaceBL","colorSpaceBR","colorSpaceTLExp","colorSpaceTRExp","colorSpaceBLExp","colorSpaceBRExp","mip","mipF","color1Mix","require","constructors","convertFormatToType","float","vec2","vec3","vec4","mat4","int","bool","convertTypeToFormat","t","tc","f","v2","v3","v4","m3","m4","NodeBuilder","slots","caches","contexts","nodeData","color","lights","fog","transparent","irradiance","consts","functions","structs","attributes","prefixCode","parsCode","nodeCode","resultCode","finalCode","uniforms","vars","defines","BoolNode","Boolean","IntNode","Math","floor","ColorNode","g","Color","Matrix3Node","matrix","Matrix3","Matrix4Node","Matrix4","ScreenNode","ReflectorNode","mirror","setMirror","PropertyNode","object","RawNode","NodeMaterial","ShaderMaterial","RTTNode","width","height","options","clear","renderTarget","WebGLRenderTarget","material","camera","OrthographicCamera","scene","Scene","quad","Mesh","PlaneBufferGeometry","frustumCulled","render","buildShader","addVaryCode","addVertexParsCode","addVertexFinalCode","setShader","setMaterial","mergeDefines","addSlot","addCache","removeSlot","removeCache","pop","assign","addVertexCode","addCode","addFragmentCode","addVertexNodeCode","addFragmentNodeCode","addFinalCode","addFragmentFinalCode","addParsCode","addFragmentParsCode","isCache","isSlot","define","isDefined","arguments","prefix","getCode","getVarListCode","getIncludesCode","l","nVar","formatType","getFormatByType","createUniform","uniform","parent","includesStruct","included","colorToVectorProperties","replace","colorToVector","getIncludes","sortByPosition","sort","len","test","parseInt","substr","getTypeFromLength","findNode","nodeCandidate","resolve","isTexture","mapping","CubeReflectionMapping","CubeRefractionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","isVector2","isVector3","isVector4","from","to","useCache","getElementByIndex","getIndexByElement","elm","mergeUniform","map","isWebGLRenderTarget","gamma","r","fromArray","concat","textureMatrix","localPosition","uvResult","tDiffuse","isNodeMaterial","version","needsCompile","onBeforeCompile","vertexShader","fragmentShader","extensionDerivatives","derivatives","extensionFragDepth","fragDepth","extensionDrawBuffers","drawBuffers","extensionShaderTextureLOD","shaderTextureLOD","customProgramCacheKey","frame","blending","NormalBlending","materials","size","sizeAttenuation","flatShading","side","FrontSide","vertexColors","NoColors","depthFunc","LessEqualDepth","depthTest","depthWrite","linewidth","dashSize","gapSize","scale","dithering","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","alphaTest","premultipliedAlpha","morphTargets","skinning","visible","rttBuilder","updateFramesaveTo","saveTo","saveToCurrent","saveToMaterial","dispose","saveToScene","setRenderTarget","dHdxy_fwd","vertexDict","fragmentDict","ColorsNode","CameraNode","setScope","POSITION","setCamera","LightNode","TOTAL","ResolutionNode","ScreenUVNode","resolution","CondNode","ifNode","elseNode","NoiseNode","CheckerNode","NormalMapNode","BumpMapNode","toNormalMap","BypassNode","depthColor","DEPTH","TO_VERTEX","onUpdateFrame","near","far","number","getSize","pixelRatio","getPixelRatio","EQUAL","NOT_EQUAL","GREATER","GREATER_EQUAL","LESS","LESS_EQUAL","AND","OR","ifType","elseType","getCondType","condType","ifCode","elseCode","snoise","checker","perturbNormal2Arb","BackSide","perturbNormalArb","bumpToNormal","derivativeHeight","derivativeHeightCode","LUMA","JoinNode","SwitchNode","TimerNode","timeScale","GLOBAL","VelocityNode","target","velocity","setTarget","setParams","UVTransformNode","MaxMIPLevelNode","maxMIPLevel","SpecularMIPLevelNode","SubSlotNode","BlurNode","radius","blurX","blurY","horizontal","vertical","LuminanceNode","rgb","ColorAdjustmentNode","adjustment","SATURATION","BasicNode","SpriteNode","spherical","PhongNode","specular","shininess","StandardNode","metalness","MeshStandardNode","normalScale","BasicNodeMaterial","SpriteNodeMaterial","PhongNodeMaterial","StandardNodeMaterial","MeshStandardNodeMaterial","NodePostProcessing","parameters","minFilter","LinearFilter","magFilter","RGBAFormat","getDrawingBufferSize","getNumElements","max","outputs","inputLength","outputLength","idx","DELTA","moment","speed","springVelocity","lastVelocity","oldPosition","getWorldPosition","clone","updateFrameVelocity","subVectors","deltaFps","fps","spring","pow","damping","multiplyScalar","exp","setUvTransform","tx","ty","sx","sy","rotation","cx","cy","image","Array","isArray","log","LOG2E","getSpecularMIPLevel","blurCode","luminance","hue","saturation","vibrance","HUE","VIBRANCE","BRIGHTNESS","CONTRAST","alpha","mask","UniformsUtils","merge","UniformsLib","light","ao","ambient","shadow","emissive","environment","environmentAlpha","useClearcoat","clearcoat","clearcoatRoughness","clearCoatNormal","LTC_1","ltc_1","ltc_2","specularRoughness","contextEnvironment","contextGammaOnly","contextClearcoatEnvironment","clearcoatNormal","reflectivity","sheen","radiance","clearcoatEnv","props","roughnessMap","metalnessMap","normalMap","envMap","setPixelRatio","setSize","post","NodeMaterialLoader","manager","library","DefaultLoadingManager","passes","names","load","url","onLoad","onProgress","onError","loader","FileLoader","setPath","path","text","getObjectByName","getObjectById","getNode","json","_typeof","declare","pass","webglLoaderNodes","container","clock","teapot","mesh","cloud","controls","gui","mounted","document","getElementById","$THREE","Clock","fov","window","addEventListener","init","beforeDestroy","hide","methods","WebGLRenderer","antialias","devicePixelRatio","innerWidth","innerHeight","appendChild","domElement","PerspectiveCamera","TextureLoader","wrapS","wrapT","RepeatWrapping","OrbitControls","minDistance","maxDistance","AmbientLight","light1","DirectionalLight","light2","TeapotBufferGeometry","onWindowResize","updateMaterial","animate","clearGui","_this","destroy","dat_gui_module","caustic","displace","wave","xray","onFinishChange","open","addGui","isColor","min","_this2","addColor","onChange","webglLoaderNodes__typeof","_this3","NodeMaterialLoader_NodeMaterialLoader","$onWindowResize","getDelta","requestAnimationFrame","loader_webglLoaderNodes","$createElement","_self","_c","_m","staticRenderFns","_h","staticClass","attrs","_v","href","rel","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","d","__WEBPACK_IMPORTED_MODULE_0__components_build_three_module_js__","segments","bottom","lid","body","fitLid","blinn","teapotPatches","teapotVertices","BufferGeometry","maxHeight2","trueSize","numTriangles","indices","Uint32Array","numVertices","vertices","Float32Array","normals","uvs","ms","tcoord","sstep","tstep","vertPerRow","s","sval","tval","p","v1","sp","tp","dsp","dtp","mgm","vert","sdir","tdir","norm","dsval","dtval","normOut","gmx","tmtx","vsp","vtp","vdsp","vdtp","vsdir","vtdir","mst","transpose","notDegenerate","vtx1","vtx2","vtx3","maxPatches","surfCount","vertCount","normCount","uvCount","indexCount","surf","multiplyMatrices","applyMatrix4","dot","crossVectors","normalize","setIndex","BufferAttribute","setAttribute","computeBoundingSphere"],"mappings":"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AI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAErE,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAC1E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAE3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAE3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAC3E,IAAK,IAAK,IAAK,IAAK,IA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","file":"static/js/16.eb9c17886e1683cc3f5f.js","sourcesContent":["import { MathUtils } from '@/components/build/three.module.js';\r\n\r\nfunction Node( type ) {\r\n\r\n\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\tthis.name = \"\";\r\n\r\n\tthis.type = type;\r\n\r\n\tthis.userData = {};\r\n\r\n}\r\n\r\nNode.prototype = {\r\n\r\n\tconstructor: Node,\r\n\r\n\tisNode: true,\r\n\r\n\thashProperties: undefined,\r\n\r\n\tanalyze: function ( builder, settings ) {\r\n\r\n\t\tsettings = settings || {};\r\n\r\n\t\tbuilder.analyzing = true;\r\n\r\n\t\tthis.build( builder.addFlow( settings.slot, settings.cache, settings.context ), 'v4' );\r\n\r\n\t\tbuilder.clearVertexNodeCode();\r\n\t\tbuilder.clearFragmentNodeCode();\r\n\r\n\t\tbuilder.removeFlow();\r\n\r\n\t\tbuilder.analyzing = false;\r\n\r\n\t},\r\n\r\n\tanalyzeAndFlow: function ( builder, output, settings ) {\r\n\r\n\t\tsettings = settings || {};\r\n\r\n\t\tthis.analyze( builder, settings );\r\n\r\n\t\treturn this.flow( builder, output, settings );\r\n\r\n\t},\r\n\r\n\tflow: function ( builder, output, settings ) {\r\n\r\n\t\tsettings = settings || {};\r\n\r\n\t\tbuilder.addFlow( settings.slot, settings.cache, settings.context );\r\n\r\n\t\tvar flow = {};\r\n\t\tflow.result = this.build( builder, output );\r\n\t\tflow.code = builder.clearNodeCode();\r\n\t\tflow.extra = builder.context.extra;\r\n\r\n\t\tbuilder.removeFlow();\r\n\r\n\t\treturn flow;\r\n\r\n\t},\r\n\r\n\tbuild: function ( builder, output, uuid ) {\r\n\r\n\t\toutput = output || this.getType( builder, output );\r\n\r\n\t\tvar data = builder.getNodeData( uuid || this );\r\n\r\n\t\tif ( builder.analyzing ) {\r\n\r\n\t\t\tthis.appendDepsNode( builder, data, output );\r\n\r\n\t\t}\r\n\r\n\t\tif ( builder.nodes.indexOf( this ) === - 1 ) {\r\n\r\n\t\t\tbuilder.nodes.push( this );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.updateFrame !== undefined && builder.updaters.indexOf( this ) === - 1 ) {\r\n\r\n\t\t\tbuilder.updaters.push( this );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.generate( builder, output, uuid );\r\n\r\n\t},\r\n\r\n\tgenerate: function ( /* builder, output, uuid, type, ns */ ) {\r\n\r\n\t\t// This method needs to be implemented in subclasses\r\n\r\n\t},\r\n\r\n\tgetHash: function () {\r\n\r\n\t\tvar hash = '{';\r\n\t\tvar prop, obj;\r\n\r\n\t\tfor ( prop in this ) {\r\n\r\n\t\t\tobj = this[ prop ];\r\n\r\n\t\t\tif ( obj instanceof Node ) {\r\n\r\n\t\t\t\thash += '\"' + prop + '\":' + obj.getHash() + ',';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.hashProperties ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.hashProperties.length; i ++ ) {\r\n\r\n\t\t\t\tprop = this.hashProperties[ i ];\r\n\t\t\t\tobj = this[ prop ];\r\n\r\n\t\t\t\thash += '\"' + prop + '\":\"' + String( obj ) + '\",';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\thash += '\"id\":\"' + this.uuid + '\"}';\r\n\r\n\t\treturn hash;\r\n\r\n\t},\r\n\r\n\tappendDepsNode: function ( builder, data, output ) {\r\n\r\n\t\tdata.deps = ( data.deps || 0 ) + 1;\r\n\r\n\t\tvar outputLen = builder.getTypeLength( output );\r\n\r\n\t\tif ( outputLen > ( data.outputMax || 0 ) || this.getType( builder, output ) ) {\r\n\r\n\t\t\tdata.outputMax = outputLen;\r\n\t\t\tdata.output = output;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tsetName: function ( name ) {\r\n\r\n\t\tthis.name = name;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetName: function ( /* builder */ ) {\r\n\r\n\t\treturn this.name;\r\n\r\n\t},\r\n\r\n\tgetType: function ( builder, output ) {\r\n\r\n\t\treturn output === 'sampler2D' || output === 'samplerCube' ? output : this.type;\r\n\r\n\t},\r\n\r\n\tgetJSONNode: function ( meta ) {\r\n\r\n\t\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\tif ( ! isRootObject && meta.nodes[ this.uuid ] !== undefined ) {\r\n\r\n\t\t\treturn meta.nodes[ this.uuid ];\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tif ( source.name !== undefined ) this.name = source.name;\r\n\r\n\t\tif ( source.userData !== undefined ) this.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tcreateJSONNode: function ( meta ) {\r\n\r\n\t\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\tvar data = {};\r\n\r\n\t\tif ( typeof this.nodeType !== \"string\" ) throw new Error( \"Node does not allow serialization.\" );\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.nodeType = this.nodeType;\r\n\r\n\t\tif ( this.name !== \"\" ) data.name = this.name;\r\n\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\r\n\r\n\t\tif ( ! isRootObject ) {\r\n\r\n\t\t\tmeta.nodes[ this.uuid ] = data;\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\treturn this.getJSONNode( meta ) || this.createJSONNode( meta );\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { Node };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/Node.js","import { MathUtils } from '@/components/build/three.module.js';\r\nimport { Node } from './Node.js';\r\n\r\nfunction TempNode( type, params ) {\r\n\r\n\tNode.call( this, type );\r\n\r\n\tparams = params || {};\r\n\r\n\tthis.shared = params.shared !== undefined ? params.shared : true;\r\n\tthis.unique = params.unique !== undefined ? params.unique : false;\r\n\r\n}\r\n\r\nTempNode.prototype = Object.create( Node.prototype );\r\nTempNode.prototype.constructor = TempNode;\r\n\r\nTempNode.prototype.build = function ( builder, output, uuid, ns ) {\r\n\r\n\toutput = output || this.getType( builder );\r\n\r\n\tif ( this.getShared( builder, output ) ) {\r\n\r\n\t\tvar isUnique = this.getUnique( builder, output );\r\n\r\n\t\tif ( isUnique && this.constructor.uuid === undefined ) {\r\n\r\n\t\t\tthis.constructor.uuid = MathUtils.generateUUID();\r\n\r\n\t\t}\r\n\r\n\t\tuuid = builder.getUuid( uuid || this.getUuid(), ! isUnique );\r\n\r\n\t\tvar data = builder.getNodeData( uuid ),\r\n\t\t\ttype = data.output || this.getType( builder );\r\n\r\n\t\tif ( builder.analyzing ) {\r\n\r\n\t\t\tif ( ( data.deps || 0 ) > 0 || this.getLabel() ) {\r\n\r\n\t\t\t\tthis.appendDepsNode( builder, data, output );\r\n\r\n\t\t\t\treturn this.generate( builder, output, uuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn Node.prototype.build.call( this, builder, output, uuid );\r\n\r\n\t\t} else if ( isUnique ) {\r\n\r\n\t\t\tdata.name = data.name || Node.prototype.build.call( this, builder, output, uuid );\r\n\r\n\t\t\treturn data.name;\r\n\r\n\t\t} else if ( ! this.getLabel() && ( ! this.getShared( builder, type ) || ( builder.context.ignoreCache || data.deps === 1 ) ) ) {\r\n\r\n\t\t\treturn Node.prototype.build.call( this, builder, output, uuid );\r\n\r\n\t\t}\r\n\r\n\t\tuuid = this.getUuid( false );\r\n\r\n\t\tvar name = this.getTemp( builder, uuid );\r\n\r\n\t\tif ( name ) {\r\n\r\n\t\t\treturn builder.format( name, type, output );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tname = TempNode.prototype.generate.call( this, builder, output, uuid, data.output, ns );\r\n\r\n\t\t\tvar code = this.generate( builder, type, uuid );\r\n\r\n\t\t\tbuilder.addNodeCode( name + ' = ' + code + ';' );\r\n\r\n\t\t\treturn builder.format( name, type, output );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn Node.prototype.build.call( this, builder, output, uuid );\r\n\r\n};\r\n\r\nTempNode.prototype.getShared = function ( builder, output ) {\r\n\r\n\treturn output !== 'sampler2D' && output !== 'samplerCube' && this.shared;\r\n\r\n};\r\n\r\nTempNode.prototype.getUnique = function ( /* builder, output */ ) {\r\n\r\n\treturn this.unique;\r\n\r\n};\r\n\r\nTempNode.prototype.setLabel = function ( name ) {\r\n\r\n\tthis.label = name;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTempNode.prototype.getLabel = function ( /* builder */ ) {\r\n\r\n\treturn this.label;\r\n\r\n};\r\n\r\nTempNode.prototype.getUuid = function ( unique ) {\r\n\r\n\tvar uuid = unique || unique == undefined ? this.constructor.uuid || this.uuid : this.uuid;\r\n\r\n\tif ( typeof this.scope === \"string\" ) uuid = this.scope + '-' + uuid;\r\n\r\n\treturn uuid;\r\n\r\n};\r\n\r\nTempNode.prototype.getTemp = function ( builder, uuid ) {\r\n\r\n\tuuid = uuid || this.uuid;\r\n\r\n\tvar tempVar = builder.getVars()[ uuid ];\r\n\r\n\treturn tempVar ? tempVar.name : undefined;\r\n\r\n};\r\n\r\nTempNode.prototype.generate = function ( builder, output, uuid, type, ns ) {\r\n\r\n\tif ( ! this.getShared( builder, output ) ) console.error( \"THREE.TempNode is not shared!\" );\r\n\r\n\tuuid = uuid || this.uuid;\r\n\r\n\treturn builder.getTempVar( uuid, type || this.getType( builder ), ns, this.getLabel() ).name;\r\n\r\n};\r\n\r\nexport { TempNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/TempNode.js","import { TempNode } from './TempNode.js';\r\n\r\nfunction InputNode( type, params ) {\r\n\r\n\tparams = params || {};\r\n\tparams.shared = params.shared !== undefined ? params.shared : false;\r\n\r\n\tTempNode.call( this, type, params );\r\n\r\n\tthis.readonly = false;\r\n\r\n}\r\n\r\nInputNode.prototype = Object.create( TempNode.prototype );\r\nInputNode.prototype.constructor = InputNode;\r\n\r\nInputNode.prototype.setReadonly = function ( value ) {\r\n\r\n\tthis.readonly = value;\r\n\r\n\tthis.hashProperties = this.readonly ? [ \"value\" ] : undefined;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nInputNode.prototype.getReadonly = function ( /* builder */ ) {\r\n\r\n\treturn this.readonly;\r\n\r\n};\r\n\r\nInputNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tif ( source.readonly !== undefined ) this.readonly = source.readonly;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nInputNode.prototype.createJSONNode = function ( meta ) {\r\n\r\n\tvar data = TempNode.prototype.createJSONNode.call( this, meta );\r\n\r\n\tif ( this.readonly === true ) data.readonly = this.readonly;\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nInputNode.prototype.generate = function ( builder, output, uuid, type, ns, needsUpdate ) {\r\n\r\n\tuuid = builder.getUuid( uuid || this.getUuid() );\r\n\ttype = type || this.getType( builder );\r\n\r\n\tvar data = builder.getNodeData( uuid ),\r\n\t\treadonly = this.getReadonly( builder ) && this.generateReadonly !== undefined;\r\n\r\n\tif ( readonly ) {\r\n\r\n\t\treturn this.generateReadonly( builder, output, uuid, type, ns, needsUpdate );\r\n\r\n\t} else {\r\n\r\n\t\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\t\tif ( ! data.vertex ) {\r\n\r\n\t\t\t\tdata.vertex = builder.createVertexUniform( type, this, ns, needsUpdate, this.getLabel() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn builder.format( data.vertex.name, type, output );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( ! data.fragment ) {\r\n\r\n\t\t\t\tdata.fragment = builder.createFragmentUniform( type, this, ns, needsUpdate, this.getLabel() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn builder.format( data.fragment.name, type, output );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { InputNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/InputNode.js","import { TempNode } from './TempNode.js';\r\n\r\nvar declarationRegexp = /^([a-z_0-9]+)\\s([a-z_0-9]+)\\s?\\=?\\s?(.*?)(\\;|$)/i;\r\n\r\nfunction ConstNode( src, useDefine ) {\r\n\r\n\tTempNode.call( this );\r\n\r\n\tthis.parse( src || ConstNode.PI, useDefine );\r\n\r\n}\r\n\r\nConstNode.PI = 'PI';\r\nConstNode.PI2 = 'PI2';\r\nConstNode.RECIPROCAL_PI = 'RECIPROCAL_PI';\r\nConstNode.RECIPROCAL_PI2 = 'RECIPROCAL_PI2';\r\nConstNode.LOG2 = 'LOG2';\r\nConstNode.EPSILON = 'EPSILON';\r\n\r\nConstNode.prototype = Object.create( TempNode.prototype );\r\nConstNode.prototype.constructor = ConstNode;\r\nConstNode.prototype.nodeType = \"Const\";\r\n\r\nConstNode.prototype.getType = function ( builder ) {\r\n\r\n\treturn builder.getTypeByFormat( this.type );\r\n\r\n};\r\n\r\nConstNode.prototype.parse = function ( src, useDefine ) {\r\n\r\n\tthis.src = src || '';\r\n\r\n\tvar name, type, value = \"\";\r\n\r\n\tvar match = this.src.match( declarationRegexp );\r\n\r\n\tthis.useDefine = useDefine || this.src.charAt( 0 ) === '#';\r\n\r\n\tif ( match && match.length > 1 ) {\r\n\r\n\t\ttype = match[ 1 ];\r\n\t\tname = match[ 2 ];\r\n\t\tvalue = match[ 3 ];\r\n\r\n\t} else {\r\n\r\n\t\tname = this.src;\r\n\t\ttype = 'f';\r\n\r\n\t}\r\n\r\n\tthis.name = name;\r\n\tthis.type = type;\r\n\tthis.value = value;\r\n\r\n};\r\n\r\nConstNode.prototype.build = function ( builder, output ) {\r\n\r\n\tif ( output === 'source' ) {\r\n\r\n\t\tif ( this.value ) {\r\n\r\n\t\t\tif ( this.useDefine ) {\r\n\r\n\t\t\t\treturn '#define ' + this.name + ' ' + this.value;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn 'const ' + this.type + ' ' + this.name + ' = ' + this.value + ';';\r\n\r\n\t\t} else if ( this.useDefine ) {\r\n\r\n\t\t\treturn this.src;\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\tbuilder.include( this );\r\n\r\n\t\treturn builder.format( this.name, this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nConstNode.prototype.generate = function ( builder, output ) {\r\n\r\n\treturn builder.format( this.name, this.getType( builder ), output );\r\n\r\n};\r\n\r\nConstNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.parse( source.src, source.useDefine );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nConstNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.src = this.src;\r\n\r\n\t\tif ( data.useDefine === true ) data.useDefine = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ConstNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/ConstNode.js","import { Node } from './Node.js';\r\n\r\nfunction VarNode( type, value ) {\r\n\r\n\tNode.call( this, type );\r\n\r\n\tthis.value = value;\r\n\r\n}\r\n\r\nVarNode.prototype = Object.create( Node.prototype );\r\nVarNode.prototype.constructor = VarNode;\r\nVarNode.prototype.nodeType = \"Var\";\r\n\r\nVarNode.prototype.getType = function ( builder ) {\r\n\r\n\treturn builder.getTypeByFormat( this.type );\r\n\r\n};\r\n\r\nVarNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar varying = builder.getVar( this.uuid, this.type );\r\n\r\n\tif ( this.value && builder.isShader( 'vertex' ) ) {\r\n\r\n\t\tbuilder.addNodeCode( varying.name + ' = ' + this.value.build( builder, this.getType( builder ) ) + ';' );\r\n\r\n\t}\r\n\r\n\treturn builder.format( varying.name, this.getType( builder ), output );\r\n\r\n};\r\n\r\nVarNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\tthis.type = source.type;\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nVarNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.type = this.type;\r\n\r\n\t\tif ( this.value ) data.value = this.value.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { VarNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/VarNode.js","import { TempNode } from './TempNode.js';\r\n\r\nvar declarationRegexp = /^struct\\s*([a-z_0-9]+)\\s*{\\s*((.|\\n)*?)}/img,\r\n\tpropertiesRegexp = /\\s*(\\w*?)\\s*(\\w*?)(\\=|\\;)/img;\r\n\r\nfunction StructNode( src ) {\r\n\r\n\tTempNode.call( this );\r\n\r\n\tthis.parse( src );\r\n\r\n}\r\n\r\nStructNode.prototype = Object.create( TempNode.prototype );\r\nStructNode.prototype.constructor = StructNode;\r\nStructNode.prototype.nodeType = \"Struct\";\r\n\r\nStructNode.prototype.getType = function ( builder ) {\r\n\r\n\treturn builder.getTypeByFormat( this.name );\r\n\r\n};\r\n\r\nStructNode.prototype.getInputByName = function ( name ) {\r\n\r\n\tvar i = this.inputs.length;\r\n\r\n\twhile ( i -- ) {\r\n\r\n\t\tif ( this.inputs[ i ].name === name ) {\r\n\r\n\t\t\treturn this.inputs[ i ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nStructNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( output === 'source' ) {\r\n\r\n\t\treturn this.src + ';';\r\n\r\n\t} else {\r\n\r\n\t\treturn builder.format( '( ' + this.src + ' )', this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nStructNode.prototype.parse = function ( src ) {\r\n\r\n\tthis.src = src || '';\r\n\r\n\tthis.inputs = [];\r\n\r\n\tvar declaration = declarationRegexp.exec( this.src );\r\n\r\n\tif ( declaration ) {\r\n\r\n\t\tvar properties = declaration[ 2 ], match;\r\n\r\n\t\twhile ( match = propertiesRegexp.exec( properties ) ) {\r\n\r\n\t\t\tthis.inputs.push( {\r\n\t\t\t\ttype: match[ 1 ],\r\n\t\t\t\tname: match[ 2 ]\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tthis.name = declaration[ 1 ];\r\n\r\n\t} else {\r\n\r\n\t\tthis.name = '';\r\n\r\n\t}\r\n\r\n\tthis.type = this.name;\r\n\r\n};\r\n\r\nStructNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.src = this.src;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { StructNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/StructNode.js","import { Node } from './Node.js';\r\n\r\nfunction AttributeNode( name, type ) {\r\n\r\n\tNode.call( this, type );\r\n\r\n\tthis.name = name;\r\n\r\n}\r\n\r\nAttributeNode.prototype = Object.create( Node.prototype );\r\nAttributeNode.prototype.constructor = AttributeNode;\r\nAttributeNode.prototype.nodeType = \"Attribute\";\r\n\r\nAttributeNode.prototype.getAttributeType = function ( builder ) {\r\n\r\n\treturn typeof this.type === 'number' ? builder.getConstructorFromLength( this.type ) : this.type;\r\n\r\n};\r\n\r\nAttributeNode.prototype.getType = function ( builder ) {\r\n\r\n\tvar type = this.getAttributeType( builder );\r\n\r\n\treturn builder.getTypeByFormat( type );\r\n\r\n};\r\n\r\nAttributeNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar type = this.getAttributeType( builder );\r\n\r\n\tvar attribute = builder.getAttribute( this.name, type ),\r\n\t\tname = builder.isShader( 'vertex' ) ? this.name : attribute.varying.name;\r\n\r\n\treturn builder.format( name, this.getType( builder ), output );\r\n\r\n};\r\n\r\nAttributeNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\tthis.type = source.type;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nAttributeNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.type = this.type;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { AttributeNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/AttributeNode.js","var NodeLib = {\r\n\r\n\tnodes: {},\r\n\tkeywords: {},\r\n\r\n\tadd: function ( node ) {\r\n\r\n\t\tthis.nodes[ node.name ] = node;\r\n\r\n\t},\r\n\r\n\taddKeyword: function ( name, callback, cache ) {\r\n\r\n\t\tcache = cache !== undefined ? cache : true;\r\n\r\n\t\tthis.keywords[ name ] = { callback: callback, cache: cache };\r\n\r\n\t},\r\n\r\n\tremove: function ( node ) {\r\n\r\n\t\tdelete this.nodes[ node.name ];\r\n\r\n\t},\r\n\r\n\tremoveKeyword: function ( name ) {\r\n\r\n\t\tdelete this.keywords[ name ];\r\n\r\n\t},\r\n\r\n\tget: function ( name ) {\r\n\r\n\t\treturn this.nodes[ name ];\r\n\r\n\t},\r\n\r\n\tgetKeyword: function ( name, builder ) {\r\n\r\n\t\treturn this.keywords[ name ].callback.call( this, builder );\r\n\r\n\t},\r\n\r\n\tgetKeywordData: function ( name ) {\r\n\r\n\t\treturn this.keywords[ name ];\r\n\r\n\t},\r\n\r\n\tcontains: function ( name ) {\r\n\r\n\t\treturn this.nodes[ name ] !== undefined;\r\n\r\n\t},\r\n\r\n\tcontainsKeyword: function ( name ) {\r\n\r\n\t\treturn this.keywords[ name ] !== undefined;\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { NodeLib };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/NodeLib.js","import { TempNode } from './TempNode.js';\r\nimport { NodeLib } from './NodeLib.js';\r\n\r\nvar declarationRegexp = /^\\s*([a-z_0-9]+)\\s([a-z_0-9]+)\\s*\\((.*?)\\)/i,\r\n\tpropertiesRegexp = /[a-z_0-9]+/ig;\r\n\r\nfunction FunctionNode( src, includes, extensions, keywords, type ) {\r\n\r\n\tthis.isMethod = type === undefined;\r\n\tthis.isInterface = false;\r\n\r\n\tTempNode.call( this, type );\r\n\r\n\tthis.parse( src, includes, extensions, keywords );\r\n\r\n}\r\n\r\nFunctionNode.prototype = Object.create( TempNode.prototype );\r\nFunctionNode.prototype.constructor = FunctionNode;\r\nFunctionNode.prototype.nodeType = \"Function\";\r\n\r\nFunctionNode.prototype.useKeywords = true;\r\n\r\nFunctionNode.prototype.getShared = function ( /* builder, output */ ) {\r\n\r\n\treturn ! this.isMethod;\r\n\r\n};\r\n\r\nFunctionNode.prototype.getType = function ( builder ) {\r\n\r\n\treturn builder.getTypeByFormat( this.type );\r\n\r\n};\r\n\r\nFunctionNode.prototype.getInputByName = function ( name ) {\r\n\r\n\tvar i = this.inputs.length;\r\n\r\n\twhile ( i -- ) {\r\n\r\n\t\tif ( this.inputs[ i ].name === name ) {\r\n\r\n\t\t\treturn this.inputs[ i ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nFunctionNode.prototype.getIncludeByName = function ( name ) {\r\n\r\n\tvar i = this.includes.length;\r\n\r\n\twhile ( i -- ) {\r\n\r\n\t\tif ( this.includes[ i ].name === name ) {\r\n\r\n\t\t\treturn this.includes[ i ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nFunctionNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar match, offset = 0, src = this.src;\r\n\r\n\tfor ( var i = 0; i < this.includes.length; i ++ ) {\r\n\r\n\t\tbuilder.include( this.includes[ i ], this );\r\n\r\n\t}\r\n\r\n\tfor ( var ext in this.extensions ) {\r\n\r\n\t\tbuilder.extensions[ ext ] = true;\r\n\r\n\t}\r\n\r\n\tvar matches = [];\r\n\r\n\twhile ( match = propertiesRegexp.exec( this.src ) ) matches.push( match );\r\n\r\n\tfor ( var i = 0; i < matches.length; i ++ ) {\r\n\r\n\t\tvar match = matches[ i ];\r\n\r\n\t\tvar prop = match[ 0 ],\r\n\t\t\tisGlobal = this.isMethod ? ! this.getInputByName( prop ) : true,\r\n\t\t\treference = prop;\r\n\r\n\t\tif ( this.keywords[ prop ] || ( this.useKeywords && isGlobal && NodeLib.containsKeyword( prop ) ) ) {\r\n\r\n\t\t\tvar node = this.keywords[ prop ];\r\n\r\n\t\t\tif ( ! node ) {\r\n\r\n\t\t\t\tvar keyword = NodeLib.getKeywordData( prop );\r\n\r\n\t\t\t\tif ( keyword.cache ) node = builder.keywords[ prop ];\r\n\r\n\t\t\t\tnode = node || NodeLib.getKeyword( prop, builder );\r\n\r\n\t\t\t\tif ( keyword.cache ) builder.keywords[ prop ] = node;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treference = node.build( builder );\r\n\r\n\t\t}\r\n\r\n\t\tif ( prop !== reference ) {\r\n\r\n\t\t\tsrc = src.substring( 0, match.index + offset ) + reference + src.substring( match.index + prop.length + offset );\r\n\r\n\t\t\toffset += reference.length - prop.length;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.getIncludeByName( reference ) === undefined && NodeLib.contains( reference ) ) {\r\n\r\n\t\t\tbuilder.include( NodeLib.get( reference ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tif ( output === 'source' ) {\r\n\r\n\t\treturn src;\r\n\r\n\t} else if ( this.isMethod ) {\r\n\r\n\t\tif ( ! this.isInterface ) {\r\n\r\n\t\t\tbuilder.include( this, false, src );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.name;\r\n\r\n\t} else {\r\n\r\n\t\treturn builder.format( '( ' + src + ' )', this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nFunctionNode.prototype.parse = function ( src, includes, extensions, keywords ) {\r\n\r\n\tthis.src = src || '';\r\n\r\n\tthis.includes = includes || [];\r\n\tthis.extensions = extensions || {};\r\n\tthis.keywords = keywords || {};\r\n\r\n\tif ( this.isMethod ) {\r\n\r\n\t\tvar match = this.src.match( declarationRegexp );\r\n\r\n\t\tthis.inputs = [];\r\n\r\n\t\tif ( match && match.length == 4 ) {\r\n\r\n\t\t\tthis.type = match[ 1 ];\r\n\t\t\tthis.name = match[ 2 ];\r\n\r\n\t\t\tvar inputs = match[ 3 ].match( propertiesRegexp );\r\n\r\n\t\t\tif ( inputs ) {\r\n\r\n\t\t\t\tvar i = 0;\r\n\r\n\t\t\t\twhile ( i < inputs.length ) {\r\n\r\n\t\t\t\t\tvar qualifier = inputs[ i ++ ];\r\n\t\t\t\t\tvar type, name;\r\n\r\n\t\t\t\t\tif ( qualifier === 'in' || qualifier === 'out' || qualifier === 'inout' ) {\r\n\r\n\t\t\t\t\t\ttype = inputs[ i ++ ];\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttype = qualifier;\r\n\t\t\t\t\t\tqualifier = '';\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tname = inputs[ i ++ ];\r\n\r\n\t\t\t\t\tthis.inputs.push( {\r\n\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\ttype: type,\r\n\t\t\t\t\t\tqualifier: qualifier\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.isInterface = this.src.indexOf( '{' ) === - 1;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.type = '';\r\n\t\t\tthis.name = '';\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nFunctionNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.isMethod = source.isMethod;\r\n\tthis.useKeywords = source.useKeywords;\r\n\r\n\tthis.parse( source.src, source.includes, source.extensions, source.keywords );\r\n\r\n\tif ( source.type !== undefined ) this.type = source.type;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nFunctionNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.src = this.src;\r\n\t\tdata.isMethod = this.isMethod;\r\n\t\tdata.useKeywords = this.useKeywords;\r\n\r\n\t\tif ( ! this.isMethod ) data.type = this.type;\r\n\r\n\t\tdata.extensions = JSON.parse( JSON.stringify( this.extensions ) );\r\n\t\tdata.keywords = {};\r\n\r\n\t\tfor ( var keyword in this.keywords ) {\r\n\r\n\t\t\tdata.keywords[ keyword ] = this.keywords[ keyword ].toJSON( meta ).uuid;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.includes.length ) {\r\n\r\n\t\t\tdata.includes = [];\r\n\r\n\t\t\tfor ( var i = 0; i < this.includes.length; i ++ ) {\r\n\r\n\t\t\t\tdata.includes.push( this.includes[ i ].toJSON( meta ).uuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { FunctionNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/FunctionNode.js","import { FunctionNode } from './FunctionNode.js';\r\n\r\nfunction ExpressionNode( src, type, keywords, extensions, includes ) {\r\n\r\n\tFunctionNode.call( this, src, includes, extensions, keywords, type );\r\n\r\n}\r\n\r\nExpressionNode.prototype = Object.create( FunctionNode.prototype );\r\nExpressionNode.prototype.constructor = ExpressionNode;\r\nExpressionNode.prototype.nodeType = \"Expression\";\r\n\r\nexport { ExpressionNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/ExpressionNode.js","import { TempNode } from './TempNode.js';\r\n\r\nfunction FunctionCallNode( func, inputs ) {\r\n\r\n\tTempNode.call( this );\r\n\r\n\tthis.setFunction( func, inputs );\r\n\r\n}\r\n\r\nFunctionCallNode.prototype = Object.create( TempNode.prototype );\r\nFunctionCallNode.prototype.constructor = FunctionCallNode;\r\nFunctionCallNode.prototype.nodeType = \"FunctionCall\";\r\n\r\nFunctionCallNode.prototype.setFunction = function ( func, inputs ) {\r\n\r\n\tthis.value = func;\r\n\tthis.inputs = inputs || [];\r\n\r\n};\r\n\r\nFunctionCallNode.prototype.getFunction = function () {\r\n\r\n\treturn this.value;\r\n\r\n};\r\n\r\nFunctionCallNode.prototype.getType = function ( builder ) {\r\n\r\n\treturn this.value.getType( builder );\r\n\r\n};\r\n\r\nFunctionCallNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar type = this.getType( builder ),\r\n\t\tfunc = this.value;\r\n\r\n\tvar code = func.build( builder, output ) + '( ',\r\n\t\tparams = [];\r\n\r\n\tfor ( var i = 0; i < func.inputs.length; i ++ ) {\r\n\r\n\t\tvar inpt = func.inputs[ i ],\r\n\t\t\tparam = this.inputs[ i ] || this.inputs[ inpt.name ];\r\n\r\n\t\tparams.push( param.build( builder, builder.getTypeByFormat( inpt.type ) ) );\r\n\r\n\t}\r\n\r\n\tcode += params.join( ', ' ) + ' )';\r\n\r\n\treturn builder.format( code, type, output );\r\n\r\n};\r\n\r\nFunctionCallNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tfor ( var prop in source.inputs ) {\r\n\r\n\t\tthis.inputs[ prop ] = source.inputs[ prop ];\r\n\r\n\t}\r\n\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nFunctionCallNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tvar func = this.value;\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.toJSON( meta ).uuid;\r\n\r\n\t\tif ( func.inputs.length ) {\r\n\r\n\t\t\tdata.inputs = {};\r\n\r\n\t\t\tfor ( var i = 0; i < func.inputs.length; i ++ ) {\r\n\r\n\t\t\t\tvar inpt = func.inputs[ i ],\r\n\t\t\t\t\tnode = this.inputs[ i ] || this.inputs[ inpt.name ];\r\n\r\n\t\t\t\tdata.inputs[ inpt.name ] = node.toJSON( meta ).uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { FunctionCallNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/FunctionCallNode.js","var NodeUtils = {\r\n\r\n\telements: [ 'x', 'y', 'z', 'w' ],\r\n\r\n\taddShortcuts: function () {\r\n\r\n\t\tfunction applyShortcut( proxy, property, subProperty ) {\r\n\r\n\t\t\tif ( subProperty ) {\r\n\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\treturn this[ proxy ][ property ][ subProperty ];\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tset: function ( val ) {\r\n\r\n\t\t\t\t\t\tthis[ proxy ][ property ][ subProperty ] = val;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\treturn this[ proxy ][ property ];\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tset: function ( val ) {\r\n\r\n\t\t\t\t\t\tthis[ proxy ][ property ] = val;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn function addShortcuts( proto, proxy, list ) {\r\n\r\n\t\t\tvar shortcuts = {};\r\n\r\n\t\t\tfor ( var i = 0; i < list.length; ++ i ) {\r\n\r\n\t\t\t\tvar data = list[ i ].split( \".\" ),\r\n\t\t\t\t\tproperty = data[ 0 ],\r\n\t\t\t\t\tsubProperty = data[ 1 ];\r\n\r\n\t\t\t\tshortcuts[ property ] = applyShortcut( proxy, property, subProperty );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tObject.defineProperties( proto, shortcuts );\r\n\r\n\t\t};\r\n\r\n\t}()\r\n\r\n};\r\n\r\nexport { NodeUtils };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/NodeUtils.js","import {\r\n\tGammaEncoding,\r\n\tLinearEncoding,\r\n\tRGBEEncoding,\r\n\tRGBM7Encoding,\r\n\tRGBM16Encoding,\r\n\tRGBDEncoding,\r\n\tsRGBEncoding\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { TempNode } from '../core/TempNode.js';\r\nimport { ConstNode } from '../core/ConstNode.js';\r\nimport { FloatNode } from '../inputs/FloatNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { ExpressionNode } from '../core/ExpressionNode.js';\r\n\r\nfunction ColorSpaceNode( input, method ) {\r\n\r\n\tTempNode.call( this, 'v4' );\r\n\r\n\tthis.input = input;\r\n\r\n\tthis.method = method || ColorSpaceNode.LINEAR_TO_LINEAR;\r\n\r\n}\r\n\r\nColorSpaceNode.Nodes = ( function () {\r\n\r\n\t// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\r\n\r\n\tvar LinearToLinear = new FunctionNode( [\r\n\t\t\"vec4 LinearToLinear( in vec4 value ) {\",\r\n\r\n\t\t\"\treturn value;\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar GammaToLinear = new FunctionNode( [\r\n\t\t\"vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\",\r\n\r\n\t\t\"\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar LinearToGamma = new FunctionNode( [\r\n\t\t\"vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\",\r\n\r\n\t\t\"\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar sRGBToLinear = new FunctionNode( [\r\n\t\t\"vec4 sRGBToLinear( in vec4 value ) {\",\r\n\r\n\t\t\"\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar LinearTosRGB = new FunctionNode( [\r\n\t\t\"vec4 LinearTosRGB( in vec4 value ) {\",\r\n\r\n\t\t\"\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar RGBEToLinear = new FunctionNode( [\r\n\t\t\"vec4 RGBEToLinear( in vec4 value ) {\",\r\n\r\n\t\t\"\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar LinearToRGBE = new FunctionNode( [\r\n\t\t\"vec4 LinearToRGBE( in vec4 value ) {\",\r\n\r\n\t\t\"\tfloat maxComponent = max( max( value.r, value.g ), value.b );\",\r\n\t\t\"\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\",\r\n\t\t\"\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\",\r\n\t\t//  return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\t// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\r\n\r\n\tvar RGBMToLinear = new FunctionNode( [\r\n\t\t\"vec3 RGBMToLinear( in vec4 value, in float maxRange ) {\",\r\n\r\n\t\t\"\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar LinearToRGBM = new FunctionNode( [\r\n\t\t\"vec3 LinearToRGBM( in vec4 value, in float maxRange ) {\",\r\n\r\n\t\t\"\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\",\r\n\t\t\"\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\",\r\n\t\t\"\tM            = ceil( M * 255.0 ) / 255.0;\",\r\n\t\t\"\treturn vec4( value.rgb / ( M * maxRange ), M );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\t// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\r\n\r\n\tvar RGBDToLinear = new FunctionNode( [\r\n\t\t\"vec3 RGBDToLinear( in vec4 value, in float maxRange ) {\",\r\n\r\n\t\t\"\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\r\n\tvar LinearToRGBD = new FunctionNode( [\r\n\t\t\"vec3 LinearToRGBD( in vec4 value, in float maxRange ) {\",\r\n\r\n\t\t\"\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\",\r\n\t\t\"\tfloat D      = max( maxRange / maxRGB, 1.0 );\",\r\n\t\t\"\tD            = clamp( floor( D ) / 255.0, 0.0, 1.0 );\",\r\n\t\t\"\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\t// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\r\n\r\n\t// M matrix, for encoding\r\n\r\n\tvar cLogLuvM = new ConstNode( \"const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\" );\r\n\r\n\tvar LinearToLogLuv = new FunctionNode( [\r\n\t\t\"vec4 LinearToLogLuv( in vec4 value ) {\",\r\n\r\n\t\t\"\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\",\r\n\t\t\"\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\",\r\n\t\t\"\tvec4 vResult;\",\r\n\t\t\"\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\",\r\n\t\t\"\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\",\r\n\t\t\"\tvResult.w = fract(Le);\",\r\n\t\t\"\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\",\r\n\t\t\"\treturn vResult;\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ), [ cLogLuvM ] );\r\n\r\n\t// Inverse M matrix, for decoding\r\n\r\n\tvar cLogLuvInverseM = new ConstNode( \"const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\" );\r\n\r\n\tvar LogLuvToLinear = new FunctionNode( [\r\n\t\t\"vec4 LogLuvToLinear( in vec4 value ) {\",\r\n\r\n\t\t\"\tfloat Le = value.z * 255.0 + value.w;\",\r\n\t\t\"\tvec3 Xp_Y_XYZp;\",\r\n\t\t\"\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\",\r\n\t\t\"\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\",\r\n\t\t\"\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\",\r\n\t\t\"\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\",\r\n\t\t\"\treturn vec4( max(vRGB, 0.0), 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ), [ cLogLuvInverseM ] );\r\n\r\n\treturn {\r\n\t\tLinearToLinear: LinearToLinear,\r\n\t\tGammaToLinear: GammaToLinear,\r\n\t\tLinearToGamma: LinearToGamma,\r\n\t\tsRGBToLinear: sRGBToLinear,\r\n\t\tLinearTosRGB: LinearTosRGB,\r\n\t\tRGBEToLinear: RGBEToLinear,\r\n\t\tLinearToRGBE: LinearToRGBE,\r\n\t\tRGBMToLinear: RGBMToLinear,\r\n\t\tLinearToRGBM: LinearToRGBM,\r\n\t\tRGBDToLinear: RGBDToLinear,\r\n\t\tLinearToRGBD: LinearToRGBD,\r\n\t\tcLogLuvM: cLogLuvM,\r\n\t\tLinearToLogLuv: LinearToLogLuv,\r\n\t\tcLogLuvInverseM: cLogLuvInverseM,\r\n\t\tLogLuvToLinear: LogLuvToLinear\r\n\t};\r\n\r\n} )();\r\n\r\nColorSpaceNode.LINEAR_TO_LINEAR = 'LinearToLinear';\r\n\r\nColorSpaceNode.GAMMA_TO_LINEAR = 'GammaToLinear';\r\nColorSpaceNode.LINEAR_TO_GAMMA = 'LinearToGamma';\r\n\r\nColorSpaceNode.SRGB_TO_LINEAR = 'sRGBToLinear';\r\nColorSpaceNode.LINEAR_TO_SRGB = 'LinearTosRGB';\r\n\r\nColorSpaceNode.RGBE_TO_LINEAR = 'RGBEToLinear';\r\nColorSpaceNode.LINEAR_TO_RGBE = 'LinearToRGBE';\r\n\r\nColorSpaceNode.RGBM_TO_LINEAR = 'RGBMToLinear';\r\nColorSpaceNode.LINEAR_TO_RGBM = 'LinearToRGBM';\r\n\r\nColorSpaceNode.RGBD_TO_LINEAR = 'RGBDToLinear';\r\nColorSpaceNode.LINEAR_TO_RGBD = 'LinearToRGBD';\r\n\r\nColorSpaceNode.LINEAR_TO_LOG_LUV = 'LinearToLogLuv';\r\nColorSpaceNode.LOG_LUV_TO_LINEAR = 'LogLuvToLinear';\r\n\r\nColorSpaceNode.getEncodingComponents = function ( encoding ) {\r\n\r\n\tswitch ( encoding ) {\r\n\r\n\t\tcase LinearEncoding:\r\n\t\t\treturn [ 'Linear' ];\r\n\t\tcase sRGBEncoding:\r\n\t\t\treturn [ 'sRGB' ];\r\n\t\tcase RGBEEncoding:\r\n\t\t\treturn [ 'RGBE' ];\r\n\t\tcase RGBM7Encoding:\r\n\t\t\treturn [ 'RGBM', new FloatNode( 7.0 ).setReadonly( true ) ];\r\n\t\tcase RGBM16Encoding:\r\n\t\t\treturn [ 'RGBM', new FloatNode( 16.0 ).setReadonly( true ) ];\r\n\t\tcase RGBDEncoding:\r\n\t\t\treturn [ 'RGBD', new FloatNode( 256.0 ).setReadonly( true ) ];\r\n\t\tcase GammaEncoding:\r\n\t\t\treturn [ 'Gamma', new ExpressionNode( 'float( GAMMA_FACTOR )', 'f' ) ];\r\n\r\n\t}\r\n\r\n};\r\n\r\nColorSpaceNode.prototype = Object.create( TempNode.prototype );\r\nColorSpaceNode.prototype.constructor = ColorSpaceNode;\r\nColorSpaceNode.prototype.nodeType = \"ColorSpace\";\r\nColorSpaceNode.prototype.hashProperties = [ \"method\" ];\r\n\r\nColorSpaceNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar input = this.input.build( builder, 'v4' );\r\n\tvar outputType = this.getType( builder );\r\n\r\n\tvar methodNode = ColorSpaceNode.Nodes[ this.method ];\r\n\tvar method = builder.include( methodNode );\r\n\r\n\tif ( method === ColorSpaceNode.LINEAR_TO_LINEAR ) {\r\n\r\n\t\treturn builder.format( input, outputType, output );\r\n\r\n\t} else {\r\n\r\n\t\tif ( methodNode.inputs.length === 2 ) {\r\n\r\n\t\t\tvar factor = this.factor.build( builder, 'f' );\r\n\r\n\t\t\treturn builder.format( method + '( ' + input + ', ' + factor + ' )', outputType, output );\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn builder.format( method + '( ' + input + ' )', outputType, output );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nColorSpaceNode.prototype.fromEncoding = function ( encoding ) {\r\n\r\n\tvar components = ColorSpaceNode.getEncodingComponents( encoding );\r\n\r\n\tthis.method = 'LinearTo' + components[ 0 ];\r\n\tthis.factor = components[ 1 ];\r\n\r\n};\r\n\r\nColorSpaceNode.prototype.fromDecoding = function ( encoding ) {\r\n\r\n\tvar components = ColorSpaceNode.getEncodingComponents( encoding );\r\n\r\n\tthis.method = components[ 0 ] + 'ToLinear';\r\n\tthis.factor = components[ 1 ];\r\n\r\n};\r\n\r\nColorSpaceNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.input = source.input;\r\n\tthis.method = source.method;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nColorSpaceNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.input = this.input.toJSON( meta ).uuid;\r\n\t\tdata.method = this.method;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ColorSpaceNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/ColorSpaceNode.js","function NodeFrame( time ) {\r\n\r\n\tthis.time = time !== undefined ? time : 0;\r\n\r\n\tthis.id = 0;\r\n\r\n}\r\n\r\nNodeFrame.prototype = {\r\n\r\n\tconstructor: NodeFrame,\r\n\r\n\tupdate: function ( delta ) {\r\n\r\n\t\t++ this.id;\r\n\r\n\t\tthis.time += delta;\r\n\t\tthis.delta = delta;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRenderer: function ( renderer ) {\r\n\r\n\t\tthis.renderer = renderer;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetRenderTexture: function ( renderTexture ) {\r\n\r\n\t\tthis.renderTexture = renderTexture;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tupdateNode: function ( node ) {\r\n\r\n\t\tif ( node.frameId === this.id ) return this;\r\n\r\n\t\tnode.updateFrame( this );\r\n\r\n\t\tnode.frameId = this.id;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { NodeFrame };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/NodeFrame.js","function NodeUniform( params ) {\r\n\r\n\tparams = params || {};\r\n\r\n\tthis.name = params.name;\r\n\tthis.type = params.type;\r\n\tthis.node = params.node;\r\n\tthis.needsUpdate = params.needsUpdate;\r\n\r\n}\r\n\r\nObject.defineProperties( NodeUniform.prototype, {\r\n\r\n\tvalue: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.node.value;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( val ) {\r\n\r\n\t\t\tthis.node.value = val;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { NodeUniform };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/NodeUniform.js","import { Vector2 } from '@/components/build/three.module.js';\r\n\r\nimport { InputNode } from '../core/InputNode.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction Vector2Node( x, y ) {\r\n\r\n\tInputNode.call( this, 'v2' );\r\n\r\n\tthis.value = x instanceof Vector2 ? x : new Vector2( x, y );\r\n\r\n}\r\n\r\nVector2Node.prototype = Object.create( InputNode.prototype );\r\nVector2Node.prototype.constructor = Vector2Node;\r\nVector2Node.prototype.nodeType = \"Vector2\";\r\n\r\nNodeUtils.addShortcuts( Vector2Node.prototype, 'value', [ 'x', 'y' ] );\r\n\r\nVector2Node.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate*/ ) {\r\n\r\n\treturn builder.format( \"vec2( \" + this.x + \", \" + this.y + \" )\", type, output );\r\n\r\n};\r\n\r\nVector2Node.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value.copy( source );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nVector2Node.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.x = this.x;\r\n\t\tdata.y = this.y;\r\n\r\n\t\tif ( this.readonly === true ) data.readonly = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { Vector2Node };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/Vector2Node.js","import { Vector3 } from '@/components/build/three.module.js';\r\n\r\nimport { InputNode } from '../core/InputNode.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction Vector3Node( x, y, z ) {\r\n\r\n\tInputNode.call( this, 'v3' );\r\n\r\n\tthis.value = x instanceof Vector3 ? x : new Vector3( x, y, z );\r\n\r\n}\r\n\r\nVector3Node.prototype = Object.create( InputNode.prototype );\r\nVector3Node.prototype.constructor = Vector3Node;\r\nVector3Node.prototype.nodeType = \"Vector3\";\r\n\r\nNodeUtils.addShortcuts( Vector3Node.prototype, 'value', [ 'x', 'y', 'z' ] );\r\n\r\nVector3Node.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate*/ ) {\r\n\r\n\treturn builder.format( \"vec3( \" + this.x + \", \" + this.y + \", \" + this.z + \" )\", type, output );\r\n\r\n};\r\n\r\nVector3Node.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value.copy( source );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nVector3Node.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.x = this.x;\r\n\t\tdata.y = this.y;\r\n\t\tdata.z = this.z;\r\n\r\n\t\tif ( this.readonly === true ) data.readonly = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { Vector3Node };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/Vector3Node.js","import { Vector4 } from '@/components/build/three.module.js';\r\n\r\nimport { InputNode } from '../core/InputNode.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction Vector4Node( x, y, z, w ) {\r\n\r\n\tInputNode.call( this, 'v4' );\r\n\r\n\tthis.value = x instanceof Vector4 ? x : new Vector4( x, y, z, w );\r\n\r\n}\r\n\r\nVector4Node.prototype = Object.create( InputNode.prototype );\r\nVector4Node.prototype.constructor = Vector4Node;\r\nVector4Node.prototype.nodeType = \"Vector4\";\r\n\r\nNodeUtils.addShortcuts( Vector4Node.prototype, 'value', [ 'x', 'y', 'z', 'w' ] );\r\n\r\nVector4Node.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate*/ ) {\r\n\r\n\treturn builder.format( \"vec4( \" + this.x + \", \" + this.y + \", \" + this.z + \", \" + this.w + \" )\", type, output );\r\n\r\n};\r\n\r\nVector4Node.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value.copy( source );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nVector4Node.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.x = this.x;\r\n\t\tdata.y = this.y;\r\n\t\tdata.z = this.z;\r\n\t\tdata.w = this.w;\r\n\r\n\t\tif ( this.readonly === true ) data.readonly = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { Vector4Node };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/Vector4Node.js","import { TempNode } from '../core/TempNode.js';\r\nimport { NodeLib } from '../core/NodeLib.js';\r\n\r\nfunction UVNode( index ) {\r\n\r\n\tTempNode.call( this, 'v2', { shared: false } );\r\n\r\n\tthis.index = index || 0;\r\n\r\n}\r\n\r\nUVNode.prototype = Object.create( TempNode.prototype );\r\nUVNode.prototype.constructor = UVNode;\r\nUVNode.prototype.nodeType = \"UV\";\r\n\r\nUVNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tbuilder.requires.uv[ this.index ] = true;\r\n\r\n\tvar uvIndex = this.index > 0 ? this.index + 1 : '';\r\n\tvar result = builder.isShader( 'vertex' ) ? 'uv' + uvIndex : 'vUv' + uvIndex;\r\n\r\n\treturn builder.format( result, this.getType( builder ), output );\r\n\r\n};\r\n\r\nUVNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.index = source.index;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nUVNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.index = this.index;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nNodeLib.addKeyword( 'uv', function () {\r\n\r\n\treturn new UVNode();\r\n\r\n} );\r\n\r\nNodeLib.addKeyword( 'uv2', function () {\r\n\r\n\treturn new UVNode( 1 );\r\n\r\n} );\r\n\r\nexport { UVNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/UVNode.js","import { InputNode } from '../core/InputNode.js';\r\n\r\nfunction FloatNode( value ) {\r\n\r\n\tInputNode.call( this, 'f' );\r\n\r\n\tthis.value = value || 0;\r\n\r\n}\r\n\r\nFloatNode.prototype = Object.create( InputNode.prototype );\r\nFloatNode.prototype.constructor = FloatNode;\r\nFloatNode.prototype.nodeType = \"Float\";\r\n\r\nFloatNode.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate */ ) {\r\n\r\n\treturn builder.format( this.value + ( this.value % 1 ? '' : '.0' ), type, output );\r\n\r\n};\r\n\r\nFloatNode.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nFloatNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value;\r\n\r\n\t\tif ( this.readonly === true ) data.readonly = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { FloatNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/FloatNode.js","import { InputNode } from '../core/InputNode.js';\r\nimport { UVNode } from '../accessors/UVNode.js';\r\nimport { ColorSpaceNode } from '../utils/ColorSpaceNode.js';\r\nimport { ExpressionNode } from '../core/ExpressionNode.js';\r\n\r\nfunction TextureNode( value, uv, bias, project ) {\r\n\r\n\tInputNode.call( this, 'v4', { shared: true } );\r\n\r\n\tthis.value = value;\r\n\tthis.uv = uv || new UVNode();\r\n\tthis.bias = bias;\r\n\tthis.project = project !== undefined ? project : false;\r\n\r\n}\r\n\r\nTextureNode.prototype = Object.create( InputNode.prototype );\r\nTextureNode.prototype.constructor = TextureNode;\r\nTextureNode.prototype.nodeType = \"Texture\";\r\n\r\nTextureNode.prototype.getTexture = function ( builder, output ) {\r\n\r\n\treturn InputNode.prototype.generate.call( this, builder, output, this.value.uuid, 't' );\r\n\r\n};\r\n\r\nTextureNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( output === 'sampler2D' ) {\r\n\r\n\t\treturn this.getTexture( builder, output );\r\n\r\n\t}\r\n\r\n\tvar tex = this.getTexture( builder, output ),\r\n\t\tuv = this.uv.build( builder, this.project ? 'v4' : 'v2' ),\r\n\t\tbias = this.bias ? this.bias.build( builder, 'f' ) : undefined;\r\n\r\n\tif ( bias === undefined && builder.context.bias ) {\r\n\r\n\t\tbias = builder.context.bias.setTexture( this ).build( builder, 'f' );\r\n\r\n\t}\r\n\r\n\tvar method, code;\r\n\r\n\tif ( this.project ) method = 'texture2DProj';\r\n\telse method = bias ? 'tex2DBias' : 'tex2D';\r\n\r\n\tif ( bias ) code = method + '( ' + tex + ', ' + uv + ', ' + bias + ' )';\r\n\telse code = method + '( ' + tex + ', ' + uv + ' )';\r\n\r\n\t// add a custom context for fix incompatibility with the core\r\n\t// include ColorSpace function only for vertex shader (in fragment shader color space functions is added automatically by core)\r\n\t// this should be removed in the future\r\n\t// context.include is used to include or not functions if used FunctionNode\r\n\t// context.ignoreCache =: not create temp variables nodeT0..9 to optimize the code\r\n\tvar context = { include: builder.isShader( 'vertex' ), ignoreCache: true };\r\n\tvar outputType = this.getType( builder );\r\n\r\n\tbuilder.addContext( context );\r\n\r\n\tthis.colorSpace = this.colorSpace || new ColorSpaceNode( new ExpressionNode( '', outputType ) );\r\n\tthis.colorSpace.fromDecoding( builder.getTextureEncodingFromMap( this.value ) );\r\n\tthis.colorSpace.input.parse( code );\r\n\r\n\tcode = this.colorSpace.build( builder, outputType );\r\n\r\n\t// end custom context\r\n\r\n\tbuilder.removeContext();\r\n\r\n\treturn builder.format( code, outputType, output );\r\n\r\n};\r\n\r\nTextureNode.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tif ( source.value ) this.value = source.value;\r\n\r\n\tthis.uv = source.uv;\r\n\r\n\tif ( source.bias ) this.bias = source.bias;\r\n\tif ( source.project !== undefined ) this.project = source.project;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTextureNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tif ( this.value ) data.value = this.value.uuid;\r\n\r\n\t\tdata.uv = this.uv.toJSON( meta ).uuid;\r\n\t\tdata.project = this.project;\r\n\r\n\t\tif ( this.bias ) data.bias = this.bias.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { TextureNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/TextureNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { NodeLib } from '../core/NodeLib.js';\r\n\r\nfunction PositionNode( scope ) {\r\n\r\n\tTempNode.call( this, 'v3' );\r\n\r\n\tthis.scope = scope || PositionNode.LOCAL;\r\n\r\n}\r\n\r\nPositionNode.LOCAL = 'local';\r\nPositionNode.WORLD = 'world';\r\nPositionNode.VIEW = 'view';\r\nPositionNode.PROJECTION = 'projection';\r\n\r\nPositionNode.prototype = Object.create( TempNode.prototype );\r\nPositionNode.prototype.constructor = PositionNode;\r\nPositionNode.prototype.nodeType = \"Position\";\r\n\r\nPositionNode.prototype.getType = function ( ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase PositionNode.PROJECTION:\r\n\r\n\t\t\treturn 'v4';\r\n\r\n\t}\r\n\r\n\treturn this.type;\r\n\r\n};\r\n\r\nPositionNode.prototype.getShared = function ( /* builder */ ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase PositionNode.LOCAL:\r\n\t\tcase PositionNode.WORLD:\r\n\r\n\t\t\treturn false;\r\n\r\n\t}\r\n\r\n\treturn true;\r\n\r\n};\r\n\r\nPositionNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar result;\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase PositionNode.LOCAL:\r\n\r\n\t\t\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\t\t\tresult = 'transformed';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbuilder.requires.position = true;\r\n\r\n\t\t\t\tresult = 'vPosition';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase PositionNode.WORLD:\r\n\r\n\t\t\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\t\t\treturn '( modelMatrix * vec4( transformed, 1.0 ) ).xyz';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbuilder.requires.worldPosition = true;\r\n\r\n\t\t\t\tresult = 'vWPosition';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase PositionNode.VIEW:\r\n\r\n\t\t\tresult = builder.isShader( 'vertex' ) ? '-mvPosition.xyz' : 'vViewPosition';\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase PositionNode.PROJECTION:\r\n\r\n\t\t\tresult = builder.isShader( 'vertex' ) ? '( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )' : 'vec4( 0.0 )';\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\treturn builder.format( result, this.getType( builder ), output );\r\n\r\n};\r\n\r\nPositionNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.scope = source.scope;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nPositionNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.scope = this.scope;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nNodeLib.addKeyword( 'position', function () {\r\n\r\n\treturn new PositionNode();\r\n\r\n} );\r\n\r\nNodeLib.addKeyword( 'worldPosition', function () {\r\n\r\n\treturn new PositionNode( PositionNode.WORLD );\r\n\r\n} );\r\n\r\nNodeLib.addKeyword( 'viewPosition', function () {\r\n\r\n\treturn new PositionNode( PositionNode.VIEW );\r\n\r\n} );\r\n\r\nexport { PositionNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/PositionNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { NodeLib } from '../core/NodeLib.js';\r\n\r\nfunction NormalNode( scope ) {\r\n\r\n\tTempNode.call( this, 'v3' );\r\n\r\n\tthis.scope = scope || NormalNode.VIEW;\r\n\r\n}\r\n\r\nNormalNode.LOCAL = 'local';\r\nNormalNode.WORLD = 'world';\r\nNormalNode.VIEW = 'view';\r\n\r\nNormalNode.prototype = Object.create( TempNode.prototype );\r\nNormalNode.prototype.constructor = NormalNode;\r\nNormalNode.prototype.nodeType = \"Normal\";\r\n\r\nNormalNode.prototype.getShared = function () {\r\n\r\n\t// if shared is false, TempNode will not create temp variable (for optimization)\r\n\r\n\treturn this.scope === NormalNode.WORLD;\r\n\r\n};\r\n\r\nNormalNode.prototype.build = function ( builder, output, uuid, ns ) {\r\n\r\n\tvar contextNormal = builder.context[ this.scope + 'Normal' ];\r\n\r\n\tif ( contextNormal ) {\r\n\r\n\t\treturn contextNormal.build( builder, output, uuid, ns );\r\n\r\n\t}\r\n\r\n\treturn TempNode.prototype.build.call( this, builder, output, uuid );\r\n\r\n};\r\n\r\nNormalNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar result;\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase NormalNode.VIEW:\r\n\r\n\t\t\tif ( builder.isShader( 'vertex' ) ) result = 'transformedNormal';\r\n\t\t\telse result = 'geometryNormal';\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase NormalNode.LOCAL:\r\n\r\n\t\t\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\t\t\tresult = 'objectNormal';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbuilder.requires.normal = true;\r\n\r\n\t\t\t\tresult = 'vObjectNormal';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase NormalNode.WORLD:\r\n\r\n\t\t\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\t\t\tresult = 'inverseTransformDirection( transformedNormal, viewMatrix ).xyz';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tbuilder.requires.worldNormal = true;\r\n\r\n\t\t\t\tresult = 'vWNormal';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\treturn builder.format( result, this.getType( builder ), output );\r\n\r\n};\r\n\r\nNormalNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.scope = source.scope;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nNormalNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.scope = this.scope;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nNodeLib.addKeyword( 'viewNormal', function () {\r\n\r\n\treturn new NormalNode( NormalNode.VIEW );\r\n\r\n} );\r\n\r\nNodeLib.addKeyword( 'localNormal', function () {\r\n\r\n\treturn new NormalNode( NormalNode.NORMAL );\r\n\r\n} );\r\n\r\nNodeLib.addKeyword( 'worldNormal', function () {\r\n\r\n\treturn new NormalNode( NormalNode.WORLD );\r\n\r\n} );\r\n\r\nexport { NormalNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/NormalNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { PositionNode } from './PositionNode.js';\r\nimport { NormalNode } from './NormalNode.js';\r\n\r\nfunction ReflectNode( scope ) {\r\n\r\n\tTempNode.call( this, 'v3' );\r\n\r\n\tthis.scope = scope || ReflectNode.CUBE;\r\n\r\n}\r\n\r\nReflectNode.CUBE = 'cube';\r\nReflectNode.SPHERE = 'sphere';\r\nReflectNode.VECTOR = 'vector';\r\n\r\nReflectNode.prototype = Object.create( TempNode.prototype );\r\nReflectNode.prototype.constructor = ReflectNode;\r\nReflectNode.prototype.nodeType = \"Reflect\";\r\n\r\nReflectNode.prototype.getUnique = function ( builder ) {\r\n\r\n\treturn ! builder.context.viewNormal;\r\n\r\n};\r\n\r\nReflectNode.prototype.getType = function ( /* builder */ ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase ReflectNode.SPHERE:\r\n\r\n\t\t\treturn 'v2';\r\n\r\n\t}\r\n\r\n\treturn this.type;\r\n\r\n};\r\n\r\nReflectNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar isUnique = this.getUnique( builder );\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tvar result;\r\n\r\n\t\tswitch ( this.scope ) {\r\n\r\n\t\t\tcase ReflectNode.VECTOR:\r\n\r\n\t\t\t\tvar viewNormalNode = new NormalNode( NormalNode.VIEW );\r\n\t\t\t\tvar roughnessNode = builder.context.roughness;\r\n\r\n\t\t\t\tvar viewNormal = viewNormalNode.build( builder, 'v3' );\r\n\t\t\t\tvar viewPosition = new PositionNode( PositionNode.VIEW ).build( builder, 'v3' );\r\n\t\t\t\tvar roughness = roughnessNode ? roughnessNode.build( builder, 'f' ) : undefined;\r\n\r\n\t\t\t\tvar method = `reflect( -normalize( ${viewPosition} ), ${viewNormal} )`;\r\n\r\n\t\t\t\tif ( roughness ) {\r\n\r\n\t\t\t\t\t// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\r\n\t\t\t\t\tmethod = `normalize( mix( ${method}, ${viewNormal}, ${roughness} * ${roughness} ) )`;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar code = `inverseTransformDirection( ${method}, viewMatrix )`;\r\n\r\n\t\t\t\tif ( isUnique ) {\r\n\r\n\t\t\t\t\tbuilder.addNodeCode( `vec3 reflectVec = ${code};` );\r\n\r\n\t\t\t\t\tresult = 'reflectVec';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tresult = code;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ReflectNode.CUBE:\r\n\r\n\t\t\t\tvar reflectVec = new ReflectNode( ReflectNode.VECTOR ).build( builder, 'v3' );\r\n\r\n\t\t\t\tvar code = 'vec3( -' + reflectVec + '.x, ' + reflectVec + '.yz )';\r\n\r\n\t\t\t\tif ( isUnique ) {\r\n\r\n\t\t\t\t\tbuilder.addNodeCode( `vec3 reflectCubeVec = ${code};` );\r\n\r\n\t\t\t\t\tresult = 'reflectCubeVec';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tresult = code;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ReflectNode.SPHERE:\r\n\r\n\t\t\t\tvar reflectVec = new ReflectNode( ReflectNode.VECTOR ).build( builder, 'v3' );\r\n\r\n\t\t\t\tvar code = 'normalize( ( viewMatrix * vec4( ' + reflectVec + ', 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5';\r\n\r\n\t\t\t\tif ( isUnique ) {\r\n\r\n\t\t\t\t\tbuilder.addNodeCode( `vec2 reflectSphereVec = ${code};` );\r\n\r\n\t\t\t\t\tresult = 'reflectSphereVec';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tresult = code;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\treturn builder.format( result, this.getType( builder ), output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.ReflectNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( 'vec3( 0.0 )', this.type, output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nReflectNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.scope = this.scope;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ReflectNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/ReflectNode.js","import { InputNode } from '../core/InputNode.js';\r\nimport { ReflectNode } from '../accessors/ReflectNode.js';\r\nimport { ColorSpaceNode } from '../utils/ColorSpaceNode.js';\r\nimport { ExpressionNode } from '../core/ExpressionNode.js';\r\n\r\nfunction CubeTextureNode( value, uv, bias ) {\r\n\r\n\tInputNode.call( this, 'v4', { shared: true } );\r\n\r\n\tthis.value = value;\r\n\tthis.uv = uv || new ReflectNode();\r\n\tthis.bias = bias;\r\n\r\n}\r\n\r\nCubeTextureNode.prototype = Object.create( InputNode.prototype );\r\nCubeTextureNode.prototype.constructor = CubeTextureNode;\r\nCubeTextureNode.prototype.nodeType = \"CubeTexture\";\r\n\r\nCubeTextureNode.prototype.getTexture = function ( builder, output ) {\r\n\r\n\treturn InputNode.prototype.generate.call( this, builder, output, this.value.uuid, 'tc' );\r\n\r\n};\r\n\r\nCubeTextureNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( output === 'samplerCube' ) {\r\n\r\n\t\treturn this.getTexture( builder, output );\r\n\r\n\t}\r\n\r\n\tvar cubetex = this.getTexture( builder, output );\r\n\tvar uv = this.uv.build( builder, 'v3' );\r\n\tvar bias = this.bias ? this.bias.build( builder, 'f' ) : undefined;\r\n\r\n\tif ( bias === undefined && builder.context.bias ) {\r\n\r\n\t\tbias = builder.context.bias.setTexture( this ).build( builder, 'f' );\r\n\r\n\t}\r\n\r\n\tvar code;\r\n\r\n\tif ( bias ) code = 'texCubeBias( ' + cubetex + ', ' + uv + ', ' + bias + ' )';\r\n\telse code = 'texCube( ' + cubetex + ', ' + uv + ' )';\r\n\r\n\t// add a custom context for fix incompatibility with the core\r\n\t// include ColorSpace function only for vertex shader (in fragment shader color space functions is added automatically by core)\r\n\t// this should be removed in the future\r\n\t// context.include =: is used to include or not functions if used FunctionNode\r\n\t// context.ignoreCache =: not create variables temp nodeT0..9 to optimize the code\r\n\tvar context = { include: builder.isShader( 'vertex' ), ignoreCache: true };\r\n\tvar outputType = this.getType( builder );\r\n\r\n\tbuilder.addContext( context );\r\n\r\n\tthis.colorSpace = this.colorSpace || new ColorSpaceNode( new ExpressionNode( '', outputType ) );\r\n\tthis.colorSpace.fromDecoding( builder.getTextureEncodingFromMap( this.value ) );\r\n\tthis.colorSpace.input.parse( code );\r\n\r\n\tcode = this.colorSpace.build( builder, outputType );\r\n\r\n\t// end custom context\r\n\r\n\tbuilder.removeContext();\r\n\r\n\treturn builder.format( code, outputType, output );\r\n\r\n};\r\n\r\nCubeTextureNode.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tif ( source.value ) this.value = source.value;\r\n\r\n\tthis.uv = source.uv;\r\n\r\n\tif ( source.bias ) this.bias = source.bias;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nCubeTextureNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.uuid;\r\n\t\tdata.uv = this.uv.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.bias ) data.bias = this.bias.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { CubeTextureNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/CubeTextureNode.js","import { TempNode } from '../core/TempNode.js';\r\n\r\nfunction OperatorNode( a, b, op ) {\r\n\r\n\tTempNode.call( this );\r\n\r\n\tthis.a = a;\r\n\tthis.b = b;\r\n\tthis.op = op;\r\n\r\n}\r\n\r\nOperatorNode.ADD = '+';\r\nOperatorNode.SUB = '-';\r\nOperatorNode.MUL = '*';\r\nOperatorNode.DIV = '/';\r\n\r\nOperatorNode.prototype = Object.create( TempNode.prototype );\r\nOperatorNode.prototype.constructor = OperatorNode;\r\nOperatorNode.prototype.nodeType = \"Operator\";\r\n\r\nOperatorNode.prototype.getType = function ( builder ) {\r\n\r\n\tvar a = this.a.getType( builder ),\r\n\t\tb = this.b.getType( builder );\r\n\r\n\tif ( builder.isTypeMatrix( a ) ) {\r\n\r\n\t\treturn 'v4';\r\n\r\n\t} else if ( builder.getTypeLength( b ) > builder.getTypeLength( a ) ) {\r\n\r\n\t\t// use the greater length vector\r\n\r\n\t\treturn b;\r\n\r\n\t}\r\n\r\n\treturn a;\r\n\r\n};\r\n\r\nOperatorNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar type = this.getType( builder );\r\n\r\n\tvar a = this.a.build( builder, type ),\r\n\t\tb = this.b.build( builder, type );\r\n\r\n\treturn builder.format( '( ' + a + ' ' + this.op + ' ' + b + ' )', type, output );\r\n\r\n};\r\n\r\nOperatorNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.a = source.a;\r\n\tthis.b = source.b;\r\n\tthis.op = source.op;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nOperatorNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.a = this.a.toJSON( meta ).uuid;\r\n\t\tdata.b = this.b.toJSON( meta ).uuid;\r\n\t\tdata.op = this.op;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { OperatorNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/math/OperatorNode.js","import { TempNode } from '../core/TempNode.js';\r\n\r\nfunction MathNode( a, bOrMethod, cOrMethod, method ) {\r\n\r\n\tTempNode.call( this );\r\n\r\n\tthis.a = a;\r\n\ttypeof bOrMethod !== 'string' ? this.b = bOrMethod : method = bOrMethod;\r\n\ttypeof cOrMethod !== 'string' ? this.c = cOrMethod : method = cOrMethod;\r\n\r\n\tthis.method = method;\r\n\r\n}\r\n\r\n// 1 input\r\n\r\nMathNode.RAD = 'radians';\r\nMathNode.DEG = 'degrees';\r\nMathNode.EXP = 'exp';\r\nMathNode.EXP2 = 'exp2';\r\nMathNode.LOG = 'log';\r\nMathNode.LOG2 = 'log2';\r\nMathNode.SQRT = 'sqrt';\r\nMathNode.INV_SQRT = 'inversesqrt';\r\nMathNode.FLOOR = 'floor';\r\nMathNode.CEIL = 'ceil';\r\nMathNode.NORMALIZE = 'normalize';\r\nMathNode.FRACT = 'fract';\r\nMathNode.SATURATE = 'saturate';\r\nMathNode.SIN = 'sin';\r\nMathNode.COS = 'cos';\r\nMathNode.TAN = 'tan';\r\nMathNode.ASIN = 'asin';\r\nMathNode.ACOS = 'acos';\r\nMathNode.ARCTAN = 'atan';\r\nMathNode.ABS = 'abs';\r\nMathNode.SIGN = 'sign';\r\nMathNode.LENGTH = 'length';\r\nMathNode.NEGATE = 'negate';\r\nMathNode.INVERT = 'invert';\r\n\r\n// 2 inputs\r\n\r\nMathNode.MIN = 'min';\r\nMathNode.MAX = 'max';\r\nMathNode.MOD = 'mod';\r\nMathNode.STEP = 'step';\r\nMathNode.REFLECT = 'reflect';\r\nMathNode.DISTANCE = 'distance';\r\nMathNode.DOT = 'dot';\r\nMathNode.CROSS = 'cross';\r\nMathNode.POW = 'pow';\r\n\r\n// 3 inputs\r\n\r\nMathNode.MIX = 'mix';\r\nMathNode.CLAMP = 'clamp';\r\nMathNode.REFRACT = 'refract';\r\nMathNode.SMOOTHSTEP = 'smoothstep';\r\nMathNode.FACEFORWARD = 'faceforward';\r\n\r\nMathNode.prototype = Object.create( TempNode.prototype );\r\nMathNode.prototype.constructor = MathNode;\r\nMathNode.prototype.nodeType = \"Math\";\r\nMathNode.prototype.hashProperties = [ \"method\" ];\r\n\r\nMathNode.prototype.getNumInputs = function ( /*builder*/ ) {\r\n\r\n\tswitch ( this.method ) {\r\n\r\n\t\tcase MathNode.MIX:\r\n\t\tcase MathNode.CLAMP:\r\n\t\tcase MathNode.REFRACT:\r\n\t\tcase MathNode.SMOOTHSTEP:\r\n\t\tcase MathNode.FACEFORWARD:\r\n\r\n\t\t\treturn 3;\r\n\r\n\t\tcase MathNode.MIN:\r\n\t\tcase MathNode.MAX:\r\n\t\tcase MathNode.MOD:\r\n\t\tcase MathNode.STEP:\r\n\t\tcase MathNode.REFLECT:\r\n\t\tcase MathNode.DISTANCE:\r\n\t\tcase MathNode.DOT:\r\n\t\tcase MathNode.CROSS:\r\n\t\tcase MathNode.POW:\r\n\r\n\t\t\treturn 2;\r\n\r\n\t\tdefault:\r\n\r\n\t\t\treturn 1;\r\n\r\n\t}\r\n\r\n};\r\n\r\nMathNode.prototype.getInputType = function ( builder ) {\r\n\r\n\tvar a = builder.getTypeLength( this.a.getType( builder ) );\r\n\tvar b = this.b ? builder.getTypeLength( this.b.getType( builder ) ) : 0;\r\n\tvar c = this.c ? builder.getTypeLength( this.c.getType( builder ) ) : 0;\r\n\r\n\tif ( a > b && a > c ) {\r\n\r\n\t\treturn this.a.getType( builder );\r\n\r\n\t} else if ( b > c ) {\r\n\r\n\t\treturn this.b.getType( builder );\r\n\r\n\t}\r\n\r\n\treturn this.c.getType( builder );\r\n\r\n};\r\n\r\nMathNode.prototype.getType = function ( builder ) {\r\n\r\n\tswitch ( this.method ) {\r\n\r\n\t\tcase MathNode.LENGTH:\r\n\t\tcase MathNode.DISTANCE:\r\n\t\tcase MathNode.DOT:\r\n\r\n\t\t\treturn 'f';\r\n\r\n\t\tcase MathNode.CROSS:\r\n\r\n\t\t\treturn 'v3';\r\n\r\n\t}\r\n\r\n\treturn this.getInputType( builder );\r\n\r\n};\r\n\r\nMathNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar a, b, c,\r\n\t\tal = this.a ? builder.getTypeLength( this.a.getType( builder ) ) : 0,\r\n\t\tbl = this.b ? builder.getTypeLength( this.b.getType( builder ) ) : 0,\r\n\t\tcl = this.c ? builder.getTypeLength( this.c.getType( builder ) ) : 0,\r\n\t\tinputType = this.getInputType( builder ),\r\n\t\tnodeType = this.getType( builder );\r\n\r\n\tswitch ( this.method ) {\r\n\r\n\t\t// 1 input\r\n\r\n\t\tcase MathNode.NEGATE:\r\n\r\n\t\t\treturn builder.format( '( -' + this.a.build( builder, inputType ) + ' )', inputType, output );\r\n\r\n\t\tcase MathNode.INVERT:\r\n\r\n\t\t\treturn builder.format( '( 1.0 - ' + this.a.build( builder, inputType ) + ' )', inputType, output );\r\n\r\n\t\t\t// 2 inputs\r\n\r\n\t\tcase MathNode.CROSS:\r\n\r\n\t\t\ta = this.a.build( builder, 'v3' );\r\n\t\t\tb = this.b.build( builder, 'v3' );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase MathNode.STEP:\r\n\r\n\t\t\ta = this.a.build( builder, al === 1 ? 'f' : inputType );\r\n\t\t\tb = this.b.build( builder, inputType );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase MathNode.MIN:\r\n\t\tcase MathNode.MAX:\r\n\t\tcase MathNode.MOD:\r\n\r\n\t\t\ta = this.a.build( builder, inputType );\r\n\t\t\tb = this.b.build( builder, bl === 1 ? 'f' : inputType );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t\t// 3 inputs\r\n\r\n\t\tcase MathNode.REFRACT:\r\n\r\n\t\t\ta = this.a.build( builder, inputType );\r\n\t\t\tb = this.b.build( builder, inputType );\r\n\t\t\tc = this.c.build( builder, 'f' );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase MathNode.MIX:\r\n\r\n\t\t\ta = this.a.build( builder, inputType );\r\n\t\t\tb = this.b.build( builder, inputType );\r\n\t\t\tc = this.c.build( builder, cl === 1 ? 'f' : inputType );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t\t// default\r\n\r\n\t\tdefault:\r\n\r\n\t\t\ta = this.a.build( builder, inputType );\r\n\t\t\tif ( this.b ) b = this.b.build( builder, inputType );\r\n\t\t\tif ( this.c ) c = this.c.build( builder, inputType );\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\t// build function call\r\n\r\n\tvar params = [];\r\n\tparams.push( a );\r\n\tif ( b ) params.push( b );\r\n\tif ( c ) params.push( c );\r\n\r\n\tvar numInputs = this.getNumInputs( builder );\r\n\r\n\tif ( params.length !== numInputs ) {\r\n\r\n\t\tthrow Error( `Arguments not match used in \"${this.method}\". Require ${numInputs}, currently ${params.length}.` );\r\n\r\n\t}\r\n\r\n\treturn builder.format( this.method + '( ' + params.join( ', ' ) + ' )', nodeType, output );\r\n\r\n};\r\n\r\nMathNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.a = source.a;\r\n\tthis.b = source.b;\r\n\tthis.c = source.c;\r\n\tthis.method = source.method;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nMathNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.a = this.a.toJSON( meta ).uuid;\r\n\t\tif ( this.b ) data.b = this.b.toJSON( meta ).uuid;\r\n\t\tif ( this.c ) data.c = this.c.toJSON( meta ).uuid;\r\n\r\n\t\tdata.method = this.method;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { MathNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/math/MathNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { ConstNode } from '../core/ConstNode.js';\r\nimport { StructNode } from '../core/StructNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { FunctionCallNode } from '../core/FunctionCallNode.js';\r\nimport { ExpressionNode } from '../core/ExpressionNode.js';\r\nimport { FloatNode } from '../inputs/FloatNode.js';\r\nimport { OperatorNode } from '../math/OperatorNode.js';\r\nimport { MathNode } from '../math/MathNode.js';\r\nimport { ColorSpaceNode } from '../utils/ColorSpaceNode.js';\r\n\r\nfunction TextureCubeUVNode( value, uv, bias ) {\r\n\r\n\tTempNode.call( this, 'v4' );\r\n\r\n\tthis.value = value,\r\n\tthis.uv = uv;\r\n\tthis.bias = bias;\r\n\r\n}\r\n\r\nTextureCubeUVNode.Nodes = ( function () {\r\n\r\n\tvar TextureCubeUVData = new StructNode(\r\n\t\t`struct TextureCubeUVData {\r\n\t\t\tvec4 tl;\r\n\t\t\tvec4 tr;\r\n\t\t\tvec4 br;\r\n\t\t\tvec4 bl;\r\n\t\t\tvec2 f;\r\n\t\t}` );\r\n\r\n\tvar cubeUV_maxMipLevel = new ConstNode( `float cubeUV_maxMipLevel 8.0`, true );\r\n\tvar cubeUV_minMipLevel = new ConstNode( `float cubeUV_minMipLevel 4.0`, true );\r\n\tvar cubeUV_maxTileSize = new ConstNode( `float cubeUV_maxTileSize 256.0`, true );\r\n\tvar cubeUV_minTileSize = new ConstNode( `float cubeUV_minTileSize 16.0`, true );\r\n\r\n\t// These shader functions convert between the UV coordinates of a single face of\r\n\t// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\r\n\t// sampling a textureCube (not generally normalized).\r\n\r\n\tvar getFace = new FunctionNode(\r\n\t\t`float getFace(vec3 direction) {\r\n\t\t\t\tvec3 absDirection = abs(direction);\r\n\t\t\t\tfloat face = -1.0;\r\n\t\t\t\tif (absDirection.x > absDirection.z) {\r\n\t\t\t\t\tif (absDirection.x > absDirection.y)\r\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (absDirection.z > absDirection.y)\r\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\r\n\t\t\t\t}\r\n\t\t\t\treturn face;\r\n\t\t}` );\r\n\tgetFace.useKeywords = false;\r\n\r\n\tvar getUV = new FunctionNode(\r\n\t\t`vec2 getUV(vec3 direction, float face) {\r\n\t\t\t\tvec2 uv;\r\n\t\t\t\tif (face == 0.0) {\r\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\r\n\t\t\t\t} else if (face == 1.0) {\r\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\r\n\t\t\t\t} else if (face == 2.0) {\r\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\r\n\t\t\t\t} else if (face == 3.0) {\r\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\r\n\t\t\t\t} else if (face == 4.0) {\r\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\r\n\t\t\t\t}\r\n\t\t\t\treturn 0.5 * (uv + 1.0);\r\n\t\t}` );\r\n\tgetUV.useKeywords = false;\r\n\r\n\tvar bilinearCubeUV = new FunctionNode(\r\n\t\t`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\r\n\r\n\t\t\tfloat face = getFace(direction);\r\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\r\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\r\n\t\t\tfloat faceSize = exp2(mipInt);\r\n\r\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\r\n\r\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\r\n\t\t\tvec2 f = fract(uv);\r\n\t\t\tuv += 0.5 - f;\r\n\t\t\tif (face > 2.0) {\r\n\t\t\t\tuv.y += faceSize;\r\n\t\t\t\tface -= 3.0;\r\n\t\t\t}\r\n\t\t\tuv.x += face * faceSize;\r\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\r\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\r\n\t\t\t}\r\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\r\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\r\n\t\t\tuv *= texelSize;\r\n\r\n\t\t\tvec4 tl = texture2D(envMap, uv);\r\n\t\t\tuv.x += texelSize;\r\n\t\t\tvec4 tr = texture2D(envMap, uv);\r\n\t\t\tuv.y += texelSize;\r\n\t\t\tvec4 br = texture2D(envMap, uv);\r\n\t\t\tuv.x -= texelSize;\r\n\t\t\tvec4 bl = texture2D(envMap, uv);\r\n\r\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\r\n\t\t}`, [ TextureCubeUVData, getFace, getUV, cubeUV_maxMipLevel, cubeUV_minMipLevel, cubeUV_maxTileSize, cubeUV_minTileSize ] );\r\n\tbilinearCubeUV.useKeywords = false;\r\n\r\n\t// These defines must match with PMREMGenerator\r\n\r\n\tvar r0 = new ConstNode( `float r0 1.0`, true );\r\n\tvar v0 = new ConstNode( `float v0 0.339`, true );\r\n\tvar m0 = new ConstNode( `float m0 -2.0`, true );\r\n\tvar r1 = new ConstNode( `float r1 0.8`, true );\r\n\tvar v1 = new ConstNode( `float v1 0.276`, true );\r\n\tvar m1 = new ConstNode( `float m1 -1.0`, true );\r\n\tvar r4 = new ConstNode( `float r4 0.4`, true );\r\n\tvar v4 = new ConstNode( `float v4 0.046`, true );\r\n\tvar m4 = new ConstNode( `float m4 2.0`, true );\r\n\tvar r5 = new ConstNode( `float r5 0.305`, true );\r\n\tvar v5 = new ConstNode( `float v5 0.016`, true );\r\n\tvar m5 = new ConstNode( `float m5 3.0`, true );\r\n\tvar r6 = new ConstNode( `float r6 0.21`, true );\r\n\tvar v6 = new ConstNode( `float v6 0.0038`, true );\r\n\tvar m6 = new ConstNode( `float m6 4.0`, true );\r\n\r\n\tvar defines = [ r0, v0, m0, r1, v1, m1, r4, v4, m4, r5, v5, m5, r6, v6, m6 ];\r\n\r\n\tvar roughnessToMip = new FunctionNode(\r\n\t\t`float roughnessToMip(float roughness) {\r\n\t\t\tfloat mip = 0.0;\r\n\t\t\tif (roughness >= r1) {\r\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\r\n\t\t\t} else if (roughness >= r4) {\r\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\r\n\t\t\t} else if (roughness >= r5) {\r\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\r\n\t\t\t} else if (roughness >= r6) {\r\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\r\n\t\t\t} else {\r\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\r\n\t\t\t}\r\n\t\t\treturn mip;\r\n\t\t}`, defines );\r\n\r\n\treturn {\r\n\t\tbilinearCubeUV: bilinearCubeUV,\r\n\t\troughnessToMip: roughnessToMip,\r\n\t\tm0: m0,\r\n\t\tcubeUV_maxMipLevel: cubeUV_maxMipLevel\r\n\t};\r\n\r\n} )();\r\n\r\nTextureCubeUVNode.prototype = Object.create( TempNode.prototype );\r\nTextureCubeUVNode.prototype.constructor = TextureCubeUVNode;\r\nTextureCubeUVNode.prototype.nodeType = \"TextureCubeUV\";\r\n\r\nTextureCubeUVNode.prototype.bilinearCubeUV = function ( builder, texture, uv, mipInt ) {\r\n\r\n\tvar bilinearCubeUV = new FunctionCallNode( TextureCubeUVNode.Nodes.bilinearCubeUV, [ texture, uv, mipInt ] );\r\n\r\n\tthis.colorSpaceTL = this.colorSpaceTL || new ColorSpaceNode( new ExpressionNode( '', 'v4' ) );\r\n\tthis.colorSpaceTL.fromDecoding( builder.getTextureEncodingFromMap( this.value.value ) );\r\n\tthis.colorSpaceTL.input.parse( bilinearCubeUV.build( builder ) + '.tl' );\r\n\r\n\tthis.colorSpaceTR = this.colorSpaceTR || new ColorSpaceNode( new ExpressionNode( '', 'v4' ) );\r\n\tthis.colorSpaceTR.fromDecoding( builder.getTextureEncodingFromMap( this.value.value ) );\r\n\tthis.colorSpaceTR.input.parse( bilinearCubeUV.build( builder ) + '.tr' );\r\n\r\n\tthis.colorSpaceBL = this.colorSpaceBL || new ColorSpaceNode( new ExpressionNode( '', 'v4' ) );\r\n\tthis.colorSpaceBL.fromDecoding( builder.getTextureEncodingFromMap( this.value.value ) );\r\n\tthis.colorSpaceBL.input.parse( bilinearCubeUV.build( builder ) + '.bl' );\r\n\r\n\tthis.colorSpaceBR = this.colorSpaceBR || new ColorSpaceNode( new ExpressionNode( '', 'v4' ) );\r\n\tthis.colorSpaceBR.fromDecoding( builder.getTextureEncodingFromMap( this.value.value ) );\r\n\tthis.colorSpaceBR.input.parse( bilinearCubeUV.build( builder ) + '.br' );\r\n\r\n\t// add a custom context for fix incompatibility with the core\r\n\t// include ColorSpace function only for vertex shader (in fragment shader color space functions is added automatically by core)\r\n\t// this should be removed in the future\r\n\t// context.include =: is used to include or not functions if used FunctionNode\r\n\t// context.ignoreCache =: not create temp variables nodeT0..9 to optimize the code\r\n\tvar context = { include: builder.isShader( 'vertex' ), ignoreCache: true };\r\n\r\n\tbuilder.addContext( context );\r\n\r\n\tthis.colorSpaceTLExp = new ExpressionNode( this.colorSpaceTL.build( builder, 'v4' ), 'v4' );\r\n\tthis.colorSpaceTRExp = new ExpressionNode( this.colorSpaceTR.build( builder, 'v4' ), 'v4' );\r\n\tthis.colorSpaceBLExp = new ExpressionNode( this.colorSpaceBL.build( builder, 'v4' ), 'v4' );\r\n\tthis.colorSpaceBRExp = new ExpressionNode( this.colorSpaceBR.build( builder, 'v4' ), 'v4' );\r\n\r\n\t// end custom context\r\n\r\n\tbuilder.removeContext();\r\n\r\n\t// --\r\n\r\n\tvar output = new ExpressionNode( `mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )`, 'v4' );\r\n\toutput.keywords[ 'cubeUV_TL' ] = this.colorSpaceTLExp;\r\n\toutput.keywords[ 'cubeUV_TR' ] = this.colorSpaceTRExp;\r\n\toutput.keywords[ 'cubeUV_BL' ] = this.colorSpaceBLExp;\r\n\toutput.keywords[ 'cubeUV_BR' ] = this.colorSpaceBRExp;\r\n\toutput.keywords[ 'cubeUV' ] = bilinearCubeUV;\r\n\r\n\treturn output;\r\n\r\n};\r\n\r\nTextureCubeUVNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tvar uv = this.uv;\r\n\t\tvar bias = this.bias || builder.context.roughness;\r\n\r\n\t\tvar mipV = new FunctionCallNode( TextureCubeUVNode.Nodes.roughnessToMip, [ bias ] );\r\n\t\tvar mip = new MathNode( mipV, TextureCubeUVNode.Nodes.m0, TextureCubeUVNode.Nodes.cubeUV_maxMipLevel, MathNode.CLAMP );\r\n\t\tvar mipInt\t= new MathNode( mip, MathNode.FLOOR );\r\n\t\tvar mipF\t= new MathNode( mip, MathNode.FRACT );\r\n\r\n\t\tvar color0 = this.bilinearCubeUV( builder, this.value, uv, mipInt );\r\n\t\tvar color1 = this.bilinearCubeUV( builder, this.value, uv, new OperatorNode(\r\n\t\t\tmipInt,\r\n\t\t\tnew FloatNode( 1 ).setReadonly( true ),\r\n\t\t\tOperatorNode.ADD\r\n\t\t) );\r\n\r\n\t\tvar color1Mix = new MathNode( color0, color1, mipF, MathNode.MIX );\r\n\r\n\t\t/*\r\n\t\t// TODO: Optimize this in the future\r\n\t\tvar cond = new CondNode(\r\n\t\t\tmipF,\r\n\t\t\tnew FloatNode( 0 ).setReadonly( true ),\r\n\t\t\tCondNode.EQUAL,\r\n\t\t\tcolor0, // if\r\n\t\t\tcolor1Mix\t// else\r\n\t\t);\r\n\t\t*/\r\n\r\n\t\treturn builder.format( color1Mix.build( builder ), 'v4', output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.TextureCubeUVNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( 'vec4( 0.0 )', this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTextureCubeUVNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.toJSON( meta ).uuid;\r\n\t\tdata.uv = this.uv.toJSON( meta ).uuid;\r\n\t\tdata.bias = this.bias.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { TextureCubeUVNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/misc/TextureCubeUVNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { FloatNode } from '../inputs/FloatNode.js';\r\nimport { TextureCubeUVNode } from './TextureCubeUVNode.js';\r\nimport { ReflectNode } from '../accessors/ReflectNode.js';\r\nimport { NormalNode } from '../accessors/NormalNode.js';\r\n\r\nfunction TextureCubeNode( value, uv, bias ) {\r\n\r\n\tTempNode.call( this, 'v4' );\r\n\r\n\tthis.value = value;\r\n\r\n\tthis.radianceNode = new TextureCubeUVNode(\r\n\t\tthis.value,\r\n\t\tuv || new ReflectNode( ReflectNode.VECTOR ),\r\n\t\t// bias should be replaced in builder.context in build process\r\n\t\tbias\r\n\t);\r\n\r\n\tthis.irradianceNode = new TextureCubeUVNode(\r\n\t\tthis.value,\r\n\t\tnew NormalNode( NormalNode.WORLD ),\r\n\t\tnew FloatNode( 1 ).setReadonly( true )\r\n\t);\r\n\r\n}\r\n\r\nTextureCubeNode.prototype = Object.create( TempNode.prototype );\r\nTextureCubeNode.prototype.constructor = TextureCubeNode;\r\nTextureCubeNode.prototype.nodeType = \"TextureCube\";\r\n\r\nTextureCubeNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tbuilder.require( 'irradiance' );\r\n\r\n\t\tif ( builder.context.bias ) {\r\n\r\n\t\t\tbuilder.context.bias.setTexture( this.value );\r\n\r\n\t\t}\r\n\r\n\t\tvar scopeNode = builder.slot === 'irradiance' ? this.irradianceNode : this.radianceNode;\r\n\r\n\t\treturn scopeNode.build( builder, output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.TextureCubeNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( 'vec4( 0.0 )', this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nTextureCubeNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTextureCubeNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { TextureCubeNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/misc/TextureCubeNode.js","import {\r\n\tCubeReflectionMapping,\r\n\tCubeRefractionMapping,\r\n\tCubeUVReflectionMapping,\r\n\tCubeUVRefractionMapping,\r\n\tLinearEncoding,\r\n\tGammaEncoding\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { NodeUniform } from './NodeUniform.js';\r\nimport { NodeUtils } from './NodeUtils.js';\r\nimport { NodeLib } from './NodeLib.js';\r\nimport { FunctionNode } from './FunctionNode.js';\r\nimport { ConstNode } from './ConstNode.js';\r\nimport { StructNode } from './StructNode.js';\r\nimport { Vector2Node } from '../inputs/Vector2Node.js';\r\nimport { Vector3Node } from '../inputs/Vector3Node.js';\r\nimport { Vector4Node } from '../inputs/Vector4Node.js';\r\nimport { TextureNode } from '../inputs/TextureNode.js';\r\nimport { CubeTextureNode } from '../inputs/CubeTextureNode.js';\r\nimport { TextureCubeNode } from '../misc/TextureCubeNode.js';\r\n\r\n\r\nvar elements = NodeUtils.elements,\r\n\tconstructors = [ 'float', 'vec2', 'vec3', 'vec4' ],\r\n\tconvertFormatToType = {\r\n\t\tfloat: 'f',\r\n\t\tvec2: 'v2',\r\n\t\tvec3: 'v3',\r\n\t\tvec4: 'v4',\r\n\t\tmat4: 'v4',\r\n\t\tint: 'i',\r\n\t\tbool: 'b'\r\n\t},\r\n\tconvertTypeToFormat = {\r\n\t\tt: 'sampler2D',\r\n\t\ttc: 'samplerCube',\r\n\t\tb: 'bool',\r\n\t\ti: 'int',\r\n\t\tf: 'float',\r\n\t\tc: 'vec3',\r\n\t\tv2: 'vec2',\r\n\t\tv3: 'vec3',\r\n\t\tv4: 'vec4',\r\n\t\tm3: 'mat3',\r\n\t\tm4: 'mat4'\r\n\t};\r\n\r\nfunction NodeBuilder() {\r\n\r\n\tthis.slots = [];\r\n\tthis.caches = [];\r\n\tthis.contexts = [];\r\n\r\n\tthis.keywords = {};\r\n\r\n\tthis.nodeData = {};\r\n\r\n\tthis.requires = {\r\n\t\tuv: [],\r\n\t\tcolor: [],\r\n\t\tlights: false,\r\n\t\tfog: false,\r\n\t\ttransparent: false,\r\n\t\tirradiance: false\r\n\t};\r\n\r\n\tthis.includes = {\r\n\t\tconsts: [],\r\n\t\tfunctions: [],\r\n\t\tstructs: []\r\n\t};\r\n\r\n\tthis.attributes = {};\r\n\r\n\tthis.prefixCode = [\r\n\t\t\"#ifdef TEXTURE_LOD_EXT\",\r\n\r\n\t\t\"\t#define texCube(a, b) textureCube(a, b)\",\r\n\t\t\"\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)\",\r\n\r\n\t\t\"\t#define tex2D(a, b) texture2D(a, b)\",\r\n\t\t\"\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)\",\r\n\r\n\t\t\"#else\",\r\n\r\n\t\t\"\t#define texCube(a, b) textureCube(a, b)\",\r\n\t\t\"\t#define texCubeBias(a, b, c) textureCube(a, b, c)\",\r\n\r\n\t\t\"\t#define tex2D(a, b) texture2D(a, b)\",\r\n\t\t\"\t#define tex2DBias(a, b, c) texture2D(a, b, c)\",\r\n\r\n\t\t\"#endif\",\r\n\r\n\t\t\"#include <packing>\",\r\n\t\t\"#include <common>\"\r\n\r\n\t].join( \"\\n\" );\r\n\r\n\tthis.parsCode = {\r\n\t\tvertex: '',\r\n\t\tfragment: ''\r\n\t};\r\n\r\n\tthis.code = {\r\n\t\tvertex: '',\r\n\t\tfragment: ''\r\n\t};\r\n\r\n\tthis.nodeCode = {\r\n\t\tvertex: '',\r\n\t\tfragment: ''\r\n\t};\r\n\r\n\tthis.resultCode = {\r\n\t\tvertex: '',\r\n\t\tfragment: ''\r\n\t};\r\n\r\n\tthis.finalCode = {\r\n\t\tvertex: '',\r\n\t\tfragment: ''\r\n\t};\r\n\r\n\tthis.inputs = {\r\n\t\tuniforms: {\r\n\t\t\tlist: [],\r\n\t\t\tvertex: [],\r\n\t\t\tfragment: []\r\n\t\t},\r\n\t\tvars: {\r\n\t\t\tvarying: [],\r\n\t\t\tvertex: [],\r\n\t\t\tfragment: []\r\n\t\t}\r\n\t};\r\n\r\n\t// send to material\r\n\r\n\tthis.defines = {};\r\n\r\n\tthis.uniforms = {};\r\n\r\n\tthis.extensions = {};\r\n\r\n\tthis.updaters = [];\r\n\r\n\tthis.nodes = [];\r\n\r\n\t// --\r\n\r\n\tthis.analyzing = false;\r\n\r\n}\r\n\r\nNodeBuilder.prototype = {\r\n\r\n\tconstructor: NodeBuilder,\r\n\r\n\tbuild: function ( vertex, fragment ) {\r\n\r\n\t\tthis.buildShader( 'vertex', vertex );\r\n\t\tthis.buildShader( 'fragment', fragment );\r\n\r\n\t\tfor ( var i = 0; i < this.requires.uv.length; i ++ ) {\r\n\r\n\t\t\tif ( this.requires.uv[ i ] ) {\r\n\r\n\t\t\t\tvar uvIndex = i > 0 ? i + 1 : '';\r\n\r\n\t\t\t\tthis.addVaryCode( 'varying vec2 vUv' + uvIndex + ';' );\r\n\r\n\t\t\t\tif ( i > 0 ) {\r\n\r\n\t\t\t\t\tthis.addVertexParsCode( 'attribute vec2 uv' + uvIndex + ';' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.addVertexFinalCode( 'vUv' + uvIndex + ' = uv' + uvIndex + ';' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.requires.color[ 0 ] ) {\r\n\r\n\t\t\tthis.addVaryCode( 'varying vec4 vColor;' );\r\n\t\t\tthis.addVertexParsCode( 'attribute vec4 color;' );\r\n\r\n\t\t\tthis.addVertexFinalCode( 'vColor = color;' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.requires.color[ 1 ] ) {\r\n\r\n\t\t\tthis.addVaryCode( 'varying vec4 vColor2;' );\r\n\t\t\tthis.addVertexParsCode( 'attribute vec4 color2;' );\r\n\r\n\t\t\tthis.addVertexFinalCode( 'vColor2 = color2;' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.requires.position ) {\r\n\r\n\t\t\tthis.addVaryCode( 'varying vec3 vPosition;' );\r\n\r\n\t\t\tthis.addVertexFinalCode( 'vPosition = transformed;' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.requires.worldPosition ) {\r\n\r\n\t\t\tthis.addVaryCode( 'varying vec3 vWPosition;' );\r\n\r\n\t\t\tthis.addVertexFinalCode( 'vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.requires.normal ) {\r\n\r\n\t\t\tthis.addVaryCode( 'varying vec3 vObjectNormal;' );\r\n\r\n\t\t\tthis.addVertexFinalCode( 'vObjectNormal = normal;' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.requires.worldNormal ) {\r\n\r\n\t\t\tthis.addVaryCode( 'varying vec3 vWNormal;' );\r\n\r\n\t\t\tthis.addVertexFinalCode( 'vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;' );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tbuildShader: function ( shader, node ) {\r\n\r\n\t\tthis.resultCode[ shader ] = node.build( this.setShader( shader ), 'v4' );\r\n\r\n\t},\r\n\r\n\tsetMaterial: function ( material, renderer ) {\r\n\r\n\t\tthis.material = material;\r\n\t\tthis.renderer = renderer;\r\n\r\n\t\tthis.requires.lights = material.lights;\r\n\t\tthis.requires.fog = material.fog;\r\n\r\n\t\tthis.mergeDefines( material.defines );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddFlow: function ( slot, cache, context ) {\r\n\r\n\t\treturn this.addSlot( slot ).addCache( cache ).addContext( context );\r\n\r\n\t},\r\n\r\n\tremoveFlow: function () {\r\n\r\n\t\treturn this.removeSlot().removeCache().removeContext();\r\n\r\n\t},\r\n\r\n\taddCache: function ( name ) {\r\n\r\n\t\tthis.cache = name || '';\r\n\t\tthis.caches.push( this.cache );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremoveCache: function () {\r\n\r\n\t\tthis.caches.pop();\r\n\t\tthis.cache = this.caches[ this.caches.length - 1 ] || '';\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddContext: function ( context ) {\r\n\r\n\t\tthis.context = Object.assign( {}, this.context, context );\r\n\t\tthis.context.extra = this.context.extra || {};\r\n\r\n\t\tthis.contexts.push( this.context );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremoveContext: function () {\r\n\r\n\t\tthis.contexts.pop();\r\n\t\tthis.context = this.contexts[ this.contexts.length - 1 ] || {};\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\taddSlot: function ( name ) {\r\n\r\n\t\tthis.slot = name || '';\r\n\t\tthis.slots.push( this.slot );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tremoveSlot: function () {\r\n\r\n\t\tthis.slots.pop();\r\n\t\tthis.slot = this.slots[ this.slots.length - 1 ] || '';\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\r\n\taddVertexCode: function ( code ) {\r\n\r\n\t\tthis.addCode( code, 'vertex' );\r\n\r\n\t},\r\n\r\n\taddFragmentCode: function ( code ) {\r\n\r\n\t\tthis.addCode( code, 'fragment' );\r\n\r\n\t},\r\n\r\n\taddCode: function ( code, shader ) {\r\n\r\n\t\tthis.code[ shader || this.shader ] += code + '\\n';\r\n\r\n\t},\r\n\r\n\r\n\taddVertexNodeCode: function ( code ) {\r\n\r\n\t\tthis.addNodeCode( code, 'vertex' );\r\n\r\n\t},\r\n\r\n\taddFragmentNodeCode: function ( code ) {\r\n\r\n\t\tthis.addNodeCode( code, 'fragment' );\r\n\r\n\t},\r\n\r\n\taddNodeCode: function ( code, shader ) {\r\n\r\n\t\tthis.nodeCode[ shader || this.shader ] += code + '\\n';\r\n\r\n\t},\r\n\r\n\tclearNodeCode: function ( shader ) {\r\n\r\n\t\tshader = shader || this.shader;\r\n\r\n\t\tvar code = this.nodeCode[ shader ];\r\n\r\n\t\tthis.nodeCode[ shader ] = '';\r\n\r\n\t\treturn code;\r\n\r\n\t},\r\n\r\n\tclearVertexNodeCode: function ( ) {\r\n\r\n\t\treturn this.clearNodeCode( 'vertex' );\r\n\r\n\t},\r\n\r\n\tclearFragmentNodeCode: function ( ) {\r\n\r\n\t\treturn this.clearNodeCode( 'fragment' );\r\n\r\n\t},\r\n\r\n\taddVertexFinalCode: function ( code ) {\r\n\r\n\t\tthis.addFinalCode( code, 'vertex' );\r\n\r\n\t},\r\n\r\n\taddFragmentFinalCode: function ( code ) {\r\n\r\n\t\tthis.addFinalCode( code, 'fragment' );\r\n\r\n\t},\r\n\r\n\taddFinalCode: function ( code, shader ) {\r\n\r\n\t\tthis.finalCode[ shader || this.shader ] += code + '\\n';\r\n\r\n\t},\r\n\r\n\r\n\taddVertexParsCode: function ( code ) {\r\n\r\n\t\tthis.addParsCode( code, 'vertex' );\r\n\r\n\t},\r\n\r\n\taddFragmentParsCode: function ( code ) {\r\n\r\n\t\tthis.addParsCode( code, 'fragment' );\r\n\r\n\t},\r\n\r\n\taddParsCode: function ( code, shader ) {\r\n\r\n\t\tthis.parsCode[ shader || this.shader ] += code + '\\n';\r\n\r\n\t},\r\n\r\n\r\n\taddVaryCode: function ( code ) {\r\n\r\n\t\tthis.addVertexParsCode( code );\r\n\t\tthis.addFragmentParsCode( code );\r\n\r\n\t},\r\n\r\n\r\n\tisCache: function ( name ) {\r\n\r\n\t\treturn this.caches.indexOf( name ) !== - 1;\r\n\r\n\t},\r\n\r\n\tisSlot: function ( name ) {\r\n\r\n\t\treturn this.slots.indexOf( name ) !== - 1;\r\n\r\n\t},\r\n\r\n\tdefine: function ( name, value ) {\r\n\r\n\t\tthis.defines[ name ] = value === undefined ? 1 : value;\r\n\r\n\t},\r\n\r\n\trequire: function ( name ) {\r\n\r\n\t\tthis.requires[ name ] = true;\r\n\r\n\t},\r\n\r\n\tisDefined: function ( name ) {\r\n\r\n\t\treturn this.defines[ name ] !== undefined;\r\n\r\n\t},\r\n\r\n\tgetVar: function ( uuid, type, ns, shader = 'varying', prefix = 'V', label = '' ) {\r\n\r\n\t\tvar vars = this.getVars( shader ),\r\n\t\t\tdata = vars[ uuid ];\r\n\r\n\t\tif ( ! data ) {\r\n\r\n\t\t\tvar index = vars.length,\r\n\t\t\t\tname = ns ? ns : 'node' + prefix + index + ( label ? '_' + label : '' );\r\n\r\n\t\t\tdata = { name: name, type: type };\r\n\r\n\t\t\tvars.push( data );\r\n\t\t\tvars[ uuid ] = data;\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t},\r\n\r\n\tgetTempVar: function ( uuid, type, ns, label ) {\r\n\r\n\t\treturn this.getVar( uuid, type, ns, this.shader, 'T', label );\r\n\r\n\t},\r\n\r\n\tgetAttribute: function ( name, type ) {\r\n\r\n\t\tif ( ! this.attributes[ name ] ) {\r\n\r\n\t\t\tvar varying = this.getVar( name, type );\r\n\r\n\t\t\tthis.addVertexParsCode( 'attribute ' + type + ' ' + name + ';' );\r\n\t\t\tthis.addVertexFinalCode( varying.name + ' = ' + name + ';' );\r\n\r\n\t\t\tthis.attributes[ name ] = { varying: varying, name: name, type: type };\r\n\r\n\t\t}\r\n\r\n\t\treturn this.attributes[ name ];\r\n\r\n\t},\r\n\r\n\tgetCode: function ( shader ) {\r\n\r\n\t\treturn [\r\n\t\t\tthis.prefixCode,\r\n\t\t\tthis.parsCode[ shader ],\r\n\t\t\tthis.getVarListCode( this.getVars( 'varying' ), 'varying' ),\r\n\t\t\tthis.getVarListCode( this.inputs.uniforms[ shader ], 'uniform' ),\r\n\t\t\tthis.getIncludesCode( 'consts', shader ),\r\n\t\t\tthis.getIncludesCode( 'structs', shader ),\r\n\t\t\tthis.getIncludesCode( 'functions', shader ),\r\n\t\t\t'void main() {',\r\n\t\t\tthis.getVarListCode( this.getVars( shader ) ),\r\n\t\t\tthis.code[ shader ],\r\n\t\t\tthis.resultCode[ shader ],\r\n\t\t\tthis.finalCode[ shader ],\r\n\t\t\t'}'\r\n\t\t].join( \"\\n\" );\r\n\r\n\t},\r\n\r\n\tgetVarListCode: function ( vars, prefix ) {\r\n\r\n\t\tprefix = prefix || '';\r\n\r\n\t\tvar code = '';\r\n\r\n\t\tfor ( var i = 0, l = vars.length; i < l; ++ i ) {\r\n\r\n\t\t\tvar nVar = vars[ i ],\r\n\t\t\t\ttype = nVar.type,\r\n\t\t\t\tname = nVar.name;\r\n\r\n\t\t\tvar formatType = this.getFormatByType( type );\r\n\r\n\t\t\tif ( formatType === undefined ) {\r\n\r\n\t\t\t\tthrow new Error( \"Node pars \" + formatType + \" not found.\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcode += prefix + ' ' + formatType + ' ' + name + ';\\n';\r\n\r\n\t\t}\r\n\r\n\t\treturn code;\r\n\r\n\t},\r\n\r\n\tgetVars: function ( shader ) {\r\n\r\n\t\treturn this.inputs.vars[ shader || this.shader ];\r\n\r\n\t},\r\n\r\n\tgetNodeData: function ( node ) {\r\n\r\n\t\tvar uuid = node.isNode ? node.uuid : node;\r\n\r\n\t\treturn this.nodeData[ uuid ] = this.nodeData[ uuid ] || {};\r\n\r\n\t},\r\n\r\n\tcreateUniform: function ( shader, type, node, ns, needsUpdate, label ) {\r\n\r\n\t\tvar uniforms = this.inputs.uniforms,\r\n\t\t\tindex = uniforms.list.length;\r\n\r\n\t\tvar uniform = new NodeUniform( {\r\n\t\t\ttype: type,\r\n\t\t\tname: ns ? ns : 'nodeU' + index + ( label ? '_' + label : '' ),\r\n\t\t\tnode: node,\r\n\t\t\tneedsUpdate: needsUpdate\r\n\t\t} );\r\n\r\n\t\tuniforms.list.push( uniform );\r\n\r\n\t\tuniforms[ shader ].push( uniform );\r\n\t\tuniforms[ shader ][ uniform.name ] = uniform;\r\n\r\n\t\tthis.uniforms[ uniform.name ] = uniform;\r\n\r\n\t\treturn uniform;\r\n\r\n\t},\r\n\r\n\tcreateVertexUniform: function ( type, node, ns, needsUpdate, label ) {\r\n\r\n\t\treturn this.createUniform( 'vertex', type, node, ns, needsUpdate, label );\r\n\r\n\t},\r\n\r\n\tcreateFragmentUniform: function ( type, node, ns, needsUpdate, label ) {\r\n\r\n\t\treturn this.createUniform( 'fragment', type, node, ns, needsUpdate, label );\r\n\r\n\t},\r\n\r\n\tinclude: function ( node, parent, source ) {\r\n\r\n\t\tvar includesStruct;\r\n\r\n\t\tnode = typeof node === 'string' ? NodeLib.get( node ) : node;\r\n\r\n\t\tif ( this.context.include === false ) {\r\n\r\n\t\t\treturn node.name;\r\n\r\n\t\t}\r\n\r\n\r\n\t\tif ( node instanceof FunctionNode ) {\r\n\r\n\t\t\tincludesStruct = this.includes.functions;\r\n\r\n\t\t} else if ( node instanceof ConstNode ) {\r\n\r\n\t\t\tincludesStruct = this.includes.consts;\r\n\r\n\t\t} else if ( node instanceof StructNode ) {\r\n\r\n\t\t\tincludesStruct = this.includes.structs;\r\n\r\n\t\t}\r\n\r\n\t\tvar includes = includesStruct[ this.shader ] = includesStruct[ this.shader ] || [];\r\n\r\n\t\tif ( node ) {\r\n\r\n\t\t\tvar included = includes[ node.name ];\r\n\r\n\t\t\tif ( ! included ) {\r\n\r\n\t\t\t\tincluded = includes[ node.name ] = {\r\n\t\t\t\t\tnode: node,\r\n\t\t\t\t\tdeps: []\r\n\t\t\t\t};\r\n\r\n\t\t\t\tincludes.push( included );\r\n\r\n\t\t\t\tincluded.src = node.build( this, 'source' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( node instanceof FunctionNode && parent && includes[ parent.name ] && includes[ parent.name ].deps.indexOf( node ) == - 1 ) {\r\n\r\n\t\t\t\tincludes[ parent.name ].deps.push( node );\r\n\r\n\t\t\t\tif ( node.includes && node.includes.length ) {\r\n\r\n\t\t\t\t\tvar i = 0;\r\n\r\n\t\t\t\t\tdo {\r\n\r\n\t\t\t\t\t\tthis.include( node.includes[ i ++ ], parent );\r\n\r\n\t\t\t\t\t} while ( i < node.includes.length );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( source ) {\r\n\r\n\t\t\t\tincluded.src = source;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn node.name;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthrow new Error( \"Include not found.\" );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tcolorToVectorProperties: function ( color ) {\r\n\r\n\t\treturn color.replace( 'r', 'x' ).replace( 'g', 'y' ).replace( 'b', 'z' ).replace( 'a', 'w' );\r\n\r\n\t},\r\n\r\n\tcolorToVector: function ( color ) {\r\n\r\n\t\treturn color.replace( /c/g, 'v3' );\r\n\r\n\t},\r\n\r\n\tgetIncludes: function ( type, shader ) {\r\n\r\n\t\treturn this.includes[ type ][ shader || this.shader ];\r\n\r\n\t},\r\n\r\n\tgetIncludesCode: function () {\r\n\r\n\t\tfunction sortByPosition( a, b ) {\r\n\r\n\t\t\treturn a.deps.length - b.deps.length;\r\n\r\n\t\t}\r\n\r\n\t\treturn function getIncludesCode( type, shader ) {\r\n\r\n\t\t\tvar includes = this.getIncludes( type, shader );\r\n\r\n\t\t\tif ( ! includes ) return '';\r\n\r\n\t\t\tvar code = '',\r\n\t\t\t\tincludes = includes.sort( sortByPosition );\r\n\r\n\t\t\tfor ( var i = 0; i < includes.length; i ++ ) {\r\n\r\n\t\t\t\tif ( includes[ i ].src ) code += includes[ i ].src + '\\n';\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn code;\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tgetConstructorFromLength: function ( len ) {\r\n\r\n\t\treturn constructors[ len - 1 ];\r\n\r\n\t},\r\n\r\n\tisTypeMatrix: function ( format ) {\r\n\r\n\t\treturn /^m/.test( format );\r\n\r\n\t},\r\n\r\n\tgetTypeLength: function ( type ) {\r\n\r\n\t\tif ( type === 'f' ) return 1;\r\n\r\n\t\treturn parseInt( this.colorToVector( type ).substr( 1 ) );\r\n\r\n\t},\r\n\r\n\tgetTypeFromLength: function ( len ) {\r\n\r\n\t\tif ( len === 1 ) return 'f';\r\n\r\n\t\treturn 'v' + len;\r\n\r\n\t},\r\n\r\n\tfindNode: function () {\r\n\r\n\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\tvar nodeCandidate = arguments[ i ];\r\n\r\n\t\t\tif ( nodeCandidate !== undefined && nodeCandidate.isNode ) {\r\n\r\n\t\t\t\treturn nodeCandidate;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tresolve: function () {\r\n\r\n\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\tvar nodeCandidate = arguments[ i ];\r\n\r\n\t\t\tif ( nodeCandidate !== undefined ) {\r\n\r\n\t\t\t\tif ( nodeCandidate.isNode ) {\r\n\r\n\t\t\t\t\treturn nodeCandidate;\r\n\r\n\t\t\t\t} else if ( nodeCandidate.isTexture ) {\r\n\r\n\t\t\t\t\tswitch ( nodeCandidate.mapping ) {\r\n\r\n\t\t\t\t\t\tcase CubeReflectionMapping:\r\n\t\t\t\t\t\tcase CubeRefractionMapping:\r\n\r\n\t\t\t\t\t\t\treturn new CubeTextureNode( nodeCandidate );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase CubeUVReflectionMapping:\r\n\t\t\t\t\t\tcase CubeUVRefractionMapping:\r\n\r\n\t\t\t\t\t\t\treturn new TextureCubeNode( new TextureNode( nodeCandidate ) );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\treturn new TextureNode( nodeCandidate );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( nodeCandidate.isVector2 ) {\r\n\r\n\t\t\t\t\treturn new Vector2Node( nodeCandidate );\r\n\r\n\t\t\t\t} else if ( nodeCandidate.isVector3 ) {\r\n\r\n\t\t\t\t\treturn new Vector3Node( nodeCandidate );\r\n\r\n\t\t\t\t} else if ( nodeCandidate.isVector4 ) {\r\n\r\n\t\t\t\t\treturn new Vector4Node( nodeCandidate );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tformat: function ( code, from, to ) {\r\n\r\n\t\tvar typeToType = this.colorToVector( to + ' <- ' + from );\r\n\r\n\t\tswitch ( typeToType ) {\r\n\r\n\t\t\tcase 'f <- v2' : return code + '.x';\r\n\t\t\tcase 'f <- v3' : return code + '.x';\r\n\t\t\tcase 'f <- v4' : return code + '.x';\r\n\t\t\tcase 'f <- i' :\r\n\t\t\tcase 'f <- b' :\treturn 'float( ' + code + ' )';\r\n\r\n\t\t\tcase 'v2 <- f' : return 'vec2( ' + code + ' )';\r\n\t\t\tcase 'v2 <- v3': return code + '.xy';\r\n\t\t\tcase 'v2 <- v4': return code + '.xy';\r\n\t\t\tcase 'v2 <- i' :\r\n\t\t\tcase 'v2 <- b' : return 'vec2( float( ' + code + ' ) )';\r\n\r\n\t\t\tcase 'v3 <- f' : return 'vec3( ' + code + ' )';\r\n\t\t\tcase 'v3 <- v2': return 'vec3( ' + code + ', 0.0 )';\r\n\t\t\tcase 'v3 <- v4': return code + '.xyz';\r\n\t\t\tcase 'v3 <- i' :\r\n\t\t\tcase 'v3 <- b' : return 'vec2( float( ' + code + ' ) )';\r\n\r\n\t\t\tcase 'v4 <- f' : return 'vec4( ' + code + ' )';\r\n\t\t\tcase 'v4 <- v2': return 'vec4( ' + code + ', 0.0, 1.0 )';\r\n\t\t\tcase 'v4 <- v3': return 'vec4( ' + code + ', 1.0 )';\r\n\t\t\tcase 'v4 <- i' :\r\n\t\t\tcase 'v4 <- b' : return 'vec4( float( ' + code + ' ) )';\r\n\r\n\t\t\tcase 'i <- f' :\r\n\t\t\tcase 'i <- b' : return 'int( ' + code + ' )';\r\n\t\t\tcase 'i <- v2' : return 'int( ' + code + '.x )';\r\n\t\t\tcase 'i <- v3' : return 'int( ' + code + '.x )';\r\n\t\t\tcase 'i <- v4' : return 'int( ' + code + '.x )';\r\n\r\n\t\t\tcase 'b <- f' : return '( ' + code + ' != 0.0 )';\r\n\t\t\tcase 'b <- v2' : return '( ' + code + ' != vec2( 0.0 ) )';\r\n\t\t\tcase 'b <- v3' : return '( ' + code + ' != vec3( 0.0 ) )';\r\n\t\t\tcase 'b <- v4' : return '( ' + code + ' != vec4( 0.0 ) )';\r\n\t\t\tcase 'b <- i' : return '( ' + code + ' != 0 )';\r\n\r\n\t\t}\r\n\r\n\t\treturn code;\r\n\r\n\t},\r\n\r\n\tgetTypeByFormat: function ( format ) {\r\n\r\n\t\treturn convertFormatToType[ format ] || format;\r\n\r\n\t},\r\n\r\n\tgetFormatByType: function ( type ) {\r\n\r\n\t\treturn convertTypeToFormat[ type ] || type;\r\n\r\n\t},\r\n\r\n\tgetUuid: function ( uuid, useCache ) {\r\n\r\n\t\tuseCache = useCache !== undefined ? useCache : true;\r\n\r\n\t\tif ( useCache && this.cache ) uuid = this.cache + '-' + uuid;\r\n\r\n\t\treturn uuid;\r\n\r\n\t},\r\n\r\n\tgetElementByIndex: function ( index ) {\r\n\r\n\t\treturn elements[ index ];\r\n\r\n\t},\r\n\r\n\tgetIndexByElement: function ( elm ) {\r\n\r\n\t\treturn elements.indexOf( elm );\r\n\r\n\t},\r\n\r\n\tisShader: function ( shader ) {\r\n\r\n\t\treturn this.shader === shader;\r\n\r\n\t},\r\n\r\n\tsetShader: function ( shader ) {\r\n\r\n\t\tthis.shader = shader;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tmergeDefines: function ( defines ) {\r\n\r\n\t\tfor ( var name in defines ) {\r\n\r\n\t\t\tthis.defines[ name ] = defines[ name ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this.defines;\r\n\r\n\t},\r\n\r\n\tmergeUniform: function ( uniforms ) {\r\n\r\n\t\tfor ( var name in uniforms ) {\r\n\r\n\t\t\tthis.uniforms[ name ] = uniforms[ name ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this.uniforms;\r\n\r\n\t},\r\n\r\n\tgetTextureEncodingFromMap: function ( map ) {\r\n\r\n\t\tvar encoding;\r\n\r\n\t\tif ( ! map ) {\r\n\r\n\t\t\tencoding = LinearEncoding;\r\n\r\n\t\t} else if ( map.isTexture ) {\r\n\r\n\t\t\tencoding = map.encoding;\r\n\r\n\t\t} else if ( map.isWebGLRenderTarget ) {\r\n\r\n\t\t\tconsole.warn( \"THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.\" );\r\n\t\t\tencoding = map.texture.encoding;\r\n\r\n\t\t}\r\n\r\n\t\tif ( encoding === LinearEncoding && this.context.gamma ) {\r\n\r\n\t\t\tencoding = GammaEncoding;\r\n\r\n\t\t}\r\n\r\n\t\treturn encoding;\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { NodeBuilder };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/core/NodeBuilder.js","import { InputNode } from '../core/InputNode.js';\r\n\r\nfunction BoolNode( value ) {\r\n\r\n\tInputNode.call( this, 'b' );\r\n\r\n\tthis.value = Boolean( value );\r\n\r\n}\r\n\r\nBoolNode.prototype = Object.create( InputNode.prototype );\r\nBoolNode.prototype.constructor = BoolNode;\r\nBoolNode.prototype.nodeType = \"Bool\";\r\n\r\nBoolNode.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate */ ) {\r\n\r\n\treturn builder.format( this.value, type, output );\r\n\r\n};\r\n\r\nBoolNode.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nBoolNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value;\r\n\r\n\t\tif ( this.readonly === true ) data.readonly = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { BoolNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/BoolNode.js","import { InputNode } from '../core/InputNode.js';\r\n\r\nfunction IntNode( value ) {\r\n\r\n\tInputNode.call( this, 'i' );\r\n\r\n\tthis.value = Math.floor( value || 0 );\r\n\r\n}\r\n\r\nIntNode.prototype = Object.create( InputNode.prototype );\r\nIntNode.prototype.constructor = IntNode;\r\nIntNode.prototype.nodeType = \"Int\";\r\n\r\nIntNode.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate */ ) {\r\n\r\n\treturn builder.format( this.value, type, output );\r\n\r\n};\r\n\r\nIntNode.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nIntNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value;\r\n\r\n\t\tif ( this.readonly === true ) data.readonly = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { IntNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/IntNode.js","import { Color } from '@/components/build/three.module.js';\r\n\r\nimport { InputNode } from '../core/InputNode.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction ColorNode( color, g, b ) {\r\n\r\n\tInputNode.call( this, 'c' );\r\n\r\n\tthis.value = color instanceof Color ? color : new Color( color || 0, g, b );\r\n\r\n}\r\n\r\nColorNode.prototype = Object.create( InputNode.prototype );\r\nColorNode.prototype.constructor = ColorNode;\r\nColorNode.prototype.nodeType = \"Color\";\r\n\r\nNodeUtils.addShortcuts( ColorNode.prototype, 'value', [ 'r', 'g', 'b' ] );\r\n\r\nColorNode.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate */ ) {\r\n\r\n\treturn builder.format( \"vec3( \" + this.r + \", \" + this.g + \", \" + this.b + \" )\", type, output );\r\n\r\n};\r\n\r\nColorNode.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value.copy( source );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nColorNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.r = this.r;\r\n\t\tdata.g = this.g;\r\n\t\tdata.b = this.b;\r\n\r\n\t\tif ( this.readonly === true ) data.readonly = true;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ColorNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/ColorNode.js","import { Matrix3 } from '@/components/build/three.module.js';\r\n\r\nimport { InputNode } from '../core/InputNode.js';\r\n\r\nfunction Matrix3Node( matrix ) {\r\n\r\n\tInputNode.call( this, 'm3' );\r\n\r\n\tthis.value = matrix || new Matrix3();\r\n\r\n}\r\n\r\nMatrix3Node.prototype = Object.create( InputNode.prototype );\r\nMatrix3Node.prototype.constructor = Matrix3Node;\r\nMatrix3Node.prototype.nodeType = \"Matrix3\";\r\n\r\nObject.defineProperties( Matrix3Node.prototype, {\r\n\r\n\telements: {\r\n\r\n\t\tset: function ( val ) {\r\n\r\n\t\t\tthis.value.elements = val;\r\n\r\n\t\t},\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.value.elements;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\nMatrix3Node.prototype.generateReadonly = function ( builder, output, uuid, type/*, ns, needsUpdate */ ) {\r\n\r\n\treturn builder.format( \"mat3( \" + this.value.elements.join( \", \" ) + \" )\", type, output );\r\n\r\n};\r\n\r\n\r\nMatrix3Node.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value.fromArray( source.elements );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nMatrix3Node.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.elements = this.value.elements.concat();\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { Matrix3Node };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/Matrix3Node.js","import { Matrix4 } from '@/components/build/three.module.js';\r\n\r\nimport { InputNode } from '../core/InputNode.js';\r\n\r\nfunction Matrix4Node( matrix ) {\r\n\r\n\tInputNode.call( this, 'm4' );\r\n\r\n\tthis.value = matrix || new Matrix4();\r\n\r\n}\r\n\r\nMatrix4Node.prototype = Object.create( InputNode.prototype );\r\nMatrix4Node.prototype.constructor = Matrix4Node;\r\nMatrix4Node.prototype.nodeType = \"Matrix4\";\r\n\r\nObject.defineProperties( Matrix4Node.prototype, {\r\n\r\n\telements: {\r\n\r\n\t\tset: function ( val ) {\r\n\r\n\t\t\tthis.value.elements = val;\r\n\r\n\t\t},\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.value.elements;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\nMatrix4Node.prototype.generateReadonly = function ( builder, output, uuid, type /*, ns, needsUpdate */ ) {\r\n\r\n\treturn builder.format( \"mat4( \" + this.value.elements.join( \", \" ) + \" )\", type, output );\r\n\r\n};\r\n\r\nMatrix4Node.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.scope.value.fromArray( source.elements );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nMatrix4Node.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.elements = this.value.elements.concat();\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { Matrix4Node };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/Matrix4Node.js","import { InputNode } from '../core/InputNode.js';\r\nimport { TextureNode } from './TextureNode.js';\r\n\r\nfunction ScreenNode( uv ) {\r\n\r\n\tTextureNode.call( this, undefined, uv );\r\n\r\n}\r\n\r\nScreenNode.prototype = Object.create( TextureNode.prototype );\r\nScreenNode.prototype.constructor = ScreenNode;\r\nScreenNode.prototype.nodeType = \"Screen\";\r\n\r\nScreenNode.prototype.getUnique = function () {\r\n\r\n\treturn true;\r\n\r\n};\r\n\r\nScreenNode.prototype.getTexture = function ( builder, output ) {\r\n\r\n\treturn InputNode.prototype.generate.call( this, builder, output, this.getUuid(), 't', 'renderTexture' );\r\n\r\n};\r\n\r\nexport { ScreenNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/ScreenNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { InputNode } from '../core/InputNode.js';\r\nimport { PositionNode } from '../accessors/PositionNode.js';\r\nimport { OperatorNode } from '../math/OperatorNode.js';\r\nimport { TextureNode } from './TextureNode.js';\r\nimport { Matrix4Node } from './Matrix4Node.js';\r\n\r\nfunction ReflectorNode( mirror ) {\r\n\r\n\tTempNode.call( this, 'v4' );\r\n\r\n\tif ( mirror ) this.setMirror( mirror );\r\n\r\n}\r\n\r\nReflectorNode.prototype = Object.create( TempNode.prototype );\r\nReflectorNode.prototype.constructor = ReflectorNode;\r\nReflectorNode.prototype.nodeType = \"Reflector\";\r\n\r\nReflectorNode.prototype.setMirror = function ( mirror ) {\r\n\r\n\tthis.mirror = mirror;\r\n\r\n\tthis.textureMatrix = new Matrix4Node( this.mirror.material.uniforms.textureMatrix.value );\r\n\r\n\tthis.localPosition = new PositionNode( PositionNode.LOCAL );\r\n\r\n\tthis.uv = new OperatorNode( this.textureMatrix, this.localPosition, OperatorNode.MUL );\r\n\tthis.uvResult = new OperatorNode( null, this.uv, OperatorNode.ADD );\r\n\r\n\tthis.texture = new TextureNode( this.mirror.material.uniforms.tDiffuse.value, this.uv, null, true );\r\n\r\n};\r\n\r\nReflectorNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tthis.uvResult.a = this.offset;\r\n\t\tthis.texture.uv = this.offset ? this.uvResult : this.uv;\r\n\r\n\t\tif ( output === 'sampler2D' ) {\r\n\r\n\t\t\treturn this.texture.build( builder, output );\r\n\r\n\t\t}\r\n\r\n\t\treturn builder.format( this.texture.build( builder, this.type ), this.type, output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.ReflectorNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( 'vec4( 0.0 )', this.type, output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nReflectorNode.prototype.copy = function ( source ) {\r\n\r\n\tInputNode.prototype.copy.call( this, source );\r\n\r\n\tthis.scope.mirror = source.mirror;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nReflectorNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.mirror = this.mirror.uuid;\r\n\r\n\t\tif ( this.offset ) data.offset = this.offset.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ReflectorNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/ReflectorNode.js","import { InputNode } from '../core/InputNode.js';\r\n\r\nfunction PropertyNode( object, property, type ) {\r\n\r\n\tInputNode.call( this, type );\r\n\r\n\tthis.object = object;\r\n\tthis.property = property;\r\n\r\n}\r\n\r\nPropertyNode.prototype = Object.create( InputNode.prototype );\r\nPropertyNode.prototype.constructor = PropertyNode;\r\nPropertyNode.prototype.nodeType = \"Property\";\r\n\r\nObject.defineProperties( PropertyNode.prototype, {\r\n\r\n\tvalue: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.object[ this.property ];\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( val ) {\r\n\r\n\t\t\tthis.object[ this.property ] = val;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\nPropertyNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value;\r\n\t\tdata.property = this.property;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { PropertyNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/PropertyNode.js","import { Node } from '../../core/Node.js';\r\n\r\nfunction RawNode( value ) {\r\n\r\n\tNode.call( this, 'v4' );\r\n\r\n\tthis.value = value;\r\n\r\n}\r\n\r\nRawNode.prototype = Object.create( Node.prototype );\r\nRawNode.prototype.constructor = RawNode;\r\nRawNode.prototype.nodeType = \"Raw\";\r\n\r\nRawNode.prototype.generate = function ( builder ) {\r\n\r\n\tvar data = this.value.analyzeAndFlow( builder, this.type ),\r\n\t\tcode = data.code + '\\n';\r\n\r\n\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\tcode += 'gl_Position = ' + data.result + ';';\r\n\r\n\t} else {\r\n\r\n\t\tcode += 'gl_FragColor = ' + data.result + ';';\r\n\r\n\t}\r\n\r\n\treturn code;\r\n\r\n};\r\n\r\nRawNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nRawNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { RawNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/nodes/RawNode.js","import {\r\n\tFrontSide,\r\n\tLessEqualDepth,\r\n\tNoColors,\r\n\tNormalBlending,\r\n\tShaderMaterial\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { NodeBuilder } from '../core/NodeBuilder.js';\r\nimport { ColorNode } from '../inputs/ColorNode.js';\r\nimport { PositionNode } from '../accessors/PositionNode.js';\r\nimport { RawNode } from './nodes/RawNode.js';\r\n\r\nfunction NodeMaterial( vertex, fragment ) {\r\n\r\n\tShaderMaterial.call( this );\r\n\r\n\tthis.vertex = vertex || new RawNode( new PositionNode( PositionNode.PROJECTION ) );\r\n\tthis.fragment = fragment || new RawNode( new ColorNode( 0xFF0000 ) );\r\n\r\n\tthis.updaters = [];\r\n\r\n}\r\n\r\nNodeMaterial.prototype = Object.create( ShaderMaterial.prototype );\r\nNodeMaterial.prototype.constructor = NodeMaterial;\r\nNodeMaterial.prototype.type = \"NodeMaterial\";\r\n\r\nNodeMaterial.prototype.isNodeMaterial = true;\r\n\r\nObject.defineProperties( NodeMaterial.prototype, {\r\n\r\n\tproperties: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.fragment.properties;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tneedsUpdate: {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) this.version ++;\r\n\t\t\tthis.needsCompile = value;\r\n\r\n\t\t},\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.needsCompile;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\nNodeMaterial.prototype.onBeforeCompile = function ( shader, renderer ) {\r\n\r\n\tthis.build( { renderer: renderer } );\r\n\r\n\tshader.defines = this.defines;\r\n\tshader.uniforms = this.uniforms;\r\n\tshader.vertexShader = this.vertexShader;\r\n\tshader.fragmentShader = this.fragmentShader;\r\n\r\n\tshader.extensionDerivatives = ( this.extensions.derivatives === true );\r\n\tshader.extensionFragDepth = ( this.extensions.fragDepth === true );\r\n\tshader.extensionDrawBuffers = ( this.extensions.drawBuffers === true );\r\n\tshader.extensionShaderTextureLOD = ( this.extensions.shaderTextureLOD === true );\r\n\r\n};\r\n\r\nNodeMaterial.prototype.customProgramCacheKey = function () {\r\n\r\n\tvar hash = this.getHash();\r\n\r\n\treturn hash;\r\n\r\n};\r\n\r\nNodeMaterial.prototype.getHash = function () {\r\n\r\n\tvar hash = '{';\r\n\r\n\thash += '\"vertex\":' + this.vertex.getHash() + ',';\r\n\thash += '\"fragment\":' + this.fragment.getHash();\r\n\r\n\thash += '}';\r\n\r\n\treturn hash;\r\n\r\n};\r\n\r\nNodeMaterial.prototype.updateFrame = function ( frame ) {\r\n\r\n\tfor ( var i = 0; i < this.updaters.length; ++ i ) {\r\n\r\n\t\tframe.updateNode( this.updaters[ i ] );\r\n\r\n\t}\r\n\r\n};\r\n\r\nNodeMaterial.prototype.build = function ( params ) {\r\n\r\n\tparams = params || {};\r\n\r\n\tvar builder = params.builder || new NodeBuilder();\r\n\r\n\tbuilder.setMaterial( this, params.renderer );\r\n\tbuilder.build( this.vertex, this.fragment );\r\n\r\n\tthis.vertexShader = builder.getCode( 'vertex' );\r\n\tthis.fragmentShader = builder.getCode( 'fragment' );\r\n\r\n\tthis.defines = builder.defines;\r\n\tthis.uniforms = builder.uniforms;\r\n\tthis.extensions = builder.extensions;\r\n\tthis.updaters = builder.updaters;\r\n\r\n\tthis.fog = builder.requires.fog;\r\n\tthis.lights = builder.requires.lights;\r\n\r\n\tthis.transparent = builder.requires.transparent || this.blending > NormalBlending;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nNodeMaterial.prototype.copy = function ( source ) {\r\n\r\n\tvar uuid = this.uuid;\r\n\r\n\tfor ( var name in source ) {\r\n\r\n\t\tthis[ name ] = source[ name ];\r\n\r\n\t}\r\n\r\n\tthis.uuid = uuid;\r\n\r\n\tif ( source.userData !== undefined ) {\r\n\r\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nNodeMaterial.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\tif ( isRootObject ) {\r\n\r\n\t\tmeta = {\r\n\t\t\tnodes: {}\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tif ( meta && ! meta.materials ) meta.materials = {};\r\n\r\n\tif ( ! meta.materials[ this.uuid ] ) {\r\n\r\n\t\tvar data = {};\r\n\r\n\t\tdata.uuid = this.uuid;\r\n\t\tdata.type = this.type;\r\n\r\n\t\tmeta.materials[ data.uuid ] = data;\r\n\r\n\t\tif ( this.name !== \"\" ) data.name = this.name;\r\n\r\n\t\tif ( this.size !== undefined ) data.size = this.size;\r\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\r\n\r\n\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\r\n\t\tif ( this.flatShading === true ) data.flatShading = this.flatShading;\r\n\t\tif ( this.side !== FrontSide ) data.side = this.side;\r\n\t\tif ( this.vertexColors !== NoColors ) data.vertexColors = this.vertexColors;\r\n\r\n\t\tif ( this.depthFunc !== LessEqualDepth ) data.depthFunc = this.depthFunc;\r\n\t\tif ( this.depthTest === false ) data.depthTest = this.depthTest;\r\n\t\tif ( this.depthWrite === false ) data.depthWrite = this.depthWrite;\r\n\r\n\t\tif ( this.linewidth !== 1 ) data.linewidth = this.linewidth;\r\n\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\r\n\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\r\n\t\tif ( this.scale !== undefined ) data.scale = this.scale;\r\n\r\n\t\tif ( this.dithering === true ) data.dithering = true;\r\n\r\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\r\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\r\n\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\r\n\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\r\n\r\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\r\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\r\n\r\n\t\tif ( this.morphTargets === true ) data.morphTargets = true;\r\n\t\tif ( this.skinning === true ) data.skinning = true;\r\n\r\n\t\tif ( this.visible === false ) data.visible = false;\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\r\n\r\n\t\tdata.fog = this.fog;\r\n\t\tdata.lights = this.lights;\r\n\r\n\t\tdata.vertex = this.vertex.toJSON( meta ).uuid;\r\n\t\tdata.fragment = this.fragment.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\tmeta.material = this.uuid;\r\n\r\n\treturn meta;\r\n\r\n};\r\n\r\nexport { NodeMaterial };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/NodeMaterial.js","import {\r\n\tMesh,\r\n\tOrthographicCamera,\r\n\tPlaneBufferGeometry,\r\n\tScene,\r\n\tWebGLRenderTarget\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { NodeBuilder } from '../core/NodeBuilder.js';\r\nimport { NodeMaterial } from '../materials/NodeMaterial.js';\r\nimport { TextureNode } from './TextureNode.js';\r\n\r\nfunction RTTNode( width, height, input, options ) {\r\n\r\n\toptions = options || {};\r\n\r\n\tthis.input = input;\r\n\r\n\tthis.clear = options.clear !== undefined ? options.clear : true;\r\n\r\n\tthis.renderTarget = new WebGLRenderTarget( width, height, options );\r\n\r\n\tthis.material = new NodeMaterial();\r\n\r\n\tthis.camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\r\n\tthis.scene = new Scene();\r\n\r\n\tthis.quad = new Mesh( new PlaneBufferGeometry( 2, 2 ), this.material );\r\n\tthis.quad.frustumCulled = false; // Avoid getting clipped\r\n\tthis.scene.add( this.quad );\r\n\r\n\tthis.render = true;\r\n\r\n\tTextureNode.call( this, this.renderTarget.texture );\r\n\r\n}\r\n\r\nRTTNode.prototype = Object.create( TextureNode.prototype );\r\nRTTNode.prototype.constructor = RTTNode;\r\nRTTNode.prototype.nodeType = \"RTT\";\r\n\r\nRTTNode.prototype.build = function ( builder, output, uuid ) {\r\n\r\n\tvar rttBuilder = new NodeBuilder();\r\n\trttBuilder.nodes = builder.nodes;\r\n\trttBuilder.updaters = builder.updaters;\r\n\r\n\tthis.material.fragment.value = this.input;\r\n\tthis.material.build( { builder: rttBuilder } );\r\n\r\n\treturn TextureNode.prototype.build.call( this, builder, output, uuid );\r\n\r\n};\r\n\r\nRTTNode.prototype.updateFramesaveTo = function ( frame ) {\r\n\r\n\tthis.saveTo.render = false;\r\n\r\n\tif ( this.saveTo !== this.saveToCurrent ) {\r\n\r\n\t\tif ( this.saveToMaterial ) this.saveToMaterial.dispose();\r\n\r\n\t\tvar material = new NodeMaterial();\r\n\t\tmaterial.fragment.value = this;\r\n\t\tmaterial.build();\r\n\r\n\t\tvar scene = new Scene();\r\n\r\n\t\tvar quad = new Mesh( new PlaneBufferGeometry( 2, 2 ), material );\r\n\t\tquad.frustumCulled = false; // Avoid getting clipped\r\n\t\tscene.add( quad );\r\n\r\n\t\tthis.saveToScene = scene;\r\n\t\tthis.saveToMaterial = material;\r\n\r\n\t}\r\n\r\n\tthis.saveToCurrent = this.saveTo;\r\n\r\n\tframe.renderer.setRenderTarget( this.saveTo.renderTarget );\r\n\tif ( this.saveTo.clear ) frame.renderer.clear();\r\n\tframe.renderer.render( this.saveToScene, this.camera );\r\n\r\n};\r\n\r\nRTTNode.prototype.updateFrame = function ( frame ) {\r\n\r\n\tif ( frame.renderer ) {\r\n\r\n\t\t// from the second frame\r\n\r\n\t\tif ( this.saveTo && this.saveTo.render === false ) {\r\n\r\n\t\t\tthis.updateFramesaveTo( frame );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.render ) {\r\n\r\n\t\t\tif ( this.material.uniforms.renderTexture ) {\r\n\r\n\t\t\t\tthis.material.uniforms.renderTexture.value = frame.renderTexture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tframe.renderer.setRenderTarget( this.renderTarget );\r\n\t\t\tif ( this.clear ) frame.renderer.clear();\r\n\t\t\tframe.renderer.render( this.scene, this.camera );\r\n\r\n\t\t}\r\n\r\n\t\t// first frame\r\n\r\n\t\tif ( this.saveTo && this.saveTo.render === true ) {\r\n\r\n\t\t\tthis.updateFramesaveTo( frame );\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"RTTNode need a renderer in NodeFrame\" );\r\n\r\n\t}\r\n\r\n};\r\n\r\nRTTNode.prototype.copy = function ( source ) {\r\n\r\n\tTextureNode.prototype.copy.call( this, source );\r\n\r\n\tthis.saveTo = source.saveTo;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nRTTNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = TextureNode.prototype.toJSON.call( this, meta );\r\n\r\n\t\tif ( this.saveTo ) data.saveTo = this.saveTo.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { RTTNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/inputs/RTTNode.js","import { TempNode } from '../core/TempNode.js';\r\n\r\nvar vertexDict = [ 'color', 'color2' ],\r\n\tfragmentDict = [ 'vColor', 'vColor2' ];\r\n\r\nfunction ColorsNode( index ) {\r\n\r\n\tTempNode.call( this, 'v4', { shared: false } );\r\n\r\n\tthis.index = index || 0;\r\n\r\n}\r\n\r\nColorsNode.prototype = Object.create( TempNode.prototype );\r\nColorsNode.prototype.constructor = ColorsNode;\r\nColorsNode.prototype.nodeType = \"Colors\";\r\n\r\nColorsNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tbuilder.requires.color[ this.index ] = true;\r\n\r\n\tvar result = builder.isShader( 'vertex' ) ? vertexDict[ this.index ] : fragmentDict[ this.index ];\r\n\r\n\treturn builder.format( result, this.getType( builder ), output );\r\n\r\n};\r\n\r\nColorsNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.index = source.index;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nColorsNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.index = this.index;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ColorsNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/ColorsNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { FloatNode } from '../inputs/FloatNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { NormalNode } from '../accessors/NormalNode.js';\r\nimport { PositionNode } from '../accessors/PositionNode.js';\r\n\r\nfunction BumpMapNode( value, scale ) {\r\n\r\n\tTempNode.call( this, 'v3' );\r\n\r\n\tthis.value = value;\r\n\tthis.scale = scale || new FloatNode( 1 );\r\n\r\n\tthis.toNormalMap = false;\r\n\r\n}\r\n\r\nBumpMapNode.Nodes = ( function () {\r\n\r\n\tvar dHdxy_fwd = new FunctionNode( [\r\n\r\n\t\t// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\r\n\t\t// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf\r\n\r\n\t\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\r\n\r\n\t\t\"vec2 dHdxy_fwd( sampler2D bumpMap, vec2 vUv, float bumpScale ) {\",\r\n\r\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\r\n\r\n\t\t\"\tvec2 dSTdx = dFdx( vUv );\",\r\n\t\t\"\tvec2 dSTdy = dFdy( vUv );\",\r\n\r\n\t\t\"\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\",\r\n\t\t\"\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\",\r\n\t\t\"\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\",\r\n\r\n\t\t\"\treturn vec2( dBx, dBy );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" ), null, { derivatives: true } );\r\n\r\n\tvar perturbNormalArb = new FunctionNode( [\r\n\r\n\t\t\"vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\",\r\n\r\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\r\n\r\n\t\t\"\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\",\r\n\t\t\"\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\",\r\n\t\t\"\tvec3 vN = surf_norm;\", // normalized\r\n\r\n\t\t\"\tvec3 R1 = cross( vSigmaY, vN );\",\r\n\t\t\"\tvec3 R2 = cross( vN, vSigmaX );\",\r\n\r\n\t\t\"\tfloat fDet = dot( vSigmaX, R1 );\",\r\n\r\n\t\t\"\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\",\r\n\r\n\t\t\"\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\",\r\n\r\n\t\t\"\treturn normalize( abs( fDet ) * surf_norm - vGrad );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" ), [ dHdxy_fwd ], { derivatives: true } );\r\n\r\n\tvar bumpToNormal = new FunctionNode( [\r\n\t\t\"vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, float scale ) {\",\r\n\r\n\t\t\"\tvec2 dSTdx = dFdx( uv );\",\r\n\t\t\"\tvec2 dSTdy = dFdy( uv );\",\r\n\r\n\t\t\"\tfloat Hll = texture2D( bumpMap, uv ).x;\",\r\n\t\t\"\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;\",\r\n\t\t\"\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;\",\r\n\r\n\t\t\"\treturn vec3( .5 - ( dBx * scale ), .5 - ( dBy * scale ), 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ), null, { derivatives: true } );\r\n\r\n\treturn {\r\n\t\tdHdxy_fwd: dHdxy_fwd,\r\n\t\tperturbNormalArb: perturbNormalArb,\r\n\t\tbumpToNormal: bumpToNormal\r\n\t};\r\n\r\n} )();\r\n\r\nBumpMapNode.prototype = Object.create( TempNode.prototype );\r\nBumpMapNode.prototype.constructor = BumpMapNode;\r\nBumpMapNode.prototype.nodeType = \"BumpMap\";\r\nBumpMapNode.prototype.hashProperties = [ \"toNormalMap\" ];\r\n\r\nBumpMapNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tif ( this.toNormalMap ) {\r\n\r\n\t\t\tvar bumpToNormal = builder.include( BumpMapNode.Nodes.bumpToNormal );\r\n\r\n\t\t\treturn builder.format( bumpToNormal + '( ' + this.value.build( builder, 'sampler2D' ) + ', ' +\r\n\t\t\t\tthis.value.uv.build( builder, 'v2' ) + ', ' +\r\n\t\t\t\tthis.scale.build( builder, 'f' ) + ' )', this.getType( builder ), output );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar derivativeHeight = builder.include( BumpMapNode.Nodes.dHdxy_fwd ),\r\n\t\t\t\tperturbNormalArb = builder.include( BumpMapNode.Nodes.perturbNormalArb );\r\n\r\n\t\t\tthis.normal = this.normal || new NormalNode();\r\n\t\t\tthis.position = this.position || new PositionNode( PositionNode.VIEW );\r\n\r\n\t\t\tvar derivativeHeightCode = derivativeHeight + '( ' + this.value.build( builder, 'sampler2D' ) + ', ' +\r\n\t\t\t\tthis.value.uv.build( builder, 'v2' ) + ', ' +\r\n\t\t\t\tthis.scale.build( builder, 'f' ) + ' )';\r\n\r\n\t\t\treturn builder.format( perturbNormalArb + '( -' + this.position.build( builder, 'v3' ) + ', ' +\r\n\t\t\t\tthis.normal.build( builder, 'v3' ) + ', ' +\r\n\t\t\t\tderivativeHeightCode + ' )', this.getType( builder ), output );\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.BumpMapNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( 'vec3( 0.0 )', this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nBumpMapNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\tthis.scale = source.scale;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nBumpMapNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.toJSON( meta ).uuid;\r\n\t\tdata.scale = this.scale.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { BumpMapNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/misc/BumpMapNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { FloatNode } from '../inputs/FloatNode.js';\r\nimport { PositionNode } from '../accessors/PositionNode.js';\r\n\r\nfunction CameraNode( scope, camera ) {\r\n\r\n\tTempNode.call( this, 'v3' );\r\n\r\n\tthis.setScope( scope || CameraNode.POSITION );\r\n\tthis.setCamera( camera );\r\n\r\n}\r\n\r\nCameraNode.Nodes = ( function () {\r\n\r\n\tvar depthColor = new FunctionNode( [\r\n\t\t\"float depthColor( float mNear, float mFar ) {\",\r\n\r\n\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\r\n\r\n\t\t\"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\r\n\r\n\t\t\"\t#else\",\r\n\r\n\t\t\"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\r\n\r\n\t\t\"\t#endif\",\r\n\r\n\t\t\"\treturn 1.0 - smoothstep( mNear, mFar, depth );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\treturn {\r\n\t\tdepthColor: depthColor\r\n\t};\r\n\r\n} )();\r\n\r\nCameraNode.POSITION = 'position';\r\nCameraNode.DEPTH = 'depth';\r\nCameraNode.TO_VERTEX = 'toVertex';\r\n\r\nCameraNode.prototype = Object.create( TempNode.prototype );\r\nCameraNode.prototype.constructor = CameraNode;\r\nCameraNode.prototype.nodeType = \"Camera\";\r\n\r\nCameraNode.prototype.setCamera = function ( camera ) {\r\n\r\n\tthis.camera = camera;\r\n\tthis.updateFrame = camera !== undefined ? this.onUpdateFrame : undefined;\r\n\r\n};\r\n\r\nCameraNode.prototype.setScope = function ( scope ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase CameraNode.DEPTH:\r\n\r\n\t\t\tdelete this.near;\r\n\t\t\tdelete this.far;\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\tthis.scope = scope;\r\n\r\n\tswitch ( scope ) {\r\n\r\n\t\tcase CameraNode.DEPTH:\r\n\r\n\t\t\tvar camera = this.camera;\r\n\r\n\t\t\tthis.near = new FloatNode( camera ? camera.near : 1 );\r\n\t\t\tthis.far = new FloatNode( camera ? camera.far : 1200 );\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n};\r\n\r\nCameraNode.prototype.getType = function ( /* builder */ ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase CameraNode.DEPTH:\r\n\r\n\t\t\treturn 'f';\r\n\r\n\t}\r\n\r\n\treturn this.type;\r\n\r\n};\r\n\r\nCameraNode.prototype.getUnique = function ( /* builder */ ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase CameraNode.DEPTH:\r\n\t\tcase CameraNode.TO_VERTEX:\r\n\r\n\t\t\treturn true;\r\n\r\n\t}\r\n\r\n\treturn false;\r\n\r\n};\r\n\r\nCameraNode.prototype.getShared = function ( /* builder */ ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase CameraNode.POSITION:\r\n\r\n\t\t\treturn false;\r\n\r\n\t}\r\n\r\n\treturn true;\r\n\r\n};\r\n\r\nCameraNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar result;\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase CameraNode.POSITION:\r\n\r\n\t\t\tresult = 'cameraPosition';\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase CameraNode.DEPTH:\r\n\r\n\t\t\tvar depthColor = builder.include( CameraNode.Nodes.depthColor );\r\n\r\n\t\t\tresult = depthColor + '( ' + this.near.build( builder, 'f' ) + ', ' + this.far.build( builder, 'f' ) + ' )';\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase CameraNode.TO_VERTEX:\r\n\r\n\t\t\tresult = 'normalize( ' + new PositionNode( PositionNode.WORLD ).build( builder, 'v3' ) + ' - cameraPosition )';\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\treturn builder.format( result, this.getType( builder ), output );\r\n\r\n};\r\n\r\nCameraNode.prototype.onUpdateFrame = function ( /* frame */ ) {\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase CameraNode.DEPTH:\r\n\r\n\t\t\tvar camera = this.camera;\r\n\r\n\t\t\tthis.near.value = camera.near;\r\n\t\t\tthis.far.value = camera.far;\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n};\r\n\r\nCameraNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.setScope( source.scope );\r\n\r\n\tif ( source.camera ) {\r\n\r\n\t\tthis.setCamera( source.camera );\r\n\r\n\t}\r\n\r\n\tswitch ( source.scope ) {\r\n\r\n\t\tcase CameraNode.DEPTH:\r\n\r\n\t\t\tthis.near.number = source.near;\r\n\t\t\tthis.far.number = source.far;\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nCameraNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.scope = this.scope;\r\n\r\n\t\tif ( this.camera ) data.camera = this.camera.uuid;\r\n\r\n\t\tswitch ( this.scope ) {\r\n\r\n\t\t\tcase CameraNode.DEPTH:\r\n\r\n\t\t\t\tdata.near = this.near.value;\r\n\t\t\t\tdata.far = this.far.value;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { CameraNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/CameraNode.js","import { TempNode } from '../core/TempNode.js';\r\n\r\nfunction LightNode( scope ) {\r\n\r\n\tTempNode.call( this, 'v3', { shared: false } );\r\n\r\n\tthis.scope = scope || LightNode.TOTAL;\r\n\r\n}\r\n\r\nLightNode.TOTAL = 'total';\r\n\r\nLightNode.prototype = Object.create( TempNode.prototype );\r\nLightNode.prototype.constructor = LightNode;\r\nLightNode.prototype.nodeType = \"Light\";\r\n\r\nLightNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isCache( 'light' ) ) {\r\n\r\n\t\treturn builder.format( 'reflectedLight.directDiffuse', this.type, output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.LightNode is only compatible in \\\"light\\\" channel.\" );\r\n\r\n\t\treturn builder.format( 'vec3( 0.0 )', this.type, output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nLightNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.scope = source.scope;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nLightNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.scope = this.scope;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { LightNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/LightNode.js","import { Vector2 } from '@/components/build/three.module.js';\r\n\r\nimport { Vector2Node } from '../inputs/Vector2Node.js';\r\n\r\nfunction ResolutionNode() {\r\n\r\n\tVector2Node.call( this );\r\n\r\n\tthis.size = new Vector2();\r\n\r\n}\r\n\r\nResolutionNode.prototype = Object.create( Vector2Node.prototype );\r\nResolutionNode.prototype.constructor = ResolutionNode;\r\nResolutionNode.prototype.nodeType = \"Resolution\";\r\n\r\nResolutionNode.prototype.updateFrame = function ( frame ) {\r\n\r\n\tif ( frame.renderer ) {\r\n\r\n\t\tframe.renderer.getSize( this.size );\r\n\r\n\t\tvar pixelRatio = frame.renderer.getPixelRatio();\r\n\r\n\t\tthis.x = this.size.width * pixelRatio;\r\n\t\tthis.y = this.size.height * pixelRatio;\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"ResolutionNode need a renderer in NodeFrame\" );\r\n\r\n\t}\r\n\r\n};\r\n\r\nResolutionNode.prototype.copy = function ( source ) {\r\n\r\n\tVector2Node.prototype.copy.call( this, source );\r\n\r\n\tthis.renderer = source.renderer;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nResolutionNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.renderer = this.renderer.uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ResolutionNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/ResolutionNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { ResolutionNode } from './ResolutionNode.js';\r\n\r\nfunction ScreenUVNode( resolution ) {\r\n\r\n\tTempNode.call( this, 'v2' );\r\n\r\n\tthis.resolution = resolution || new ResolutionNode();\r\n\r\n}\r\n\r\nScreenUVNode.prototype = Object.create( TempNode.prototype );\r\nScreenUVNode.prototype.constructor = ScreenUVNode;\r\nScreenUVNode.prototype.nodeType = \"ScreenUV\";\r\n\r\nScreenUVNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar result;\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tresult = '( gl_FragCoord.xy / ' + this.resolution.build( builder, 'v2' ) + ')';\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.ScreenUVNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\tresult = 'vec2( 0.0 )';\r\n\r\n\t}\r\n\r\n\treturn builder.format( result, this.getType( builder ), output );\r\n\r\n};\r\n\r\nScreenUVNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.resolution = source.resolution;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nScreenUVNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.resolution = this.resolution.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ScreenUVNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/accessors/ScreenUVNode.js","import { TempNode } from '../core/TempNode.js';\r\n\r\nfunction CondNode( a, b, op, ifNode, elseNode ) {\r\n\r\n\tTempNode.call( this );\r\n\r\n\tthis.a = a;\r\n\tthis.b = b;\r\n\r\n\tthis.op = op;\r\n\r\n\tthis.ifNode = ifNode;\r\n\tthis.elseNode = elseNode;\r\n\r\n}\r\n\r\nCondNode.EQUAL = '==';\r\nCondNode.NOT_EQUAL = '!=';\r\nCondNode.GREATER = '>';\r\nCondNode.GREATER_EQUAL = '>=';\r\nCondNode.LESS = '<';\r\nCondNode.LESS_EQUAL = '<=';\r\nCondNode.AND = '&&';\r\nCondNode.OR = '||';\r\n\r\nCondNode.prototype = Object.create( TempNode.prototype );\r\nCondNode.prototype.constructor = CondNode;\r\nCondNode.prototype.nodeType = \"Cond\";\r\n\r\nCondNode.prototype.getType = function ( builder ) {\r\n\r\n\tif ( this.ifNode ) {\r\n\r\n\t\tvar ifType = this.ifNode.getType( builder );\r\n\t\tvar elseType = this.elseNode.getType( builder );\r\n\r\n\t\tif ( builder.getTypeLength( elseType ) > builder.getTypeLength( ifType ) ) {\r\n\r\n\t\t\treturn elseType;\r\n\r\n\t\t}\r\n\r\n\t\treturn ifType;\r\n\r\n\t}\r\n\r\n\treturn 'b';\r\n\r\n};\r\n\r\nCondNode.prototype.getCondType = function ( builder ) {\r\n\r\n\tif ( builder.getTypeLength( this.b.getType( builder ) ) > builder.getTypeLength( this.a.getType( builder ) ) ) {\r\n\r\n\t\treturn this.b.getType( builder );\r\n\r\n\t}\r\n\r\n\treturn this.a.getType( builder );\r\n\r\n};\r\n\r\nCondNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar type = this.getType( builder ),\r\n\t\tcondType = this.getCondType( builder ),\r\n\t\ta = this.a.build( builder, condType ),\r\n\t\tb = this.b.build( builder, condType ),\r\n\t\tcode;\r\n\r\n\tif ( this.ifNode ) {\r\n\r\n\t\tvar ifCode = this.ifNode.build( builder, type ),\r\n\t\t\telseCode = this.elseNode.build( builder, type );\r\n\r\n\t\tcode = '( ' + [ a, this.op, b, '?', ifCode, ':', elseCode ].join( ' ' ) + ' )';\r\n\r\n\t} else {\r\n\r\n\t\tcode = '( ' + a + ' ' + this.op + ' ' + b + ' )';\r\n\r\n\t}\r\n\r\n\treturn builder.format( code, this.getType( builder ), output );\r\n\r\n};\r\n\r\nCondNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.a = source.a;\r\n\tthis.b = source.b;\r\n\r\n\tthis.op = source.op;\r\n\r\n\tthis.ifNode = source.ifNode;\r\n\tthis.elseNode = source.elseNode;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nCondNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.a = this.a.toJSON( meta ).uuid;\r\n\t\tdata.b = this.b.toJSON( meta ).uuid;\r\n\r\n\t\tdata.op = this.op;\r\n\r\n\t\tif ( data.ifNode ) data.ifNode = this.ifNode.toJSON( meta ).uuid;\r\n\t\tif ( data.elseNode ) data.elseNode = this.elseNode.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { CondNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/math/CondNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { UVNode } from '../accessors/UVNode.js';\r\n\r\nfunction NoiseNode( uv ) {\r\n\r\n\tTempNode.call( this, 'f' );\r\n\r\n\tthis.uv = uv || new UVNode();\r\n\r\n}\r\n\r\nNoiseNode.prototype = Object.create( TempNode.prototype );\r\nNoiseNode.prototype.constructor = NoiseNode;\r\nNoiseNode.prototype.nodeType = \"Noise\";\r\n\r\nNoiseNode.Nodes = ( function () {\r\n\r\n\tvar snoise = new FunctionNode( [\r\n\t\t\"float snoise(vec2 co) {\",\r\n\r\n\t\t\"\treturn fract( sin( dot( co.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\treturn {\r\n\t\tsnoise: snoise\r\n\t};\r\n\r\n} )();\r\n\r\nNoiseNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar snoise = builder.include( NoiseNode.Nodes.snoise );\r\n\r\n\treturn builder.format( snoise + '( ' + this.uv.build( builder, 'v2' ) + ' )', this.getType( builder ), output );\r\n\r\n};\r\n\r\nNoiseNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.uv = source.uv;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nNoiseNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.uv = this.uv.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { NoiseNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/procedural/NoiseNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { UVNode } from '../accessors/UVNode.js';\r\n\r\nfunction CheckerNode( uv ) {\r\n\r\n\tTempNode.call( this, 'f' );\r\n\r\n\tthis.uv = uv || new UVNode();\r\n\r\n}\r\n\r\nCheckerNode.prototype = Object.create( TempNode.prototype );\r\nCheckerNode.prototype.constructor = CheckerNode;\r\nCheckerNode.prototype.nodeType = \"Noise\";\r\n\r\nCheckerNode.Nodes = ( function () {\r\n\r\n\t// https://github.com/mattdesl/glsl-checker/blob/master/index.glsl\r\n\r\n\tvar checker = new FunctionNode( [\r\n\t\t\"float checker( vec2 uv ) {\",\r\n\r\n\t\t\"\tfloat cx = floor( uv.x );\",\r\n\t\t\"\tfloat cy = floor( uv.y ); \",\r\n\t\t\"\tfloat result = mod( cx + cy, 2.0 );\",\r\n\r\n\t\t\"\treturn sign( result );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\treturn {\r\n\t\tchecker: checker\r\n\t};\r\n\r\n} )();\r\n\r\nCheckerNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar snoise = builder.include( CheckerNode.Nodes.checker );\r\n\r\n\treturn builder.format( snoise + '( ' + this.uv.build( builder, 'v2' ) + ' )', this.getType( builder ), output );\r\n\r\n};\r\n\r\nCheckerNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.uv = source.uv;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nCheckerNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.uv = this.uv.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { CheckerNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/procedural/CheckerNode.js","import {\r\n\tBackSide\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { TempNode } from '../core/TempNode.js';\r\nimport { Vector2Node } from '../inputs/Vector2Node.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { UVNode } from '../accessors/UVNode.js';\r\nimport { NormalNode } from '../accessors/NormalNode.js';\r\nimport { PositionNode } from '../accessors/PositionNode.js';\r\n\r\nfunction NormalMapNode( value, scale ) {\r\n\r\n\tTempNode.call( this, 'v3' );\r\n\r\n\tthis.value = value;\r\n\tthis.scale = scale || new Vector2Node( 1, 1 );\r\n\r\n}\r\n\r\nNormalMapNode.Nodes = ( function () {\r\n\r\n\tvar perturbNormal2Arb = new FunctionNode(\r\n\r\n\t\t// Per-Pixel Tangent Space Normal Mapping\r\n\t\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\r\n\r\n\t\t`vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 vUv, vec2 normalScale ) {\r\n\r\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\r\n\r\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\r\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\r\n\t\tvec2 st0 = dFdx( vUv.st );\r\n\t\tvec2 st1 = dFdy( vUv.st );\r\n\r\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\r\n\r\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\r\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\r\n\t\tvec3 N = normalize( surf_norm );\r\n\r\n\t\tvec3 mapN = map * 2.0 - 1.0;\r\n\r\n\t\tmapN.xy *= normalScale;\r\n\r\n\t\t#ifdef DOUBLE_SIDED\r\n\r\n\t\t\t// Workaround for Adreno GPUs gl_FrontFacing bug. See #15850 and #10331\r\n\r\n\t\t\tif ( dot( cross( S, T ), N ) < 0.0 ) mapN.xy *= - 1.0;\r\n\r\n\t\t#else\r\n\r\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\r\n\r\n\t\t#endif\r\n\r\n\t\tmat3 tsn = mat3( S, T, N );\r\n\t\treturn normalize( tsn * mapN );\r\n\r\n\t}`, null, { derivatives: true } );\r\n\r\n\treturn {\r\n\t\tperturbNormal2Arb: perturbNormal2Arb\r\n\t};\r\n\r\n} )();\r\n\r\nNormalMapNode.prototype = Object.create( TempNode.prototype );\r\nNormalMapNode.prototype.constructor = NormalMapNode;\r\nNormalMapNode.prototype.nodeType = \"NormalMap\";\r\n\r\nNormalMapNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tvar perturbNormal2Arb = builder.include( NormalMapNode.Nodes.perturbNormal2Arb );\r\n\r\n\t\tthis.normal = this.normal || new NormalNode();\r\n\t\tthis.position = this.position || new PositionNode( PositionNode.VIEW );\r\n\t\tthis.uv = this.uv || new UVNode();\r\n\r\n\t\tvar scale = this.scale.build( builder, 'v2' );\r\n\r\n\t\tif ( builder.material.side === BackSide ) {\r\n\r\n\t\t\tscale = '-' + scale;\r\n\r\n\t\t}\r\n\r\n\t\treturn builder.format( perturbNormal2Arb + '( -' + this.position.build( builder, 'v3' ) + ', ' +\r\n\t\t\tthis.normal.build( builder, 'v3' ) + ', ' +\r\n\t\t\tthis.value.build( builder, 'v3' ) + ', ' +\r\n\t\t\tthis.uv.build( builder, 'v2' ) + ', ' +\r\n\t\t\tscale + ' )', this.getType( builder ), output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.NormalMapNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( 'vec3( 0.0 )', this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nNormalMapNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\tthis.scale = source.scale;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nNormalMapNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.toJSON( meta ).uuid;\r\n\t\tdata.scale = this.scale.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { NormalMapNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/misc/NormalMapNode.js","import { Node } from '../core/Node.js';\r\n\r\nfunction BypassNode( code, value ) {\r\n\r\n\tNode.call( this );\r\n\r\n\tthis.code = code;\r\n\tthis.value = value;\r\n\r\n}\r\n\r\nBypassNode.prototype = Object.create( Node.prototype );\r\nBypassNode.prototype.constructor = BypassNode;\r\nBypassNode.prototype.nodeType = \"Bypass\";\r\n\r\nBypassNode.prototype.getType = function ( builder ) {\r\n\r\n\tif ( this.value ) {\r\n\r\n\t\treturn this.value.getType( builder );\r\n\r\n\t} else if ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\treturn 'f';\r\n\r\n\t}\r\n\r\n\treturn 'void';\r\n\r\n};\r\n\r\nBypassNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar code = this.code.build( builder, output ) + ';';\r\n\r\n\tbuilder.addNodeCode( code );\r\n\r\n\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\tif ( this.value ) {\r\n\r\n\t\t\treturn this.value.build( builder, output );\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\treturn this.value ? this.value.build( builder, output ) : builder.format( '0.0', 'f', output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nBypassNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\tthis.code = source.code;\r\n\tthis.value = source.value;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nBypassNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.code = this.code.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.value ) data.value = this.value.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { BypassNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/BypassNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nvar inputs = NodeUtils.elements;\r\n\r\nfunction JoinNode( x, y, z, w ) {\r\n\r\n\tTempNode.call( this, 'f' );\r\n\r\n\tthis.x = x;\r\n\tthis.y = y;\r\n\tthis.z = z;\r\n\tthis.w = w;\r\n\r\n}\r\n\r\nJoinNode.prototype = Object.create( TempNode.prototype );\r\nJoinNode.prototype.constructor = JoinNode;\r\nJoinNode.prototype.nodeType = \"Join\";\r\n\r\nJoinNode.prototype.getNumElements = function () {\r\n\r\n\tvar i = inputs.length;\r\n\r\n\twhile ( i -- ) {\r\n\r\n\t\tif ( this[ inputs[ i ] ] !== undefined ) {\r\n\r\n\t\t\t++ i;\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn Math.max( i, 2 );\r\n\r\n};\r\n\r\nJoinNode.prototype.getType = function ( builder ) {\r\n\r\n\treturn builder.getTypeFromLength( this.getNumElements() );\r\n\r\n};\r\n\r\nJoinNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar type = this.getType( builder ),\r\n\t\tlength = this.getNumElements(),\r\n\t\toutputs = [];\r\n\r\n\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\tvar elm = this[ inputs[ i ] ];\r\n\r\n\t\toutputs.push( elm ? elm.build( builder, 'f' ) : '0.0' );\r\n\r\n\t}\r\n\r\n\tvar code = ( length > 1 ? builder.getConstructorFromLength( length ) : '' ) + '( ' + outputs.join( ', ' ) + ' )';\r\n\r\n\treturn builder.format( code, type, output );\r\n\r\n};\r\n\r\nJoinNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tfor ( var prop in source.inputs ) {\r\n\r\n\t\tthis[ prop ] = source.inputs[ prop ];\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nJoinNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.inputs = {};\r\n\r\n\t\tvar length = this.getNumElements();\r\n\r\n\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\tvar elm = this[ inputs[ i ] ];\r\n\r\n\t\t\tif ( elm ) {\r\n\r\n\t\t\t\tdata.inputs[ inputs[ i ] ] = elm.toJSON( meta ).uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { JoinNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/JoinNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { ConstNode } from '../core/ConstNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\n\r\nfunction LuminanceNode( rgb ) {\r\n\r\n\tTempNode.call( this, 'f' );\r\n\r\n\tthis.rgb = rgb;\r\n\r\n}\r\n\r\nLuminanceNode.Nodes = ( function () {\r\n\r\n\tvar LUMA = new ConstNode( \"vec3 LUMA vec3( 0.2125, 0.7154, 0.0721 )\" );\r\n\r\n\tvar luminance = new FunctionNode( [\r\n\t\t// Algorithm from Chapter 10 of Graphics Shaders\r\n\t\t\"float luminance( vec3 rgb ) {\",\r\n\r\n\t\t\"\treturn dot( rgb, LUMA );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ), [ LUMA ] );\r\n\r\n\treturn {\r\n\t\tLUMA: LUMA,\r\n\t\tluminance: luminance\r\n\t};\r\n\r\n} )();\r\n\r\nLuminanceNode.prototype = Object.create( TempNode.prototype );\r\nLuminanceNode.prototype.constructor = LuminanceNode;\r\nLuminanceNode.prototype.nodeType = \"Luminance\";\r\n\r\nLuminanceNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar luminance = builder.include( LuminanceNode.Nodes.luminance );\r\n\r\n\treturn builder.format( luminance + '( ' + this.rgb.build( builder, 'v3' ) + ' )', this.getType( builder ), output );\r\n\r\n};\r\n\r\nLuminanceNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.rgb = source.rgb;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nLuminanceNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.rgb = this.rgb.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { LuminanceNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/effects/LuminanceNode.js","import { Node } from '../core/Node.js';\r\n\r\nfunction SwitchNode( node, components ) {\r\n\r\n\tNode.call( this );\r\n\r\n\tthis.node = node;\r\n\tthis.components = components || 'x';\r\n\r\n}\r\n\r\nSwitchNode.prototype = Object.create( Node.prototype );\r\nSwitchNode.prototype.constructor = SwitchNode;\r\nSwitchNode.prototype.nodeType = \"Switch\";\r\n\r\nSwitchNode.prototype.getType = function ( builder ) {\r\n\r\n\treturn builder.getTypeFromLength( this.components.length );\r\n\r\n};\r\n\r\nSwitchNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar type = this.node.getType( builder ),\r\n\t\tnode = this.node.build( builder, type ),\r\n\t\tinputLength = builder.getTypeLength( type ) - 1;\r\n\r\n\tif ( inputLength > 0 ) {\r\n\r\n\t\t// get max length\r\n\r\n\t\tvar outputLength = 0,\r\n\t\t\tcomponents = builder.colorToVectorProperties( this.components );\r\n\r\n\t\tvar i, len = components.length;\r\n\r\n\t\tfor ( i = 0; i < len; i ++ ) {\r\n\r\n\t\t\toutputLength = Math.max( outputLength, builder.getIndexByElement( components.charAt( i ) ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( outputLength > inputLength ) outputLength = inputLength;\r\n\r\n\t\t// split\r\n\r\n\t\tnode += '.';\r\n\r\n\t\tfor ( i = 0; i < len; i ++ ) {\r\n\r\n\t\t\tvar idx = builder.getIndexByElement( components.charAt( i ) );\r\n\r\n\t\t\tif ( idx > outputLength ) idx = outputLength;\r\n\r\n\t\t\tnode += builder.getElementByIndex( idx );\r\n\r\n\t\t}\r\n\r\n\t\treturn builder.format( node, this.getType( builder ), output );\r\n\r\n\t} else {\r\n\r\n\t\t// join\r\n\r\n\t\treturn builder.format( node, type, output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nSwitchNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\tthis.node = source.node;\r\n\tthis.components = source.components;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nSwitchNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.node = this.node.toJSON( meta ).uuid;\r\n\t\tdata.components = this.components;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { SwitchNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/SwitchNode.js","import { FloatNode } from '../inputs/FloatNode.js';\r\nimport { NodeLib } from '../core/NodeLib.js';\r\n\r\nfunction TimerNode( scale, scope, timeScale ) {\r\n\r\n\tFloatNode.call( this );\r\n\r\n\tthis.scale = scale !== undefined ? scale : 1;\r\n\tthis.scope = scope || TimerNode.GLOBAL;\r\n\r\n\tthis.timeScale = timeScale !== undefined ? timeScale : scale !== undefined;\r\n\r\n}\r\n\r\nTimerNode.GLOBAL = 'global';\r\nTimerNode.LOCAL = 'local';\r\nTimerNode.DELTA = 'delta';\r\n\r\nTimerNode.prototype = Object.create( FloatNode.prototype );\r\nTimerNode.prototype.constructor = TimerNode;\r\nTimerNode.prototype.nodeType = \"Timer\";\r\n\r\nTimerNode.prototype.getReadonly = function () {\r\n\r\n\t// never use TimerNode as readonly but aways as \"uniform\"\r\n\r\n\treturn false;\r\n\r\n};\r\n\r\nTimerNode.prototype.getUnique = function () {\r\n\r\n\t// share TimerNode \"uniform\" input if is used on more time with others TimerNode\r\n\r\n\treturn this.timeScale && ( this.scope === TimerNode.GLOBAL || this.scope === TimerNode.DELTA );\r\n\r\n};\r\n\r\nTimerNode.prototype.updateFrame = function ( frame ) {\r\n\r\n\tvar scale = this.timeScale ? this.scale : 1;\r\n\r\n\tswitch ( this.scope ) {\r\n\r\n\t\tcase TimerNode.LOCAL:\r\n\r\n\t\t\tthis.value += frame.delta * scale;\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase TimerNode.DELTA:\r\n\r\n\t\t\tthis.value = frame.delta * scale;\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\r\n\t\t\tthis.value = frame.time * scale;\r\n\r\n\t}\r\n\r\n};\r\n\r\nTimerNode.prototype.copy = function ( source ) {\r\n\r\n\tFloatNode.prototype.copy.call( this, source );\r\n\r\n\tthis.scope = source.scope;\r\n\tthis.scale = source.scale;\r\n\r\n\tthis.timeScale = source.timeScale;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nTimerNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.scope = this.scope;\r\n\t\tdata.scale = this.scale;\r\n\r\n\t\tdata.timeScale = this.timeScale;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nNodeLib.addKeyword( 'time', function () {\r\n\r\n\treturn new TimerNode();\r\n\r\n} );\r\n\r\nexport { TimerNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/TimerNode.js","import { Vector3 } from '@/components/build/three.module.js';\r\n\r\nimport { Vector3Node } from '../inputs/Vector3Node.js';\r\n\r\nfunction VelocityNode( target, params ) {\r\n\r\n\tVector3Node.call( this );\r\n\r\n\tthis.params = {};\r\n\r\n\tthis.velocity = new Vector3();\r\n\r\n\tthis.setTarget( target );\r\n\tthis.setParams( params );\r\n\r\n}\r\n\r\nVelocityNode.prototype = Object.create( Vector3Node.prototype );\r\nVelocityNode.prototype.constructor = VelocityNode;\r\nVelocityNode.prototype.nodeType = \"Velocity\";\r\n\r\nVelocityNode.prototype.getReadonly = function ( /*builder*/ ) {\r\n\r\n\treturn false;\r\n\r\n};\r\n\r\nVelocityNode.prototype.setParams = function ( params ) {\r\n\r\n\tswitch ( this.params.type ) {\r\n\r\n\t\tcase \"elastic\":\r\n\r\n\t\t\tdelete this.moment;\r\n\r\n\t\t\tdelete this.speed;\r\n\t\t\tdelete this.springVelocity;\r\n\r\n\t\t\tdelete this.lastVelocity;\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\tthis.params = params || {};\r\n\r\n\tswitch ( this.params.type ) {\r\n\r\n\t\tcase \"elastic\":\r\n\r\n\t\t\tthis.moment = new Vector3();\r\n\r\n\t\t\tthis.speed = new Vector3();\r\n\t\t\tthis.springVelocity = new Vector3();\r\n\r\n\t\t\tthis.lastVelocity = new Vector3();\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n};\r\n\r\nVelocityNode.prototype.setTarget = function ( target ) {\r\n\r\n\tif ( this.target ) {\r\n\r\n\t\tdelete this.position;\r\n\t\tdelete this.oldPosition;\r\n\r\n\t}\r\n\r\n\tthis.target = target;\r\n\r\n\tif ( target ) {\r\n\r\n\t\tthis.position = target.getWorldPosition( this.position || new Vector3() );\r\n\t\tthis.oldPosition = this.position.clone();\r\n\r\n\t}\r\n\r\n};\r\n\r\nVelocityNode.prototype.updateFrameVelocity = function ( /*frame*/ ) {\r\n\r\n\tif ( this.target ) {\r\n\r\n\t\tthis.position = this.target.getWorldPosition( this.position || new Vector3() );\r\n\t\tthis.velocity.subVectors( this.position, this.oldPosition );\r\n\t\tthis.oldPosition.copy( this.position );\r\n\r\n\t}\r\n\r\n};\r\n\r\nVelocityNode.prototype.updateFrame = function ( frame ) {\r\n\r\n\tthis.updateFrameVelocity( frame );\r\n\r\n\tswitch ( this.params.type ) {\r\n\r\n\t\tcase \"elastic\":\r\n\r\n\t\t\t// convert to real scale: 0 at 1 values\r\n\t\t\tvar deltaFps = frame.delta * ( this.params.fps || 60 );\r\n\r\n\t\t\tvar spring = Math.pow( this.params.spring, deltaFps ),\r\n\t\t\t\tdamping = Math.pow( this.params.damping, deltaFps );\r\n\r\n\t\t\t// fix relative frame-rate\r\n\t\t\tthis.velocity.multiplyScalar( Math.exp( - this.params.damping * deltaFps ) );\r\n\r\n\t\t\t// elastic\r\n\t\t\tthis.velocity.add( this.springVelocity );\r\n\t\t\tthis.velocity.add( this.speed.multiplyScalar( damping ).multiplyScalar( 1 - spring ) );\r\n\r\n\t\t\t// speed\r\n\t\t\tthis.speed.subVectors( this.velocity, this.lastVelocity );\r\n\r\n\t\t\t// spring velocity\r\n\t\t\tthis.springVelocity.add( this.speed );\r\n\t\t\tthis.springVelocity.multiplyScalar( spring );\r\n\r\n\t\t\t// moment\r\n\t\t\tthis.moment.add( this.springVelocity );\r\n\r\n\t\t\t// damping\r\n\t\t\tthis.moment.multiplyScalar( damping );\r\n\r\n\t\t\tthis.lastVelocity.copy( this.velocity );\r\n\t\t\tthis.value.copy( this.moment );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\r\n\t\t\tthis.value.copy( this.velocity );\r\n\r\n\t}\r\n\r\n};\r\n\r\nVelocityNode.prototype.copy = function ( source ) {\r\n\r\n\tVector3Node.prototype.copy.call( this, source );\r\n\r\n\tif ( source.target ) this.setTarget( source.target );\r\n\r\n\tthis.setParams( source.params );\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nVelocityNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tif ( this.target ) data.target = this.target.uuid;\r\n\r\n\t\t// clone params\r\n\t\tdata.params = JSON.parse( JSON.stringify( this.params ) );\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { VelocityNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/VelocityNode.js","import { ExpressionNode } from '../core/ExpressionNode.js';\r\nimport { Matrix3Node } from '../inputs/Matrix3Node.js';\r\nimport { UVNode } from '../accessors/UVNode.js';\r\n\r\nfunction UVTransformNode( uv, position ) {\r\n\r\n\tExpressionNode.call( this, \"( uvTransform * vec3( uvNode, 1 ) ).xy\", \"vec2\" );\r\n\r\n\tthis.uv = uv || new UVNode();\r\n\tthis.position = position || new Matrix3Node();\r\n\r\n}\r\n\r\nUVTransformNode.prototype = Object.create( ExpressionNode.prototype );\r\nUVTransformNode.prototype.constructor = UVTransformNode;\r\nUVTransformNode.prototype.nodeType = \"UVTransform\";\r\n\r\nUVTransformNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tthis.keywords[ \"uvNode\" ] = this.uv;\r\n\tthis.keywords[ \"uvTransform\" ] = this.position;\r\n\r\n\treturn ExpressionNode.prototype.generate.call( this, builder, output );\r\n\r\n};\r\n\r\nUVTransformNode.prototype.setUvTransform = function ( tx, ty, sx, sy, rotation, cx, cy ) {\r\n\r\n\tcx = cx !== undefined ? cx : .5;\r\n\tcy = cy !== undefined ? cy : .5;\r\n\r\n\tthis.position.value.setUvTransform( tx, ty, sx, sy, rotation, cx, cy );\r\n\r\n};\r\n\r\nUVTransformNode.prototype.copy = function ( source ) {\r\n\r\n\tExpressionNode.prototype.copy.call( this, source );\r\n\r\n\tthis.uv = source.uv;\r\n\tthis.position = source.position;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nUVTransformNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.uv = this.uv.toJSON( meta ).uuid;\r\n\t\tdata.position = this.position.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { UVTransformNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/UVTransformNode.js","import { FloatNode } from '../inputs/FloatNode.js';\r\n\r\nfunction MaxMIPLevelNode( texture ) {\r\n\r\n\tFloatNode.call( this );\r\n\r\n\tthis.texture = texture;\r\n\r\n\tthis.maxMIPLevel = 0;\r\n\r\n}\r\n\r\nMaxMIPLevelNode.prototype = Object.create( FloatNode.prototype );\r\nMaxMIPLevelNode.prototype.constructor = MaxMIPLevelNode;\r\nMaxMIPLevelNode.prototype.nodeType = \"MaxMIPLevel\";\r\n\r\nObject.defineProperties( MaxMIPLevelNode.prototype, {\r\n\r\n\tvalue: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tif ( this.maxMIPLevel === 0 ) {\r\n\r\n\t\t\t\tvar image = this.texture.value.image;\r\n\r\n\t\t\t\tif ( Array.isArray( image ) ) image = image[ 0 ];\r\n\r\n\t\t\t\tthis.maxMIPLevel = image !== undefined ? Math.log( Math.max( image.width, image.height ) ) * Math.LOG2E : 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.maxMIPLevel;\r\n\r\n\t\t},\r\n\r\n\t\tset: function () { }\r\n\r\n\t}\r\n\r\n} );\r\n\r\nMaxMIPLevelNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.texture = this.texture.uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { MaxMIPLevelNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/MaxMIPLevelNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { MaxMIPLevelNode } from './MaxMIPLevelNode.js';\r\n\r\nfunction SpecularMIPLevelNode( roughness, texture ) {\r\n\r\n\tTempNode.call( this, 'f' );\r\n\r\n\tthis.roughness = roughness;\r\n\tthis.texture = texture;\r\n\r\n\tthis.maxMIPLevel = undefined;\r\n\r\n}\r\n\r\nSpecularMIPLevelNode.Nodes = ( function () {\r\n\r\n\tvar getSpecularMIPLevel = new FunctionNode( [\r\n\t\t// taken from here: http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\r\n\t\t\"float getSpecularMIPLevel( const in float roughness, const in float maxMIPLevelScalar ) {\",\r\n\r\n\t\t\"\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\",\r\n\t\t\"\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\",\r\n\r\n\t\t// clamp to allowable LOD ranges.\r\n\t\t\"\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\treturn {\r\n\t\tgetSpecularMIPLevel: getSpecularMIPLevel\r\n\t};\r\n\r\n} )();\r\n\r\nSpecularMIPLevelNode.prototype = Object.create( TempNode.prototype );\r\nSpecularMIPLevelNode.prototype.constructor = SpecularMIPLevelNode;\r\nSpecularMIPLevelNode.prototype.nodeType = \"SpecularMIPLevel\";\r\n\r\nSpecularMIPLevelNode.prototype.setTexture = function ( texture ) {\r\n\r\n\tthis.texture = texture;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nSpecularMIPLevelNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tthis.maxMIPLevel = this.maxMIPLevel || new MaxMIPLevelNode();\r\n\t\tthis.maxMIPLevel.texture = this.texture;\r\n\r\n\t\tvar getSpecularMIPLevel = builder.include( SpecularMIPLevelNode.Nodes.getSpecularMIPLevel );\r\n\r\n\t\treturn builder.format( getSpecularMIPLevel + '( ' + this.roughness.build( builder, 'f' ) + ', ' + this.maxMIPLevel.build( builder, 'f' ) + ' )', this.type, output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.SpecularMIPLevelNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( '0.0', this.type, output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nSpecularMIPLevelNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.texture = source.texture;\r\n\tthis.roughness = source.roughness;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nSpecularMIPLevelNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.texture = this.texture;\r\n\t\tdata.roughness = this.roughness;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { SpecularMIPLevelNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/SpecularMIPLevelNode.js","import { TempNode } from '../core/TempNode.js';\r\n\r\nfunction SubSlotNode( slots ) {\r\n\r\n\tTempNode.call( this );\r\n\r\n\tthis.slots = slots || {};\r\n\r\n}\r\n\r\nSubSlotNode.prototype = Object.create( TempNode.prototype );\r\nSubSlotNode.prototype.constructor = SubSlotNode;\r\nSubSlotNode.prototype.nodeType = \"SubSlot\";\r\n\r\nSubSlotNode.prototype.getType = function ( builder, output ) {\r\n\r\n\treturn output;\r\n\r\n};\r\n\r\nSubSlotNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( this.slots[ builder.slot ] ) {\r\n\r\n\t\treturn this.slots[ builder.slot ].build( builder, output );\r\n\r\n\t}\r\n\r\n\treturn builder.format( '0.0', 'f', output );\r\n\r\n};\r\n\r\nSubSlotNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tfor ( var prop in source.slots ) {\r\n\r\n\t\tthis.slots[ prop ] = source.slots[ prop ];\r\n\r\n\t}\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nSubSlotNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.slots = {};\r\n\r\n\t\tfor ( var prop in this.slots ) {\r\n\r\n\t\t\tvar slot = this.slots[ prop ];\r\n\r\n\t\t\tif ( slot ) {\r\n\r\n\t\t\t\tdata.slots[ prop ] = slot.toJSON( meta ).uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { SubSlotNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/utils/SubSlotNode.js","import { Vector2 } from '@/components/build/three.module.js';\r\n\r\nimport { TempNode } from '../core/TempNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { FloatNode } from '../inputs/FloatNode.js';\r\nimport { Vector2Node } from '../inputs/Vector2Node.js';\r\nimport { UVNode } from '../accessors/UVNode.js';\r\n\r\nfunction BlurNode( value, uv, radius, size ) {\r\n\r\n\tTempNode.call( this, 'v4' );\r\n\r\n\tthis.value = value;\r\n\tthis.uv = uv || new UVNode();\r\n\tthis.radius = radius || new Vector2Node( 1, 1 );\r\n\r\n\tthis.size = size;\r\n\r\n\tthis.blurX = true;\r\n\tthis.blurY = true;\r\n\r\n\tthis.horizontal = new FloatNode( 1 / 64 );\r\n\tthis.vertical = new FloatNode( 1 / 64 );\r\n\r\n}\r\n\r\nBlurNode.Nodes = ( function () {\r\n\r\n\tvar blurX = new FunctionNode( [\r\n\t\t\"vec4 blurX( sampler2D tex, vec2 uv, float s ) {\",\r\n\t\t\"\tvec4 sum = vec4( 0.0 );\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y ) ) * 0.1633;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;\",\r\n\t\t\"\treturn sum * .667;\",\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar blurY = new FunctionNode( [\r\n\t\t\"vec4 blurY( sampler2D tex, vec2 uv, float s ) {\",\r\n\t\t\"\tvec4 sum = vec4( 0.0 );\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y ) ) * 0.1633;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;\",\r\n\t\t\"\tsum += texture2D( tex, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;\",\r\n\t\t\"\treturn sum * .667;\",\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\treturn {\r\n\t\tblurX: blurX,\r\n\t\tblurY: blurY\r\n\t};\r\n\r\n} )();\r\n\r\n\r\nBlurNode.prototype = Object.create( TempNode.prototype );\r\nBlurNode.prototype.constructor = BlurNode;\r\nBlurNode.prototype.nodeType = \"Blur\";\r\nBlurNode.prototype.hashProperties = [ \"blurX\", \"blurY\" ];\r\n\r\nBlurNode.prototype.updateFrame = function ( /* frame */ ) {\r\n\r\n\tif ( this.size ) {\r\n\r\n\t\tthis.horizontal.value = this.radius.x / this.size.x;\r\n\t\tthis.vertical.value = this.radius.y / this.size.y;\r\n\r\n\t} else if ( this.value.value && this.value.value.image ) {\r\n\r\n\t\tvar image = this.value.value.image;\r\n\r\n\t\tthis.horizontal.value = this.radius.x / image.width;\r\n\t\tthis.vertical.value = this.radius.y / image.height;\r\n\r\n\t}\r\n\r\n};\r\n\r\nBlurNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\tvar blurCode = [], code;\r\n\r\n\t\tvar blurX = builder.include( BlurNode.Nodes.blurX ),\r\n\t\t\tblurY = builder.include( BlurNode.Nodes.blurY );\r\n\r\n\t\tif ( this.blurX ) {\r\n\r\n\t\t\tblurCode.push( blurX + '( ' + this.value.build( builder, 'sampler2D' ) + ', ' + this.uv.build( builder, 'v2' ) + ', ' + this.horizontal.build( builder, 'f' ) + ' )' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.blurY ) {\r\n\r\n\t\t\tblurCode.push( blurY + '( ' + this.value.build( builder, 'sampler2D' ) + ', ' + this.uv.build( builder, 'v2' ) + ', ' + this.vertical.build( builder, 'f' ) + ' )' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( blurCode.length == 2 ) code = '( ' + blurCode.join( ' + ' ) + ' / 2.0 )';\r\n\t\telse if ( blurCode.length ) code = '( ' + blurCode[ 0 ] + ' )';\r\n\t\telse code = 'vec4( 0.0 )';\r\n\r\n\t\treturn builder.format( code, this.getType( builder ), output );\r\n\r\n\t} else {\r\n\r\n\t\tconsole.warn( \"THREE.BlurNode is not compatible with \" + builder.shader + \" shader.\" );\r\n\r\n\t\treturn builder.format( 'vec4( 0.0 )', this.getType( builder ), output );\r\n\r\n\t}\r\n\r\n};\r\n\r\nBlurNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.value = source.value;\r\n\tthis.uv = source.uv;\r\n\tthis.radius = source.radius;\r\n\r\n\tif ( source.size !== undefined ) this.size = new Vector2( source.size.x, source.size.y );\r\n\r\n\tthis.blurX = source.blurX;\r\n\tthis.blurY = source.blurY;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nBlurNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.value = this.value.toJSON( meta ).uuid;\r\n\t\tdata.uv = this.uv.toJSON( meta ).uuid;\r\n\t\tdata.radius = this.radius.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.size ) data.size = { x: this.size.x, y: this.size.y };\r\n\r\n\t\tdata.blurX = this.blurX;\r\n\t\tdata.blurY = this.blurY;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { BlurNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/effects/BlurNode.js","import { TempNode } from '../core/TempNode.js';\r\nimport { FunctionNode } from '../core/FunctionNode.js';\r\nimport { LuminanceNode } from './LuminanceNode.js';\r\n\r\nfunction ColorAdjustmentNode( rgb, adjustment, method ) {\r\n\r\n\tTempNode.call( this, 'v3' );\r\n\r\n\tthis.rgb = rgb;\r\n\tthis.adjustment = adjustment;\r\n\r\n\tthis.method = method || ColorAdjustmentNode.SATURATION;\r\n\r\n}\r\n\r\nColorAdjustmentNode.Nodes = ( function () {\r\n\r\n\tvar hue = new FunctionNode( [\r\n\t\t\"vec3 hue(vec3 rgb, float adjustment) {\",\r\n\r\n\t\t\"\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);\",\r\n\t\t\"\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);\",\r\n\r\n\t\t\"\tvec3 yiq = RGBtoYIQ * rgb;\",\r\n\r\n\t\t\"\tfloat hue = atan(yiq.z, yiq.y) + adjustment;\",\r\n\t\t\"\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\",\r\n\r\n\t\t\"\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\tvar saturation = new FunctionNode( [\r\n\t\t// Algorithm from Chapter 16 of OpenGL Shading Language\r\n\t\t\"vec3 saturation(vec3 rgb, float adjustment) {\",\r\n\r\n\t\t\"\tvec3 intensity = vec3( luminance( rgb ) );\",\r\n\r\n\t\t\"\treturn mix( intensity, rgb, adjustment );\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ), [ LuminanceNode.Nodes.luminance ] ); // include LuminanceNode function\r\n\r\n\tvar vibrance = new FunctionNode( [\r\n\t\t// Shader by Evan Wallace adapted by @lo-th\r\n\t\t\"vec3 vibrance(vec3 rgb, float adjustment) {\",\r\n\r\n\t\t\"\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;\",\r\n\r\n\t\t\"\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));\",\r\n\t\t\"\tfloat amt = (mx - average) * (-3.0 * adjustment);\",\r\n\r\n\t\t\"\treturn mix(rgb.rgb, vec3(mx), amt);\",\r\n\r\n\t\t\"}\"\r\n\t].join( \"\\n\" ) );\r\n\r\n\treturn {\r\n\t\thue: hue,\r\n\t\tsaturation: saturation,\r\n\t\tvibrance: vibrance\r\n\t};\r\n\r\n} )();\r\n\r\nColorAdjustmentNode.SATURATION = 'saturation';\r\nColorAdjustmentNode.HUE = 'hue';\r\nColorAdjustmentNode.VIBRANCE = 'vibrance';\r\nColorAdjustmentNode.BRIGHTNESS = 'brightness';\r\nColorAdjustmentNode.CONTRAST = 'contrast';\r\n\r\nColorAdjustmentNode.prototype = Object.create( TempNode.prototype );\r\nColorAdjustmentNode.prototype.constructor = ColorAdjustmentNode;\r\nColorAdjustmentNode.prototype.nodeType = \"ColorAdjustment\";\r\nColorAdjustmentNode.prototype.hashProperties = [ \"method\" ];\r\n\r\nColorAdjustmentNode.prototype.generate = function ( builder, output ) {\r\n\r\n\tvar rgb = this.rgb.build( builder, 'v3' ),\r\n\t\tadjustment = this.adjustment.build( builder, 'f' );\r\n\r\n\tswitch ( this.method ) {\r\n\r\n\t\tcase ColorAdjustmentNode.BRIGHTNESS:\r\n\r\n\t\t\treturn builder.format( '( ' + rgb + ' + ' + adjustment + ' )', this.getType( builder ), output );\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase ColorAdjustmentNode.CONTRAST:\r\n\r\n\t\t\treturn builder.format( '( ' + rgb + ' * ' + adjustment + ' )', this.getType( builder ), output );\r\n\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n\tvar method = builder.include( ColorAdjustmentNode.Nodes[ this.method ] );\r\n\r\n\treturn builder.format( method + '( ' + rgb + ', ' + adjustment + ' )', this.getType( builder ), output );\r\n\r\n};\r\n\r\nColorAdjustmentNode.prototype.copy = function ( source ) {\r\n\r\n\tTempNode.prototype.copy.call( this, source );\r\n\r\n\tthis.rgb = source.rgb;\r\n\tthis.adjustment = source.adjustment;\r\n\tthis.method = source.method;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nColorAdjustmentNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.rgb = this.rgb.toJSON( meta ).uuid;\r\n\t\tdata.adjustment = this.adjustment.toJSON( meta ).uuid;\r\n\t\tdata.method = this.method;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { ColorAdjustmentNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/effects/ColorAdjustmentNode.js","import { Node } from '../../core/Node.js';\r\nimport { ColorNode } from '../../inputs/ColorNode.js';\r\n\r\nfunction BasicNode() {\r\n\r\n\tNode.call( this );\r\n\r\n\tthis.color = new ColorNode( 0xFFFFFF );\r\n\r\n}\r\n\r\nBasicNode.prototype = Object.create( Node.prototype );\r\nBasicNode.prototype.constructor = BasicNode;\r\nBasicNode.prototype.nodeType = \"Basic\";\r\n\r\nBasicNode.prototype.generate = function ( builder ) {\r\n\r\n\tvar code;\r\n\r\n\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\tvar position = this.position ? this.position.analyzeAndFlow( builder, 'v3', { cache: 'position' } ) : undefined;\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"varying vec3 vViewPosition;\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\",\r\n\r\n\t\t\t\" varying vec3 vNormal;\",\r\n\r\n\t\t\t\"#endif\",\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\tvar output = [\r\n\t\t\t\"#include <beginnormal_vertex>\",\r\n\t\t\t\"#include <defaultnormal_vertex>\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\r\n\t\t\t\" vNormal = normalize( transformedNormal );\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t\"#include <begin_vertex>\",\r\n\t\t];\r\n\r\n\t\tif ( position ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tposition.code,\r\n\t\t\t\tposition.result ? \"transformed = \" + position.result + \";\" : ''\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <morphtarget_vertex>\",\r\n\t\t\t\"#include <skinning_vertex>\",\r\n\t\t\t\"#include <project_vertex>\",\r\n\t\t\t\"#include <fog_vertex>\",\r\n\t\t\t\"#include <logdepthbuf_vertex>\",\r\n\t\t\t\"#include <clipping_planes_vertex>\",\r\n\r\n\t\t\t\"\tvViewPosition = - mvPosition.xyz;\",\r\n\r\n\t\t\t\"#include <worldpos_vertex>\",\r\n\t\t\t\"#include <shadowmap_vertex>\"\r\n\t\t);\r\n\r\n\t\tcode = output.join( \"\\n\" );\r\n\r\n\t} else {\r\n\r\n\t\t// Analyze all nodes to reuse generate codes\r\n\t\tthis.color.analyze( builder, { slot: 'color' } );\r\n\r\n\t\tif ( this.alpha ) this.alpha.analyze( builder );\r\n\t\tif ( this.mask ) this.mask.analyze( builder );\r\n\r\n\t\t// Build code\r\n\t\tvar color = this.color.flow( builder, 'c', { slot: 'color' } );\r\n\t\tvar alpha = this.alpha ? this.alpha.flow( builder, 'f' ) : undefined;\r\n\t\tvar mask = this.mask ? this.mask.flow( builder, 'b' ) : undefined;\r\n\r\n\t\tbuilder.requires.transparent = alpha !== undefined;\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"varying vec3 vViewPosition;\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\",\r\n\r\n\t\t\t\" varying vec3 vNormal;\",\r\n\r\n\t\t\t\"#endif\",\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\tvar output = [\r\n\t\t\t// add before: prevent undeclared normal\r\n\t\t\t\"#include <normal_fragment_begin>\",\r\n\r\n\t\t\tcolor.code,\r\n\t\t];\r\n\r\n\t\tif ( mask ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tmask.code,\r\n\t\t\t\t'if ( ! ' + mask.result + ' ) discard;'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( alpha ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\talpha.code,\r\n\t\t\t\t'#ifdef ALPHATEST',\r\n\r\n\t\t\t\t' if ( ' + alpha.result + ' <= ALPHATEST ) discard;',\r\n\r\n\t\t\t\t'#endif'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( alpha ) {\r\n\r\n\t\t\toutput.push( \"gl_FragColor = vec4(\" + color.result + \", \" + alpha.result + \" );\" );\r\n\r\n\t\t} else {\r\n\r\n\t\t\toutput.push( \"gl_FragColor = vec4(\" + color.result + \", 1.0 );\" );\r\n\r\n\t\t}\r\n\r\n\t\tcode = output.join( \"\\n\" );\r\n\r\n\t}\r\n\r\n\treturn code;\r\n\r\n};\r\n\r\nBasicNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\tthis.color = source.color;\r\n\r\n\tif ( source.position ) this.position = source.position;\r\n\tif ( source.alpha ) this.alpha = source.alpha;\r\n\tif ( source.mask ) this.mask = source.mask;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nBasicNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tdata.color = this.color.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.position ) data.position = this.position.toJSON( meta ).uuid;\r\n\t\tif ( this.alpha ) data.alpha = this.alpha.toJSON( meta ).uuid;\r\n\t\tif ( this.mask ) data.mask = this.mask.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { BasicNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/nodes/BasicNode.js","import {\r\n\tUniformsLib,\r\n\tUniformsUtils\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { Node } from '../../core/Node.js';\r\nimport { ColorNode } from '../../inputs/ColorNode.js';\r\n\r\nfunction SpriteNode() {\r\n\r\n\tNode.call( this );\r\n\r\n\tthis.color = new ColorNode( 0xEEEEEE );\r\n\tthis.spherical = true;\r\n\r\n}\r\n\r\nSpriteNode.prototype = Object.create( Node.prototype );\r\nSpriteNode.prototype.constructor = SpriteNode;\r\nSpriteNode.prototype.nodeType = \"Sprite\";\r\n\r\nSpriteNode.prototype.build = function ( builder ) {\r\n\r\n\tvar output;\r\n\r\n\tbuilder.define( 'SPRITE' );\r\n\r\n\tbuilder.requires.lights = false;\r\n\tbuilder.requires.transparent = this.alpha !== undefined;\r\n\r\n\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\tvar position = this.position ? this.position.analyzeAndFlow( builder, 'v3', { cache: 'position' } ) : undefined;\r\n\r\n\t\tbuilder.mergeUniform( UniformsUtils.merge( [\r\n\t\t\tUniformsLib.fog\r\n\t\t] ) );\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"#include <fog_pars_vertex>\",\r\n\t\t\t\"#include <logdepthbuf_pars_vertex>\",\r\n\t\t\t\"#include <clipping_planes_pars_vertex>\"\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\toutput = [\r\n\t\t\t\"#include <clipping_planes_fragment>\",\r\n\t\t\t\"#include <begin_vertex>\"\r\n\t\t];\r\n\r\n\t\tif ( position ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tposition.code,\r\n\t\t\t\tposition.result ? \"transformed = \" + position.result + \";\" : ''\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <project_vertex>\",\r\n\t\t\t\"#include <fog_vertex>\",\r\n\r\n\t\t\t'mat4 modelViewMtx = modelViewMatrix;',\r\n\t\t\t'mat4 modelMtx = modelMatrix;',\r\n\r\n\t\t\t// ignore position from modelMatrix (use vary position)\r\n\t\t\t'modelMtx[3][0] = 0.0;',\r\n\t\t\t'modelMtx[3][1] = 0.0;',\r\n\t\t\t'modelMtx[3][2] = 0.0;'\r\n\t\t);\r\n\r\n\t\tif ( ! this.spherical ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\t'modelMtx[1][1] = 1.0;'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t// http://www.geeks3d.com/20140807/billboarding-vertex-shader-glsl/\r\n\t\t\t// First colunm.\r\n\t\t\t'modelViewMtx[0][0] = 1.0;',\r\n\t\t\t'modelViewMtx[0][1] = 0.0;',\r\n\t\t\t'modelViewMtx[0][2] = 0.0;'\r\n\t\t);\r\n\r\n\t\tif ( this.spherical ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\t// Second colunm.\r\n\t\t\t\t'modelViewMtx[1][0] = 0.0;',\r\n\t\t\t\t'modelViewMtx[1][1] = 1.0;',\r\n\t\t\t\t'modelViewMtx[1][2] = 0.0;'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t// Thrid colunm.\r\n\t\t\t'modelViewMtx[2][0] = 0.0;',\r\n\t\t\t'modelViewMtx[2][1] = 0.0;',\r\n\t\t\t'modelViewMtx[2][2] = 1.0;',\r\n\r\n\t\t\t\"gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );\",\r\n\r\n\t\t\t\"#include <logdepthbuf_vertex>\",\r\n\t\t\t\"#include <clipping_planes_vertex>\",\r\n\t\t\t\"#include <fog_vertex>\"\r\n\t\t);\r\n\r\n\t} else {\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"#include <fog_pars_fragment>\",\r\n\t\t\t\"#include <logdepthbuf_pars_fragment>\",\r\n\t\t\t\"#include <clipping_planes_pars_fragment>\"\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\tbuilder.addCode( [\r\n\t\t\t\"#include <clipping_planes_fragment>\",\r\n\t\t\t\"#include <logdepthbuf_fragment>\"\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\t// analyze all nodes to reuse generate codes\r\n\r\n\t\tif ( this.mask ) this.mask.analyze( builder );\r\n\r\n\t\tif ( this.alpha ) this.alpha.analyze( builder );\r\n\r\n\t\tthis.color.analyze( builder, { slot: 'color' } );\r\n\r\n\t\t// build code\r\n\r\n\t\tvar mask = this.mask ? this.mask.flow( builder, 'b' ) : undefined,\r\n\t\t\talpha = this.alpha ? this.alpha.flow( builder, 'f' ) : undefined,\r\n\t\t\tcolor = this.color.flow( builder, 'c', { slot: 'color' } ),\r\n\t\t\toutput = [];\r\n\r\n\t\tif ( mask ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tmask.code,\r\n\t\t\t\t'if ( ! ' + mask.result + ' ) discard;'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( alpha ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\talpha.code,\r\n\t\t\t\t'#ifdef ALPHATEST',\r\n\r\n\t\t\t\t'if ( ' + alpha.result + ' <= ALPHATEST ) discard;',\r\n\r\n\t\t\t\t'#endif',\r\n\t\t\t\tcolor.code,\r\n\t\t\t\t\"gl_FragColor = vec4( \" + color.result + \", \" + alpha.result + \" );\"\r\n\t\t\t);\r\n\r\n\t\t} else {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tcolor.code,\r\n\t\t\t\t\"gl_FragColor = vec4( \" + color.result + \", 1.0 );\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <tonemapping_fragment>\",\r\n\t\t\t\"#include <encodings_fragment>\",\r\n\t\t\t\"#include <fog_fragment>\"\r\n\t\t);\r\n\r\n\t}\r\n\r\n\treturn output.join( \"\\n\" );\r\n\r\n};\r\n\r\nSpriteNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\t// vertex\r\n\r\n\tif ( source.position ) this.position = source.position;\r\n\r\n\t// fragment\r\n\r\n\tthis.color = source.color;\r\n\r\n\tif ( source.spherical !== undefined ) this.spherical = source.spherical;\r\n\r\n\tif ( source.mask ) this.mask = source.mask;\r\n\r\n\tif ( source.alpha ) this.alpha = source.alpha;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nSpriteNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\t// vertex\r\n\r\n\t\tif ( this.position ) data.position = this.position.toJSON( meta ).uuid;\r\n\r\n\t\t// fragment\r\n\r\n\t\tdata.color = this.color.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.spherical === false ) data.spherical = false;\r\n\r\n\t\tif ( this.mask ) data.mask = this.mask.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.alpha ) data.alpha = this.alpha.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { SpriteNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/nodes/SpriteNode.js","import {\r\n\tUniformsLib,\r\n\tUniformsUtils\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { Node } from '../../core/Node.js';\r\nimport { ColorNode } from '../../inputs/ColorNode.js';\r\nimport { FloatNode } from '../../inputs/FloatNode.js';\r\n\r\nfunction PhongNode() {\r\n\r\n\tNode.call( this );\r\n\r\n\tthis.color = new ColorNode( 0xEEEEEE );\r\n\tthis.specular = new ColorNode( 0x111111 );\r\n\tthis.shininess = new FloatNode( 30 );\r\n\r\n}\r\n\r\nPhongNode.prototype = Object.create( Node.prototype );\r\nPhongNode.prototype.constructor = PhongNode;\r\nPhongNode.prototype.nodeType = \"Phong\";\r\n\r\nPhongNode.prototype.build = function ( builder ) {\r\n\r\n\tvar code;\r\n\r\n\tbuilder.define( 'PHONG' );\r\n\r\n\tbuilder.requires.lights = true;\r\n\r\n\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\tvar position = this.position ? this.position.analyzeAndFlow( builder, 'v3', { cache: 'position' } ) : undefined;\r\n\r\n\t\tbuilder.mergeUniform( UniformsUtils.merge( [\r\n\r\n\t\t\tUniformsLib.fog,\r\n\t\t\tUniformsLib.lights\r\n\r\n\t\t] ) );\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"varying vec3 vViewPosition;\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\",\r\n\r\n\t\t\t\"\tvarying vec3 vNormal;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t//\"#include <encodings_pars_fragment>\", // encoding functions\r\n\t\t\t\"#include <fog_pars_vertex>\",\r\n\t\t\t\"#include <morphtarget_pars_vertex>\",\r\n\t\t\t\"#include <skinning_pars_vertex>\",\r\n\t\t\t\"#include <shadowmap_pars_vertex>\",\r\n\t\t\t\"#include <logdepthbuf_pars_vertex>\",\r\n\t\t\t\"#include <clipping_planes_pars_vertex>\"\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\tvar output = [\r\n\t\t\t\"#include <beginnormal_vertex>\",\r\n\t\t\t\"#include <morphnormal_vertex>\",\r\n\t\t\t\"#include <skinbase_vertex>\",\r\n\t\t\t\"#include <skinnormal_vertex>\",\r\n\t\t\t\"#include <defaultnormal_vertex>\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\", // normal computed with derivatives when FLAT_SHADED\r\n\r\n\t\t\t\"\tvNormal = normalize( transformedNormal );\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t\"#include <begin_vertex>\"\r\n\t\t];\r\n\r\n\t\tif ( position ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tposition.code,\r\n\t\t\t\tposition.result ? \"transformed = \" + position.result + \";\" : ''\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"\t#include <morphtarget_vertex>\",\r\n\t\t\t\"\t#include <skinning_vertex>\",\r\n\t\t\t\"\t#include <project_vertex>\",\r\n\t\t\t\"\t#include <fog_vertex>\",\r\n\t\t\t\"\t#include <logdepthbuf_vertex>\",\r\n\t\t\t\"\t#include <clipping_planes_vertex>\",\r\n\r\n\t\t\t\"\tvViewPosition = - mvPosition.xyz;\",\r\n\r\n\t\t\t\"\t#include <worldpos_vertex>\",\r\n\t\t\t\"\t#include <shadowmap_vertex>\",\r\n\t\t\t\"\t#include <fog_vertex>\"\r\n\t\t);\r\n\r\n\t\tcode = output.join( \"\\n\" );\r\n\r\n\t} else {\r\n\r\n\t\t// analyze all nodes to reuse generate codes\r\n\r\n\t\tif ( this.mask ) this.mask.analyze( builder );\r\n\r\n\t\tthis.color.analyze( builder, { slot: 'color' } );\r\n\t\tthis.specular.analyze( builder );\r\n\t\tthis.shininess.analyze( builder );\r\n\r\n\t\tif ( this.alpha ) this.alpha.analyze( builder );\r\n\r\n\t\tif ( this.normal ) this.normal.analyze( builder );\r\n\r\n\t\tif ( this.light ) this.light.analyze( builder, { cache: 'light' } );\r\n\r\n\t\tif ( this.ao ) this.ao.analyze( builder );\r\n\t\tif ( this.ambient ) this.ambient.analyze( builder );\r\n\t\tif ( this.shadow ) this.shadow.analyze( builder );\r\n\t\tif ( this.emissive ) this.emissive.analyze( builder, { slot: 'emissive' } );\r\n\r\n\t\tif ( this.environment ) this.environment.analyze( builder, { slot: 'environment' } );\r\n\t\tif ( this.environmentAlpha && this.environment ) this.environmentAlpha.analyze( builder );\r\n\r\n\t\t// build code\r\n\r\n\t\tvar mask = this.mask ? this.mask.flow( builder, 'b' ) : undefined;\r\n\r\n\t\tvar color = this.color.flow( builder, 'c', { slot: 'color' } );\r\n\t\tvar specular = this.specular.flow( builder, 'c' );\r\n\t\tvar shininess = this.shininess.flow( builder, 'f' );\r\n\r\n\t\tvar alpha = this.alpha ? this.alpha.flow( builder, 'f' ) : undefined;\r\n\r\n\t\tvar normal = this.normal ? this.normal.flow( builder, 'v3' ) : undefined;\r\n\r\n\t\tvar light = this.light ? this.light.flow( builder, 'v3', { cache: 'light' } ) : undefined;\r\n\r\n\t\tvar ao = this.ao ? this.ao.flow( builder, 'f' ) : undefined;\r\n\t\tvar ambient = this.ambient ? this.ambient.flow( builder, 'c' ) : undefined;\r\n\t\tvar shadow = this.shadow ? this.shadow.flow( builder, 'c' ) : undefined;\r\n\t\tvar emissive = this.emissive ? this.emissive.flow( builder, 'c', { slot: 'emissive' } ) : undefined;\r\n\r\n\t\tvar environment = this.environment ? this.environment.flow( builder, 'c', { slot: 'environment' } ) : undefined;\r\n\t\tvar environmentAlpha = this.environmentAlpha && this.environment ? this.environmentAlpha.flow( builder, 'f' ) : undefined;\r\n\r\n\t\tbuilder.requires.transparent = alpha !== undefined;\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"#include <fog_pars_fragment>\",\r\n\t\t\t\"#include <bsdfs>\",\r\n\t\t\t\"#include <lights_pars_begin>\",\r\n\t\t\t\"#include <lights_phong_pars_fragment>\",\r\n\t\t\t\"#include <shadowmap_pars_fragment>\",\r\n\t\t\t\"#include <logdepthbuf_pars_fragment>\"\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\tvar output = [\r\n\t\t\t// prevent undeclared normal\r\n\t\t\t\"#include <normal_fragment_begin>\",\r\n\r\n\t\t\t// prevent undeclared material\r\n\t\t\t\"\tBlinnPhongMaterial material;\"\r\n\t\t];\r\n\r\n\t\tif ( mask ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tmask.code,\r\n\t\t\t\t'if ( ! ' + mask.result + ' ) discard;'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\tcolor.code,\r\n\t\t\t\"\tvec3 diffuseColor = \" + color.result + \";\",\r\n\t\t\t\"\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\",\r\n\r\n\t\t\t\"#include <logdepthbuf_fragment>\",\r\n\r\n\t\t\tspecular.code,\r\n\t\t\t\"\tvec3 specular = \" + specular.result + \";\",\r\n\r\n\t\t\tshininess.code,\r\n\t\t\t\"\tfloat shininess = max( 0.0001, \" + shininess.result + \" );\",\r\n\r\n\t\t\t\"\tfloat specularStrength = 1.0;\" // Ignored in MaterialNode ( replace to specular )\r\n\t\t);\r\n\r\n\t\tif ( alpha ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\talpha.code,\r\n\t\t\t\t'#ifdef ALPHATEST',\r\n\r\n\t\t\t\t'if ( ' + alpha.result + ' <= ALPHATEST ) discard;',\r\n\r\n\t\t\t\t'#endif'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( normal ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tnormal.code,\r\n\t\t\t\t'normal = ' + normal.result + ';'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\t// optimization for now\r\n\r\n\t\toutput.push( 'material.diffuseColor = ' + ( light ? 'vec3( 1.0 )' : 'diffuseColor' ) + ';' );\r\n\r\n\t\toutput.push(\r\n\t\t\t// accumulation\r\n\t\t\t'material.specularColor = specular;',\r\n\t\t\t'material.specularShininess = shininess;',\r\n\t\t\t'material.specularStrength = specularStrength;',\r\n\r\n\t\t\t\"#include <lights_fragment_begin>\",\r\n\t\t\t\"#include <lights_fragment_end>\"\r\n\t\t);\r\n\r\n\t\tif ( light ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tlight.code,\r\n\t\t\t\t\"reflectedLight.directDiffuse = \" + light.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t\t// apply color\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\t\"reflectedLight.directDiffuse *= diffuseColor;\",\r\n\t\t\t\t\"reflectedLight.indirectDiffuse *= diffuseColor;\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( ao ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tao.code,\r\n\t\t\t\t\"reflectedLight.indirectDiffuse *= \" + ao.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( ambient ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tambient.code,\r\n\t\t\t\t\"reflectedLight.indirectDiffuse += \" + ambient.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( shadow ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tshadow.code,\r\n\t\t\t\t\"reflectedLight.directDiffuse *= \" + shadow.result + \";\",\r\n\t\t\t\t\"reflectedLight.directSpecular *= \" + shadow.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( emissive ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\temissive.code,\r\n\t\t\t\t\"reflectedLight.directDiffuse += \" + emissive.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push( \"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;\" );\r\n\r\n\t\tif ( environment ) {\r\n\r\n\t\t\toutput.push( environment.code );\r\n\r\n\t\t\tif ( environmentAlpha ) {\r\n\r\n\t\t\t\toutput.push(\r\n\t\t\t\t\tenvironmentAlpha.code,\r\n\t\t\t\t\t\"outgoingLight = mix( outgoingLight, \" + environment.result + \", \" + environmentAlpha.result + \" );\"\r\n\t\t\t\t);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\toutput.push( \"outgoingLight = \" + environment.result + \";\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t/*\r\n\t\tswitch( builder.material.combine ) {\r\n\r\n\t\t\tcase ENVMAP_BLENDING_MULTIPLY:\r\n\r\n\t\t\t\t//output.push( \"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;\" );\r\n\t\t\t\t//outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\r\n\t\t}\r\n\t*/\r\n\r\n\t\tif ( alpha ) {\r\n\r\n\t\t\toutput.push( \"gl_FragColor = vec4( outgoingLight, \" + alpha.result + \" );\" );\r\n\r\n\t\t} else {\r\n\r\n\t\t\toutput.push( \"gl_FragColor = vec4( outgoingLight, 1.0 );\" );\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <tonemapping_fragment>\",\r\n\t\t\t\"#include <encodings_fragment>\",\r\n\t\t\t\"#include <fog_fragment>\",\r\n\t\t\t\"#include <premultiplied_alpha_fragment>\"\r\n\t\t);\r\n\r\n\t\tcode = output.join( \"\\n\" );\r\n\r\n\t}\r\n\r\n\treturn code;\r\n\r\n};\r\n\r\nPhongNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\t// vertex\r\n\r\n\tif ( source.position ) this.position = source.position;\r\n\r\n\t// fragment\r\n\r\n\tthis.color = source.color;\r\n\tthis.specular = source.specular;\r\n\tthis.shininess = source.shininess;\r\n\r\n\tif ( source.mask ) this.mask = source.mask;\r\n\r\n\tif ( source.alpha ) this.alpha = source.alpha;\r\n\r\n\tif ( source.normal ) this.normal = source.normal;\r\n\r\n\tif ( source.light ) this.light = source.light;\r\n\tif ( source.shadow ) this.shadow = source.shadow;\r\n\r\n\tif ( source.ao ) this.ao = source.ao;\r\n\r\n\tif ( source.emissive ) this.emissive = source.emissive;\r\n\tif ( source.ambient ) this.ambient = source.ambient;\r\n\r\n\tif ( source.environment ) this.environment = source.environment;\r\n\tif ( source.environmentAlpha ) this.environmentAlpha = source.environmentAlpha;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nPhongNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\t// vertex\r\n\r\n\t\tif ( this.position ) data.position = this.position.toJSON( meta ).uuid;\r\n\r\n\t\t// fragment\r\n\r\n\t\tdata.color = this.color.toJSON( meta ).uuid;\r\n\t\tdata.specular = this.specular.toJSON( meta ).uuid;\r\n\t\tdata.shininess = this.shininess.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.mask ) data.mask = this.mask.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.alpha ) data.alpha = this.alpha.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.normal ) data.normal = this.normal.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.light ) data.light = this.light.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.ao ) data.ao = this.ao.toJSON( meta ).uuid;\r\n\t\tif ( this.ambient ) data.ambient = this.ambient.toJSON( meta ).uuid;\r\n\t\tif ( this.shadow ) data.shadow = this.shadow.toJSON( meta ).uuid;\r\n\t\tif ( this.emissive ) data.emissive = this.emissive.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.environment ) data.environment = this.environment.toJSON( meta ).uuid;\r\n\t\tif ( this.environmentAlpha ) data.environmentAlpha = this.environmentAlpha.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { PhongNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/nodes/PhongNode.js","import {\r\n\tUniformsLib,\r\n\tUniformsUtils\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { Node } from '../../core/Node.js';\r\nimport { ExpressionNode } from '../../core/ExpressionNode.js';\r\nimport { ColorNode } from '../../inputs/ColorNode.js';\r\nimport { FloatNode } from '../../inputs/FloatNode.js';\r\nimport { SpecularMIPLevelNode } from '../../utils/SpecularMIPLevelNode.js';\r\n\r\nfunction StandardNode() {\r\n\r\n\tNode.call( this );\r\n\r\n\tthis.color = new ColorNode( 0xFFFFFF );\r\n\tthis.roughness = new FloatNode( 1 );\r\n\tthis.metalness = new FloatNode( 0 );\r\n\r\n}\r\n\r\nStandardNode.prototype = Object.create( Node.prototype );\r\nStandardNode.prototype.constructor = StandardNode;\r\nStandardNode.prototype.nodeType = \"Standard\";\r\n\r\nStandardNode.prototype.build = function ( builder ) {\r\n\r\n\tvar code;\r\n\r\n\tbuilder.define( 'STANDARD' );\r\n\r\n\tvar useClearcoat = this.clearcoat || this.clearcoatRoughness || this.clearCoatNormal;\r\n\r\n\tif ( useClearcoat ) {\r\n\r\n\t\tbuilder.define( 'CLEARCOAT' );\r\n\r\n\t}\r\n\r\n\tbuilder.requires.lights = true;\r\n\r\n\tbuilder.extensions.derivatives = true;\r\n\tbuilder.extensions.shaderTextureLOD = true;\r\n\r\n\tif ( builder.isShader( 'vertex' ) ) {\r\n\r\n\t\tvar position = this.position ? this.position.analyzeAndFlow( builder, 'v3', { cache: 'position' } ) : undefined;\r\n\r\n\t\tbuilder.mergeUniform( UniformsUtils.merge( [\r\n\r\n\t\t\tUniformsLib.fog,\r\n\t\t\tUniformsLib.lights\r\n\r\n\t\t] ) );\r\n\r\n\t\tif ( UniformsLib.LTC_1 ) {\r\n\r\n\t\t\t// add ltc data textures to material uniforms\r\n\r\n\t\t\tbuilder.uniforms.ltc_1 = { value: undefined };\r\n\t\t\tbuilder.uniforms.ltc_2 = { value: undefined };\r\n\r\n\t\t}\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"varying vec3 vViewPosition;\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\",\r\n\r\n\t\t\t\"\tvarying vec3 vNormal;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t//\"#include <encodings_pars_fragment>\", // encoding functions\r\n\t\t\t\"#include <fog_pars_vertex>\",\r\n\t\t\t\"#include <morphtarget_pars_vertex>\",\r\n\t\t\t\"#include <skinning_pars_vertex>\",\r\n\t\t\t\"#include <shadowmap_pars_vertex>\",\r\n\t\t\t\"#include <logdepthbuf_pars_vertex>\",\r\n\t\t\t\"#include <clipping_planes_pars_vertex>\"\r\n\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\tvar output = [\r\n\t\t\t\"#include <beginnormal_vertex>\",\r\n\t\t\t\"#include <morphnormal_vertex>\",\r\n\t\t\t\"#include <skinbase_vertex>\",\r\n\t\t\t\"#include <skinnormal_vertex>\",\r\n\t\t\t\"#include <defaultnormal_vertex>\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\r\n\r\n\t\t\t\"\tvNormal = normalize( transformedNormal );\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t\"#include <begin_vertex>\"\r\n\t\t];\r\n\r\n\t\tif ( position ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tposition.code,\r\n\t\t\t\tposition.result ? \"transformed = \" + position.result + \";\" : ''\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <morphtarget_vertex>\",\r\n\t\t\t\"#include <skinning_vertex>\",\r\n\t\t\t\"#include <project_vertex>\",\r\n\t\t\t\"#include <fog_vertex>\",\r\n\t\t\t\"#include <logdepthbuf_vertex>\",\r\n\t\t\t\"#include <clipping_planes_vertex>\",\r\n\r\n\t\t\t\"\tvViewPosition = - mvPosition.xyz;\",\r\n\r\n\t\t\t\"#include <worldpos_vertex>\",\r\n\t\t\t\"#include <shadowmap_vertex>\"\r\n\t\t);\r\n\r\n\t\tcode = output.join( \"\\n\" );\r\n\r\n\t} else {\r\n\r\n\t\tvar specularRoughness = new ExpressionNode( 'material.specularRoughness', 'f' );\r\n\t\tvar clearcoatRoughness = new ExpressionNode( 'material.clearcoatRoughness', 'f' );\r\n\r\n\t\tvar contextEnvironment = {\r\n\t\t\troughness: specularRoughness,\r\n\t\t\tbias: new SpecularMIPLevelNode( specularRoughness ),\r\n\t\t\tviewNormal: new ExpressionNode( 'normal', 'v3' ),\r\n\t\t\tworldNormal: new ExpressionNode( 'inverseTransformDirection( geometry.normal, viewMatrix )', 'v3' ),\r\n\t\t\tgamma: true\r\n\t\t};\r\n\r\n\t\tvar contextGammaOnly = {\r\n\t\t\tgamma: true\r\n\t\t};\r\n\r\n\t\tvar contextClearcoatEnvironment = {\r\n\t\t\troughness: clearcoatRoughness,\r\n\t\t\tbias: new SpecularMIPLevelNode( clearcoatRoughness ),\r\n\t\t\tviewNormal: new ExpressionNode( 'clearcoatNormal', 'v3' ),\r\n\t\t\tworldNormal: new ExpressionNode( 'inverseTransformDirection( geometry.clearcoatNormal, viewMatrix )', 'v3' ),\r\n\t\t\tgamma: true\r\n\t\t};\r\n\r\n\t\t// analyze all nodes to reuse generate codes\r\n\r\n\t\tif ( this.mask ) this.mask.analyze( builder );\r\n\r\n\t\tthis.color.analyze( builder, { slot: 'color', context: contextGammaOnly } );\r\n\t\tthis.roughness.analyze( builder );\r\n\t\tthis.metalness.analyze( builder );\r\n\r\n\t\tif ( this.alpha ) this.alpha.analyze( builder );\r\n\r\n\t\tif ( this.normal ) this.normal.analyze( builder );\r\n\r\n\t\tif ( this.clearcoat ) this.clearcoat.analyze( builder );\r\n\t\tif ( this.clearcoatRoughness ) this.clearcoatRoughness.analyze( builder );\r\n\t\tif ( this.clearcoatNormal ) this.clearcoatNormal.analyze( builder );\r\n\r\n\t\tif ( this.reflectivity ) this.reflectivity.analyze( builder );\r\n\r\n\t\tif ( this.light ) this.light.analyze( builder, { cache: 'light' } );\r\n\r\n\t\tif ( this.ao ) this.ao.analyze( builder );\r\n\t\tif ( this.ambient ) this.ambient.analyze( builder );\r\n\t\tif ( this.shadow ) this.shadow.analyze( builder );\r\n\t\tif ( this.emissive ) this.emissive.analyze( builder, { slot: 'emissive' } );\r\n\r\n\t\tif ( this.environment ) {\r\n\r\n\t\t\t// isolate environment from others inputs ( see TextureNode, CubeTextureNode )\r\n\t\t\t// environment.analyze will detect if there is a need of calculate irradiance\r\n\r\n\t\t\tthis.environment.analyze( builder, { cache: 'radiance', context: contextEnvironment, slot: 'radiance' } );\r\n\r\n\t\t\tif ( builder.requires.irradiance ) {\r\n\r\n\t\t\t\tthis.environment.analyze( builder, { cache: 'irradiance', context: contextEnvironment, slot: 'irradiance' } );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.sheen ) this.sheen.analyze( builder );\r\n\r\n\t\t// build code\r\n\r\n\t\tvar mask = this.mask ? this.mask.flow( builder, 'b' ) : undefined;\r\n\r\n\t\tvar color = this.color.flow( builder, 'c', { slot: 'color', context: contextGammaOnly } );\r\n\t\tvar roughness = this.roughness.flow( builder, 'f' );\r\n\t\tvar metalness = this.metalness.flow( builder, 'f' );\r\n\r\n\t\tvar alpha = this.alpha ? this.alpha.flow( builder, 'f' ) : undefined;\r\n\r\n\t\tvar normal = this.normal ? this.normal.flow( builder, 'v3' ) : undefined;\r\n\r\n\t\tvar clearcoat = this.clearcoat ? this.clearcoat.flow( builder, 'f' ) : undefined;\r\n\t\tvar clearcoatRoughness = this.clearcoatRoughness ? this.clearcoatRoughness.flow( builder, 'f' ) : undefined;\r\n\t\tvar clearcoatNormal = this.clearcoatNormal ? this.clearcoatNormal.flow( builder, 'v3' ) : undefined;\r\n\r\n\t\tvar reflectivity = this.reflectivity ? this.reflectivity.flow( builder, 'f' ) : undefined;\r\n\r\n\t\tvar light = this.light ? this.light.flow( builder, 'v3', { cache: 'light' } ) : undefined;\r\n\r\n\t\tvar ao = this.ao ? this.ao.flow( builder, 'f' ) : undefined;\r\n\t\tvar ambient = this.ambient ? this.ambient.flow( builder, 'c' ) : undefined;\r\n\t\tvar shadow = this.shadow ? this.shadow.flow( builder, 'c' ) : undefined;\r\n\t\tvar emissive = this.emissive ? this.emissive.flow( builder, 'c', { slot: 'emissive' } ) : undefined;\r\n\r\n\t\tvar environment;\r\n\r\n\t\tif ( this.environment ) {\r\n\r\n\t\t\tenvironment = {\r\n\t\t\t\tradiance: this.environment.flow( builder, 'c', { cache: 'radiance', context: contextEnvironment, slot: 'radiance' } )\r\n\t\t\t};\r\n\r\n\t\t\tif ( builder.requires.irradiance ) {\r\n\r\n\t\t\t\tenvironment.irradiance = this.environment.flow( builder, 'c', { cache: 'irradiance', context: contextEnvironment, slot: 'irradiance' } );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar clearcoatEnv = useClearcoat && environment ? this.environment.flow( builder, 'c', { cache: 'clearcoat', context: contextClearcoatEnvironment, slot: 'environment' } ) : undefined;\r\n\r\n\t\tvar sheen = this.sheen ? this.sheen.flow( builder, 'c' ) : undefined;\r\n\r\n\t\tbuilder.requires.transparent = alpha !== undefined;\r\n\r\n\t\tbuilder.addParsCode( [\r\n\t\t\t\"varying vec3 vViewPosition;\",\r\n\r\n\t\t\t\"#ifndef FLAT_SHADED\",\r\n\r\n\t\t\t\"\tvarying vec3 vNormal;\",\r\n\r\n\t\t\t\"#endif\",\r\n\r\n\t\t\t\"#include <dithering_pars_fragment>\",\r\n\t\t\t\"#include <fog_pars_fragment>\",\r\n\t\t\t\"#include <bsdfs>\",\r\n\t\t\t\"#include <lights_pars_begin>\",\r\n\t\t\t\"#include <lights_physical_pars_fragment>\",\r\n\t\t\t\"#include <shadowmap_pars_fragment>\",\r\n\t\t\t\"#include <logdepthbuf_pars_fragment>\"\r\n\t\t].join( \"\\n\" ) );\r\n\r\n\t\tvar output = [\r\n\t\t\t\"#include <clipping_planes_fragment>\",\r\n\r\n\t\t\t// add before: prevent undeclared normal\r\n\t\t\t\"\t#include <normal_fragment_begin>\",\r\n\t\t\t\"\t#include <clearcoat_normal_fragment_begin>\",\r\n\r\n\t\t\t// add before: prevent undeclared material\r\n\t\t\t\"\tPhysicalMaterial material;\",\r\n\t\t\t\"\tmaterial.diffuseColor = vec3( 1.0 );\"\r\n\t\t];\r\n\r\n\t\tif ( mask ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tmask.code,\r\n\t\t\t\t'if ( ! ' + mask.result + ' ) discard;'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\tcolor.code,\r\n\t\t\t\"\tvec3 diffuseColor = \" + color.result + \";\",\r\n\t\t\t\"\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\",\r\n\r\n\t\t\t\"#include <logdepthbuf_fragment>\",\r\n\r\n\t\t\troughness.code,\r\n\t\t\t\"\tfloat roughnessFactor = \" + roughness.result + \";\",\r\n\r\n\t\t\tmetalness.code,\r\n\t\t\t\"\tfloat metalnessFactor = \" + metalness.result + \";\"\r\n\t\t);\r\n\r\n\t\tif ( alpha ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\talpha.code,\r\n\t\t\t\t'#ifdef ALPHATEST',\r\n\r\n\t\t\t\t'\tif ( ' + alpha.result + ' <= ALPHATEST ) discard;',\r\n\r\n\t\t\t\t'#endif'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( normal ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tnormal.code,\r\n\t\t\t\t'normal = ' + normal.result + ';'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( clearcoatNormal ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tclearcoatNormal.code,\r\n\t\t\t\t'clearcoatNormal = ' + clearcoatNormal.result + ';'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\t// anti-aliasing code by @elalish\r\n\r\n\t\toutput.push(\r\n\t\t\t'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\r\n\t\t\t'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\r\n\t\t);\r\n\r\n\t\t// optimization for now\r\n\r\n\t\toutput.push(\r\n\t\t\t'material.diffuseColor = ' + ( light ? 'vec3( 1.0 )' : 'diffuseColor * ( 1.0 - metalnessFactor )' ) + ';',\r\n\r\n\t\t\t'material.specularRoughness = max( roughnessFactor, 0.0525 );',\r\n\t\t\t'material.specularRoughness += geometryRoughness;',\r\n\t\t\t'material.specularRoughness = min( material.specularRoughness, 1.0 );',\r\n\r\n\t\t\t'material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );'\r\n\t\t);\r\n\r\n\t\tif ( clearcoat ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tclearcoat.code,\r\n\t\t\t\t'material.clearcoat = saturate( ' + clearcoat.result + ' );' // Burley clearcoat model\r\n\t\t\t);\r\n\r\n\t\t} else if ( useClearcoat ) {\r\n\r\n\t\t\toutput.push( 'material.clearcoat = 0.0;' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( clearcoatRoughness ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tclearcoatRoughness.code,\r\n\t\t\t\t'material.clearcoatRoughness = max( ' + clearcoatRoughness.result + ', 0.0525 );',\r\n\t\t\t\t'material.clearcoatRoughness += geometryRoughness;',\r\n\t\t\t\t'material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );'\r\n\t\t\t);\r\n\r\n\t\t} else if ( useClearcoat ) {\r\n\r\n\t\t\toutput.push( 'material.clearcoatRoughness = 0.0;' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( sheen ) {\r\n\r\n\t\t\toutput.push( 'material.sheenColor = ' + sheen.result + ';' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( reflectivity ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\treflectivity.code,\r\n\t\t\t\t'material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( ' + reflectivity.result + ' ) ), diffuseColor, metalnessFactor );'\r\n\t\t\t);\r\n\r\n\t\t} else {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\t'material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );'\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <lights_fragment_begin>\"\r\n\t\t);\r\n\r\n\t\tif ( light ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tlight.code,\r\n\t\t\t\t\"reflectedLight.directDiffuse = \" + light.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t\t// apply color\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\t\"diffuseColor *= 1.0 - metalnessFactor;\",\r\n\r\n\t\t\t\t\"reflectedLight.directDiffuse *= diffuseColor;\",\r\n\t\t\t\t\"reflectedLight.indirectDiffuse *= diffuseColor;\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( ao ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tao.code,\r\n\t\t\t\t\"reflectedLight.indirectDiffuse *= \" + ao.result + \";\",\r\n\t\t\t\t\"float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\",\r\n\t\t\t\t\"reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, \" + ao.result + \", material.specularRoughness );\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( ambient ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tambient.code,\r\n\t\t\t\t\"reflectedLight.indirectDiffuse += \" + ambient.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( shadow ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\tshadow.code,\r\n\t\t\t\t\"reflectedLight.directDiffuse *= \" + shadow.result + \";\",\r\n\t\t\t\t\"reflectedLight.directSpecular *= \" + shadow.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( emissive ) {\r\n\r\n\t\t\toutput.push(\r\n\t\t\t\temissive.code,\r\n\t\t\t\t\"reflectedLight.directDiffuse += \" + emissive.result + \";\"\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tif ( environment ) {\r\n\r\n\t\t\toutput.push( environment.radiance.code );\r\n\r\n\t\t\tif ( builder.requires.irradiance ) {\r\n\r\n\t\t\t\toutput.push( environment.irradiance.code );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( clearcoatEnv ) {\r\n\r\n\t\t\t\toutput.push(\r\n\t\t\t\t\tclearcoatEnv.code,\r\n\t\t\t\t\t\"clearcoatRadiance += \" + clearcoatEnv.result + \";\"\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\toutput.push( \"radiance += \" + environment.radiance.result + \";\" );\r\n\r\n\t\t\tif ( builder.requires.irradiance ) {\r\n\r\n\t\t\t\toutput.push( \"iblIrradiance += PI * \" + environment.irradiance.result + \";\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <lights_fragment_end>\"\r\n\t\t);\r\n\r\n\t\toutput.push( \"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;\" );\r\n\r\n\t\tif ( alpha ) {\r\n\r\n\t\t\toutput.push( \"gl_FragColor = vec4( outgoingLight, \" + alpha.result + \" );\" );\r\n\r\n\t\t} else {\r\n\r\n\t\t\toutput.push( \"gl_FragColor = vec4( outgoingLight, 1.0 );\" );\r\n\r\n\t\t}\r\n\r\n\t\toutput.push(\r\n\t\t\t\"#include <tonemapping_fragment>\",\r\n\t\t\t\"#include <encodings_fragment>\",\r\n\t\t\t\"#include <fog_fragment>\",\r\n\t\t\t\"#include <premultiplied_alpha_fragment>\",\r\n\t\t\t\"#include <dithering_fragment>\"\r\n\t\t);\r\n\r\n\t\tcode = output.join( \"\\n\" );\r\n\r\n\t}\r\n\r\n\treturn code;\r\n\r\n};\r\n\r\nStandardNode.prototype.copy = function ( source ) {\r\n\r\n\tNode.prototype.copy.call( this, source );\r\n\r\n\t// vertex\r\n\r\n\tif ( source.position ) this.position = source.position;\r\n\r\n\t// fragment\r\n\r\n\tthis.color = source.color;\r\n\tthis.roughness = source.roughness;\r\n\tthis.metalness = source.metalness;\r\n\r\n\tif ( source.mask ) this.mask = source.mask;\r\n\r\n\tif ( source.alpha ) this.alpha = source.alpha;\r\n\r\n\tif ( source.normal ) this.normal = source.normal;\r\n\r\n\tif ( source.clearcoat ) this.clearcoat = source.clearcoat;\r\n\tif ( source.clearcoatRoughness ) this.clearcoatRoughness = source.clearcoatRoughness;\r\n\tif ( source.clearcoatNormal ) this.clearcoatNormal = source.clearcoatNormal;\r\n\r\n\tif ( source.reflectivity ) this.reflectivity = source.reflectivity;\r\n\r\n\tif ( source.light ) this.light = source.light;\r\n\tif ( source.shadow ) this.shadow = source.shadow;\r\n\r\n\tif ( source.ao ) this.ao = source.ao;\r\n\r\n\tif ( source.emissive ) this.emissive = source.emissive;\r\n\tif ( source.ambient ) this.ambient = source.ambient;\r\n\r\n\tif ( source.environment ) this.environment = source.environment;\r\n\r\n\tif ( source.sheen ) this.sheen = source.sheen;\r\n\r\n\treturn this;\r\n\r\n};\r\n\r\nStandardNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\t// vertex\r\n\r\n\t\tif ( this.position ) data.position = this.position.toJSON( meta ).uuid;\r\n\r\n\t\t// fragment\r\n\r\n\t\tdata.color = this.color.toJSON( meta ).uuid;\r\n\t\tdata.roughness = this.roughness.toJSON( meta ).uuid;\r\n\t\tdata.metalness = this.metalness.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.mask ) data.mask = this.mask.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.alpha ) data.alpha = this.alpha.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.normal ) data.normal = this.normal.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.clearcoat ) data.clearcoat = this.clearcoat.toJSON( meta ).uuid;\r\n\t\tif ( this.clearcoatRoughness ) data.clearcoatRoughness = this.clearcoatRoughness.toJSON( meta ).uuid;\r\n\t\tif ( this.clearcoatNormal ) data.clearcoatNormal = this.clearcoatNormal.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.reflectivity ) data.reflectivity = this.reflectivity.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.light ) data.light = this.light.toJSON( meta ).uuid;\r\n\t\tif ( this.shadow ) data.shadow = this.shadow.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.ao ) data.ao = this.ao.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.emissive ) data.emissive = this.emissive.toJSON( meta ).uuid;\r\n\t\tif ( this.ambient ) data.ambient = this.ambient.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.environment ) data.environment = this.environment.toJSON( meta ).uuid;\r\n\r\n\t\tif ( this.sheen ) data.sheen = this.sheen.toJSON( meta ).uuid;\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { StandardNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/nodes/StandardNode.js","import {\r\n\tColor,\r\n\tVector2\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { StandardNode } from './StandardNode.js';\r\nimport { PropertyNode } from '../../inputs/PropertyNode.js';\r\nimport { OperatorNode } from '../../math/OperatorNode.js';\r\nimport { SwitchNode } from '../../utils/SwitchNode.js';\r\nimport { NormalMapNode } from '../../misc/NormalMapNode.js';\r\n\r\nfunction MeshStandardNode() {\r\n\r\n\tStandardNode.call( this );\r\n\r\n\tthis.properties = {\r\n\t\tcolor: new Color( 0xffffff ),\r\n\t\troughness: 0.5,\r\n\t\tmetalness: 0.5,\r\n\t\tnormalScale: new Vector2( 1, 1 )\r\n\t};\r\n\r\n\tthis.inputs = {\r\n\t\tcolor: new PropertyNode( this.properties, 'color', 'c' ),\r\n\t\troughness: new PropertyNode( this.properties, 'roughness', 'f' ),\r\n\t\tmetalness: new PropertyNode( this.properties, 'metalness', 'f' ),\r\n\t\tnormalScale: new PropertyNode( this.properties, 'normalScale', 'v2' )\r\n\t};\r\n\r\n}\r\n\r\nMeshStandardNode.prototype = Object.create( StandardNode.prototype );\r\nMeshStandardNode.prototype.constructor = MeshStandardNode;\r\nMeshStandardNode.prototype.nodeType = \"MeshStandard\";\r\n\r\nMeshStandardNode.prototype.build = function ( builder ) {\r\n\r\n\tvar props = this.properties,\r\n\t\tinputs = this.inputs;\r\n\r\n\tif ( builder.isShader( 'fragment' ) ) {\r\n\r\n\t\t// slots\r\n\t\t// * color\r\n\t\t// * map\r\n\r\n\t\tvar color = builder.findNode( props.color, inputs.color ),\r\n\t\t\tmap = builder.resolve( props.map );\r\n\r\n\t\tthis.color = map ? new OperatorNode( color, map, OperatorNode.MUL ) : color;\r\n\r\n\t\t// slots\r\n\t\t// * roughness\r\n\t\t// * roughnessMap\r\n\r\n\t\tvar roughness = builder.findNode( props.roughness, inputs.roughness ),\r\n\t\t\troughnessMap = builder.resolve( props.roughnessMap );\r\n\r\n\t\tthis.roughness = roughnessMap ? new OperatorNode( roughness, new SwitchNode( roughnessMap, \"g\" ), OperatorNode.MUL ) : roughness;\r\n\r\n\t\t// slots\r\n\t\t// * metalness\r\n\t\t// * metalnessMap\r\n\r\n\t\tvar metalness = builder.findNode( props.metalness, inputs.metalness ),\r\n\t\t\tmetalnessMap = builder.resolve( props.metalnessMap );\r\n\r\n\t\tthis.metalness = metalnessMap ? new OperatorNode( metalness, new SwitchNode( metalnessMap, \"b\" ), OperatorNode.MUL ) : metalness;\r\n\r\n\t\t// slots\r\n\t\t// * normalMap\r\n\t\t// * normalScale\r\n\r\n\t\tif ( props.normalMap ) {\r\n\r\n\t\t\tthis.normal = new NormalMapNode( builder.resolve( props.normalMap ) );\r\n\t\t\tthis.normal.scale = builder.findNode( props.normalScale, inputs.normalScale );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.normal = undefined;\r\n\r\n\t\t}\r\n\r\n\t\t// slots\r\n\t\t// * envMap\r\n\r\n\t\tthis.environment = builder.resolve( props.envMap );\r\n\r\n\t}\r\n\r\n\t// build code\r\n\r\n\treturn StandardNode.prototype.build.call( this, builder );\r\n\r\n};\r\n\r\nMeshStandardNode.prototype.toJSON = function ( meta ) {\r\n\r\n\tvar data = this.getJSONNode( meta );\r\n\r\n\tif ( ! data ) {\r\n\r\n\t\tdata = this.createJSONNode( meta );\r\n\r\n\t\tconsole.warn( \".toJSON not implemented in\", this );\r\n\r\n\t}\r\n\r\n\treturn data;\r\n\r\n};\r\n\r\nexport { MeshStandardNode };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/nodes/MeshStandardNode.js","import { BasicNode } from './nodes/BasicNode.js';\r\nimport { NodeMaterial } from './NodeMaterial.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction BasicNodeMaterial() {\r\n\r\n\tvar node = new BasicNode();\r\n\r\n\tNodeMaterial.call( this, node, node );\r\n\r\n\tthis.type = \"BasicNodeMaterial\";\r\n\r\n}\r\n\r\nBasicNodeMaterial.prototype = Object.create( NodeMaterial.prototype );\r\nBasicNodeMaterial.prototype.constructor = BasicNodeMaterial;\r\n\r\nNodeUtils.addShortcuts( BasicNodeMaterial.prototype, 'fragment', [\r\n\t'color',\r\n\t'alpha',\r\n\t'mask',\r\n\t'position'\r\n] );\r\n\r\nexport { BasicNodeMaterial };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/BasicNodeMaterial.js","import { SpriteNode } from './nodes/SpriteNode.js';\r\nimport { NodeMaterial } from './NodeMaterial.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction SpriteNodeMaterial() {\r\n\r\n\tvar node = new SpriteNode();\r\n\r\n\tNodeMaterial.call( this, node, node );\r\n\r\n\tthis.type = \"SpriteNodeMaterial\";\r\n\r\n}\r\n\r\nSpriteNodeMaterial.prototype = Object.create( NodeMaterial.prototype );\r\nSpriteNodeMaterial.prototype.constructor = SpriteNodeMaterial;\r\n\r\nNodeUtils.addShortcuts( SpriteNodeMaterial.prototype, 'fragment', [\r\n\t'color',\r\n\t'alpha',\r\n\t'mask',\r\n\t'position',\r\n\t'spherical'\r\n] );\r\n\r\nexport { SpriteNodeMaterial };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/SpriteNodeMaterial.js","import { PhongNode } from './nodes/PhongNode.js';\r\nimport { NodeMaterial } from './NodeMaterial.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction PhongNodeMaterial() {\r\n\r\n\tvar node = new PhongNode();\r\n\r\n\tNodeMaterial.call( this, node, node );\r\n\r\n\tthis.type = \"PhongNodeMaterial\";\r\n\r\n}\r\n\r\nPhongNodeMaterial.prototype = Object.create( NodeMaterial.prototype );\r\nPhongNodeMaterial.prototype.constructor = PhongNodeMaterial;\r\n\r\nNodeUtils.addShortcuts( PhongNodeMaterial.prototype, 'fragment', [\r\n\t'color',\r\n\t'alpha',\r\n\t'specular',\r\n\t'shininess',\r\n\t'normal',\r\n\t'emissive',\r\n\t'ambient',\r\n\t'light',\r\n\t'shadow',\r\n\t'ao',\r\n\t'environment',\r\n\t'environmentAlpha',\r\n\t'mask',\r\n\t'position'\r\n] );\r\n\r\nexport { PhongNodeMaterial };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/PhongNodeMaterial.js","import { StandardNode } from './nodes/StandardNode.js';\r\nimport { NodeMaterial } from './NodeMaterial.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction StandardNodeMaterial() {\r\n\r\n\tvar node = new StandardNode();\r\n\r\n\tNodeMaterial.call( this, node, node );\r\n\r\n\tthis.type = \"StandardNodeMaterial\";\r\n\r\n}\r\n\r\nStandardNodeMaterial.prototype = Object.create( NodeMaterial.prototype );\r\nStandardNodeMaterial.prototype.constructor = StandardNodeMaterial;\r\n\r\nNodeUtils.addShortcuts( StandardNodeMaterial.prototype, 'fragment', [\r\n\t'color',\r\n\t'alpha',\r\n\t'roughness',\r\n\t'metalness',\r\n\t'reflectivity',\r\n\t'clearcoat',\r\n\t'clearcoatRoughness',\r\n\t'clearcoatNormal',\r\n\t'normal',\r\n\t'emissive',\r\n\t'ambient',\r\n\t'light',\r\n\t'shadow',\r\n\t'ao',\r\n\t'environment',\r\n\t'mask',\r\n\t'position',\r\n\t'sheen'\r\n] );\r\n\r\nexport { StandardNodeMaterial };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/StandardNodeMaterial.js","import { MeshStandardNode } from './nodes/MeshStandardNode.js';\r\nimport { NodeMaterial } from './NodeMaterial.js';\r\nimport { NodeUtils } from '../core/NodeUtils.js';\r\n\r\nfunction MeshStandardNodeMaterial() {\r\n\r\n\tvar node = new MeshStandardNode();\r\n\r\n\tNodeMaterial.call( this, node, node );\r\n\r\n\tthis.type = \"MeshStandardNodeMaterial\";\r\n\r\n}\r\n\r\nMeshStandardNodeMaterial.prototype = Object.create( NodeMaterial.prototype );\r\nMeshStandardNodeMaterial.prototype.constructor = MeshStandardNodeMaterial;\r\n\r\nNodeUtils.addShortcuts( MeshStandardNodeMaterial.prototype, 'properties', [\r\n\t\"color\",\r\n\t\"roughness\",\r\n\t\"metalness\",\r\n\t\"map\",\r\n\t\"normalMap\",\r\n\t\"normalScale\",\r\n\t\"metalnessMap\",\r\n\t\"roughnessMap\",\r\n\t\"envMap\"\r\n] );\r\n\r\nexport { MeshStandardNodeMaterial };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/materials/MeshStandardNodeMaterial.js","import {\r\n\tLinearFilter,\r\n\tMesh,\r\n\tOrthographicCamera,\r\n\tPlaneBufferGeometry,\r\n\tRGBAFormat,\r\n\tScene,\r\n\tVector2,\r\n\tWebGLRenderTarget\r\n} from '@/components/build/three.module.js';\r\n\r\nimport { NodeMaterial } from '../materials/NodeMaterial.js';\r\nimport { ScreenNode } from '../inputs/ScreenNode.js';\r\n\r\nfunction NodePostProcessing( renderer, renderTarget ) {\r\n\r\n\tif ( renderTarget === undefined ) {\r\n\r\n\t\tvar parameters = {\r\n\t\t\tminFilter: LinearFilter,\r\n\t\t\tmagFilter: LinearFilter,\r\n\t\t\tformat: RGBAFormat\r\n\t\t};\r\n\r\n\t\tvar size = renderer.getDrawingBufferSize( new Vector2() );\r\n\t\trenderTarget = new WebGLRenderTarget( size.width, size.height, parameters );\r\n\r\n\t}\r\n\r\n\tthis.renderer = renderer;\r\n\tthis.renderTarget = renderTarget;\r\n\r\n\tthis.output = new ScreenNode();\r\n\tthis.material = new NodeMaterial();\r\n\r\n\tthis.camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\r\n\tthis.scene = new Scene();\r\n\r\n\tthis.quad = new Mesh( new PlaneBufferGeometry( 2, 2 ), this.material );\r\n\tthis.quad.frustumCulled = false; // Avoid getting clipped\r\n\tthis.scene.add( this.quad );\r\n\r\n\tthis.needsUpdate = true;\r\n\r\n}\r\n\r\nNodePostProcessing.prototype = {\r\n\r\n\tconstructor: NodePostProcessing,\r\n\r\n\trender: function ( scene, camera, frame ) {\r\n\r\n\t\tif ( this.needsUpdate ) {\r\n\r\n\t\t\tthis.material.dispose();\r\n\r\n\t\t\tthis.material.fragment.value = this.output;\r\n\t\t\tthis.material.build();\r\n\r\n\t\t\tif ( this.material.uniforms.renderTexture ) {\r\n\r\n\t\t\t\tthis.material.uniforms.renderTexture.value = this.renderTarget.texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.needsUpdate = false;\r\n\r\n\t\t}\r\n\r\n\t\tframe.setRenderer( this.renderer )\r\n\t\t\t.setRenderTexture( this.renderTarget.texture );\r\n\r\n\t\tthis.renderer.setRenderTarget( this.renderTarget );\r\n\t\tthis.renderer.render( scene, camera );\r\n\r\n\t\tframe.updateNode( this.material );\r\n\r\n\t\tthis.renderer.setRenderTarget( null );\r\n\t\tthis.renderer.render( this.scene, this.camera );\r\n\r\n\t},\r\n\r\n\tsetPixelRatio: function ( value ) {\r\n\r\n\t\tthis.renderer.setPixelRatio( value );\r\n\r\n\t\tvar size = this.renderer.getSize( new Vector2() );\r\n\r\n\t\tthis.setSize( size.width, size.height );\r\n\r\n\t},\r\n\r\n\tsetSize: function ( width, height ) {\r\n\r\n\t\tvar pixelRatio = this.renderer.getPixelRatio();\r\n\r\n\t\tthis.renderTarget.setSize( width * pixelRatio, height * pixelRatio );\r\n\r\n\t\tthis.renderer.setSize( width, height );\r\n\r\n\t},\r\n\r\n\tcopy: function ( source ) {\r\n\r\n\t\tthis.output = source.output;\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\ttoJSON: function ( meta ) {\r\n\r\n\t\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\tif ( isRootObject ) {\r\n\r\n\t\t\tmeta = {\r\n\t\t\t\tnodes: {}\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tif ( meta && ! meta.post ) meta.post = {};\r\n\r\n\t\tif ( ! meta.post[ this.uuid ] ) {\r\n\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = \"NodePostProcessing\";\r\n\r\n\t\t\tmeta.post[ this.uuid ] = data;\r\n\r\n\t\t\tif ( this.name !== \"\" ) data.name = this.name;\r\n\r\n\t\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\r\n\r\n\t\t\tdata.output = this.output.toJSON( meta ).uuid;\r\n\r\n\t\t}\r\n\r\n\t\tmeta.post = this.uuid;\r\n\r\n\t\treturn meta;\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { NodePostProcessing };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/nodes/postprocessing/NodePostProcessing.js","import {\r\n\tDefaultLoadingManager,\r\n\tFileLoader\r\n} from \"@/components/build/three.module.js\";\r\n\r\nimport * as Nodes from \"../nodes/Nodes.js\";\r\n\r\nvar NodeMaterialLoader = function ( manager, library ) {\r\n\r\n\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\tthis.nodes = {};\r\n\tthis.materials = {};\r\n\tthis.passes = {};\r\n\tthis.names = {};\r\n\tthis.library = library || {};\r\n\r\n};\r\n\r\nvar NodeMaterialLoaderUtils = {\r\n\r\n\treplaceUUIDObject: function ( object, uuid, value, recursive ) {\r\n\r\n\t\trecursive = recursive !== undefined ? recursive : true;\r\n\r\n\t\tif ( typeof uuid === \"object\" ) uuid = uuid.uuid;\r\n\r\n\t\tif ( typeof object === \"object\" ) {\r\n\r\n\t\t\tvar keys = Object.keys( object );\r\n\r\n\t\t\tfor ( var i = 0; i < keys.length; i ++ ) {\r\n\r\n\t\t\t\tvar key = keys[ i ];\r\n\r\n\t\t\t\tif ( recursive ) {\r\n\r\n\t\t\t\t\tobject[ key ] = this.replaceUUIDObject( object[ key ], uuid, value );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( key === uuid ) {\r\n\r\n\t\t\t\t\tobject[ uuid ] = object[ key ];\r\n\r\n\t\t\t\t\tdelete object[ key ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn object === uuid ? value : object;\r\n\r\n\t},\r\n\r\n\treplaceUUID: function ( json, uuid, value ) {\r\n\r\n\t\tthis.replaceUUIDObject( json, uuid, value, false );\r\n\t\tthis.replaceUUIDObject( json.nodes, uuid, value );\r\n\t\tthis.replaceUUIDObject( json.materials, uuid, value );\r\n\t\tthis.replaceUUIDObject( json.passes, uuid, value );\r\n\t\tthis.replaceUUIDObject( json.library, uuid, value, false );\r\n\r\n\t\treturn json;\r\n\r\n\t}\r\n\r\n};\r\n\r\nObject.assign( NodeMaterialLoader.prototype, {\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new FileLoader( scope.manager );\r\n\t\tloader.setPath( scope.path );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tsetPath: function ( value ) {\r\n\r\n\t\tthis.path = value;\r\n\t\treturn this;\r\n\r\n\t},\r\n\r\n\tgetObjectByName: function ( uuid ) {\r\n\r\n\t\treturn this.names[ uuid ];\r\n\r\n\t},\r\n\r\n\tgetObjectById: function ( uuid ) {\r\n\r\n\t\treturn this.library[ uuid ] ||\r\n\t\t\tthis.nodes[ uuid ] ||\r\n\t\t\tthis.materials[ uuid ] ||\r\n\t\t\tthis.passes[ uuid ] ||\r\n\t\t\tthis.names[ uuid ];\r\n\r\n\t},\r\n\r\n\tgetNode: function ( uuid ) {\r\n\r\n\t\tvar object = this.getObjectById( uuid );\r\n\r\n\t\tif ( ! object ) {\r\n\r\n\t\t\tconsole.warn( \"Node \\\"\" + uuid + \"\\\" not found.\" );\r\n\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\r\n\t},\r\n\r\n\tresolve: function ( json ) {\r\n\r\n\t\tswitch ( typeof json ) {\r\n\r\n\t\t\tcase \"boolean\":\r\n\t\t\tcase \"number\":\r\n\r\n\t\t\t\treturn json;\r\n\r\n\t\t\tcase \"string\":\r\n\r\n\t\t\t\tif ( /^\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}$/i.test( json ) || this.library[ json ] ) {\r\n\r\n\t\t\t\t\treturn this.getNode( json );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn json;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tif ( Array.isArray( json ) ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tjson[ i ] = this.resolve( json[ i ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var prop in json ) {\r\n\r\n\t\t\t\t\t\tif ( prop === \"uuid\" ) continue;\r\n\r\n\t\t\t\t\t\tjson[ prop ] = this.resolve( json[ prop ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn json;\r\n\r\n\t},\r\n\r\n\tdeclare: function ( json ) {\r\n\r\n\t\tvar uuid, node, object;\r\n\r\n\t\tfor ( uuid in json.nodes ) {\r\n\r\n\t\t\tnode = json.nodes[ uuid ];\r\n\r\n\t\t\tobject = new Nodes[ node.nodeType + \"Node\" ]();\r\n\r\n\t\t\tif ( node.name ) {\r\n\r\n\t\t\t\tobject.name = node.name;\r\n\r\n\t\t\t\tthis.names[ object.name ] = object;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.nodes[ uuid ] = object;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( uuid in json.materials ) {\r\n\r\n\t\t\tnode = json.materials[ uuid ];\r\n\r\n\t\t\tobject = new Nodes[ node.type ]();\r\n\r\n\t\t\tif ( node.name ) {\r\n\r\n\t\t\t\tobject.name = node.name;\r\n\r\n\t\t\t\tthis.names[ object.name ] = object;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.materials[ uuid ] = object;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( uuid in json.passes ) {\r\n\r\n\t\t\tnode = json.passes[ uuid ];\r\n\r\n\t\t\tobject = new Nodes[ node.type ]();\r\n\r\n\t\t\tif ( node.name ) {\r\n\r\n\t\t\t\tobject.name = node.name;\r\n\r\n\t\t\t\tthis.names[ object.name ] = object;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.passes[ uuid ] = object;\r\n\r\n\t\t}\r\n\r\n\t\tif ( json.material ) this.material = this.materials[ json.material ];\r\n\r\n\t\tif ( json.pass ) this.pass = this.passes[ json.pass ];\r\n\r\n\t\treturn json;\r\n\r\n\t},\r\n\r\n\tparse: function ( json ) {\r\n\r\n\t\tvar uuid;\r\n\r\n\t\tjson = this.resolve( this.declare( json ) );\r\n\r\n\t\tfor ( uuid in json.nodes ) {\r\n\r\n\t\t\tthis.nodes[ uuid ].copy( json.nodes[ uuid ] );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( uuid in json.materials ) {\r\n\r\n\t\t\tthis.materials[ uuid ].copy( json.materials[ uuid ] );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( uuid in json.passes ) {\r\n\r\n\t\t\tthis.passes[ uuid ].copy( json.passes[ uuid ] );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.material || this.pass || this;\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { NodeMaterialLoader, NodeMaterialLoaderUtils };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/loaders/NodeMaterialLoader.js","<template>\r\n    <div class=\"webglLoaderNodes-container\">\r\n        <div id=\"container\"></div>\r\n\t\t<div id=\"info\">\r\n\t\t\t<a href=\"https://threejs.org\" target=\"_blank\" rel=\"noopener\">three.js</a> - Node-Based Material<br />\r\n\t\t\tSerialized using <a href=\"webgl_materials_nodes.html\">webgl_materials_nodes.html</a>\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { GUI } from '@/components/jsm/libs/dat.gui.module.js';\r\nimport { OrbitControls } from '@/components/jsm/controls/OrbitControls.js';\r\nimport { NodeMaterialLoader } from '@/components/jsm/loaders/NodeMaterialLoader.js';\r\nimport { TeapotBufferGeometry } from '@/components/jsm/geometries/TeapotBufferGeometry.js';\r\nimport { NodeFrame } from '@/components/jsm/nodes/core/NodeFrame.js';\r\nimport { NodeMaterial } from '@/components/jsm/nodes/materials/NodeMaterial.js';\r\nexport default {\r\n    data() {\r\n        return {\r\n            container: null,\r\n            renderer: null,\r\n            scene: null,\r\n            camera: null,\r\n            clock: null,\r\n            frame: null,\r\n            teapot: null,\r\n            mesh: null,\r\n            cloud: null,\r\n            controls: null,\r\n            gui: null,\r\n            param: { load: 'caustic' }\r\n        }\r\n    },\r\n    mounted() {\r\n        this.container = document.getElementById('container')\r\n        this.clock = new this.$THREE.Clock()\r\n        this.fov = 50\r\n        this.frame = new NodeFrame()\r\n        window.addEventListener('load', this.init)\r\n    },\r\n    beforeDestroy() {\r\n        this.gui.hide()\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.renderer = new this.$THREE.WebGLRenderer({ antialias: true })\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            this.renderer.setSize(window.innerWidth, window.innerHeight)\r\n            this.container.appendChild(this.renderer.domElement)\r\n            this.scene = new this.$THREE.Scene()\r\n            this.camera = new this.$THREE.PerspectiveCamera(this.fov, window.innerWidth / window.innerHeight, 1, 1000)\r\n            this.camera.position.x = 50\r\n            this.camera.position.z = - 50\r\n            this.camera.position.y = 30\r\n            this.camera.target = new this.$THREE.Vector3()\r\n            this.cloud = new this.$THREE.TextureLoader().load('static/textures/lava/cloud.png')\r\n            this.cloud.wrapS = this.cloud.wrapT = this.$THREE.RepeatWrapping\r\n            this.controls = new OrbitControls(this.camera, this.renderer.domElement)\r\n            this.controls.minDistance = 50\r\n            this.controls.maxDistance = 200\r\n            this.scene.add(new this.$THREE.AmbientLight(0x464646))\r\n            var light1 = new this.$THREE.DirectionalLight(0xffddcc, 1)\r\n            light1.position.set(1, 0.75, 0.5)\r\n            this.scene.add(light1)\r\n            var light2 = new this.$THREE.DirectionalLight(0xccccff, 1)\r\n            light2.position.set(- 1, 0.75, - 0.5)\r\n            this.scene.add(light2)\r\n            this.teapot = new TeapotBufferGeometry(15, 18)\r\n            this.mesh = new this.$THREE.Mesh(this.teapot)\r\n            this.scene.add(this.mesh)\r\n            window.addEventListener('resize', this.onWindowResize, false)\r\n            this.updateMaterial()\r\n            this.onWindowResize()\r\n            this.animate()\r\n        },\r\n        clearGui() {\r\n            if (this.gui) this.gui.destroy()\r\n            this.gui = new GUI()\r\n            this.gui.add(this.param, 'load', {\r\n                'caustic': 'caustic',\r\n                'displace': 'displace',\r\n                'wave': 'wave',\r\n                'xray': 'xray'\r\n            }).onFinishChange(() => {\r\n                this.updateMaterial()\r\n            })\r\n            this.gui.open()\r\n        },\r\n        addGui(name, value, callback, isColor, min, max) {\r\n            let node\r\n            this.param[ name ] = value\r\n            if (isColor) {\r\n                node = this.gui.addColor(this.param, name).onChange(() => {\r\n                    callback(this.param[ name ])\r\n                })\r\n            } else if (typeof value == 'object') {\r\n                node = this.gui.add(this.param, name, value).onChange(() => {\r\n                    callback(this.param[ name ])\r\n                })\r\n            } else {\r\n                node = this.gui.add(this.param, name, min, max).onChange(() => {\r\n                    callback(this.param[ name ])\r\n                })\r\n            }\r\n            return node\r\n        },\r\n        updateMaterial() {\r\n            if (this.mesh.material) this.mesh.material.dispose()\r\n            this.clearGui()\r\n            var url = \"static/nodes/\" + this.param.load + \".json\"\r\n            var library = {\r\n                \"cloud\": this.cloud\r\n            }\r\n            var loader = new NodeMaterialLoader(undefined, library).load(url, () => {\r\n                var time = loader.getObjectByName(\"time\")\r\n                if (time) {\r\n                    // enable time scale\r\n                    time.timeScale = true\r\n                    // gui\r\n                    this.addGui('timeScale', time.scale, (val) => {\r\n                        time.scale = val\r\n                    }, false, - 2, 2)\r\n                }\r\n                // set material\r\n                this.mesh.material = loader.material\r\n            })\r\n        },\r\n        onWindowResize() {\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n        },\r\n        animate() {\r\n            var delta = this.clock.getDelta()\r\n            // update material animation and/or gpu calcs (pre-renderer)\r\n            if (this.mesh.material instanceof NodeMaterial) this.frame.update(delta).updateNode(this.mesh.material)\r\n            this.renderer.render(this.scene, this.camera)\r\n            requestAnimationFrame(this.animate)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglLoaderNodes-container {\r\n    width: 100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/loader/webglLoaderNodes.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglLoaderNodes-container\"},[_c('div',{attrs:{\"id\":\"container\"}}),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"info\"}},[_c('a',{attrs:{\"href\":\"https://threejs.org\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"three.js\")]),_vm._v(\" - Node-Based Material\"),_c('br'),_vm._v(\"\\n\\t\\t\\tSerialized using \"),_c('a',{attrs:{\"href\":\"webgl_materials_nodes.html\"}},[_vm._v(\"webgl_materials_nodes.html\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-62076acc\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/loader/webglLoaderNodes.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-62076acc\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglLoaderNodes.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderNodes.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderNodes.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-62076acc\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglLoaderNodes.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-62076acc\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/loader/webglLoaderNodes.vue\n// module id = null\n// module chunks = ","import {\r\n\tBufferAttribute,\r\n\tBufferGeometry,\r\n\tMatrix4,\r\n\tVector3,\r\n\tVector4\r\n} from \"@/components/build/three.module.js\";\r\n\r\n/**\r\n * Tessellates the famous Utah teapot database by Martin Newell into triangles.\r\n *\r\n * Parameters: size = 50, segments = 10, bottom = true, lid = true, body = true,\r\n *   fitLid = false, blinn = true\r\n *\r\n * size is a relative scale: I've scaled the teapot to fit vertically between -1 and 1.\r\n * Think of it as a \"radius\".\r\n * segments - number of line segments to subdivide each patch edge;\r\n *   1 is possible but gives degenerates, so two is the real minimum.\r\n * bottom - boolean, if true (default) then the bottom patches are added. Some consider\r\n *   adding the bottom heresy, so set this to \"false\" to adhere to the One True Way.\r\n * lid - to remove the lid and look inside, set to true.\r\n * body - to remove the body and leave the lid, set this and \"bottom\" to false.\r\n * fitLid - the lid is a tad small in the original. This stretches it a bit so you can't\r\n *   see the teapot's insides through the gap.\r\n * blinn - Jim Blinn scaled the original data vertically by dividing by about 1.3 to look\r\n *   nicer. If you want to see the original teapot, similar to the real-world model, set\r\n *   this to false. True by default.\r\n *   See http://en.wikipedia.org/wiki/File:Original_Utah_Teapot.jpg for the original\r\n *   real-world teapot (from http://en.wikipedia.org/wiki/Utah_teapot).\r\n *\r\n * Note that the bottom (the last four patches) is not flat - blame Frank Crow, not me.\r\n *\r\n * The teapot should normally be rendered as a double sided object, since for some\r\n * patches both sides can be seen, e.g., the gap around the lid and inside the spout.\r\n *\r\n * Segments 'n' determines the number of triangles output.\r\n *   Total triangles = 32*2*n*n - 8*n    [degenerates at the top and bottom cusps are deleted]\r\n *\r\n *   size_factor   # triangles\r\n *       1          56\r\n *       2         240\r\n *       3         552\r\n *       4         992\r\n *\r\n *      10        6320\r\n *      20       25440\r\n *      30       57360\r\n *\r\n * Code converted from my ancient SPD software, http://tog.acm.org/resources/SPD/\r\n * Created for the Udacity course \"Interactive Rendering\", http://bit.ly/ericity\r\n * Lesson: https://www.udacity.com/course/viewer#!/c-cs291/l-68866048/m-106482448\r\n * YouTube video on teapot history: https://www.youtube.com/watch?v=DxMfblPzFNc\r\n *\r\n * See https://en.wikipedia.org/wiki/Utah_teapot for the history of the teapot\r\n *\r\n */\r\n\r\nvar TeapotBufferGeometry = function ( size, segments, bottom, lid, body, fitLid, blinn ) {\r\n\r\n\t// 32 * 4 * 4 Bezier spline patches\r\n\tvar teapotPatches = [\r\n\t\t/*rim*/\r\n\t\t0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\r\n\t\t3, 16, 17, 18, 7, 19, 20, 21, 11, 22, 23, 24, 15, 25, 26, 27,\r\n\t\t18, 28, 29, 30, 21, 31, 32, 33, 24, 34, 35, 36, 27, 37, 38, 39,\r\n\t\t30, 40, 41, 0, 33, 42, 43, 4, 36, 44, 45, 8, 39, 46, 47, 12,\r\n\t\t/*body*/\r\n\t\t12, 13, 14, 15, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59,\r\n\t\t15, 25, 26, 27, 51, 60, 61, 62, 55, 63, 64, 65, 59, 66, 67, 68,\r\n\t\t27, 37, 38, 39, 62, 69, 70, 71, 65, 72, 73, 74, 68, 75, 76, 77,\r\n\t\t39, 46, 47, 12, 71, 78, 79, 48, 74, 80, 81, 52, 77, 82, 83, 56,\r\n\t\t56, 57, 58, 59, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95,\r\n\t\t59, 66, 67, 68, 87, 96, 97, 98, 91, 99, 100, 101, 95, 102, 103, 104,\r\n\t\t68, 75, 76, 77, 98, 105, 106, 107, 101, 108, 109, 110, 104, 111, 112, 113,\r\n\t\t77, 82, 83, 56, 107, 114, 115, 84, 110, 116, 117, 88, 113, 118, 119, 92,\r\n\t\t/*handle*/\r\n\t\t120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135,\r\n\t\t123, 136, 137, 120, 127, 138, 139, 124, 131, 140, 141, 128, 135, 142, 143, 132,\r\n\t\t132, 133, 134, 135, 144, 145, 146, 147, 148, 149, 150, 151, 68, 152, 153, 154,\r\n\t\t135, 142, 143, 132, 147, 155, 156, 144, 151, 157, 158, 148, 154, 159, 160, 68,\r\n\t\t/*spout*/\r\n\t\t161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176,\r\n\t\t164, 177, 178, 161, 168, 179, 180, 165, 172, 181, 182, 169, 176, 183, 184, 173,\r\n\t\t173, 174, 175, 176, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196,\r\n\t\t176, 183, 184, 173, 188, 197, 198, 185, 192, 199, 200, 189, 196, 201, 202, 193,\r\n\t\t/*lid*/\r\n\t\t203, 203, 203, 203, 204, 205, 206, 207, 208, 208, 208, 208, 209, 210, 211, 212,\r\n\t\t203, 203, 203, 203, 207, 213, 214, 215, 208, 208, 208, 208, 212, 216, 217, 218,\r\n\t\t203, 203, 203, 203, 215, 219, 220, 221, 208, 208, 208, 208, 218, 222, 223, 224,\r\n\t\t203, 203, 203, 203, 221, 225, 226, 204, 208, 208, 208, 208, 224, 227, 228, 209,\r\n\t\t209, 210, 211, 212, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240,\r\n\t\t212, 216, 217, 218, 232, 241, 242, 243, 236, 244, 245, 246, 240, 247, 248, 249,\r\n\t\t218, 222, 223, 224, 243, 250, 251, 252, 246, 253, 254, 255, 249, 256, 257, 258,\r\n\t\t224, 227, 228, 209, 252, 259, 260, 229, 255, 261, 262, 233, 258, 263, 264, 237,\r\n\t\t/*bottom*/\r\n\t\t265, 265, 265, 265, 266, 267, 268, 269, 270, 271, 272, 273, 92, 119, 118, 113,\r\n\t\t265, 265, 265, 265, 269, 274, 275, 276, 273, 277, 278, 279, 113, 112, 111, 104,\r\n\t\t265, 265, 265, 265, 276, 280, 281, 282, 279, 283, 284, 285, 104, 103, 102, 95,\r\n\t\t265, 265, 265, 265, 282, 286, 287, 266, 285, 288, 289, 270, 95, 94, 93, 92\r\n\t];\r\n\r\n\tvar teapotVertices = [\r\n\t\t1.4, 0, 2.4,\r\n\t\t1.4, - 0.784, 2.4,\r\n\t\t0.784, - 1.4, 2.4,\r\n\t\t0, - 1.4, 2.4,\r\n\t\t1.3375, 0, 2.53125,\r\n\t\t1.3375, - 0.749, 2.53125,\r\n\t\t0.749, - 1.3375, 2.53125,\r\n\t\t0, - 1.3375, 2.53125,\r\n\t\t1.4375, 0, 2.53125,\r\n\t\t1.4375, - 0.805, 2.53125,\r\n\t\t0.805, - 1.4375, 2.53125,\r\n\t\t0, - 1.4375, 2.53125,\r\n\t\t1.5, 0, 2.4,\r\n\t\t1.5, - 0.84, 2.4,\r\n\t\t0.84, - 1.5, 2.4,\r\n\t\t0, - 1.5, 2.4,\r\n\t\t- 0.784, - 1.4, 2.4,\r\n\t\t- 1.4, - 0.784, 2.4,\r\n\t\t- 1.4, 0, 2.4,\r\n\t\t- 0.749, - 1.3375, 2.53125,\r\n\t\t- 1.3375, - 0.749, 2.53125,\r\n\t\t- 1.3375, 0, 2.53125,\r\n\t\t- 0.805, - 1.4375, 2.53125,\r\n\t\t- 1.4375, - 0.805, 2.53125,\r\n\t\t- 1.4375, 0, 2.53125,\r\n\t\t- 0.84, - 1.5, 2.4,\r\n\t\t- 1.5, - 0.84, 2.4,\r\n\t\t- 1.5, 0, 2.4,\r\n\t\t- 1.4, 0.784, 2.4,\r\n\t\t- 0.784, 1.4, 2.4,\r\n\t\t0, 1.4, 2.4,\r\n\t\t- 1.3375, 0.749, 2.53125,\r\n\t\t- 0.749, 1.3375, 2.53125,\r\n\t\t0, 1.3375, 2.53125,\r\n\t\t- 1.4375, 0.805, 2.53125,\r\n\t\t- 0.805, 1.4375, 2.53125,\r\n\t\t0, 1.4375, 2.53125,\r\n\t\t- 1.5, 0.84, 2.4,\r\n\t\t- 0.84, 1.5, 2.4,\r\n\t\t0, 1.5, 2.4,\r\n\t\t0.784, 1.4, 2.4,\r\n\t\t1.4, 0.784, 2.4,\r\n\t\t0.749, 1.3375, 2.53125,\r\n\t\t1.3375, 0.749, 2.53125,\r\n\t\t0.805, 1.4375, 2.53125,\r\n\t\t1.4375, 0.805, 2.53125,\r\n\t\t0.84, 1.5, 2.4,\r\n\t\t1.5, 0.84, 2.4,\r\n\t\t1.75, 0, 1.875,\r\n\t\t1.75, - 0.98, 1.875,\r\n\t\t0.98, - 1.75, 1.875,\r\n\t\t0, - 1.75, 1.875,\r\n\t\t2, 0, 1.35,\r\n\t\t2, - 1.12, 1.35,\r\n\t\t1.12, - 2, 1.35,\r\n\t\t0, - 2, 1.35,\r\n\t\t2, 0, 0.9,\r\n\t\t2, - 1.12, 0.9,\r\n\t\t1.12, - 2, 0.9,\r\n\t\t0, - 2, 0.9,\r\n\t\t- 0.98, - 1.75, 1.875,\r\n\t\t- 1.75, - 0.98, 1.875,\r\n\t\t- 1.75, 0, 1.875,\r\n\t\t- 1.12, - 2, 1.35,\r\n\t\t- 2, - 1.12, 1.35,\r\n\t\t- 2, 0, 1.35,\r\n\t\t- 1.12, - 2, 0.9,\r\n\t\t- 2, - 1.12, 0.9,\r\n\t\t- 2, 0, 0.9,\r\n\t\t- 1.75, 0.98, 1.875,\r\n\t\t- 0.98, 1.75, 1.875,\r\n\t\t0, 1.75, 1.875,\r\n\t\t- 2, 1.12, 1.35,\r\n\t\t- 1.12, 2, 1.35,\r\n\t\t0, 2, 1.35,\r\n\t\t- 2, 1.12, 0.9,\r\n\t\t- 1.12, 2, 0.9,\r\n\t\t0, 2, 0.9,\r\n\t\t0.98, 1.75, 1.875,\r\n\t\t1.75, 0.98, 1.875,\r\n\t\t1.12, 2, 1.35,\r\n\t\t2, 1.12, 1.35,\r\n\t\t1.12, 2, 0.9,\r\n\t\t2, 1.12, 0.9,\r\n\t\t2, 0, 0.45,\r\n\t\t2, - 1.12, 0.45,\r\n\t\t1.12, - 2, 0.45,\r\n\t\t0, - 2, 0.45,\r\n\t\t1.5, 0, 0.225,\r\n\t\t1.5, - 0.84, 0.225,\r\n\t\t0.84, - 1.5, 0.225,\r\n\t\t0, - 1.5, 0.225,\r\n\t\t1.5, 0, 0.15,\r\n\t\t1.5, - 0.84, 0.15,\r\n\t\t0.84, - 1.5, 0.15,\r\n\t\t0, - 1.5, 0.15,\r\n\t\t- 1.12, - 2, 0.45,\r\n\t\t- 2, - 1.12, 0.45,\r\n\t\t- 2, 0, 0.45,\r\n\t\t- 0.84, - 1.5, 0.225,\r\n\t\t- 1.5, - 0.84, 0.225,\r\n\t\t- 1.5, 0, 0.225,\r\n\t\t- 0.84, - 1.5, 0.15,\r\n\t\t- 1.5, - 0.84, 0.15,\r\n\t\t- 1.5, 0, 0.15,\r\n\t\t- 2, 1.12, 0.45,\r\n\t\t- 1.12, 2, 0.45,\r\n\t\t0, 2, 0.45,\r\n\t\t- 1.5, 0.84, 0.225,\r\n\t\t- 0.84, 1.5, 0.225,\r\n\t\t0, 1.5, 0.225,\r\n\t\t- 1.5, 0.84, 0.15,\r\n\t\t- 0.84, 1.5, 0.15,\r\n\t\t0, 1.5, 0.15,\r\n\t\t1.12, 2, 0.45,\r\n\t\t2, 1.12, 0.45,\r\n\t\t0.84, 1.5, 0.225,\r\n\t\t1.5, 0.84, 0.225,\r\n\t\t0.84, 1.5, 0.15,\r\n\t\t1.5, 0.84, 0.15,\r\n\t\t- 1.6, 0, 2.025,\r\n\t\t- 1.6, - 0.3, 2.025,\r\n\t\t- 1.5, - 0.3, 2.25,\r\n\t\t- 1.5, 0, 2.25,\r\n\t\t- 2.3, 0, 2.025,\r\n\t\t- 2.3, - 0.3, 2.025,\r\n\t\t- 2.5, - 0.3, 2.25,\r\n\t\t- 2.5, 0, 2.25,\r\n\t\t- 2.7, 0, 2.025,\r\n\t\t- 2.7, - 0.3, 2.025,\r\n\t\t- 3, - 0.3, 2.25,\r\n\t\t- 3, 0, 2.25,\r\n\t\t- 2.7, 0, 1.8,\r\n\t\t- 2.7, - 0.3, 1.8,\r\n\t\t- 3, - 0.3, 1.8,\r\n\t\t- 3, 0, 1.8,\r\n\t\t- 1.5, 0.3, 2.25,\r\n\t\t- 1.6, 0.3, 2.025,\r\n\t\t- 2.5, 0.3, 2.25,\r\n\t\t- 2.3, 0.3, 2.025,\r\n\t\t- 3, 0.3, 2.25,\r\n\t\t- 2.7, 0.3, 2.025,\r\n\t\t- 3, 0.3, 1.8,\r\n\t\t- 2.7, 0.3, 1.8,\r\n\t\t- 2.7, 0, 1.575,\r\n\t\t- 2.7, - 0.3, 1.575,\r\n\t\t- 3, - 0.3, 1.35,\r\n\t\t- 3, 0, 1.35,\r\n\t\t- 2.5, 0, 1.125,\r\n\t\t- 2.5, - 0.3, 1.125,\r\n\t\t- 2.65, - 0.3, 0.9375,\r\n\t\t- 2.65, 0, 0.9375,\r\n\t\t- 2, - 0.3, 0.9,\r\n\t\t- 1.9, - 0.3, 0.6,\r\n\t\t- 1.9, 0, 0.6,\r\n\t\t- 3, 0.3, 1.35,\r\n\t\t- 2.7, 0.3, 1.575,\r\n\t\t- 2.65, 0.3, 0.9375,\r\n\t\t- 2.5, 0.3, 1.125,\r\n\t\t- 1.9, 0.3, 0.6,\r\n\t\t- 2, 0.3, 0.9,\r\n\t\t1.7, 0, 1.425,\r\n\t\t1.7, - 0.66, 1.425,\r\n\t\t1.7, - 0.66, 0.6,\r\n\t\t1.7, 0, 0.6,\r\n\t\t2.6, 0, 1.425,\r\n\t\t2.6, - 0.66, 1.425,\r\n\t\t3.1, - 0.66, 0.825,\r\n\t\t3.1, 0, 0.825,\r\n\t\t2.3, 0, 2.1,\r\n\t\t2.3, - 0.25, 2.1,\r\n\t\t2.4, - 0.25, 2.025,\r\n\t\t2.4, 0, 2.025,\r\n\t\t2.7, 0, 2.4,\r\n\t\t2.7, - 0.25, 2.4,\r\n\t\t3.3, - 0.25, 2.4,\r\n\t\t3.3, 0, 2.4,\r\n\t\t1.7, 0.66, 0.6,\r\n\t\t1.7, 0.66, 1.425,\r\n\t\t3.1, 0.66, 0.825,\r\n\t\t2.6, 0.66, 1.425,\r\n\t\t2.4, 0.25, 2.025,\r\n\t\t2.3, 0.25, 2.1,\r\n\t\t3.3, 0.25, 2.4,\r\n\t\t2.7, 0.25, 2.4,\r\n\t\t2.8, 0, 2.475,\r\n\t\t2.8, - 0.25, 2.475,\r\n\t\t3.525, - 0.25, 2.49375,\r\n\t\t3.525, 0, 2.49375,\r\n\t\t2.9, 0, 2.475,\r\n\t\t2.9, - 0.15, 2.475,\r\n\t\t3.45, - 0.15, 2.5125,\r\n\t\t3.45, 0, 2.5125,\r\n\t\t2.8, 0, 2.4,\r\n\t\t2.8, - 0.15, 2.4,\r\n\t\t3.2, - 0.15, 2.4,\r\n\t\t3.2, 0, 2.4,\r\n\t\t3.525, 0.25, 2.49375,\r\n\t\t2.8, 0.25, 2.475,\r\n\t\t3.45, 0.15, 2.5125,\r\n\t\t2.9, 0.15, 2.475,\r\n\t\t3.2, 0.15, 2.4,\r\n\t\t2.8, 0.15, 2.4,\r\n\t\t0, 0, 3.15,\r\n\t\t0.8, 0, 3.15,\r\n\t\t0.8, - 0.45, 3.15,\r\n\t\t0.45, - 0.8, 3.15,\r\n\t\t0, - 0.8, 3.15,\r\n\t\t0, 0, 2.85,\r\n\t\t0.2, 0, 2.7,\r\n\t\t0.2, - 0.112, 2.7,\r\n\t\t0.112, - 0.2, 2.7,\r\n\t\t0, - 0.2, 2.7,\r\n\t\t- 0.45, - 0.8, 3.15,\r\n\t\t- 0.8, - 0.45, 3.15,\r\n\t\t- 0.8, 0, 3.15,\r\n\t\t- 0.112, - 0.2, 2.7,\r\n\t\t- 0.2, - 0.112, 2.7,\r\n\t\t- 0.2, 0, 2.7,\r\n\t\t- 0.8, 0.45, 3.15,\r\n\t\t- 0.45, 0.8, 3.15,\r\n\t\t0, 0.8, 3.15,\r\n\t\t- 0.2, 0.112, 2.7,\r\n\t\t- 0.112, 0.2, 2.7,\r\n\t\t0, 0.2, 2.7,\r\n\t\t0.45, 0.8, 3.15,\r\n\t\t0.8, 0.45, 3.15,\r\n\t\t0.112, 0.2, 2.7,\r\n\t\t0.2, 0.112, 2.7,\r\n\t\t0.4, 0, 2.55,\r\n\t\t0.4, - 0.224, 2.55,\r\n\t\t0.224, - 0.4, 2.55,\r\n\t\t0, - 0.4, 2.55,\r\n\t\t1.3, 0, 2.55,\r\n\t\t1.3, - 0.728, 2.55,\r\n\t\t0.728, - 1.3, 2.55,\r\n\t\t0, - 1.3, 2.55,\r\n\t\t1.3, 0, 2.4,\r\n\t\t1.3, - 0.728, 2.4,\r\n\t\t0.728, - 1.3, 2.4,\r\n\t\t0, - 1.3, 2.4,\r\n\t\t- 0.224, - 0.4, 2.55,\r\n\t\t- 0.4, - 0.224, 2.55,\r\n\t\t- 0.4, 0, 2.55,\r\n\t\t- 0.728, - 1.3, 2.55,\r\n\t\t- 1.3, - 0.728, 2.55,\r\n\t\t- 1.3, 0, 2.55,\r\n\t\t- 0.728, - 1.3, 2.4,\r\n\t\t- 1.3, - 0.728, 2.4,\r\n\t\t- 1.3, 0, 2.4,\r\n\t\t- 0.4, 0.224, 2.55,\r\n\t\t- 0.224, 0.4, 2.55,\r\n\t\t0, 0.4, 2.55,\r\n\t\t- 1.3, 0.728, 2.55,\r\n\t\t- 0.728, 1.3, 2.55,\r\n\t\t0, 1.3, 2.55,\r\n\t\t- 1.3, 0.728, 2.4,\r\n\t\t- 0.728, 1.3, 2.4,\r\n\t\t0, 1.3, 2.4,\r\n\t\t0.224, 0.4, 2.55,\r\n\t\t0.4, 0.224, 2.55,\r\n\t\t0.728, 1.3, 2.55,\r\n\t\t1.3, 0.728, 2.55,\r\n\t\t0.728, 1.3, 2.4,\r\n\t\t1.3, 0.728, 2.4,\r\n\t\t0, 0, 0,\r\n\t\t1.425, 0, 0,\r\n\t\t1.425, 0.798, 0,\r\n\t\t0.798, 1.425, 0,\r\n\t\t0, 1.425, 0,\r\n\t\t1.5, 0, 0.075,\r\n\t\t1.5, 0.84, 0.075,\r\n\t\t0.84, 1.5, 0.075,\r\n\t\t0, 1.5, 0.075,\r\n\t\t- 0.798, 1.425, 0,\r\n\t\t- 1.425, 0.798, 0,\r\n\t\t- 1.425, 0, 0,\r\n\t\t- 0.84, 1.5, 0.075,\r\n\t\t- 1.5, 0.84, 0.075,\r\n\t\t- 1.5, 0, 0.075,\r\n\t\t- 1.425, - 0.798, 0,\r\n\t\t- 0.798, - 1.425, 0,\r\n\t\t0, - 1.425, 0,\r\n\t\t- 1.5, - 0.84, 0.075,\r\n\t\t- 0.84, - 1.5, 0.075,\r\n\t\t0, - 1.5, 0.075,\r\n\t\t0.798, - 1.425, 0,\r\n\t\t1.425, - 0.798, 0,\r\n\t\t0.84, - 1.5, 0.075,\r\n\t\t1.5, - 0.84, 0.075\r\n\t];\r\n\r\n\tBufferGeometry.call( this );\r\n\r\n\tsize = size || 50;\r\n\r\n\t// number of segments per patch\r\n\tsegments = segments !== undefined ? Math.max( 2, Math.floor( segments ) || 10 ) : 10;\r\n\r\n\t// which parts should be visible\r\n\tbottom = bottom === undefined ? true : bottom;\r\n\tlid = lid === undefined ? true : lid;\r\n\tbody = body === undefined ? true : body;\r\n\r\n\t// Should the lid be snug? It's not traditional, but we make it snug by default\r\n\tfitLid = fitLid === undefined ? true : fitLid;\r\n\r\n\t// Jim Blinn scaled the teapot down in size by about 1.3 for\r\n\t// some rendering tests. He liked the new proportions that he kept\r\n\t// the data in this form. The model was distributed with these new\r\n\t// proportions and became the norm. Trivia: comparing images of the\r\n\t// real teapot and the computer model, the ratio for the bowl of the\r\n\t// real teapot is more like 1.25, but since 1.3 is the traditional\r\n\t// value given, we use it here.\r\n\tvar blinnScale = 1.3;\r\n\tblinn = blinn === undefined ? true : blinn;\r\n\r\n\t// scale the size to be the real scaling factor\r\n\tvar maxHeight = 3.15 * ( blinn ? 1 : blinnScale );\r\n\r\n\tvar maxHeight2 = maxHeight / 2;\r\n\tvar trueSize = size / maxHeight2;\r\n\r\n\t// Number of elements depends on what is needed. Subtract degenerate\r\n\t// triangles at tip of bottom and lid out in advance.\r\n\tvar numTriangles = bottom ? ( 8 * segments - 4 ) * segments : 0;\r\n\tnumTriangles += lid ? ( 16 * segments - 4 ) * segments : 0;\r\n\tnumTriangles += body ? 40 * segments * segments : 0;\r\n\r\n\tvar indices = new Uint32Array( numTriangles * 3 );\r\n\r\n\tvar numVertices = bottom ? 4 : 0;\r\n\tnumVertices += lid ? 8 : 0;\r\n\tnumVertices += body ? 20 : 0;\r\n\tnumVertices *= ( segments + 1 ) * ( segments + 1 );\r\n\r\n\tvar vertices = new Float32Array( numVertices * 3 );\r\n\tvar normals = new Float32Array( numVertices * 3 );\r\n\tvar uvs = new Float32Array( numVertices * 2 );\r\n\r\n\t// Bezier form\r\n\tvar ms = new Matrix4();\r\n\tms.set(\r\n\t\t- 1.0, 3.0, - 3.0, 1.0,\r\n\t\t3.0, - 6.0, 3.0, 0.0,\r\n\t\t- 3.0, 3.0, 0.0, 0.0,\r\n\t\t1.0, 0.0, 0.0, 0.0 );\r\n\r\n\tvar g = [];\r\n\tvar i, r, c;\r\n\r\n\tvar sp = [];\r\n\tvar tp = [];\r\n\tvar dsp = [];\r\n\tvar dtp = [];\r\n\r\n\t// M * G * M matrix, sort of see\r\n\t// http://www.cs.helsinki.fi/group/goa/mallinnus/curves/surfaces.html\r\n\tvar mgm = [];\r\n\r\n\tvar vert = [];\r\n\tvar sdir = [];\r\n\tvar tdir = [];\r\n\r\n\tvar norm = new Vector3();\r\n\r\n\tvar tcoord;\r\n\r\n\tvar sstep, tstep;\r\n\tvar vertPerRow;\r\n\r\n\tvar s, t, sval, tval, p;\r\n\tvar dsval = 0;\r\n\tvar dtval = 0;\r\n\r\n\tvar normOut = new Vector3();\r\n\tvar v1, v2, v3, v4;\r\n\r\n\tvar gmx = new Matrix4();\r\n\tvar tmtx = new Matrix4();\r\n\r\n\tvar vsp = new Vector4();\r\n\tvar vtp = new Vector4();\r\n\tvar vdsp = new Vector4();\r\n\tvar vdtp = new Vector4();\r\n\r\n\tvar vsdir = new Vector3();\r\n\tvar vtdir = new Vector3();\r\n\r\n\tvar mst = ms.clone();\r\n\tmst.transpose();\r\n\r\n\t// internal function: test if triangle has any matching vertices;\r\n\t// if so, don't save triangle, since it won't display anything.\r\n\tvar notDegenerate = function ( vtx1, vtx2, vtx3 ) {\r\n\r\n\t\t// if any vertex matches, return false\r\n\t\treturn ! ( ( ( vertices[ vtx1 * 3 ] === vertices[ vtx2 * 3 ] ) &&\r\n\t\t\t\t\t ( vertices[ vtx1 * 3 + 1 ] === vertices[ vtx2 * 3 + 1 ] ) &&\r\n\t\t\t\t\t ( vertices[ vtx1 * 3 + 2 ] === vertices[ vtx2 * 3 + 2 ] ) ) ||\r\n\t\t\t\t   ( ( vertices[ vtx1 * 3 ] === vertices[ vtx3 * 3 ] ) &&\r\n\t\t\t\t\t ( vertices[ vtx1 * 3 + 1 ] === vertices[ vtx3 * 3 + 1 ] ) &&\r\n\t\t\t\t\t ( vertices[ vtx1 * 3 + 2 ] === vertices[ vtx3 * 3 + 2 ] ) ) ||\r\n\t\t\t\t   ( ( vertices[ vtx2 * 3 ] === vertices[ vtx3 * 3 ] ) &&\r\n\t\t\t\t\t ( vertices[ vtx2 * 3 + 1 ] === vertices[ vtx3 * 3 + 1 ] ) &&\r\n\t\t\t\t\t ( vertices[ vtx2 * 3 + 2 ] === vertices[ vtx3 * 3 + 2 ] ) ) );\r\n\r\n\t};\r\n\r\n\r\n\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\tmgm[ i ] = new Matrix4();\r\n\r\n\t}\r\n\r\n\tvar minPatches = body ? 0 : 20;\r\n\tvar maxPatches = bottom ? 32 : 28;\r\n\r\n\tvertPerRow = segments + 1;\r\n\r\n\tvar surfCount = 0;\r\n\r\n\tvar vertCount = 0;\r\n\tvar normCount = 0;\r\n\tvar uvCount = 0;\r\n\r\n\tvar indexCount = 0;\r\n\r\n\tfor ( var surf = minPatches; surf < maxPatches; surf ++ ) {\r\n\r\n\t\t// lid is in the middle of the data, patches 20-27,\r\n\t\t// so ignore it for this part of the loop if the lid is not desired\r\n\t\tif ( lid || ( surf < 20 || surf >= 28 ) ) {\r\n\r\n\t\t\t// get M * G * M matrix for x,y,z\r\n\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t// get control patches\r\n\t\t\t\tfor ( r = 0; r < 4; r ++ ) {\r\n\r\n\t\t\t\t\tfor ( c = 0; c < 4; c ++ ) {\r\n\r\n\t\t\t\t\t\t// transposed\r\n\t\t\t\t\t\tg[ c * 4 + r ] = teapotVertices[ teapotPatches[ surf * 16 + r * 4 + c ] * 3 + i ];\r\n\r\n\t\t\t\t\t\t// is the lid to be made larger, and is this a point on the lid\r\n\t\t\t\t\t\t// that is X or Y?\r\n\t\t\t\t\t\tif ( fitLid && ( surf >= 20 && surf < 28 ) && ( i !== 2 ) ) {\r\n\r\n\t\t\t\t\t\t\t// increase XY size by 7.7%, found empirically. I don't\r\n\t\t\t\t\t\t\t// increase Z so that the teapot will continue to fit in the\r\n\t\t\t\t\t\t\t// space -1 to 1 for Y (Y is up for the final model).\r\n\t\t\t\t\t\t\tg[ c * 4 + r ] *= 1.077;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Blinn \"fixed\" the teapot by dividing Z by blinnScale, and that's the\r\n\t\t\t\t\t\t// data we now use. The original teapot is taller. Fix it:\r\n\t\t\t\t\t\tif ( ! blinn && ( i === 2 ) ) {\r\n\r\n\t\t\t\t\t\t\tg[ c * 4 + r ] *= blinnScale;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgmx.set( g[ 0 ], g[ 1 ], g[ 2 ], g[ 3 ], g[ 4 ], g[ 5 ], g[ 6 ], g[ 7 ], g[ 8 ], g[ 9 ], g[ 10 ], g[ 11 ], g[ 12 ], g[ 13 ], g[ 14 ], g[ 15 ] );\r\n\r\n\t\t\t\ttmtx.multiplyMatrices( gmx, ms );\r\n\t\t\t\tmgm[ i ].multiplyMatrices( mst, tmtx );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// step along, get points, and output\r\n\t\t\tfor ( sstep = 0; sstep <= segments; sstep ++ ) {\r\n\r\n\t\t\t\ts = sstep / segments;\r\n\r\n\t\t\t\tfor ( tstep = 0; tstep <= segments; tstep ++ ) {\r\n\r\n\t\t\t\t\tt = tstep / segments;\r\n\r\n\t\t\t\t\t// point from basis\r\n\t\t\t\t\t// get power vectors and their derivatives\r\n\t\t\t\t\tfor ( p = 4, sval = tval = 1.0; p --; ) {\r\n\r\n\t\t\t\t\t\tsp[ p ] = sval;\r\n\t\t\t\t\t\ttp[ p ] = tval;\r\n\t\t\t\t\t\tsval *= s;\r\n\t\t\t\t\t\ttval *= t;\r\n\r\n\t\t\t\t\t\tif ( p === 3 ) {\r\n\r\n\t\t\t\t\t\t\tdsp[ p ] = dtp[ p ] = 0.0;\r\n\t\t\t\t\t\t\tdsval = dtval = 1.0;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tdsp[ p ] = dsval * ( 3 - p );\r\n\t\t\t\t\t\t\tdtp[ p ] = dtval * ( 3 - p );\r\n\t\t\t\t\t\t\tdsval *= s;\r\n\t\t\t\t\t\t\tdtval *= t;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvsp.fromArray( sp );\r\n\t\t\t\t\tvtp.fromArray( tp );\r\n\t\t\t\t\tvdsp.fromArray( dsp );\r\n\t\t\t\t\tvdtp.fromArray( dtp );\r\n\r\n\t\t\t\t\t// do for x,y,z\r\n\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\t\t// multiply power vectors times matrix to get value\r\n\t\t\t\t\t\ttcoord = vsp.clone();\r\n\t\t\t\t\t\ttcoord.applyMatrix4( mgm[ i ] );\r\n\t\t\t\t\t\tvert[ i ] = tcoord.dot( vtp );\r\n\r\n\t\t\t\t\t\t// get s and t tangent vectors\r\n\t\t\t\t\t\ttcoord = vdsp.clone();\r\n\t\t\t\t\t\ttcoord.applyMatrix4( mgm[ i ] );\r\n\t\t\t\t\t\tsdir[ i ] = tcoord.dot( vtp );\r\n\r\n\t\t\t\t\t\ttcoord = vsp.clone();\r\n\t\t\t\t\t\ttcoord.applyMatrix4( mgm[ i ] );\r\n\t\t\t\t\t\ttdir[ i ] = tcoord.dot( vdtp );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// find normal\r\n\t\t\t\t\tvsdir.fromArray( sdir );\r\n\t\t\t\t\tvtdir.fromArray( tdir );\r\n\t\t\t\t\tnorm.crossVectors( vtdir, vsdir );\r\n\t\t\t\t\tnorm.normalize();\r\n\r\n\t\t\t\t\t// if X and Z length is 0, at the cusp, so point the normal up or down, depending on patch number\r\n\t\t\t\t\tif ( vert[ 0 ] === 0 && vert[ 1 ] === 0 ) {\r\n\r\n\t\t\t\t\t\t// if above the middle of the teapot, normal points up, else down\r\n\t\t\t\t\t\tnormOut.set( 0, vert[ 2 ] > maxHeight2 ? 1 : - 1, 0 );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// standard output: rotate on X axis\r\n\t\t\t\t\t\tnormOut.set( norm.x, norm.z, - norm.y );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// store it all\r\n\t\t\t\t\tvertices[ vertCount ++ ] = trueSize * vert[ 0 ];\r\n\t\t\t\t\tvertices[ vertCount ++ ] = trueSize * ( vert[ 2 ] - maxHeight2 );\r\n\t\t\t\t\tvertices[ vertCount ++ ] = - trueSize * vert[ 1 ];\r\n\r\n\t\t\t\t\tnormals[ normCount ++ ] = normOut.x;\r\n\t\t\t\t\tnormals[ normCount ++ ] = normOut.y;\r\n\t\t\t\t\tnormals[ normCount ++ ] = normOut.z;\r\n\r\n\t\t\t\t\tuvs[ uvCount ++ ] = 1 - t;\r\n\t\t\t\t\tuvs[ uvCount ++ ] = 1 - s;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// save the faces\r\n\t\t\tfor ( sstep = 0; sstep < segments; sstep ++ ) {\r\n\r\n\t\t\t\tfor ( tstep = 0; tstep < segments; tstep ++ ) {\r\n\r\n\t\t\t\t\tv1 = surfCount * vertPerRow * vertPerRow + sstep * vertPerRow + tstep;\r\n\t\t\t\t\tv2 = v1 + 1;\r\n\t\t\t\t\tv3 = v2 + vertPerRow;\r\n\t\t\t\t\tv4 = v1 + vertPerRow;\r\n\r\n\t\t\t\t\t// Normals and UVs cannot be shared. Without clone(), you can see the consequences\r\n\t\t\t\t\t// of sharing if you call geometry.applyMatrix4( matrix ).\r\n\t\t\t\t\tif ( notDegenerate( v1, v2, v3 ) ) {\r\n\r\n\t\t\t\t\t\tindices[ indexCount ++ ] = v1;\r\n\t\t\t\t\t\tindices[ indexCount ++ ] = v2;\r\n\t\t\t\t\t\tindices[ indexCount ++ ] = v3;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( notDegenerate( v1, v3, v4 ) ) {\r\n\r\n\t\t\t\t\t\tindices[ indexCount ++ ] = v1;\r\n\t\t\t\t\t\tindices[ indexCount ++ ] = v3;\r\n\t\t\t\t\t\tindices[ indexCount ++ ] = v4;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// increment only if a surface was used\r\n\t\t\tsurfCount ++;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.setIndex( new BufferAttribute( indices, 1 ) );\r\n\tthis.setAttribute( 'position', new BufferAttribute( vertices, 3 ) );\r\n\tthis.setAttribute( 'normal', new BufferAttribute( normals, 3 ) );\r\n\tthis.setAttribute( 'uv', new BufferAttribute( uvs, 2 ) );\r\n\r\n\tthis.computeBoundingSphere();\r\n\r\n};\r\n\r\n\r\nTeapotBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\nTeapotBufferGeometry.prototype.constructor = TeapotBufferGeometry;\r\n\r\nexport { TeapotBufferGeometry };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/geometries/TeapotBufferGeometry.js"],"sourceRoot":""}