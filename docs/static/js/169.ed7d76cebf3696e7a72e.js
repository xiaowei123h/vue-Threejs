webpackJsonp([169],{"5lP+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("wIBv"),i=r("Y95o"),o=r("z8c2"),s={data:function(){return{container:null,camera:null,scene:null,renderer:null,controller1:null,controller2:null,controllerGrip1:null,controllerGrip2:null,box:null,controllers:[],oscillators:[],controls:null,group:null,audioCtx:null}},mounted:function(){this.box=new this.$THREE.Box3,this.init(),this.animate()},methods:{initAudio:function(){function e(){var e=this.audioCtx.createOscillator(),t=Array.from({length:8192},function(e,t){return 0===t?0:4/(t*Math.PI)*Math.sin(Math.PI*t*.18)}),r=t.map(function(){return 0});return e.setPeriodicWave(this.audioCtx.createPeriodicWave(Float32Array.from(t),Float32Array.from(r))),e.start(),e}null===this.audioCtx&&(this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.oscillators.push(e()),this.oscillators.push(e()),window.this.oscillators=this.oscillators)},init:function(){var e=this;this.container=document.createElement("div"),document.getElementsByClassName("webxrVrHaptics-container")[0].appendChild(this.container),this.scene=new this.$THREE.Scene,this.scene.background=new this.$THREE.Color(8421504),this.camera=new this.$THREE.PerspectiveCamera(50,this.$webglInnerWidth/window.innerHeight,.1,10),this.camera.position.set(0,1.6,3),this.controls=new n.b(this.camera,this.container),this.controls.target.set(0,1.6,0),this.controls.update();var t=new this.$THREE.PlaneBufferGeometry(4,4),r=new this.$THREE.MeshStandardMaterial({color:15658734,roughness:1,metalness:0}),s=new this.$THREE.Mesh(t,r);s.rotation.x=-Math.PI/2,s.receiveShadow=!0,this.scene.add(s),this.scene.add(new this.$THREE.HemisphereLight(8421504,6316128));var l=new this.$THREE.DirectionalLight(16777215);l.position.set(0,6,0),l.castShadow=!0,l.shadow.camera.top=2,l.shadow.camera.bottom=-2,l.shadow.camera.right=2,l.shadow.camera.left=-2,l.shadow.mapSize.set(4096,4096),this.scene.add(l),this.group=new this.$THREE.Group,this.group.position.z=-.5,this.scene.add(this.group);for(var a=0;a<10;a++){var c=(a+1)/10,h=new this.$THREE.BoxBufferGeometry(.1,.1*a+1,.1),d=new this.$THREE.MeshStandardMaterial({color:new this.$THREE.Color(c,.1,.1),roughness:.7,metalness:0}),u=new this.$THREE.Mesh(h,d);u.position.x=(a-5)*(.1+.05),u.castShadow=!0,u.receiveShadow=!0,u.userData={index:a+1,intensity:c},this.group.add(u)}this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.renderer.outputEncoding=this.$THREE.sRGBEncoding,this.renderer.shadowMap.enabled=!0,this.renderer.xr.enabled=!0,this.container.appendChild(this.renderer.domElement),document.getElementsByClassName("webxrVrHaptics-container")[0].appendChild(i.a.createButton(this.renderer)),document.getElementById("VRButton").addEventListener("click",function(){e.initAudio()}),this.controller1=this.renderer.xr.getController(0),this.scene.add(this.controller1),this.controller2=this.renderer.xr.getController(1),this.scene.add(this.controller2);var p=new o.a;this.controllerGrip1=this.renderer.xr.getControllerGrip(0),this.controllerGrip1.addEventListener("connected",this.controllerConnected),this.controllerGrip1.addEventListener("disconnected",this.controllerDisconnected),this.controllerGrip1.add(p.createControllerModel(this.controllerGrip1)),this.scene.add(this.controllerGrip1),this.controllerGrip2=this.renderer.xr.getControllerGrip(1),this.controllerGrip2.addEventListener("connected",this.controllerConnected),this.controllerGrip2.addEventListener("disconnected",this.controllerDisconnected),this.controllerGrip2.add(p.createControllerModel(this.controllerGrip2)),this.scene.add(this.controllerGrip2),window.addEventListener("resize",this.onWindowResize,!1)},controllerConnected:function(e){this.controllers.push({gamepad:e.data.gamepad,grip:e.target,colliding:!1,playing:!1})},controllerDisconnected:function(e){var t=this.controllers.findIndex(function(t){return t.controller===e.target});-1!==t&&this.controllers.splice(t,1)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){this.renderer.setAnimationLoop(this.render)},handleCollisions:function(){for(var e=0;e<this.controllers.length;e++){this.controllers[e].colliding=!1;var t=this.controllers[e],r=t.grip,n=t.gamepad,i={radius:.03,center:r.position};if("hapticActuators"in n&&null!=n.hapticActuators&&n.hapticActuators.length>0)for(var o=0;o<group.children.length;o++){var s=group.children[o];if(box.setFromObject(s),box.intersectsSphere(i)){s.material.emissive.b=1;var l=s.userData.index/group.children.length;s.scale.setScalar(1+.1*Math.random()*l),n.hapticActuators[0].pulse(l,100),oscillators[e].frequency.value=100+60*l,this.controllers[e].colliding=!0}else s.material.emissive.b=0,s.scale.setScalar(1)}this.controllers[e].colliding?this.controllers[e].playing||(this.controllers[e].playing=!0,oscillators[e].connect(this.audioCtx.destination)):this.controllers[e].playing&&(this.controllers[e].playing=!1,oscillators[e].disconnect(this.audioCtx.destination))}},render:function(){this.handleCollisions(),this.renderer.render(this.scene,this.camera)}}},l={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webxrVrHaptics-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" vr - haptics\n\t\t")])])}]};var a=r("VU/8")(s,l,!1,function(e){r("zhp9")},"data-v-6a73e952",null);t.default=a.exports},zhp9:function(e,t){}});
//# sourceMappingURL=169.ed7d76cebf3696e7a72e.js.map