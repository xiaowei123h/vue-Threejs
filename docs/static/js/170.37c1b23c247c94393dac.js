webpackJsonp([170],{Dhxs:function(e,t){},WHmp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s,i=n("wIBv"),o=(r=regeneratorRuntime.mark(function e(){var t,n,r,s,i,o,c,d,h,u,l,m,w,f,p,v,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(y=function(){var e=performance.now();if(v>0){var t=(e-v)/1e3;c.stepSimulation(t,10)}v=e;for(var n=0,r=u.length;n<r;n++){var s=u[n];if(s.isInstancedMesh){for(var i=s.instanceMatrix.array,o=l.get(s),h=0;h<o.length;h++){o[h].getMotionState().getWorldTransform(d),a(d.getOrigin(),d.getRotation(),i,16*h)}s.instanceMatrix.needsUpdate=!0}else if(s.isMesh){l.get(s).getMotionState().getWorldTransform(d);var m=d.getOrigin(),w=d.getRotation();s.position.set(m.x(),m.y(),m.z()),s.quaternion.set(w.x(),w.y(),w.z(),w.w())}}},p=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e.isInstancedMesh){var s=l.get(e)[r];s.setAngularVelocity(new t.btVector3(0,0,0)),s.setLinearVelocity(new t.btVector3(0,0,0)),d.setIdentity(),d.setOrigin(new t.btVector3(n.x,n.y,n.z)),s.setWorldTransform(d)}else if(e.isMesh){var i=l.get(e);i.setAngularVelocity(new t.btVector3(0,0,0)),i.setLinearVelocity(new t.btVector3(0,0,0)),d.setIdentity(),d.setOrigin(new t.btVector3(n.x,n.y,n.z)),i.setWorldTransform(d)}},f=function(e,n,r){for(var s=e.instanceMatrix.array,i=[],o=0;o<e.count;o++){var a=16*o,d=new t.btTransform;d.setFromOpenGLMatrix(s.slice(a,a+16));var h=new t.btDefaultMotionState(d),m=new t.btVector3(0,0,0);r.calculateLocalInertia(n,m);var w=new t.btRigidBodyConstructionInfo(n,h,r,m),f=new t.btRigidBody(w);c.addRigidBody(f),i.push(f)}n>0&&(e.instanceMatrix.setUsage(35048),u.push(e),l.set(e,i))},w=function(e,n,r){var s=e.position,i=e.quaternion,o=new t.btTransform;o.setIdentity(),o.setOrigin(new t.btVector3(s.x,s.y,s.z)),o.setRotation(new t.btQuaternion(i.x,i.y,i.z,i.w));var a=new t.btDefaultMotionState(o),d=new t.btVector3(0,0,0);r.calculateLocalInertia(n,d);var h=new t.btRigidBodyConstructionInfo(n,a,r,d),m=new t.btRigidBody(h);c.addRigidBody(m),n>0&&(u.push(e),l.set(e,m))},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=h(e.geometry);null!==n&&(e.isInstancedMesh?f(e,t,n):e.isMesh&&w(e,t,n))},h=function(e){var n=e.parameters;if("BoxBufferGeometry"===e.type){var r=void 0!==n.width?n.width/2:.5,s=void 0!==n.height?n.height/2:.5,i=void 0!==n.depth?n.depth/2:.5,o=new t.btBoxShape(new t.btVector3(r,s,i));return o.setMargin(.05),o}if("SphereBufferGeometry"===e.type||"IcosahedronBufferGeometry"===e.type){var a=void 0!==n.radius?n.radius:1,c=new t.btSphereShape(a);return c.setMargin(.05),c}return null},"Ammo"in window!=!1){e.next=9;break}return console.error("AmmoPhysics: Couldn't find Ammo.js"),e.abrupt("return");case 9:return e.next=11,Ammo();case 11:return t=e.sent,n=60,r=new t.btDefaultCollisionConfiguration,s=new t.btCollisionDispatcher(r),i=new t.btDbvtBroadphase,o=new t.btSequentialImpulseConstraintSolver,(c=new t.btDiscreteDynamicsWorld(s,i,o,r)).setGravity(new t.btVector3(0,-9.8,0)),d=new t.btTransform,u=[],l=new WeakMap,v=0,setInterval(y,1e3/n),e.abrupt("return",{addMesh:m,setMeshPosition:p});case 25:case"end":return e.stop()}},e,this)}),s=function(){var e=r.apply(this,arguments);return new Promise(function(t,n){return function r(s,i){try{var o=e[s](i),a=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});t(a)}("next")})},function(){return s.apply(this,arguments)});function a(e,t,n,r){var s=t.x(),i=t.y(),o=t.z(),a=t.w(),c=s+s,d=i+i,h=o+o,u=s*c,l=s*d,m=s*h,w=i*d,f=i*h,p=o*h,v=a*c,y=a*d,g=a*h;n[r+0]=1-(w+p),n[r+1]=l+g,n[r+2]=m-y,n[r+3]=0,n[r+4]=l-g,n[r+5]=1-(u+p),n[r+6]=f+v,n[r+7]=0,n[r+8]=m+y,n[r+9]=f-v,n[r+10]=1-(u+w),n[r+11]=0,n[r+12]=e.x(),n[r+13]=e.y(),n[r+14]=e.z(),n[r+15]=1}var c={data:function(){return{camera:null,scene:null,renderer:null,stats:null,physics:null,position:null,boxes:null,spheres:null}},mounted:function(){this.init()},methods:{init:function(){var e,t=this;return(e=regeneratorRuntime.mark(function e(){var n,r,s,a,c,d,h,u,l,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:for(t.physics=e.sent,t.position=new t.$THREE.Vector3,t.camera=new t.$THREE.PerspectiveCamera(50,t.$webglInnerWidth/window.innerHeight,.1,100),t.camera.position.set(-1,1.5,2),t.camera.lookAt(0,.5,0),t.scene=new t.$THREE.Scene,t.scene.background=new t.$THREE.Color(6710886),(n=new t.$THREE.HemisphereLight).intensity=.35,t.scene.add(n),(r=new t.$THREE.DirectionalLight).position.set(5,5,5),r.castShadow=!0,r.shadow.camera.zoom=2,t.scene.add(r),(s=new t.$THREE.Mesh(new t.$THREE.BoxBufferGeometry(10,5,10),new t.$THREE.ShadowMaterial({color:1118481}))).position.y=-2.5,s.receiveShadow=!0,t.scene.add(s),t.physics.addMesh(s),a=new t.$THREE.MeshLambertMaterial,c=new t.$THREE.Matrix4,d=new t.$THREE.Color,h=new t.$THREE.BoxBufferGeometry(.1,.1,.1),t.boxes=new t.$THREE.InstancedMesh(h,a,100),t.boxes.castShadow=!0,t.boxes.receiveShadow=!0,t.scene.add(t.boxes),u=0;u<t.boxes.count;u++)c.setPosition(Math.random()-.5,2*Math.random(),Math.random()-.5),t.boxes.setMatrixAt(u,c),t.boxes.setColorAt(u,d.setHex(16777215*Math.random()));for(t.physics.addMesh(t.boxes,1),l=new t.$THREE.IcosahedronBufferGeometry(.075,3),t.spheres=new t.$THREE.InstancedMesh(l,a,100),t.spheres.castShadow=!0,t.spheres.receiveShadow=!0,t.scene.add(t.spheres),u=0;u<t.spheres.count;u++)c.setPosition(Math.random()-.5,2*Math.random(),Math.random()-.5),t.spheres.setMatrixAt(u,c),t.spheres.setColorAt(u,d.setHex(16777215*Math.random()));t.physics.addMesh(t.spheres,1),t.renderer=new t.$THREE.WebGLRenderer({antialias:!0}),t.renderer.setPixelRatio(window.devicePixelRatio),t.renderer.setSize(t.$webglInnerWidth,window.innerHeight),t.renderer.shadowMap.enabled=!0,t.renderer.outputEncoding=t.$THREE.sRGBEncoding,document.getElementsByClassName("physicsAmmoInstancing-container")[0].appendChild(t.renderer.domElement),t.stats=new t.$Stats,t.stats.dom.style.left="280px",document.getElementsByClassName("physicsAmmoInstancing-container")[0].appendChild(t.stats.dom),(m=new i.b(t.camera,t.renderer.domElement)).target.y=.5,m.update(),t.animate(),window.addEventListener("resize",t.onWindowResize,!1);case 53:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(s,i){try{var o=t[s](i),a=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(a).then(function(e){r("next",e)},function(e){r("throw",e)});e(a)}("next")})})()},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate);var e=Math.floor(Math.random()*this.boxes.count);this.position.set(0,Math.random()+1,0),this.physics.setMeshPosition(this.boxes,this.position,e),e=Math.floor(Math.random()*this.spheres.count),this.position.set(0,Math.random()+1,0),this.physics.setMeshPosition(this.spheres,this.position,e),this.renderer.render(this.scene,this.camera),this.stats.update()}}},d={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"physicsAmmoInstancing-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" physics - ammo.js instancing\n\t\t")])])}]};var h=n("VU/8")(c,d,!1,function(e){n("Dhxs")},"data-v-69f02276",null);t.default=h.exports}});
//# sourceMappingURL=170.37c1b23c247c94393dac.js.map