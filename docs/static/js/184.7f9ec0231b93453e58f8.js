webpackJsonp([184],{GBHp:function(e,t){},UYsY:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("QEtz"),r=i("FktL");function s(e,t,i,n,r,s,a,o,h){var u=this;this.clearColor=s,this.camera=new a.PerspectiveCamera(n,(window.innerWidth-281)/window.innerHeight,1,1e4),this.camera.position.z=i,this.scene=new a.Scene,this.scene.add(new a.AmbientLight(5592405));var d=new a.SpotLight(16777215,1.5);d.position.set(0,500,2e3),this.scene.add(d),this.rotationSpeed=r;var l=new a.MeshPhongMaterial({color:16777215,flatShading:!0,vertexColors:!0});this.mesh=new a.Mesh(h(e,t),l),this.scene.add(this.mesh);var m={minFilter:a.LinearFilter,magFilter:a.LinearFilter,format:a.RGBFormat};this.fbo=new a.WebGLRenderTarget(window.innerWidth,window.innerHeight,m),this.render=function(e,t){u.mesh.rotation.x+=e*u.rotationSpeed.x,u.mesh.rotation.y+=e*u.rotationSpeed.y,u.mesh.rotation.z+=e*u.rotationSpeed.z,o.setClearColor(u.clearColor),t?(o.setRenderTarget(u.fbo),o.clear(),o.render(u.scene,u.camera)):(o.setRenderTarget(null),o.render(u.scene,u.camera))}}function a(e,t,i,n,r,s){var a=this;this.scene=new i.Scene,this.cameraOrtho=new i.OrthographicCamera((window.innerWidth-281)/-2,(window.innerWidth-281)/2,window.innerHeight/2,window.innerHeight/-2,-10,10),this.textures=[];for(var o=new i.TextureLoader,h=0;h<6;h++)this.textures[h]=o.load("static/textures/transition/transition"+(h+1)+".png");this.quadmaterial=new i.ShaderMaterial({uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:0},threshold:{value:.1},useTexture:{value:1},tMixTexture:{value:this.textures[0]}},vertexShader:["varying vec2 vUv;","void main() {","vUv = vec2(uv.x, uv.y);","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","uniform sampler2D tMixTexture;","uniform int useTexture;","uniform float threshold;","varying vec2 vUv;","void main() {","\tvec4 texel1 = texture2D(tDiffuse1, vUv);","\tvec4 texel2 = texture2D(tDiffuse2, vUv);","\tif (useTexture==1) {","\t\tvec4 transitionTexel = texture2D(tMixTexture, vUv);","\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;","\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);","\t\tgl_FragColor = mix(texel1, texel2, mixf);","\t} else {","\t\tgl_FragColor = mix(texel2, texel1, mixRatio);","\t}","}"].join("\n")});var u=new i.PlaneBufferGeometry(window.innerWidth-281,window.innerHeight);this.quad=new i.Mesh(u,this.quadmaterial),this.scene.add(this.quad),this.sceneA=e,this.sceneB=t,this.quadmaterial.uniforms.tDiffuse1.value=e.fbo.texture,this.quadmaterial.uniforms.tDiffuse2.value=t.fbo.texture,this.needChange=!1,this.setTextureThreshold=function(e){a.quadmaterial.uniforms.threshold.value=e},this.useTexture=function(e){a.quadmaterial.uniforms.useTexture.value=e?1:0},this.setTexture=function(e){a.quadmaterial.uniforms.tMixTexture.value=a.textures[e]},this.render=function(e){if(n.animateTransition){var t=(1+Math.sin(n.transitionSpeed*s.getElapsedTime()/Math.PI))/2;n.transition=i.MathUtils.smoothstep(t,.3,.7),!n.loopTexture||0!=n.transition&&1!=n.transition?a.needChange=!0:a.needChange&&(n.texture=(n.texture+1)%a.textures.length,a.quadmaterial.uniforms.tMixTexture.value=a.textures[n.texture],a.needChange=!1)}a.quadmaterial.uniforms.mixRatio.value=n.transition,0==n.transition?a.sceneB.render(e,!1):1==n.transition?a.sceneA.render(e,!1):(a.sceneA.render(e,!0),a.sceneB.render(e,!0),r.setRenderTarget(null),r.clear(),r.render(a.scene,a.cameraOrtho))}}var o={data:function(){return{container:null,stats:null,renderer:null,transition:null,transitionParams:{useTexture:!0,transition:.5,transitionSpeed:2,texture:5,loopTexture:!0,animateTransition:!0,textureThreshold:.3},clock:null,gui:null}},mounted:function(){this.clock=new this.$THREE.Clock,this.init(),this.animate()},beforeDestroy:function(){this.gui.destroy()},methods:{init:function(){this.initGUI(),this.container=document.getElementById("container"),this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.container.appendChild(this.renderer.domElement),this.stats=new this.$Stats,this.container.appendChild(this.stats.dom);var e=new s("cube",5e3,1200,120,new this.$THREE.Vector3(0,-.4,0),16777215,this.$THREE,this.renderer,this.generateGeometry),t=new s("sphere",500,2e3,50,new this.$THREE.Vector3(0,.2,.1),0,this.$THREE,this.renderer,this.generateGeometry);this.transition=new a(e,t,this.$THREE,this.transitionParams,this.renderer,this.clock),window.addEventListener("resize",this.onWindowResize,!1)},onWindowResize:function(){this.renderer.setSize(window.innerWidth-281,window.innerHeight)},animate:function(){requestAnimationFrame(this.animate),this.render(),this.stats.update()},initGUI:function(){var e=this;this.gui=new n.a,this.gui.add(this.transitionParams,"useTexture").onChange(function(t){e.transition.useTexture(t)}),this.gui.add(this.transitionParams,"loopTexture"),this.gui.add(this.transitionParams,"texture",{Perlin:0,Squares:1,Cells:2,Distort:3,Gradient:4,Radial:5}).onChange(function(t){e.transition.setTexture(t)}).listen(),this.gui.add(this.transitionParams,"textureThreshold",0,1,.01).onChange(function(t){e.transition.setTextureThreshold(t)}),this.gui.add(this.transitionParams,"animateTransition"),this.gui.add(this.transitionParams,"transition",0,1,.01).listen(),this.gui.add(this.transitionParams,"transitionSpeed",.5,5,.01)},render:function(){this.transition.render(this.clock.getDelta())},generateGeometry:function(e,t){var i=this;function n(e,t){for(var n=e.attributes.position,r=[],s=0;s<n.count;s++)r.push(t.r,t.g,t.b);e.setAttribute("color",new i.$THREE.Float32BufferAttribute(r,3))}for(var s=[],a=new this.$THREE.Matrix4,o=new this.$THREE.Vector3,h=new this.$THREE.Euler,u=new this.$THREE.Quaternion,d=new this.$THREE.Vector3,l=new this.$THREE.Color,m=0;m<t;m++){var c;o.x=1e4*Math.random()-5e3,o.y=6e3*Math.random()-3e3,o.z=8e3*Math.random()-4e3,h.x=2*Math.random()*Math.PI,h.y=2*Math.random()*Math.PI,h.z=2*Math.random()*Math.PI,u.setFromEuler(h),d.x=200*Math.random()+100,"cube"===e?(c=(c=new this.$THREE.BoxBufferGeometry(1,1,1)).toNonIndexed(),d.y=200*Math.random()+100,d.z=200*Math.random()+100,l.setRGB(0,0,.1+.9*Math.random())):"sphere"===e&&(c=new this.$THREE.IcosahedronBufferGeometry(1,1),d.y=d.z=d.x,l.setRGB(.1+.9*Math.random(),0,0)),n(c,l),a.compose(o,u,d),c.applyMatrix4(a),s.push(c)}return r.a.mergeBufferGeometries(s)}}},h={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglPostprocessingCrossfade-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" webgl scene transitions"),t("br"),this._v("\n\t\t\tby "),t("a",{attrs:{href:"https://twitter.com/fernandojsg"}},[this._v("fernandojsg")]),this._v(" - "),t("a",{attrs:{href:"https://github.com/kile/three.js-demos"}},[this._v("github")])]),this._v(" "),t("div",{attrs:{id:"container"}})])}]};var u=i("VU/8")(o,h,!1,function(e){i("GBHp")},"data-v-62fff8f8",null);t.default=u.exports}});
//# sourceMappingURL=184.7f9ec0231b93453e58f8.js.map