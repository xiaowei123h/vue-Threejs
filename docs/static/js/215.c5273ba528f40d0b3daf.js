webpackJsonp([215],{C8wD:function(e,t){},fc2C:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("zCdm"),r=s("wIBv"),o=s("6+nK"),n={uniforms:{tInput:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tInput;","void main() {","\tgl_FragColor = vec4( 1.0 ) - texture2D( tInput, vUv );","}"].join("\n")},a={uniforms:{tInput:{value:null},fStepSize:{value:1},vSunPositionScreenSpace:{value:new o.Vector3}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define TAPS_PER_PASS 6.0","varying vec2 vUv;","uniform sampler2D tInput;","uniform vec3 vSunPositionScreenSpace;","uniform float fStepSize;","void main() {","\tvec2 delta = vSunPositionScreenSpace.xy - vUv;","\tfloat dist = length( delta );","\tvec2 stepv = fStepSize * delta / dist;","\tfloat iters = dist/fStepSize;","\tvec2 uv = vUv.xy;","\tfloat col = 0.0;","\tfloat f = min( 1.0, max( vSunPositionScreenSpace.z / 1000.0, 0.0 ) );","\tif ( 0.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 1.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 2.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 3.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 4.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tif ( 5.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r * f;","\tuv += stepv;","\tgl_FragColor = vec4( col/TAPS_PER_PASS );","\tgl_FragColor.a = 1.0;","}"].join("\n")},h={uniforms:{tColors:{value:null},tGodRays:{value:null},fGodRayIntensity:{value:.69}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tColors;","uniform sampler2D tGodRays;","uniform float fGodRayIntensity;","void main() {","\tgl_FragColor = texture2D( tColors, vUv ) + fGodRayIntensity * vec4( 1.0 - texture2D( tGodRays, vUv ).r );","\tgl_FragColor.a = 1.0;","}"].join("\n")},p={uniforms:{vSunPositionScreenSpace:{value:new o.Vector3},fAspect:{value:1},sunColor:{value:new o.Color(16772608)},bgColor:{value:new o.Color(0)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform vec3 vSunPositionScreenSpace;","uniform float fAspect;","uniform vec3 sunColor;","uniform vec3 bgColor;","void main() {","\tvec2 diff = vUv - vSunPositionScreenSpace.xy;","\tdiff.x *= fAspect;","\tfloat prop = clamp( length( diff ) / 0.5, 0.0, 1.0 );","\tprop = 0.35 * pow( 1.0 - prop, 3.0 );","\tgl_FragColor.xyz = ( vSunPositionScreenSpace.z > 0.0 ) ? mix( sunColor, bgColor, 1.0 - prop ) : bgColor;","\tgl_FragColor.w = 1.0;","}"].join("\n")},c={data:function(){return{container:null,stats:null,camera:null,scene:null,renderer:null,materialDepth:null,sphereMesh:null,sunPosition:null,clipPosition:null,screenSpacePosition:null,postprocessing:{enabled:!0},orbitRadius:200,bgColor:1297,sunColor:16772608,godrayRenderTargetResolutionMultiplier:.25}},mounted:function(){this.sunPosition=new this.$THREE.Vector3(0,1e3,-1e3),this.clipPosition=new this.$THREE.Vector4,this.screenSpacePosition=new this.$THREE.Vector3,this.init(),this.animate()},methods:{init:function(){var e=this;this.container=document.createElement("div"),document.getElementsByClassName("webglPostprocessingGodrays-container")[0].appendChild(this.container),this.camera=new this.$THREE.PerspectiveCamera(70,this.$webglInnerWidth/window.innerHeight,1,3e3),this.camera.position.z=200,this.scene=new this.$THREE.Scene,this.materialDepth=new this.$THREE.MeshDepthMaterial;var t=new this.$THREE.MeshBasicMaterial({color:0});(new i.a).load("static/models/obj/tree.obj",function(s){s.material=t,s.position.set(0,-150,-150),s.scale.multiplyScalar(400),e.scene.add(s)});var s=new this.$THREE.SphereBufferGeometry(1,20,10);this.sphereMesh=new this.$THREE.Mesh(s,t),this.sphereMesh.scale.multiplyScalar(20),this.scene.add(this.sphereMesh),this.renderer=new this.$THREE.WebGLRenderer,this.renderer.setClearColor(16777215),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.container.appendChild(this.renderer.domElement),this.renderer.autoClear=!1;var o=new r.b(this.camera,this.renderer.domElement);o.minDistance=50,o.maxDistance=500,this.stats=new this.$Stats,this.stats.dom.style.left="280px",this.container.appendChild(this.stats.dom),window.addEventListener("resize",this.onWindowResize,!1),this.initPostprocessing(this.$webglInnerWidth,window.innerHeight)},onWindowResize:function(){var e=window.innerWidth-281,t=window.innerHeight;this.$onWindowResize(this.camera,this.renderer),this.postprocessing.rtTextureColors.setSize(e,t),this.postprocessing.rtTextureDepth.setSize(e,t),this.postprocessing.rtTextureDepthMask.setSize(e,t);var s=e*this.godrayRenderTargetResolutionMultiplier,i=t*this.godrayRenderTargetResolutionMultiplier;this.postprocessing.rtTextureGodRays1.setSize(s,i),this.postprocessing.rtTextureGodRays2.setSize(s,i)},initPostprocessing:function(e,t){this.postprocessing.scene=new this.$THREE.Scene,this.postprocessing.camera=new this.$THREE.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.postprocessing.camera.position.z=100,this.postprocessing.scene.add(this.postprocessing.camera);var s={minFilter:this.$THREE.LinearFilter,magFilter:this.$THREE.LinearFilter,format:this.$THREE.RGBFormat};this.postprocessing.rtTextureColors=new this.$THREE.WebGLRenderTarget(e,t,s),this.postprocessing.rtTextureDepth=new this.$THREE.WebGLRenderTarget(e,t,s),this.postprocessing.rtTextureDepthMask=new this.$THREE.WebGLRenderTarget(e,t,s);var i=e*this.godrayRenderTargetResolutionMultiplier,r=t*this.godrayRenderTargetResolutionMultiplier;this.postprocessing.rtTextureGodRays1=new this.$THREE.WebGLRenderTarget(i,r,s),this.postprocessing.rtTextureGodRays2=new this.$THREE.WebGLRenderTarget(i,r,s);var o=n;this.postprocessing.godrayMaskUniforms=this.$THREE.UniformsUtils.clone(o.uniforms),this.postprocessing.materialGodraysDepthMask=new this.$THREE.ShaderMaterial({uniforms:this.postprocessing.godrayMaskUniforms,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader});var c=a;this.postprocessing.godrayGenUniforms=this.$THREE.UniformsUtils.clone(c.uniforms),this.postprocessing.materialGodraysGenerate=new this.$THREE.ShaderMaterial({uniforms:this.postprocessing.godrayGenUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader});var l=h;this.postprocessing.godrayCombineUniforms=this.$THREE.UniformsUtils.clone(l.uniforms),this.postprocessing.materialGodraysCombine=new this.$THREE.ShaderMaterial({uniforms:this.postprocessing.godrayCombineUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader});var d=p;this.postprocessing.godraysFakeSunUniforms=this.$THREE.UniformsUtils.clone(d.uniforms),this.postprocessing.materialGodraysFakeSun=new this.$THREE.ShaderMaterial({uniforms:this.postprocessing.godraysFakeSunUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}),this.postprocessing.godraysFakeSunUniforms.bgColor.value.setHex(this.bgColor),this.postprocessing.godraysFakeSunUniforms.sunColor.value.setHex(this.sunColor),this.postprocessing.godrayCombineUniforms.fGodRayIntensity.value=.75,this.postprocessing.quad=new this.$THREE.Mesh(new this.$THREE.PlaneBufferGeometry(1,1),this.postprocessing.materialGodraysGenerate),this.postprocessing.quad.position.z=-9900,this.postprocessing.scene.add(this.postprocessing.quad)},animate:function(){requestAnimationFrame(this.animate,this.renderer.domElement),this.stats.begin(),this.render(),this.stats.end()},getStepSize:function(e,t,s){return e*Math.pow(t,-s)},filterGodRays:function(e,t,s){this.postprocessing.scene.overrideMaterial=this.postprocessing.materialGodraysGenerate,this.postprocessing.godrayGenUniforms.fStepSize.value=s,this.postprocessing.godrayGenUniforms.tInput.value=e,this.renderer.setRenderTarget(t),this.renderer.render(this.postprocessing.scene,this.postprocessing.camera),this.postprocessing.scene.overrideMaterial=null},render:function(){var e=Date.now()/4e3;if(this.sphereMesh.position.x=this.orbitRadius*Math.cos(e),this.sphereMesh.position.z=this.orbitRadius*Math.sin(e)-100,this.postprocessing.enabled){this.clipPosition.x=this.sunPosition.x,this.clipPosition.y=this.sunPosition.y,this.clipPosition.z=this.sunPosition.z,this.clipPosition.w=1,this.clipPosition.applyMatrix4(this.camera.matrixWorldInverse).applyMatrix4(this.camera.projectionMatrix),this.clipPosition.x/=this.clipPosition.w,this.clipPosition.y/=this.clipPosition.w,this.screenSpacePosition.x=(this.clipPosition.x+1)/2,this.screenSpacePosition.y=(this.clipPosition.y+1)/2,this.screenSpacePosition.z=this.clipPosition.z,this.postprocessing.godrayGenUniforms.vSunPositionScreenSpace.value.copy(this.screenSpacePosition),this.postprocessing.godraysFakeSunUniforms.vSunPositionScreenSpace.value.copy(this.screenSpacePosition),this.renderer.setRenderTarget(this.postprocessing.rtTextureColors),this.renderer.clear(!0,!0,!1);var t=.74*window.innerHeight,s=.74*window.innerHeight;this.screenSpacePosition.x*=this.$webglInnerWidth,this.screenSpacePosition.y*=window.innerHeight,this.renderer.setScissor(this.screenSpacePosition.x-s/2,this.screenSpacePosition.y-t/2,s,t),this.renderer.setScissorTest(!0),this.postprocessing.godraysFakeSunUniforms.fAspect.value=this.$webglInnerWidth/window.innerHeight,this.postprocessing.scene.overrideMaterial=this.postprocessing.materialGodraysFakeSun,this.renderer.setRenderTarget(this.postprocessing.rtTextureColors),this.renderer.render(this.postprocessing.scene,this.postprocessing.camera),this.renderer.setScissorTest(!1),this.scene.overrideMaterial=null,this.renderer.setRenderTarget(this.postprocessing.rtTextureColors),this.renderer.render(this.scene,this.camera),this.scene.overrideMaterial=this.materialDepth,this.renderer.setRenderTarget(this.postprocessing.rtTextureDepth),this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.postprocessing.godrayMaskUniforms.tInput.value=this.postprocessing.rtTextureDepth.texture,this.postprocessing.scene.overrideMaterial=this.postprocessing.materialGodraysDepthMask,this.renderer.setRenderTarget(this.postprocessing.rtTextureDepthMask),this.renderer.render(this.postprocessing.scene,this.postprocessing.camera);this.filterGodRays(this.postprocessing.rtTextureDepthMask.texture,this.postprocessing.rtTextureGodRays2,this.getStepSize(1,6,1)),this.filterGodRays(this.postprocessing.rtTextureGodRays2.texture,this.postprocessing.rtTextureGodRays1,this.getStepSize(1,6,2)),this.filterGodRays(this.postprocessing.rtTextureGodRays1.texture,this.postprocessing.rtTextureGodRays2,this.getStepSize(1,6,3)),this.postprocessing.godrayCombineUniforms.tColors.value=this.postprocessing.rtTextureColors.texture,this.postprocessing.godrayCombineUniforms.tGodRays.value=this.postprocessing.rtTextureGodRays2.texture,this.postprocessing.scene.overrideMaterial=this.postprocessing.materialGodraysCombine,this.renderer.setRenderTarget(null),this.renderer.render(this.postprocessing.scene,this.postprocessing.camera),this.postprocessing.scene.overrideMaterial=null}else this.renderer.setRenderTarget(null),this.renderer.clear(),this.renderer.render(this.scene,this.camera)}}},l={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglPostprocessingGodrays-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" - webgl god-rays example - tree by "),t("a",{attrs:{href:"http://www.turbosquid.com/3d-models/free-tree-3d-model/592617",target:"_blank",rel:"noopener"}},[this._v("stanloshka")])])])}]};var d=s("VU/8")(c,l,!1,function(e){s("C8wD")},"data-v-52547cc8",null);t.default=d.exports}});
//# sourceMappingURL=215.c5273ba528f40d0b3daf.js.map