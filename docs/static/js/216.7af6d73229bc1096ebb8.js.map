{"version":3,"sources":["webpack:///src/views/ar/webxrArHittest.vue","webpack:///./src/views/ar/webxrArHittest.vue?af10","webpack:///./src/views/ar/webxrArHittest.vue"],"names":["webxrArHittest","data","container","camera","scene","renderer","controller","reticle","hitTestSource","hitTestSourceRequested","mounted","this","init","animate","methods","document","createElement","getElementsByClassName","appendChild","$THREE","Scene","PerspectiveCamera","$webglInnerWidth","window","innerHeight","light","HemisphereLight","position","set","add","WebGLRenderer","antialias","alpha","setPixelRatio","devicePixelRatio","setSize","xr","enabled","domElement","ARButton","createButton","requiredFeatures","geometry","CylinderBufferGeometry","translate","that","getController","addEventListener","visible","material","MeshPhongMaterial","color","Math","random","mesh","Mesh","setFromMatrixPosition","matrix","scale","y","RingBufferGeometry","rotateX","PI","MeshBasicMaterial","matrixAutoUpdate","onWindowResize","$onWindowResize","setAnimationLoop","render","timestamp","frame","_this","referenceSpace","getReferenceSpace","session","getSession","requestReferenceSpace","then","requestHitTestSource","space","source","hitTestResults","getHitTestResults","length","hit","fromArray","getPose","transform","ar_webxrArHittest","$createElement","_self","_c","_m","staticRenderFns","_h","staticClass","attrs","id","href","target","rel","_v","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/216.7af6d73229bc1096ebb8.js","sourcesContent":["<template>\r\n    <div class=\"webxrArHittest-container\">\r\n        <div id=\"info\">\r\n\t\t\t<a href=\"https://threejs.org\" target=\"_blank\" rel=\"noopener\">three.js</a> ar - hit test<br/>(Chrome Android 81+)\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ARButton } from '@/components/jsm/webxr/ARButton.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            container: null,\r\n            camera: null,\r\n            scene: null,\r\n            renderer: null,\r\n\t\t\tcontroller: null,\r\n\t\t\treticle: null,\r\n\t\t\thitTestSource: null,\r\n\t\t\thitTestSourceRequested: false,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.init()\r\n\t\tthis.animate()\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.container = document.createElement('div')\r\n            document.getElementsByClassName('webxrArHittest-container')[0].appendChild(this.container)\r\n            this.scene = new this.$THREE.Scene()\r\n            this.camera = new this.$THREE.PerspectiveCamera(70, this.$webglInnerWidth / window.innerHeight, 0.01, 20)\r\n            var light = new this.$THREE.HemisphereLight(0xffffff, 0xbbbbff, 1)\r\n            light.position.set(0.5, 1, 0.25)\r\n            this.scene.add(light)\r\n            //\r\n            this.renderer = new this.$THREE.WebGLRenderer({ antialias: true, alpha: true })\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            this.renderer.setSize(this.$webglInnerWidth, window.innerHeight)\r\n            this.renderer.xr.enabled = true\r\n            this.container.appendChild(this.renderer.domElement)\r\n            //\r\n            document.getElementsByClassName('webxrArHittest-container')[0].appendChild(ARButton.createButton(this.renderer, { requiredFeatures: [ 'hit-test' ] }))\r\n            //\r\n            var geometry = new this.$THREE.CylinderBufferGeometry(0.1, 0.1, 0.2, 32).translate(0, 0.1, 0)\r\n            var that = this\r\n            function onSelect() {\r\n                if (that.reticle.visible) {\r\n                    var material = new that.$THREE.MeshPhongMaterial({ color: 0xffffff * Math.random() })\r\n                    var mesh = new that.$THREE.Mesh(geometry, material)\r\n                    mesh.position.setFromMatrixPosition(that.reticle.matrix)\r\n                    mesh.scale.y = Math.random() * 2 + 1\r\n                    that.scene.add(mesh)\r\n                }\r\n            }\r\n            this.controller = this.renderer.xr.getController(0)\r\n            this.controller.addEventListener('select', onSelect)\r\n            this.scene.add(this.controller)\r\n            this.reticle = new this.$THREE.Mesh(\r\n                new this.$THREE.RingBufferGeometry(0.15, 0.2, 32).rotateX(- Math.PI / 2),\r\n                new this.$THREE.MeshBasicMaterial()\r\n            )\r\n            this.reticle.matrixAutoUpdate = false\r\n            this.reticle.visible = false\r\n            this.scene.add(this.reticle)\r\n            //\r\n            window.addEventListener('resize', this.onWindowResize, false)\r\n        },\r\n        onWindowResize() {\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n        },\r\n        animate() {\r\n            this.renderer.setAnimationLoop(this.render)\r\n        },\r\n        render(timestamp, frame) {\r\n            if (frame) {\r\n                var referenceSpace = this.renderer.xr.getReferenceSpace()\r\n                var session = this.renderer.xr.getSession()\r\n                if (this.hitTestSourceRequested === false) {\r\n                    session.requestReferenceSpace('viewer').then((referenceSpace) => {\r\n                        session.requestHitTestSource({ space: referenceSpace }).then((source) => {\r\n                            this.hitTestSource = source\r\n                        })\r\n                    })\r\n                    session.addEventListener('end', () => {\r\n                        this.hitTestSourceRequested = false\r\n                        this.hitTestSource = null\r\n                    })\r\n                    this.hitTestSourceRequested = true\r\n                }\r\n                if (this.hitTestSource) {\r\n                    var hitTestResults = frame.getHitTestResults(this.hitTestSource)\r\n                    if (hitTestResults.length) {\r\n                        var hit = hitTestResults[ 0 ]\r\n                        this.reticle.visible = true\r\n                        this.reticle.matrix.fromArray(hit.getPose(referenceSpace).transform.matrix)\r\n                    } else {\r\n                        this.reticle.visible = false\r\n                    }\r\n                }\r\n            }\r\n            this.renderer.render(this.scene, this.camera)\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webxrArHittest-container {\r\n    position: relative;\r\n    width: 100%;\r\n    background-color: #000;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/ar/webxrArHittest.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webxrArHittest-container\"},[_c('div',{attrs:{\"id\":\"info\"}},[_c('a',{attrs:{\"href\":\"https://threejs.org\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"three.js\")]),_vm._v(\" ar - hit test\"),_c('br'),_vm._v(\"(Chrome Android 81+)\\n\\t\\t\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-520e2621\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/ar/webxrArHittest.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-520e2621\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webxrArHittest.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webxrArHittest.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webxrArHittest.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-520e2621\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webxrArHittest.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-520e2621\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/ar/webxrArHittest.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}