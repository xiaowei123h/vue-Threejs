webpackJsonp([244],{"8qeW":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("6+nK"),a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],s=!0,a=!1,n=void 0;try{for(var i,o=e[Symbol.iterator]();!(s=(i=o.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(e){a=!0,n=e}finally{try{!s&&o.return&&o.return()}finally{if(a)throw n}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(e){s.Loader.call(this,e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig={format:null,astcSupported:!1,bptcSupported:!1,etcSupported:!1,dxtSupported:!1,pvrtcSupported:!1}};n.taskCache=new WeakMap,n.prototype=Object.assign(Object.create(s.Loader.prototype),{constructor:n,setTranscoderPath:function(e){return this.transcoderPath=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},detectSupport:function(e){var t=this.workerConfig;if(t.astcSupported=e.extensions.has("WEBGL_compressed_texture_astc"),t.bptcSupported=e.extensions.has("EXT_texture_compression_bptc"),t.etcSupported=e.extensions.has("WEBGL_compressed_texture_etc1"),t.dxtSupported=e.extensions.has("WEBGL_compressed_texture_s3tc"),t.pvrtcSupported=e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc"),t.astcSupported)t.format=n.BASIS_FORMAT.cTFASTC_4x4;else if(t.bptcSupported)t.format=n.BASIS_FORMAT.cTFBC7_M5;else if(t.dxtSupported)t.format=n.BASIS_FORMAT.cTFBC3;else if(t.pvrtcSupported)t.format=n.BASIS_FORMAT.cTFPVRTC1_4_RGBA;else{if(!t.etcSupported)throw new Error("THREE.BasisTextureLoader: No suitable compressed texture format found.");t.format=n.BASIS_FORMAT.cTFETC1}return this},load:function(e,t,r,a){var i=this,o=new s.FileLoader(this.manager);o.setResponseType("arraybuffer"),o.setWithCredentials(this.withCredentials),o.load(e,function(r){if(n.taskCache.has(r))return n.taskCache.get(r).promise.then(t).catch(a);i._createTexture(r,e).then(t).catch(a)},r,a)},_createTexture:function(e,t){var r,a,i=this,o=e.byteLength,c=this._allocateWorker(o).then(function(t){return r=t,a=i.workerNextTaskID++,new Promise(function(t,s){r._callbacks[a]={resolve:t,reject:s},r.postMessage({type:"transcode",id:a,buffer:e},[e])})}).then(function(e){var t,r=i.workerConfig,a=e.width,o=e.height,c=e.mipmaps;switch(e.format){case n.BASIS_FORMAT.cTFASTC_4x4:t=new s.CompressedTexture(c,a,o,s.RGBA_ASTC_4x4_Format);break;case n.BASIS_FORMAT.cTFBC7_M5:t=new s.CompressedTexture(c,a,o,s.RGBA_BPTC_Format);break;case n.BASIS_FORMAT.cTFBC1:case n.BASIS_FORMAT.cTFBC3:t=new s.CompressedTexture(c,a,o,n.DXT_FORMAT_MAP[r.format],s.UnsignedByteType);break;case n.BASIS_FORMAT.cTFETC1:t=new s.CompressedTexture(c,a,o,s.RGB_ETC1_Format);break;case n.BASIS_FORMAT.cTFPVRTC1_4_RGB:t=new s.CompressedTexture(c,a,o,s.RGB_PVRTC_4BPPV1_Format);break;case n.BASIS_FORMAT.cTFPVRTC1_4_RGBA:t=new s.CompressedTexture(c,a,o,s.RGBA_PVRTC_4BPPV1_Format);break;default:throw new Error("THREE.BasisTextureLoader: No supported format available.")}return t.minFilter=1===c.length?s.LinearFilter:s.LinearMipmapLinearFilter,t.magFilter=s.LinearFilter,t.generateMipmaps=!1,t.needsUpdate=!0,t});return c.catch(function(){return!0}).then(function(){r&&a&&(r._taskLoad-=o,delete r._callbacks[a])}),n.taskCache.set(e,{url:t,promise:c}),c},_initTranscoder:function(){var e=this;if(!this.transcoderPending){var t=new s.FileLoader(this.manager);t.setPath(this.transcoderPath),t.setWithCredentials(this.withCredentials);var r=new Promise(function(e,r){t.load("basis_transcoder.js",e,void 0,r)}),i=new s.FileLoader(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);var o=new Promise(function(e,t){i.load("basis_transcoder.wasm",e,void 0,t)});this.transcoderPending=Promise.all([r,o]).then(function(t){var r=a(t,2),s=r[0],i=r[1],o=n.BasisWorker.toString(),c=["/* basis_transcoder.js */",s,"/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([c])),e.transcoderBinary=i})}return this.transcoderPending},_allocateWorker:function(e){var t=this;return this._initTranscoder().then(function(){var r;t.workerPool.length<t.workerLimit?((r=new Worker(t.workerSourceURL))._callbacks={},r._taskLoad=0,r.postMessage({type:"init",config:t.workerConfig,transcoderBinary:t.transcoderBinary}),r.onmessage=function(e){var t=e.data;switch(t.type){case"transcode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.BasisTextureLoader: Unexpected message, "'+t.type+'"')}},t.workerPool.push(r)):t.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});return(r=t.workerPool[t.workerPool.length-1])._taskLoad+=e,r})},dispose:function(){for(var e=0;e<this.workerPool.length;e++)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),n.BASIS_FORMAT={cTFETC1:0,cTFETC2:1,cTFBC1:2,cTFBC3:3,cTFBC4:4,cTFBC5:5,cTFBC7_M6_OPAQUE_ONLY:6,cTFBC7_M5:7,cTFPVRTC1_4_RGB:8,cTFPVRTC1_4_RGBA:9,cTFASTC_4x4:10,cTFATC_RGB:11,cTFATC_RGBA_INTERPOLATED_ALPHA:12,cTFRGBA32:13,cTFRGB565:14,cTFBGR565:15,cTFRGBA4444:16},n.DXT_FORMAT={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779},(n.DXT_FORMAT_MAP={})[n.BASIS_FORMAT.cTFBC1]=n.DXT_FORMAT.COMPRESSED_RGB_S3TC_DXT1_EXT,n.DXT_FORMAT_MAP[n.BASIS_FORMAT.cTFBC3]=n.DXT_FORMAT.COMPRESSED_RGBA_S3TC_DXT5_EXT,n.BasisWorker=function(){var e,t,r;onmessage=function(s){var a,n,i=s.data;switch(i.type){case"init":e=i.config,a=i.transcoderBinary,t=new Promise(function(e){n={wasmBinary:a,onRuntimeInitialized:e},BASIS(n)}).then(function(){var e=n,t=e.BasisFile,s=e.initializeBasis;r=t,s()});break;case"transcode":t.then(function(){try{for(var t=function(t){var s=new r(new Uint8Array(t)),a=s.getImageWidth(0,0),n=s.getImageHeight(0,0),i=s.getNumLevels(0),o=s.getHasAlpha();function c(){s.close(),s.delete()}if(!o)switch(e.format){case 9:e.format=8}if(!a||!n||!i)throw c(),new Error("THREE.BasisTextureLoader:\tInvalid .basis file");if(!s.startTranscoding())throw c(),new Error("THREE.BasisTextureLoader: .startTranscoding failed");for(var h=[],d=0;d<i;d++){var u=s.getImageWidth(0,d),l=s.getImageHeight(0,d),T=new Uint8Array(s.getImageTranscodedSizeInBytes(0,d,e.format)),_=s.transcodeImage(T,0,d,e.format,0,o);if(!_)throw c(),new Error("THREE.BasisTextureLoader: .transcodeImage failed.");h.push({data:T,width:u,height:l})}return c(),{width:a,height:n,hasAlpha:o,mipmaps:h,format:e.format}}(i.buffer),s=t.width,a=t.height,n=t.hasAlpha,o=t.mipmaps,c=t.format,h=[],d=0;d<o.length;++d)h.push(o[d].data.buffer);self.postMessage({type:"transcode",id:i.id,width:s,height:a,hasAlpha:n,mipmaps:o,format:c},h)}catch(e){console.error(e),self.postMessage({type:"error",id:i.id,error:e.message})}})}}};var i={data:function(){return{camera:null,scene:null,renderer:null,mesh:null,clock:null}},mounted:function(){this.clock=new this.$THREE.Clock,this.init(),this.animate()},methods:{init:function(){var e=this;this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.renderer.outputEncoding=this.$THREE.sRGBEncoding,document.getElementsByClassName("webglLoaderTextureBasis-container")[0].appendChild(this.renderer.domElement),this.camera=new this.$THREE.PerspectiveCamera(50,this.$webglInnerWidth/window.innerHeight,1,2e3),this.camera.position.z=500,this.scene=new this.$THREE.Scene;var t=new this.$THREE.BoxBufferGeometry(200,200,200),r=new this.$THREE.MeshBasicMaterial;this.mesh=new this.$THREE.Mesh(t,r),this.scene.add(this.mesh);var s=new n;s.setTranscoderPath("static/js/libs/basis/"),s.detectSupport(this.renderer),s.load("static/textures/compressed/PavingStones.basis",function(t){t.encoding=e.$THREE.sRGBEncoding,r.map=t,r.needsUpdate=!0},void 0,function(e){console.error(e)}),window.addEventListener("resize",this.onWindowResize,!1)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate);var e=.5*this.clock.getDelta();this.mesh.rotation.x+=e,this.mesh.rotation.y+=e,this.renderer.render(this.scene,this.camera)}}},o={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglLoaderTextureBasis-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" - webgl - basis texture loader"),t("br"),this._v(" "),t("a",{attrs:{href:"https://github.com/binomialLLC/basis_universal",target:"_blank"}},[this._v("Basis Universal GPU Texture Codec")])])])}]};var c=r("VU/8")(i,o,!1,function(e){r("c5Ev")},"data-v-4214d04b",null);t.default=c.exports},c5Ev:function(e,t){}});
//# sourceMappingURL=244.30a2e2741d4b043542e9.js.map