{"version":3,"sources":["webpack:///src/views/loader/webglLoaderPly.vue","webpack:///./src/views/loader/webglLoaderPly.vue?435e","webpack:///./src/views/loader/webglLoaderPly.vue","webpack:///./src/components/jsm/loaders/PLYLoader.js"],"names":["webglLoaderPly","data","container","stats","camera","cameraTarget","scene","renderer","mounted","this","init","animate","methods","_this","document","createElement","getElementsByClassName","appendChild","$THREE","PerspectiveCamera","$webglInnerWidth","window","innerHeight","position","set","Vector3","Scene","background","Color","fog","Fog","plane","Mesh","PlaneBufferGeometry","MeshPhongMaterial","color","specular","rotation","x","Math","PI","y","add","receiveShadow","loader","PLYLoader","load","geometry","computeVertexNormals","material","MeshStandardMaterial","flatShading","mesh","z","scale","multiplyScalar","castShadow","HemisphereLight","addShadowedLight","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setSize","outputEncoding","sRGBEncoding","shadowMap","enabled","domElement","$Stats","dom","style","left","addEventListener","onWindowResize","intensity","directionalLight","DirectionalLight","shadow","right","top","bottom","near","far","mapSize","width","height","bias","$onWindowResize","requestAnimationFrame","render","update","timer","Date","now","sin","cos","lookAt","loader_webglLoaderPly","$createElement","_self","_c","_m","staticRenderFns","_h","staticClass","attrs","id","href","target","rel","_v","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","d","__WEBPACK_IMPORTED_MODULE_0__components_build_three_module_js__","manager","Loader","call","propertyNameMapping","prototype","Object","assign","create","constructor","url","onLoad","onProgress","onError","scope","FileLoader","setPath","path","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","text","parse","e","console","error","itemError","setPropertyNameMapping","mapping","parseHeader","headerText","headerLength","result","exec","Blob","size","currentElement","lineType","lineValues","propertValues","property","header","comments","elements","objInfo","lines","split","i","length","line","trim","shift","join","format","version","push","undefined","name","count","parseInt","properties","type","countType","itemType","log","parseASCIINumber","n","parseFloat","parseASCIIElement","values","element","list","j","parseASCII","buffer","indices","vertices","normals","uvs","faceVertexUvs","colors","body","currentElementCount","handleElement","postProcess","BufferGeometry","setIndex","setAttribute","Float32BufferAttribute","toNonIndexed","computeBoundingSphere","elementName","nx","ny","nz","s","t","red","green","blue","vertex_indices","vertex_index","texcoord","binaryRead","dataview","at","little_endian","getInt8","getUint8","getInt16","getUint16","getInt32","getUint32","getFloat32","getFloat64","binaryReadElement","read","ArrayBuffer","LoaderUtils","decodeText","Uint8Array","DataView","loc","parseBinary"],"mappings":"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","file":"static/js/27.f0e5c70ee0870e00a859.js","sourcesContent":["<template>\r\n    <div class=\"webglLoaderPly-container\">\r\n        <div id=\"info\">\r\n\t\t\t<a href=\"https://threejs.org\" target=\"_blank\" rel=\"noopener\">three.js</a> -\r\n\t\t\tPLY loader test by <a href=\"https://github.com/menway\" target=\"_blank\" rel=\"noopener\">Wei Meng</a>.<br/>\r\n\t\t\tImage from <a href=\"http://people.sc.fsu.edu/~jburkardt/data/ply/ply.html\">John Burkardt</a>\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { PLYLoader } from '@/components/jsm/loaders/PLYLoader.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            container: null,\r\n            stats: null,\r\n            camera: null,\r\n            cameraTarget: null,\r\n            scene: null,\r\n            renderer: null,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.init()\r\n\t\tthis.animate()\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.container = document.createElement('div')\r\n            document.getElementsByClassName('webglLoaderPly-container')[0].appendChild(this.container)\r\n            this.camera = new this.$THREE.PerspectiveCamera(35, this.$webglInnerWidth / window.innerHeight, 1, 15)\r\n            this.camera.position.set(3, 0.15, 3)\r\n            this.cameraTarget = new this.$THREE.Vector3(0, - 0.1, 0)\r\n            this.scene = new this.$THREE.Scene()\r\n            this.scene.background = new this.$THREE.Color(0x72645b)\r\n            this.scene.fog = new this.$THREE.Fog(0x72645b, 2, 15)\r\n            // Ground\r\n            var plane = new this.$THREE.Mesh(\r\n                new this.$THREE.PlaneBufferGeometry(40, 40),\r\n                new this.$THREE.MeshPhongMaterial({ color: 0x999999, specular: 0x101010 })\r\n            )\r\n            plane.rotation.x = - Math.PI / 2\r\n            plane.position.y = - 0.5\r\n            this.scene.add(plane)\r\n            plane.receiveShadow = true\r\n            // PLY file\r\n            var loader = new PLYLoader()\r\n            loader.load('static/models/ply/ascii/dolphins.ply', (geometry) => {\r\n                geometry.computeVertexNormals()\r\n                var material = new this.$THREE.MeshStandardMaterial({ color: 0x0055ff, flatShading: true })\r\n                var mesh = new this.$THREE.Mesh(geometry, material)\r\n                mesh.position.y = - 0.2\r\n                mesh.position.z = 0.3\r\n                mesh.rotation.x = - Math.PI / 2\r\n                mesh.scale.multiplyScalar(0.001)\r\n                mesh.castShadow = true\r\n                mesh.receiveShadow = true\r\n                this.scene.add(mesh)\r\n            })\r\n            loader.load('static/models/ply/binary/Lucy100k.ply', (geometry) => {\r\n                geometry.computeVertexNormals()\r\n                var material = new this.$THREE.MeshStandardMaterial({ color: 0x0055ff, flatShading: true })\r\n                var mesh = new this.$THREE.Mesh(geometry, material)\r\n                mesh.position.x = - 0.2\r\n                mesh.position.y = - 0.02\r\n                mesh.position.z = - 0.2\r\n                mesh.scale.multiplyScalar(0.0006)\r\n                mesh.castShadow = true\r\n                mesh.receiveShadow = true\r\n                this.scene.add(mesh)\r\n            })\r\n            // Lights\r\n            this.scene.add(new this.$THREE.HemisphereLight(0x443333, 0x111122))\r\n            this.addShadowedLight(1, 1, 1, 0xffffff, 1.35)\r\n            this.addShadowedLight(0.5, 1, - 1, 0xffaa00, 1)\r\n            // renderer\r\n            this.renderer = new this.$THREE.WebGLRenderer({ antialias: true })\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            this.renderer.setSize(this.$webglInnerWidth, window.innerHeight)\r\n            this.renderer.outputEncoding = this.$THREE.sRGBEncoding\r\n            this.renderer.shadowMap.enabled = true\r\n            this.container.appendChild(this.renderer.domElement)\r\n            // stats\r\n            this.stats = new this.$Stats()\r\n            this.stats.dom.style.left = '280px'\r\n            this.container.appendChild(this.stats.dom)\r\n            // resize\r\n            window.addEventListener('resize', this.onWindowResize, false)\r\n        },\r\n        addShadowedLight(x, y, z, color, intensity) {\r\n            var directionalLight = new this.$THREE.DirectionalLight(color, intensity)\r\n            directionalLight.position.set(x, y, z)\r\n            this.scene.add(directionalLight)\r\n            directionalLight.castShadow = true\r\n            var d = 1\r\n            directionalLight.shadow.camera.left = - d\r\n            directionalLight.shadow.camera.right = d\r\n            directionalLight.shadow.camera.top = d\r\n            directionalLight.shadow.camera.bottom = - d\r\n            directionalLight.shadow.camera.near = 1\r\n            directionalLight.shadow.camera.far = 4\r\n            directionalLight.shadow.mapSize.width = 1024\r\n            directionalLight.shadow.mapSize.height = 1024\r\n            directionalLight.shadow.bias = - 0.001\r\n        },\r\n        onWindowResize() {\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n        },\r\n        animate() {\r\n            requestAnimationFrame(this.animate)\r\n            this.render()\r\n            this.stats.update()\r\n        },\r\n        render() {\r\n            var timer = Date.now() * 0.0005\r\n            this.camera.position.x = Math.sin(timer) * 2.5\r\n            this.camera.position.z = Math.cos(timer) * 2.5\r\n            this.camera.lookAt(this.cameraTarget)\r\n            this.renderer.render(this.scene, this.camera)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglLoaderPly-container {\r\n    width: 100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/loader/webglLoaderPly.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglLoaderPly-container\"},[_c('div',{attrs:{\"id\":\"info\"}},[_c('a',{attrs:{\"href\":\"https://threejs.org\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"three.js\")]),_vm._v(\" -\\n\\t\\t\\tPLY loader test by \"),_c('a',{attrs:{\"href\":\"https://github.com/menway\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"Wei Meng\")]),_vm._v(\".\"),_c('br'),_vm._v(\"\\n\\t\\t\\tImage from \"),_c('a',{attrs:{\"href\":\"http://people.sc.fsu.edu/~jburkardt/data/ply/ply.html\"}},[_vm._v(\"John Burkardt\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3f2cdaee\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/loader/webglLoaderPly.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3f2cdaee\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglLoaderPly.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderPly.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderPly.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3f2cdaee\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglLoaderPly.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-3f2cdaee\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/loader/webglLoaderPly.vue\n// module id = null\n// module chunks = ","import {\r\n\tBufferGeometry,\r\n\tFileLoader,\r\n\tFloat32BufferAttribute,\r\n\tLoader,\r\n\tLoaderUtils\r\n} from \"@/components/build/three.module.js\";\r\n\r\n/**\r\n * Description: A THREE loader for PLY ASCII files (known as the Polygon\r\n * File Format or the Stanford Triangle Format).\r\n *\r\n * Limitations: ASCII decoding assumes file is UTF-8.\r\n *\r\n * Usage:\r\n *\tvar loader = new PLYLoader();\r\n *\tloader.load('./models/ply/ascii/dolphins.ply', function (geometry) {\r\n *\r\n *\t\tscene.add( new THREE.Mesh( geometry ) );\r\n *\r\n *\t} );\r\n *\r\n * If the PLY file uses non standard property names, they can be mapped while\r\n * loading. For example, the following maps the properties\r\n * “diffuse_(red|green|blue)” in the file to standard color names.\r\n *\r\n * loader.setPropertyNameMapping( {\r\n *\tdiffuse_red: 'red',\r\n *\tdiffuse_green: 'green',\r\n *\tdiffuse_blue: 'blue'\r\n * } );\r\n *\r\n */\r\n\r\n\r\nvar PLYLoader = function ( manager ) {\r\n\r\n\tLoader.call( this, manager );\r\n\r\n\tthis.propertyNameMapping = {};\r\n\r\n};\r\n\r\nPLYLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\tconstructor: PLYLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar loader = new FileLoader( this.manager );\r\n\t\tloader.setPath( this.path );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\tloader.setRequestHeader( this.requestHeader );\r\n\t\tloader.setWithCredentials( this.withCredentials );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tonLoad( scope.parse( text ) );\r\n\r\n\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\tif ( onError ) {\r\n\r\n\t\t\t\t\tonError( e );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( e );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tsetPropertyNameMapping: function ( mapping ) {\r\n\r\n\t\tthis.propertyNameMapping = mapping;\r\n\r\n\t},\r\n\r\n\tparse: function ( data ) {\r\n\r\n\t\tfunction parseHeader( data ) {\r\n\r\n\t\t\tvar patternHeader = /ply([\\s\\S]*)end_header\\r?\\n/;\r\n\t\t\tvar headerText = '';\r\n\t\t\tvar headerLength = 0;\r\n\t\t\tvar result = patternHeader.exec( data );\r\n\r\n\t\t\tif ( result !== null ) {\r\n\r\n\t\t\t\theaderText = result[ 1 ];\r\n\t\t\t\theaderLength = new Blob( [ result[ 0 ] ] ).size;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar header = {\r\n\t\t\t\tcomments: [],\r\n\t\t\t\telements: [],\r\n\t\t\t\theaderLength: headerLength,\r\n\t\t\t\tobjInfo: ''\r\n\t\t\t};\r\n\r\n\t\t\tvar lines = headerText.split( '\\n' );\r\n\t\t\tvar currentElement;\r\n\t\t\tvar lineType, lineValues;\r\n\r\n\t\t\tfunction make_ply_element_property( propertValues, propertyNameMapping ) {\r\n\r\n\t\t\t\tvar property = { type: propertValues[ 0 ] };\r\n\r\n\t\t\t\tif ( property.type === 'list' ) {\r\n\r\n\t\t\t\t\tproperty.name = propertValues[ 3 ];\r\n\t\t\t\t\tproperty.countType = propertValues[ 1 ];\r\n\t\t\t\t\tproperty.itemType = propertValues[ 2 ];\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tproperty.name = propertValues[ 1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( property.name in propertyNameMapping ) {\r\n\r\n\t\t\t\t\tproperty.name = propertyNameMapping[ property.name ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn property;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\t\tvar line = lines[ i ];\r\n\t\t\t\tline = line.trim();\r\n\r\n\t\t\t\tif ( line === '' ) continue;\r\n\r\n\t\t\t\tlineValues = line.split( /\\s+/ );\r\n\t\t\t\tlineType = lineValues.shift();\r\n\t\t\t\tline = lineValues.join( ' ' );\r\n\r\n\t\t\t\tswitch ( lineType ) {\r\n\r\n\t\t\t\t\tcase 'format':\r\n\r\n\t\t\t\t\t\theader.format = lineValues[ 0 ];\r\n\t\t\t\t\t\theader.version = lineValues[ 1 ];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'comment':\r\n\r\n\t\t\t\t\t\theader.comments.push( line );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'element':\r\n\r\n\t\t\t\t\t\tif ( currentElement !== undefined ) {\r\n\r\n\t\t\t\t\t\t\theader.elements.push( currentElement );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcurrentElement = {};\r\n\t\t\t\t\t\tcurrentElement.name = lineValues[ 0 ];\r\n\t\t\t\t\t\tcurrentElement.count = parseInt( lineValues[ 1 ] );\r\n\t\t\t\t\t\tcurrentElement.properties = [];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'property':\r\n\r\n\t\t\t\t\t\tcurrentElement.properties.push( make_ply_element_property( lineValues, scope.propertyNameMapping ) );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'obj_info':\r\n\r\n\t\t\t\t\t\theader.objInfo = line;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tconsole.log( 'unhandled', lineType, lineValues );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( currentElement !== undefined ) {\r\n\r\n\t\t\t\theader.elements.push( currentElement );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn header;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseASCIINumber( n, type ) {\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\tcase 'char': case 'uchar': case 'short': case 'ushort': case 'int': case 'uint':\r\n\t\t\t\tcase 'int8': case 'uint8': case 'int16': case 'uint16': case 'int32': case 'uint32':\r\n\r\n\t\t\t\t\treturn parseInt( n );\r\n\r\n\t\t\t\tcase 'float': case 'double': case 'float32': case 'float64':\r\n\r\n\t\t\t\t\treturn parseFloat( n );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseASCIIElement( properties, line ) {\r\n\r\n\t\t\tvar values = line.split( /\\s+/ );\r\n\r\n\t\t\tvar element = {};\r\n\r\n\t\t\tfor ( var i = 0; i < properties.length; i ++ ) {\r\n\r\n\t\t\t\tif ( properties[ i ].type === 'list' ) {\r\n\r\n\t\t\t\t\tvar list = [];\r\n\t\t\t\t\tvar n = parseASCIINumber( values.shift(), properties[ i ].countType );\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < n; j ++ ) {\r\n\r\n\t\t\t\t\t\tlist.push( parseASCIINumber( values.shift(), properties[ i ].itemType ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telement[ properties[ i ].name ] = list;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\telement[ properties[ i ].name ] = parseASCIINumber( values.shift(), properties[ i ].type );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn element;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseASCII( data, header ) {\r\n\r\n\t\t\t// PLY ascii format specification, as per http://en.wikipedia.org/wiki/PLY_(file_format)\r\n\r\n\t\t\tvar buffer = {\r\n\t\t\t\tindices: [],\r\n\t\t\t\tvertices: [],\r\n\t\t\t\tnormals: [],\r\n\t\t\t\tuvs: [],\r\n\t\t\t\tfaceVertexUvs: [],\r\n\t\t\t\tcolors: []\r\n\t\t\t};\r\n\r\n\t\t\tvar result;\r\n\r\n\t\t\tvar patternBody = /end_header\\s([\\s\\S]*)$/;\r\n\t\t\tvar body = '';\r\n\t\t\tif ( ( result = patternBody.exec( data ) ) !== null ) {\r\n\r\n\t\t\t\tbody = result[ 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar lines = body.split( '\\n' );\r\n\t\t\tvar currentElement = 0;\r\n\t\t\tvar currentElementCount = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\t\tvar line = lines[ i ];\r\n\t\t\t\tline = line.trim();\r\n\t\t\t\tif ( line === '' ) {\r\n\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( currentElementCount >= header.elements[ currentElement ].count ) {\r\n\r\n\t\t\t\t\tcurrentElement ++;\r\n\t\t\t\t\tcurrentElementCount = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar element = parseASCIIElement( header.elements[ currentElement ].properties, line );\r\n\r\n\t\t\t\thandleElement( buffer, header.elements[ currentElement ].name, element );\r\n\r\n\t\t\t\tcurrentElementCount ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn postProcess( buffer );\r\n\r\n\t\t}\r\n\r\n\t\tfunction postProcess( buffer ) {\r\n\r\n\t\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\t\t// mandatory buffer data\r\n\r\n\t\t\tif ( buffer.indices.length > 0 ) {\r\n\r\n\t\t\t\tgeometry.setIndex( buffer.indices );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( buffer.vertices, 3 ) );\r\n\r\n\t\t\t// optional buffer data\r\n\r\n\t\t\tif ( buffer.normals.length > 0 ) {\r\n\r\n\t\t\t\tgeometry.setAttribute( 'normal', new Float32BufferAttribute( buffer.normals, 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( buffer.uvs.length > 0 ) {\r\n\r\n\t\t\t\tgeometry.setAttribute( 'uv', new Float32BufferAttribute( buffer.uvs, 2 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( buffer.colors.length > 0 ) {\r\n\r\n\t\t\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( buffer.colors, 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( buffer.faceVertexUvs.length > 0 ) {\r\n\r\n\t\t\t\tgeometry = geometry.toNonIndexed();\r\n\t\t\t\tgeometry.setAttribute( 'uv', new Float32BufferAttribute( buffer.faceVertexUvs, 2 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t\tfunction handleElement( buffer, elementName, element ) {\r\n\r\n\t\t\tif ( elementName === 'vertex' ) {\r\n\r\n\t\t\t\tbuffer.vertices.push( element.x, element.y, element.z );\r\n\r\n\t\t\t\tif ( 'nx' in element && 'ny' in element && 'nz' in element ) {\r\n\r\n\t\t\t\t\tbuffer.normals.push( element.nx, element.ny, element.nz );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( 's' in element && 't' in element ) {\r\n\r\n\t\t\t\t\tbuffer.uvs.push( element.s, element.t );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( 'red' in element && 'green' in element && 'blue' in element ) {\r\n\r\n\t\t\t\t\tbuffer.colors.push( element.red / 255.0, element.green / 255.0, element.blue / 255.0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( elementName === 'face' ) {\r\n\r\n\t\t\t\tvar vertex_indices = element.vertex_indices || element.vertex_index; // issue #9338\r\n\t\t\t\tvar texcoord = element.texcoord;\r\n\r\n\t\t\t\tif ( vertex_indices.length === 3 ) {\r\n\r\n\t\t\t\t\tbuffer.indices.push( vertex_indices[ 0 ], vertex_indices[ 1 ], vertex_indices[ 2 ] );\r\n\r\n\t\t\t\t\tif ( texcoord && texcoord.length === 6 ) {\r\n\r\n\t\t\t\t\t\tbuffer.faceVertexUvs.push( texcoord[ 0 ], texcoord[ 1 ] );\r\n\t\t\t\t\t\tbuffer.faceVertexUvs.push( texcoord[ 2 ], texcoord[ 3 ] );\r\n\t\t\t\t\t\tbuffer.faceVertexUvs.push( texcoord[ 4 ], texcoord[ 5 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( vertex_indices.length === 4 ) {\r\n\r\n\t\t\t\t\tbuffer.indices.push( vertex_indices[ 0 ], vertex_indices[ 1 ], vertex_indices[ 3 ] );\r\n\t\t\t\t\tbuffer.indices.push( vertex_indices[ 1 ], vertex_indices[ 2 ], vertex_indices[ 3 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction binaryRead( dataview, at, type, little_endian ) {\r\n\r\n\t\t\tswitch ( type ) {\r\n\r\n\t\t\t\t// corespondences for non-specific length types here match rply:\r\n\t\t\t\tcase 'int8':\t\tcase 'char':\t return [ dataview.getInt8( at ), 1 ];\r\n\t\t\t\tcase 'uint8':\t\tcase 'uchar':\t return [ dataview.getUint8( at ), 1 ];\r\n\t\t\t\tcase 'int16':\t\tcase 'short':\t return [ dataview.getInt16( at, little_endian ), 2 ];\r\n\t\t\t\tcase 'uint16':\tcase 'ushort': return [ dataview.getUint16( at, little_endian ), 2 ];\r\n\t\t\t\tcase 'int32':\t\tcase 'int':\t\t return [ dataview.getInt32( at, little_endian ), 4 ];\r\n\t\t\t\tcase 'uint32':\tcase 'uint':\t return [ dataview.getUint32( at, little_endian ), 4 ];\r\n\t\t\t\tcase 'float32': case 'float':\t return [ dataview.getFloat32( at, little_endian ), 4 ];\r\n\t\t\t\tcase 'float64': case 'double': return [ dataview.getFloat64( at, little_endian ), 8 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction binaryReadElement( dataview, at, properties, little_endian ) {\r\n\r\n\t\t\tvar element = {};\r\n\t\t\tvar result, read = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < properties.length; i ++ ) {\r\n\r\n\t\t\t\tif ( properties[ i ].type === 'list' ) {\r\n\r\n\t\t\t\t\tvar list = [];\r\n\r\n\t\t\t\t\tresult = binaryRead( dataview, at + read, properties[ i ].countType, little_endian );\r\n\t\t\t\t\tvar n = result[ 0 ];\r\n\t\t\t\t\tread += result[ 1 ];\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < n; j ++ ) {\r\n\r\n\t\t\t\t\t\tresult = binaryRead( dataview, at + read, properties[ i ].itemType, little_endian );\r\n\t\t\t\t\t\tlist.push( result[ 0 ] );\r\n\t\t\t\t\t\tread += result[ 1 ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telement[ properties[ i ].name ] = list;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tresult = binaryRead( dataview, at + read, properties[ i ].type, little_endian );\r\n\t\t\t\t\telement[ properties[ i ].name ] = result[ 0 ];\r\n\t\t\t\t\tread += result[ 1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn [ element, read ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseBinary( data, header ) {\r\n\r\n\t\t\tvar buffer = {\r\n\t\t\t\tindices: [],\r\n\t\t\t\tvertices: [],\r\n\t\t\t\tnormals: [],\r\n\t\t\t\tuvs: [],\r\n\t\t\t\tfaceVertexUvs: [],\r\n\t\t\t\tcolors: []\r\n\t\t\t};\r\n\r\n\t\t\tvar little_endian = ( header.format === 'binary_little_endian' );\r\n\t\t\tvar body = new DataView( data, header.headerLength );\r\n\t\t\tvar result, loc = 0;\r\n\r\n\t\t\tfor ( var currentElement = 0; currentElement < header.elements.length; currentElement ++ ) {\r\n\r\n\t\t\t\tfor ( var currentElementCount = 0; currentElementCount < header.elements[ currentElement ].count; currentElementCount ++ ) {\r\n\r\n\t\t\t\t\tresult = binaryReadElement( body, loc, header.elements[ currentElement ].properties, little_endian );\r\n\t\t\t\t\tloc += result[ 1 ];\r\n\t\t\t\t\tvar element = result[ 0 ];\r\n\r\n\t\t\t\t\thandleElement( buffer, header.elements[ currentElement ].name, element );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn postProcess( buffer );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar geometry;\r\n\t\tvar scope = this;\r\n\r\n\t\tif ( data instanceof ArrayBuffer ) {\r\n\r\n\t\t\tvar text = LoaderUtils.decodeText( new Uint8Array( data ) );\r\n\t\t\tvar header = parseHeader( text );\r\n\r\n\t\t\tgeometry = header.format === 'ascii' ? parseASCII( text, header ) : parseBinary( data, header );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgeometry = parseASCII( data, parseHeader( data ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn geometry;\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { PLYLoader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/loaders/PLYLoader.js"],"sourceRoot":""}