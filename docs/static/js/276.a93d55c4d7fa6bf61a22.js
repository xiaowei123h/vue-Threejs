webpackJsonp([276],{NWEx:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("5WRe"),r=i("6+nK"),o=function e(){r.Mesh.call(this,e.Geometry,new r.MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var t=new r.Vector3,i=new r.Vector3,n=new r.DataTexture(new Uint8Array(768),16,16,r.RGBFormat);n.minFilter=r.NearestFilter,n.magFilter=r.NearestFilter,n.wrapS=r.ClampToEdgeWrapping,n.wrapT=r.ClampToEdgeWrapping;var o=new r.DataTexture(new Uint8Array(768),16,16,r.RGBFormat);o.minFilter=r.NearestFilter,o.magFilter=r.NearestFilter,o.wrapS=r.ClampToEdgeWrapping,o.wrapT=r.ClampToEdgeWrapping;var s=e.Geometry,a=new r.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),l=new r.RawShaderMaterial({uniforms:{map:{value:n},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),u=new r.Mesh(s,a),h=[],d=c.Shader,v=new r.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:o},color:{value:new r.Color(16777215)},scale:{value:new r.Vector2},screenPosition:{value:new r.Vector3}},vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:r.AdditiveBlending,transparent:!0,depthWrite:!1}),p=new r.Mesh(s,v);this.addElement=function(e){h.push(e)};var m=new r.Vector2,f=new r.Vector2,w=new r.Box2,g=new r.Vector4;this.onBeforeRender=function(e,r,c){e.getCurrentViewport(g);var d=g.w/g.z,y=g.z/2,x=g.w/2,E=16/g.w;if(m.set(E*d,E),w.min.set(g.x,g.y),w.max.set(g.x+(g.z-16),g.y+(g.w-16)),i.setFromMatrixPosition(this.matrixWorld),i.applyMatrix4(c.matrixWorldInverse),!(i.z>0)&&(t.copy(i).applyMatrix4(c.projectionMatrix),f.x=g.x+t.x*y+y-8,f.y=g.y+t.y*x+x-8,w.containsPoint(f))){e.copyFramebufferToTexture(f,n),(T=a.uniforms).scale.value=m,T.screenPosition.value=t,e.renderBufferDirect(c,null,s,a,u,null),e.copyFramebufferToTexture(f,o),(T=l.uniforms).scale.value=m,T.screenPosition.value=t,e.renderBufferDirect(c,null,s,l,u,null);for(var b=2*-t.x,M=2*-t.y,P=0,R=h.length;P<R;P++){var T,S=h[P];(T=v.uniforms).color.value.copy(S.color),T.map.value=S.texture,T.screenPosition.value.x=t.x+b*S.distance,T.screenPosition.value.y=t.y+M*S.distance;E=S.size/g.w,d=g.w/g.z;T.scale.value.set(E*d,E),v.uniformsNeedUpdate=!0,e.renderBufferDirect(c,null,s,v,p,null)}}},this.dispose=function(){a.dispose(),l.dispose(),v.dispose(),n.dispose(),o.dispose();for(var e=0,t=h.length;e<t;e++)h[e].texture.dispose()}};o.prototype=Object.create(r.Mesh.prototype),o.prototype.constructor=o,o.prototype.isLensflare=!0;var s,a,l,c=function(e,t,i,n){this.texture=e,this.size=t||1,this.distance=i||0,this.color=n||new r.Color(16777215)};c.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},o.Geometry=(s=new r.BufferGeometry,a=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),l=new r.InterleavedBuffer(a,5),s.setIndex([0,1,2,0,2,3]),s.setAttribute("position",new r.InterleavedBufferAttribute(l,3,0,!1)),s.setAttribute("uv",new r.InterleavedBufferAttribute(l,2,3,!1)),s);var u={data:function(){return{container:null,stats:null,camera:null,scene:null,renderer:null,controls:null,clock:null}},mounted:function(){this.clock=new this.$THREE.Clock,this.init(),this.animate()},methods:{init:function(){this.container=document.createElement("div"),document.getElementsByClassName("webglLensflares-container")[0].appendChild(this.container),this.camera=new this.$THREE.PerspectiveCamera(40,this.$webglInnerWidth/window.innerHeight,1,15e3),this.camera.position.z=250,this.scene=new this.$THREE.Scene,this.scene.background=(new this.$THREE.Color).setHSL(.51,.4,.01),this.scene.fog=new this.$THREE.Fog(this.scene.background,3500,15e3);for(var e=new this.$THREE.BoxBufferGeometry(250,250,250),t=new this.$THREE.MeshPhongMaterial({color:16777215,specular:16777215,shininess:50}),i=0;i<3e3;i++){var r=new this.$THREE.Mesh(e,t);r.position.x=8e3*(2*Math.random()-1),r.position.y=8e3*(2*Math.random()-1),r.position.z=8e3*(2*Math.random()-1),r.rotation.x=Math.random()*Math.PI,r.rotation.y=Math.random()*Math.PI,r.rotation.z=Math.random()*Math.PI,r.matrixAutoUpdate=!1,r.updateMatrix(),this.scene.add(r)}var s=new this.$THREE.DirectionalLight(16777215,.05);s.position.set(0,-1,0).normalize(),s.color.setHSL(.1,.7,.5),this.scene.add(s);var a=new this.$THREE.TextureLoader,l=a.load("static/textures/lensflare/lensflare0.png"),u=a.load("static/textures/lensflare/lensflare3.png"),h=this;function d(e,t,i,n,r,s){var a=new h.$THREE.PointLight(16777215,1.5,2e3);a.color.setHSL(e,t,i),a.position.set(n,r,s),h.scene.add(a);var d=new o;d.addElement(new c(l,700,0,a.color)),d.addElement(new c(u,60,.6)),d.addElement(new c(u,70,.7)),d.addElement(new c(u,120,.9)),d.addElement(new c(u,70,1)),a.add(d)}d(.55,.9,.5,5e3,0,-1e3),d(.08,.8,.5,0,0,-1e3),d(.995,.5,.9,5e3,5e3,-1e3),this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.renderer.outputEncoding=this.$THREE.sRGBEncoding,this.container.appendChild(this.renderer.domElement),this.controls=new n.a(this.camera,this.renderer.domElement),this.controls.movementSpeed=2500,this.controls.domElement=this.container,this.controls.rollSpeed=Math.PI/6,this.controls.autoForward=!1,this.controls.dragToLook=!1,this.stats=new this.$Stats,this.stats.dom.style.left="280px",this.container.appendChild(this.stats.dom),window.addEventListener("resize",this.onWindowResize,!1)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate),this.render(),this.stats.update()},render:function(){var e=this.clock.getDelta();this.controls.update(e),this.renderer.render(this.scene,this.camera)}}},h={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglLensflares-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" - lensflares"),t("br"),this._v("\n\t\t\ttextures from "),t("a",{attrs:{href:"http://www.ro.me",target:"_blank",rel:"noopener"}},[this._v("ro.me")]),t("br"),this._v("\n\t\t\tfly with WASD/RF/QE + mouse\n\t\t")])])}]};var d=i("VU/8")(u,h,!1,function(e){i("RfvT")},"data-v-2e2dae92",null);t.default=d.exports},RfvT:function(e,t){}});
//# sourceMappingURL=276.a93d55c4d7fa6bf61a22.js.map