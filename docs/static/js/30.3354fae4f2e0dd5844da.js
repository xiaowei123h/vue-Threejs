webpackJsonp([30],{"3qDO":function(t,e){},"rC+4":function(t,e,r){"use strict";var i=r("6+nK");
/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */function a(t){throw t}var n=void 0,s={};function o(t,e){var r,i=t.split("."),a=s;!(i[0]in a)&&a.execScript&&a.execScript("var "+i[0]);for(;i.length&&(r=i.shift());)i.length||e===n?a=a[r]?a[r]:a[r]={}:a[r]=e}var c,h="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;for(new(h?Uint8Array:Array)(256),c=0;256>c;++c)for(var l=(l=c)>>>1;l;l>>>=1)0;function u(t,e,r){var i,a="number"==typeof e?e:e=0,n="number"==typeof r?r:t.length;for(i=-1,a=7&n;a--;++e)i=i>>>8^f[255&(i^t[e])];for(a=n>>3;a--;e+=8)i=(i=(i=(i=(i=(i=(i=(i=i>>>8^f[255&(i^t[e])])>>>8^f[255&(i^t[e+1])])>>>8^f[255&(i^t[e+2])])>>>8^f[255&(i^t[e+3])])>>>8^f[255&(i^t[e+4])])>>>8^f[255&(i^t[e+5])])>>>8^f[255&(i^t[e+6])])>>>8^f[255&(i^t[e+7])];return(4294967295^i)>>>0}var d=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],f=h?new Uint32Array(d):d;function v(){}function p(t){var e,r,i,a,n,s,o,c,l,u,d=t.length,f=0,v=Number.POSITIVE_INFINITY;for(c=0;c<d;++c)t[c]>f&&(f=t[c]),t[c]<v&&(v=t[c]);for(e=1<<f,r=new(h?Uint32Array:Array)(e),i=1,a=0,n=2;i<=f;){for(c=0;c<d;++c)if(t[c]===i){for(s=0,o=a,l=0;l<i;++l)s=s<<1|1&o,o>>=1;for(u=i<<16|c,l=s;l<e;l+=n)r[l]=u;++a}++i,a<<=1,n<<=1}return[r,f,v]}v.prototype.getName=function(){return this.name},v.prototype.getData=function(){return this.data},v.prototype.H=function(){return this.I},o("Zlib.GunzipMember",v),o("Zlib.GunzipMember.prototype.getName",v.prototype.getName),o("Zlib.GunzipMember.prototype.getData",v.prototype.getData),o("Zlib.GunzipMember.prototype.getMtime",v.prototype.H);var g,m=[];for(g=0;288>g;g++)switch(!0){case 143>=g:m.push([g+48,8]);break;case 255>=g:m.push([g-144+400,9]);break;case 279>=g:m.push([g-256+0,7]);break;case 287>=g:m.push([g-280+192,8]);break;default:a("invalid literal: "+g)}var y=function(){function t(t){switch(!0){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case 12>=t:return[265,t-11,1];case 14>=t:return[266,t-13,1];case 16>=t:return[267,t-15,1];case 18>=t:return[268,t-17,1];case 22>=t:return[269,t-19,2];case 26>=t:return[270,t-23,2];case 30>=t:return[271,t-27,2];case 34>=t:return[272,t-31,2];case 42>=t:return[273,t-35,3];case 50>=t:return[274,t-43,3];case 58>=t:return[275,t-51,3];case 66>=t:return[276,t-59,3];case 82>=t:return[277,t-67,4];case 98>=t:return[278,t-83,4];case 114>=t:return[279,t-99,4];case 130>=t:return[280,t-115,4];case 162>=t:return[281,t-131,5];case 194>=t:return[282,t-163,5];case 226>=t:return[283,t-195,5];case 257>=t:return[284,t-227,5];case 258===t:return[285,t-258,0];default:a("invalid length: "+t)}}var e,r,i=[];for(e=3;258>=e;e++)r=t(e),i[e]=r[2]<<24|r[1]<<16|r[0];return i}();function _(t,e){switch(this.i=[],this.j=32768,this.d=this.f=this.c=this.n=0,this.input=h?new Uint8Array(t):t,this.o=!1,this.k=b,this.z=!1,!e&&(e={})||(e.index&&(this.c=e.index),e.bufferSize&&(this.j=e.bufferSize),e.bufferType&&(this.k=e.bufferType),e.resize&&(this.z=e.resize)),this.k){case w:this.a=32768,this.b=new(h?Uint8Array:Array)(32768+this.j+258);break;case b:this.a=0,this.b=new(h?Uint8Array:Array)(this.j),this.e=this.F,this.q=this.B,this.l=this.D;break;default:a(Error("invalid inflate mode"))}}h&&new Uint32Array(y);var w=0,b=1;_.prototype.g=function(){for(;!this.o;){var t=j(this,3);switch(1&t&&(this.o=!0),t>>>=1){case 0:var e=this.input,r=this.c,i=this.b,s=this.a,o=e.length,c=n,l=i.length,u=n;switch(this.d=this.f=0,r+1>=o&&a(Error("invalid uncompressed block header: LEN")),c=e[r++]|e[r++]<<8,r+1>=o&&a(Error("invalid uncompressed block header: NLEN")),c===~(e[r++]|e[r++]<<8)&&a(Error("invalid uncompressed block header: length verify")),r+c>e.length&&a(Error("input buffer is broken")),this.k){case w:for(;s+c>i.length;){if(c-=u=l-s,h)i.set(e.subarray(r,r+u),s),s+=u,r+=u;else for(;u--;)i[s++]=e[r++];this.a=s,i=this.e(),s=this.a}break;case b:for(;s+c>i.length;)i=this.e({t:2});break;default:a(Error("invalid inflate mode"))}if(h)i.set(e.subarray(r,r+c),s),s+=c,r+=c;else for(;c--;)i[s++]=e[r++];this.c=r,this.a=s,this.b=i;break;case 1:this.l(H,P);break;case 2:$(this);break;default:a(Error("unknown BTYPE: "+t))}}return this.q()};var x,E,A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=h?new Uint16Array(A):A,z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],M=h?new Uint16Array(z):z,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],N=h?new Uint8Array(k):k,U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],T=h?new Uint16Array(U):U,S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=h?new Uint8Array(S):S,I=new(h?Uint8Array:Array)(288);for(x=0,E=I.length;x<E;++x)I[x]=143>=x?8:255>=x?9:279>=x?7:8;var C,F,H=p(I),D=new(h?Uint8Array:Array)(30);for(C=0,F=D.length;C<F;++C)D[C]=5;var P=p(D);function j(t,e){for(var r,i=t.f,n=t.d,s=t.input,o=t.c,c=s.length;n<e;)o>=c&&a(Error("input buffer is broken")),i|=s[o++]<<n,n+=8;return r=i&(1<<e)-1,t.f=i>>>e,t.d=n-e,t.c=o,r}function B(t,e){for(var r,i,a=t.f,n=t.d,s=t.input,o=t.c,c=s.length,h=e[0],l=e[1];n<l&&!(o>=c);)a|=s[o++]<<n,n+=8;return i=(r=h[a&(1<<l)-1])>>>16,t.f=a>>i,t.d=n-i,t.c=o,65535&r}function $(t){function e(t,e,r){var i,a,n,s=this.w;for(n=0;n<t;)switch(i=B(this,e)){case 16:for(a=3+j(this,2);a--;)r[n++]=s;break;case 17:for(a=3+j(this,3);a--;)r[n++]=0;s=0;break;case 18:for(a=11+j(this,7);a--;)r[n++]=0;s=0;break;default:s=r[n++]=i}return this.w=s,r}var r,i,a,n,s=j(t,5)+257,o=j(t,5)+1,c=j(t,4)+4,l=new(h?Uint8Array:Array)(L.length);for(n=0;n<c;++n)l[L[n]]=j(t,3);if(!h)for(n=c,c=l.length;n<c;++n)l[L[n]]=0;r=p(l),i=new(h?Uint8Array:Array)(s),a=new(h?Uint8Array:Array)(o),t.w=0,t.l(p(e.call(t,s,r,i)),p(e.call(t,o,r,a)))}function G(t){this.input=t,this.c=0,this.m=[],this.s=!1}_.prototype.l=function(t,e){var r=this.b,i=this.a;this.r=t;for(var a,n,s,o,c=r.length-258;256!==(a=B(this,t));)if(256>a)i>=c&&(this.a=i,r=this.e(),i=this.a),r[i++]=a;else for(o=M[n=a-257],0<N[n]&&(o+=j(this,N[n])),a=B(this,e),s=T[a],0<R[a]&&(s+=j(this,R[a])),i>=c&&(this.a=i,r=this.e(),i=this.a);o--;)r[i]=r[i++-s];for(;8<=this.d;)this.d-=8,this.c--;this.a=i},_.prototype.D=function(t,e){var r=this.b,i=this.a;this.r=t;for(var a,n,s,o,c=r.length;256!==(a=B(this,t));)if(256>a)i>=c&&(c=(r=this.e()).length),r[i++]=a;else for(o=M[n=a-257],0<N[n]&&(o+=j(this,N[n])),a=B(this,e),s=T[a],0<R[a]&&(s+=j(this,R[a])),i+o>c&&(c=(r=this.e()).length);o--;)r[i]=r[i++-s];for(;8<=this.d;)this.d-=8,this.c--;this.a=i},_.prototype.e=function(){var t,e,r=new(h?Uint8Array:Array)(this.a-32768),i=this.a-32768,a=this.b;if(h)r.set(a.subarray(32768,r.length));else for(t=0,e=r.length;t<e;++t)r[t]=a[t+32768];if(this.i.push(r),this.n+=r.length,h)a.set(a.subarray(i,i+32768));else for(t=0;32768>t;++t)a[t]=a[i+t];return this.a=32768,a},_.prototype.F=function(t){var e,r,i,a=this.input.length/this.c+1|0,n=this.input,s=this.b;return t&&("number"==typeof t.t&&(a=t.t),"number"==typeof t.A&&(a+=t.A)),2>a?r=(i=(n.length-this.c)/this.r[2]/2*258|0)<s.length?s.length+i:s.length<<1:r=s.length*a,h?(e=new Uint8Array(r)).set(s):e=s,this.b=e},_.prototype.q=function(){var t,e,r,i,a,n=0,s=this.b,o=this.i,c=new(h?Uint8Array:Array)(this.n+(this.a-32768));if(0===o.length)return h?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);for(e=0,r=o.length;e<r;++e)for(i=0,a=(t=o[e]).length;i<a;++i)c[n++]=t[i];for(e=32768,r=this.a;e<r;++e)c[n++]=s[e];return this.i=[],this.buffer=c},_.prototype.B=function(){var t,e=this.a;return h?this.z?(t=new Uint8Array(e)).set(this.b.subarray(0,e)):t=this.b.subarray(0,e):(this.b.length>e&&(this.b.length=e),t=this.b),this.buffer=t},G.prototype.G=function(){return this.s||this.g(),this.m.slice()},G.prototype.g=function(){for(var t=this.input.length;this.c<t;){var e,r,i=new v,s=n,o=n,c=n,l=n,d=n,f=n,p=n,g=this.input,m=this.c;switch(i.u=g[m++],i.v=g[m++],(31!==i.u||139!==i.v)&&a(Error("invalid file signature:"+i.u+","+i.v)),i.p=g[m++],i.p){case 8:break;default:a(Error("unknown compression method: "+i.p))}if(i.h=g[m++],r=g[m++]|g[m++]<<8|g[m++]<<16|g[m++]<<24,i.I=new Date(1e3*r),i.O=g[m++],i.N=g[m++],0<(4&i.h)&&(i.J=g[m++]|g[m++]<<8,m+=i.J),0<(8&i.h)){for(f=[],d=0;0<(l=g[m++]);)f[d++]=String.fromCharCode(l);i.name=f.join("")}if(0<(16&i.h)){for(f=[],d=0;0<(l=g[m++]);)f[d++]=String.fromCharCode(l);i.K=f.join("")}0<(2&i.h)&&(i.C=65535&u(g,0,m),i.C!==(g[m++]|g[m++]<<8)&&a(Error("invalid header crc16"))),s=g[g.length-4]|g[g.length-3]<<8|g[g.length-2]<<16|g[g.length-1]<<24,g.length-m-4-4<512*s&&(c=s),o=new _(g,{index:m,bufferSize:c}),i.data=e=o.g(),m=o.c,i.L=p=(g[m++]|g[m++]<<8|g[m++]<<16|g[m++]<<24)>>>0,u(e,n,n)!==p&&a(Error("invalid CRC-32 checksum: 0x"+u(e,n,n).toString(16)+" / 0x"+p.toString(16))),i.M=s=(g[m++]|g[m++]<<8|g[m++]<<16|g[m++]<<24)>>>0,(4294967295&e.length)!==s&&a(Error("invalid input size: "+(4294967295&e.length)+" / "+s)),this.m.push(i),this.c=m}this.s=!0;var y,w,b,x=this.m,E=0,A=0;for(y=0,w=x.length;y<w;++y)A+=x[y].data.length;if(h)for(b=new Uint8Array(A),y=0;y<w;++y)b.set(x[y].data,E),E+=x[y].data.length;else{for(b=[],y=0;y<w;++y)b[y]=x[y].data;b=Array.prototype.concat.apply([],b)}return b},o("Zlib.Gunzip",G),o("Zlib.Gunzip.prototype.decompress",G.prototype.g),o("Zlib.Gunzip.prototype.getMembers",G.prototype.G);var V=s.Zlib,O=function(t,e,r){var a=this;this.volume=t,e=e||0,Object.defineProperty(this,"index",{get:function(){return e},set:function(t){return e=t,a.geometryNeedsUpdate=!0,e}}),this.axis=r||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var n=new i._91(this.canvas);n.minFilter=i._18,n.wrapS=n.wrapT=i.p;var s=new i._30({map:n,side:i.J,transparent:!0});this.mesh=new i._29(this.geometry,s),this.mesh.matrixAutoUpdate=!1,this.geometryNeedsUpdate=!0,this.repaint()};O.prototype={constructor:O,repaint:function(){this.geometryNeedsUpdate&&this.updateGeometry();var t=this.iLength,e=this.jLength,r=this.sliceAccess,i=this.volume,a=this.canvasBuffer,n=this.ctxBuffer,s=n.getImageData(0,0,t,e),o=s.data,c=i.data,h=i.upperThreshold,l=i.lowerThreshold,u=i.windowLow,d=i.windowHigh,f=0;if("label"===i.dataType)for(var v=0;v<e;v++)for(var p=0;p<t;p++){var g=c[r(p,v)];g=g>=this.colorMap.length?g%this.colorMap.length+1:g;var m=this.colorMap[g];o[4*f]=m>>24&255,o[4*f+1]=m>>16&255,o[4*f+2]=m>>8&255,o[4*f+3]=255&m,f++}else for(v=0;v<e;v++)for(p=0;p<t;p++){var y=c[r(p,v)],_=255;_=h>=y&&l<=y?_:0,y=(y=Math.floor(255*(y-u)/(d-u)))>255?255:y<0?0:0|y,o[4*f]=y,o[4*f+1]=y,o[4*f+2]=y,o[4*f+3]=_,f++}n.putImageData(s,0,0),this.ctx.drawImage(a,0,0,t,e,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0},updateGeometry:function(){var t=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=t.sliceAccess,this.jLength=t.jLength,this.iLength=t.iLength,this.matrix=t.matrix,this.canvas.width=t.planeWidth,this.canvas.height=t.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry&&this.geometry.dispose(),this.geometry=new i._53(t.planeWidth,t.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix.identity(),this.mesh.applyMatrix4(this.matrix)),this.geometryNeedsUpdate=!1}};var W=function(t,e,r,a,n){if(arguments.length>0){switch(this.xLength=Number(t)||1,this.yLength=Number(e)||1,this.zLength=Number(r)||1,a){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":this.data=new Uint8Array(n);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(n);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(n);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(n);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(n);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(n);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw"Error in Volume constructor : this type is not supported in JavaScript";case"Float32":case"float32":case"float":this.data=new Float32Array(n);break;case"Float64":case"float64":case"double":this.data=new Float64Array(n);break;default:this.data=new Uint8Array(n)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw"Error in Volume constructor, lengths are not matching arrayBuffer size"}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new i._27,this.matrix.identity();var s=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return s},set:function(t){s=t,this.sliceList.forEach(function(t){t.geometryNeedsUpdate=!0})}});var o=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return o},set:function(t){o=t,this.sliceList.forEach(function(t){t.geometryNeedsUpdate=!0})}}),this.sliceList=[]};W.prototype={constructor:W,getData:function(t,e,r){return this.data[r*this.xLength*this.yLength+e*this.xLength+t]},access:function(t,e,r){return r*this.xLength*this.yLength+e*this.xLength+t},reverseAccess:function(t){var e=Math.floor(t/(this.yLength*this.xLength)),r=Math.floor((t-e*this.yLength*this.xLength)/this.xLength);return[t-e*this.yLength*this.xLength-r*this.xLength,r,e]},map:function(t,e){var r=this.data.length;e=e||this;for(var i=0;i<r;i++)this.data[i]=t.call(e,this.data[i],i,this.data);return this},extractPerpendicularPlane:function(t,e){var r,a,n,s,o,c,h,l,u=(new i._28).identity(),d=this,f=new i._105,v=new i._105,p=new i._105,g=new i._105(this.xLength,this.yLength,this.zLength);switch(t){case"x":f.set(1,0,0),v.set(0,0,-1),p.set(0,-1,0),o=this.spacing[2],c=this.spacing[1],l=new i._105(e,0,0),u.multiply((new i._28).makeRotationY(Math.PI/2)),h=(d.RASDimensions[0]-1)/2,u.setPosition(new i._105(e-h,0,0));break;case"y":f.set(0,1,0),v.set(1,0,0),p.set(0,0,1),o=this.spacing[0],c=this.spacing[2],l=new i._105(0,e,0),u.multiply((new i._28).makeRotationX(-Math.PI/2)),h=(d.RASDimensions[1]-1)/2,u.setPosition(new i._105(0,e-h,0));break;case"z":default:f.set(0,0,1),v.set(1,0,0),p.set(0,-1,0),o=this.spacing[0],c=this.spacing[1],l=new i._105(0,0,e),h=(d.RASDimensions[2]-1)/2,u.setPosition(new i._105(0,0,e-h))}v.applyMatrix4(d.inverseMatrix).normalize(),v.argVar="i",p.applyMatrix4(d.inverseMatrix).normalize(),p.argVar="j",f.applyMatrix4(d.inverseMatrix).normalize(),r=Math.floor(Math.abs(v.dot(g))),a=Math.floor(Math.abs(p.dot(g))),n=Math.abs(r*o),s=Math.abs(a*c),l=Math.abs(Math.round(l.applyMatrix4(d.inverseMatrix).dot(f)));var m=[new i._105(1,0,0),new i._105(0,1,0),new i._105(0,0,1)],y=[v,p,f].find(function(t){return Math.abs(t.dot(m[0]))>.9}),_=[v,p,f].find(function(t){return Math.abs(t.dot(m[1]))>.9}),w=[v,p,f].find(function(t){return Math.abs(t.dot(m[2]))>.9});return{iLength:r,jLength:a,sliceAccess:function(t,e){var r=y===f?l:"i"===y.argVar?t:e,i=_===f?l:"i"===_.argVar?t:e,a=w===f?l:"i"===w.argVar?t:e,n=y.dot(m[0])>0?r:d.xLength-1-r,s=_.dot(m[1])>0?i:d.yLength-1-i,o=w.dot(m[2])>0?a:d.zLength-1-a;return d.access(n,s,o)},matrix:u,planeWidth:n,planeHeight:s}},extractSlice:function(t,e){var r=new O(this,e,t);return this.sliceList.push(r),r},repaintAllSlices:function(){return this.sliceList.forEach(function(t){t.repaint()}),this},computeMinMax:function(){var t=1/0,e=-1/0,r=this.data.length,i=0;for(i=0;i<r;i++)if(!isNaN(this.data[i])){var a=this.data[i];t=Math.min(t,a),e=Math.max(e,a)}return this.min=t,this.max=e,[t,e]}},r.d(e,"a",function(){return Z});var Z=function(t){i._21.call(this,t)};Z.prototype=Object.assign(Object.create(i._21.prototype),{constructor:Z,load:function(t,e,r,a){var n=this,s=new i.S(n.manager);s.setPath(n.path),s.setResponseType("arraybuffer"),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(t,function(r){try{e(n.parse(r))}catch(e){a?a(e):console.error(e),n.manager.itemError(t)}},r,a)},parse:function(t){var e=t,r=0,a=new Int8Array(new Int16Array([1]).buffer)[0]>0,n=!0,s={};var o=function(t,i){void 0!==i&&null!==i||(i=1);var s=1,o=Uint8Array;switch(t){case"uchar":break;case"schar":o=Int8Array;break;case"ushort":o=Uint16Array,s=2;break;case"sshort":o=Int16Array,s=2;break;case"uint":o=Uint32Array,s=4;break;case"sint":o=Int32Array,s=4;break;case"float":o=Float32Array,s=4;break;case"complex":case"double":o=Float64Array,s=8}var c=new o(e.slice(r,r+=i*s));return a!=n&&(c=function(t,e){for(var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=0;i<t.byteLength;i+=e)for(var a=i+e-1,n=i;a>n;a--,n++){var s=r[n];r[n]=r[a],r[a]=s}return t}(c,s)),1==i?c[0]:c}("uchar",t.byteLength),c=o.length,h=null,l=0;for(f=1;f<c;f++)if(10==o[f-1]&&10==o[f]){h=this.parseChars(o,0,f-2),l=f+1;break}!function(t){var e,r,a,n,o,c,h,l,u;for(l=0,u=(c=t.split(/\r?\n/)).length;l<u;l++)(o=c[l]).match(/NRRD\d+/)?s.isNrrd=!0:o.match(/^#/)||(h=o.match(/(.*):(.*)/))&&(r=h[1].trim(),e=h[2].trim(),(a=Z.prototype.fieldFunctions[r])?a.call(s,e):s[r]=e);if(!s.isNrrd)throw new Error("Not an NRRD file");if("bz2"===s.encoding||"bzip2"===s.encoding)throw new Error("Bzip is not supported");if(!s.vectors&&(s.vectors=[new i._105(1,0,0),new i._105(0,1,0),new i._105(0,0,1)],s.spacings))for(n=0;n<=2;n++)isNaN(s.spacings[n])||s.vectors[n].multiplyScalar(s.spacings[n])}(h);e=o.subarray(l);if("gzip"===s.encoding||"gz"===s.encoding){var u=new V.Gunzip(new Uint8Array(e));e=u.decompress()}else if("ascii"===s.encoding||"text"===s.encoding||"txt"===s.encoding||"hex"===s.encoding)e=function(t,e,r){var i,a="";e=e||0,r=r||t.length;var n=s.sizes.reduce(function(t,e){return t*e},1),o=10;"hex"===s.encoding&&(o=16);var c=new s.__array(n),h=0,l=parseInt;s.__array!==Float32Array&&s.__array!==Float64Array||(l=parseFloat);for(var u=e;u<r;u++)((i=t[u])<9||i>13)&&32!==i?a+=String.fromCharCode(i):(""!==a&&(c[h]=l(a,o),h++),a="");return""!==a&&(c[h]=l(a,o),h++),c}(e);else if("raw"===s.encoding){for(var d=new Uint8Array(e.length),f=0;f<e.length;f++)d[f]=e[f];e=d}e=e.buffer;var v=new W;v.header=s,v.data=new s.__array(e);var p=v.computeMinMax(),g=p[0],m=p[1];v.windowLow=g,v.windowHigh=m,v.dimensions=[s.sizes[0],s.sizes[1],s.sizes[2]],v.xLength=v.dimensions[0],v.yLength=v.dimensions[1],v.zLength=v.dimensions[2];var y=new i._105(s.vectors[0][0],s.vectors[0][1],s.vectors[0][2]).length(),_=new i._105(s.vectors[1][0],s.vectors[1][1],s.vectors[1][2]).length(),w=new i._105(s.vectors[2][0],s.vectors[2][1],s.vectors[2][2]).length();v.spacing=[y,_,w],v.matrix=new i._28;var b=1,x=1;if("left-posterior-superior"==s.space?(b=-1,x=-1):"left-anterior-superior"===s.space&&(b=-1),s.vectors){var E=s.vectors;v.matrix.set(b*E[0][0],b*E[1][0],b*E[2][0],0,x*E[0][1],x*E[1][1],x*E[2][1],0,1*E[0][2],1*E[1][2],1*E[2][2],0,0,0,0,1)}else v.matrix.set(b,0,0,0,0,x,0,0,0,0,1,0,0,0,0,1);return v.inverseMatrix=new i._28,v.inverseMatrix.copy(v.matrix).invert(),v.RASDimensions=new i._105(v.xLength,v.yLength,v.zLength).applyMatrix4(v.matrix).round().toArray().map(Math.abs),v.lowerThreshold===-1/0&&(v.lowerThreshold=g),v.upperThreshold===1/0&&(v.upperThreshold=m),v},parseChars:function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=t.length);var i="",a=0;for(a=e;a<r;++a)i+=String.fromCharCode(t[a]);return i},fieldFunctions:{type:function(t){switch(t){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.__array=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.__array=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.__array=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.__array=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.__array=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.__array=Uint32Array;break;case"float":this.__array=Float32Array;break;case"double":this.__array=Float64Array;break;default:throw new Error("Unsupported NRRD data type: "+t)}return this.type=t},endian:function(t){return this.endian=t},encoding:function(t){return this.encoding=t},dimension:function(t){return this.dim=parseInt(t,10)},sizes:function(t){var e;return this.sizes=function(){var r,i,a,n;for(n=[],r=0,i=(a=t.split(/\s+/)).length;r<i;r++)e=a[r],n.push(parseInt(e,10));return n}()},space:function(t){return this.space=t},"space origin":function(t){return this.space_origin=t.split("(")[1].split(")")[0].split(",")},"space directions":function(t){var e,r,i;return r=t.match(/\(.*?\)/g),this.vectors=function(){var t,a,n;for(n=[],t=0,a=r.length;t<a;t++)i=r[t],n.push(function(){var t,r,a,n;for(n=[],t=0,r=(a=i.slice(1,-1).split(/,/)).length;t<r;t++)e=a[t],n.push(parseFloat(e));return n}());return n}()},spacings:function(t){var e,r;return r=t.split(/\s+/),this.spacings=function(){var t,i,a=[];for(t=0,i=r.length;t<i;t++)e=r[t],a.push(parseFloat(e));return a}()}}})},rjhO:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("QEtz"),a=r("wIBv"),n=r("rC+4"),s=r("6+nK"),o={uniforms:{u_size:{value:new s._105(1,1,1)},u_renderstyle:{value:0},u_renderthreshold:{value:.5},u_clim:{value:new s._104(1,1)},u_data:{value:null},u_cmdata:{value:null}},vertexShader:["\t\tvarying vec4 v_nearpos;","\t\tvarying vec4 v_farpos;","\t\tvarying vec3 v_position;","\t\tvoid main() {","\t\t\t\tmat4 viewtransformf = modelViewMatrix;","\t\t\t\tmat4 viewtransformi = inverse(modelViewMatrix);","\t\t\t\tvec4 position4 = vec4(position, 1.0);","\t\t\t\tvec4 pos_in_cam = viewtransformf * position4;","\t\t\t\tpos_in_cam.z = -pos_in_cam.w;","\t\t\t\tv_nearpos = viewtransformi * pos_in_cam;","\t\t\t\tpos_in_cam.z = pos_in_cam.w;","\t\t\t\tv_farpos = viewtransformi * pos_in_cam;","\t\t\t\tv_position = position;","\t\t\t\tgl_Position = projectionMatrix * viewMatrix * modelMatrix * position4;","\t\t}"].join("\n"),fragmentShader:["\t\tprecision highp float;","\t\tprecision mediump sampler3D;","\t\tuniform vec3 u_size;","\t\tuniform int u_renderstyle;","\t\tuniform float u_renderthreshold;","\t\tuniform vec2 u_clim;","\t\tuniform sampler3D u_data;","\t\tuniform sampler2D u_cmdata;","\t\tvarying vec3 v_position;","\t\tvarying vec4 v_nearpos;","\t\tvarying vec4 v_farpos;","\t\tconst int MAX_STEPS = 887;\t// 887 for 512^3, 1774 for 1024^3","\t\tconst int REFINEMENT_STEPS = 4;","\t\tconst float relative_step_size = 1.0;","\t\tconst vec4 ambient_color = vec4(0.2, 0.4, 0.2, 1.0);","\t\tconst vec4 diffuse_color = vec4(0.8, 0.2, 0.2, 1.0);","\t\tconst vec4 specular_color = vec4(1.0, 1.0, 1.0, 1.0);","\t\tconst float shininess = 40.0;","\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","\t\tfloat sample1(vec3 texcoords);","\t\tvec4 apply_colormap(float val);","\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray);","\t\tvoid main() {","\t\t\t\tvec3 farpos = v_farpos.xyz / v_farpos.w;","\t\t\t\tvec3 nearpos = v_nearpos.xyz / v_nearpos.w;","\t\t\t\tvec3 view_ray = normalize(nearpos.xyz - farpos.xyz);","\t\t\t\tfloat distance = dot(nearpos - v_position, view_ray);","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.x) / view_ray.x,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.x - 0.5 - v_position.x) / view_ray.x));","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.y) / view_ray.y,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.y - 0.5 - v_position.y) / view_ray.y));","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.z) / view_ray.z,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.z - 0.5 - v_position.z) / view_ray.z));","\t\t\t\tvec3 front = v_position + view_ray * distance;","\t\t\t\tint nsteps = int(-distance / relative_step_size + 0.5);","\t\t\t\tif ( nsteps < 1 )","\t\t\t\t\t\tdiscard;","\t\t\t\tvec3 step = ((v_position - front) / u_size) / float(nsteps);","\t\t\t\tvec3 start_loc = front / u_size;","\t\t\t\tif (u_renderstyle == 0)","\t\t\t\t\t\tcast_mip(start_loc, step, nsteps, view_ray);","\t\t\t\telse if (u_renderstyle == 1)","\t\t\t\t\t\tcast_iso(start_loc, step, nsteps, view_ray);","\t\t\t\tif (gl_FragColor.a < 0.05)","\t\t\t\t\t\tdiscard;","\t\t}","\t\tfloat sample1(vec3 texcoords) {","\t\t\t\t/* Sample float value from a 3D texture. Assumes intensity data. */","\t\t\t\treturn texture(u_data, texcoords.xyz).r;","\t\t}","\t\tvec4 apply_colormap(float val) {","\t\t\t\tval = (val - u_clim[0]) / (u_clim[1] - u_clim[0]);","\t\t\t\treturn texture2D(u_cmdata, vec2(val, 0.5));","\t\t}","\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","\t\t\t\tfloat max_val = -1e6;","\t\t\t\tint max_i = 100;","\t\t\t\tvec3 loc = start_loc;","\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {","\t\t\t\t\t\tif (iter >= nsteps)","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tfloat val = sample1(loc);","\t\t\t\t\t\tif (val > max_val) {","\t\t\t\t\t\t\t\tmax_val = val;","\t\t\t\t\t\t\t\tmax_i = iter;","\t\t\t\t\t\t}","\t\t\t\t\t\tloc += step;","\t\t\t\t}","\t\t\t\tvec3 iloc = start_loc + step * (float(max_i) - 0.5);","\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);","\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {","\t\t\t\t\t\tmax_val = max(max_val, sample1(iloc));","\t\t\t\t\t\tiloc += istep;","\t\t\t\t}","\t\t\t\tgl_FragColor = apply_colormap(max_val);","\t\t}","\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","\t\t\t\tgl_FragColor = vec4(0.0);\t// init transparent","\t\t\t\tvec4 color3 = vec4(0.0);\t// final color","\t\t\t\tvec3 dstep = 1.5 / u_size;\t// step to sample derivative","\t\t\t\tvec3 loc = start_loc;","\t\t\t\tfloat low_threshold = u_renderthreshold - 0.02 * (u_clim[1] - u_clim[0]);","\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {","\t\t\t\t\t\tif (iter >= nsteps)","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tfloat val = sample1(loc);","\t\t\t\t\t\tif (val > low_threshold) {","\t\t\t\t\t\t\t\tvec3 iloc = loc - 0.5 * step;","\t\t\t\t\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);","\t\t\t\t\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {","\t\t\t\t\t\t\t\t\t\tval = sample1(iloc);","\t\t\t\t\t\t\t\t\t\tif (val > u_renderthreshold) {","\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = add_lighting(val, iloc, dstep, view_ray);","\t\t\t\t\t\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\t\t\tiloc += istep;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t\tloc += step;","\t\t\t\t}","\t\t}","\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray)","\t\t{","\t\t\t\tvec3 V = normalize(view_ray);","\t\t\t\tvec3 N;","\t\t\t\tfloat val1, val2;","\t\t\t\tval1 = sample1(loc + vec3(-step[0], 0.0, 0.0));","\t\t\t\tval2 = sample1(loc + vec3(+step[0], 0.0, 0.0));","\t\t\t\tN[0] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tval1 = sample1(loc + vec3(0.0, -step[1], 0.0));","\t\t\t\tval2 = sample1(loc + vec3(0.0, +step[1], 0.0));","\t\t\t\tN[1] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tval1 = sample1(loc + vec3(0.0, 0.0, -step[2]));","\t\t\t\tval2 = sample1(loc + vec3(0.0, 0.0, +step[2]));","\t\t\t\tN[2] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tfloat gm = length(N); // gradient magnitude","\t\t\t\tN = normalize(N);","\t\t\t\tfloat Nselect = float(dot(N, V) > 0.0);","\t\t\t\tN = (2.0 * Nselect - 1.0) * N;\t// ==\tNselect * N - (1.0-Nselect)*N;","\t\t\t\tvec4 ambient_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tvec4 diffuse_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tvec4 specular_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tfor (int i=0; i<1; i++)","\t\t\t\t{","\t\t\t\t\t\tvec3 L = normalize(view_ray);\t//lightDirs[i];","\t\t\t\t\t\tfloat lightEnabled = float( length(L) > 0.0 );","\t\t\t\t\t\tL = normalize(L + (1.0 - lightEnabled));","\t\t\t\t\t\tfloat lambertTerm = clamp(dot(N, L), 0.0, 1.0);","\t\t\t\t\t\tvec3 H = normalize(L+V); // Halfway vector","\t\t\t\t\t\tfloat specularTerm = pow(max(dot(H, N), 0.0), shininess);","\t\t\t\t\t\tfloat mask1 = lightEnabled;","\t\t\t\t\t\tambient_color +=\tmask1 * ambient_color;\t// * gl_LightSource[i].ambient;","\t\t\t\t\t\tdiffuse_color +=\tmask1 * lambertTerm;","\t\t\t\t\t\tspecular_color += mask1 * specularTerm * specular_color;","\t\t\t\t}","\t\t\t\tvec4 final_color;","\t\t\t\tvec4 color = apply_colormap(val);","\t\t\t\tfinal_color = color * (ambient_color + diffuse_color) + specular_color;","\t\t\t\tfinal_color.a = color.a;","\t\t\t\treturn final_color;","\t\t}"].join("\n")},c=r("DqHV"),h={data:function(){return{renderer:null,scene:null,camera:null,controls:null,material:null,volconfig:null,cmtextures:null,gui:null}},mounted:function(){!1===c.a.isWebGL2Available()&&document.getElementsByClassName("webgl2MaterialsTexture3d-container")[0].appendChild(c.a.getWebGL2ErrorMessage()),this.init()},beforeDestroy:function(){this.gui.destroy()},methods:{init:function(){var t=this;this.scene=new this.$THREE.Scene,this.renderer=new this.$THREE.WebGLRenderer,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),document.getElementsByClassName("webgl2MaterialsTexture3d-container")[0].appendChild(this.renderer.domElement);var e=512,r=this.$webglInnerWidth/window.innerHeight;this.camera=new this.$THREE.OrthographicCamera(-e*r/2,e*r/2,256,-256,1,1e3),this.camera.position.set(0,0,128),this.camera.up.set(0,0,1),this.controls=new a.b(this.camera,this.renderer.domElement),this.controls.addEventListener("change",this.render),this.controls.target.set(64,64,128),this.controls.minZoom=.5,this.controls.maxZoom=4,this.controls.update(),this.volconfig={clim1:0,clim2:1,renderstyle:"iso",isothreshold:.15,colormap:"viridis"},this.gui=new i.a,this.gui.add(this.volconfig,"clim1",0,1,.01).onChange(this.updateUniforms),this.gui.add(this.volconfig,"clim2",0,1,.01).onChange(this.updateUniforms),this.gui.add(this.volconfig,"colormap",{gray:"gray",viridis:"viridis"}).onChange(this.updateUniforms),this.gui.add(this.volconfig,"renderstyle",{mip:"mip",iso:"iso"}).onChange(this.updateUniforms),this.gui.add(this.volconfig,"isothreshold",0,1,.01).onChange(this.updateUniforms),(new n.a).load("static/models/nrrd/stent.nrrd",function(e){var r=new t.$THREE.DataTexture3D(e.data,e.xLength,e.yLength,e.zLength);r.format=t.$THREE.RedFormat,r.type=t.$THREE.FloatType,r.minFilter=r.magFilter=t.$THREE.LinearFilter,r.unpackAlignment=1,t.cmtextures={viridis:(new t.$THREE.TextureLoader).load("static/textures/cm_viridis.png",t.render),gray:(new t.$THREE.TextureLoader).load("static/textures/cm_gray.png",t.render)};var i=o,a=t.$THREE.UniformsUtils.clone(i.uniforms);a.u_data.value=r,a.u_size.value.set(e.xLength,e.yLength,e.zLength),a.u_clim.value.set(t.volconfig.clim1,t.volconfig.clim2),a.u_renderstyle.value="mip"==t.volconfig.renderstyle?0:1,a.u_renderthreshold.value=t.volconfig.isothreshold,a.u_cmdata.value=t.cmtextures[t.volconfig.colormap],t.material=new t.$THREE.ShaderMaterial({uniforms:a,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:t.$THREE.BackSide});var n=new t.$THREE.BoxBufferGeometry(e.xLength,e.yLength,e.zLength);n.translate(e.xLength/2-.5,e.yLength/2-.5,e.zLength/2-.5);var s=new t.$THREE.Mesh(n,t.material);t.scene.add(s),t.render()}),window.addEventListener("resize",this.onWindowResize,!1)},updateUniforms:function(){this.material.uniforms.u_clim.value.set(this.volconfig.clim1,this.volconfig.clim2),this.material.uniforms.u_renderstyle.value="mip"==this.volconfig.renderstyle?0:1,this.material.uniforms.u_renderthreshold.value=this.volconfig.isothreshold,this.material.uniforms.u_cmdata.value=this.cmtextures[this.volconfig.colormap],this.render()},onWindowResize:function(){this.renderer.setSize(window.innerWidth-281,window.innerHeight);var t=(window.innerWidth-281)/window.innerHeight,e=this.camera.top-this.camera.bottom;this.camera.left=-e*t/2,this.camera.right=e*t/2,this.camera.updateProjectionMatrix(),this.render()},render:function(){this.renderer.render(this.scene,this.camera)}}},l={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"webgl2MaterialsTexture3d-container"},[e("div",{attrs:{id:"info"}},[e("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" - Float volume render test (mip / isosurface)\n    ")]),this._v(" "),e("div",{attrs:{id:"inset"}})])}]};var u=r("VU/8")(h,l,!1,function(t){r("3qDO")},"data-v-4985ab4e",null);e.default=u.exports}});
//# sourceMappingURL=30.3354fae4f2e0dd5844da.js.map