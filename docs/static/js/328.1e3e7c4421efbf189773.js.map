{"version":3,"sources":["webpack:///./src/components/jsm/shaders/WaterRefractionShader.js","webpack:///src/views/refraction/webglRefraction.vue","webpack:///./src/views/refraction/webglRefraction.vue?414b","webpack:///./src/views/refraction/webglRefraction.vue"],"names":["WaterRefractionShader","uniforms","color","value","time","tDiffuse","tDudv","textureMatrix","vertexShader","join","fragmentShader","webglRefraction","data","scene","camera","clock","renderer","refractor","mounted","this","init","methods","_this","$THREE","Scene","PerspectiveCamera","$webglInnerWidth","window","innerHeight","position","set","lookAt","Clock","geometry","TorusKnotBufferGeometry","material","MeshStandardMaterial","mesh","Mesh","add","refractorGeometry","PlaneBufferGeometry","Refractor","textureWidth","textureHeight","shader","dudvMap","TextureLoader","load","animate","wrapS","wrapT","RepeatWrapping","ambientLight","AmbientLight","pointLight","PointLight","WebGLRenderer","antialias","setSize","setClearColor","setPixelRatio","devicePixelRatio","document","getElementsByClassName","appendChild","domElement","controls","OrbitControls","minDistance","maxDistance","addEventListener","onResize","$onWindowResize","requestAnimationFrame","render","getDelta","refraction_webglRefraction","$createElement","_self","_c","_m","staticRenderFns","_h","staticClass","attrs","id","_v","href","target","rel","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/328.1e3e7c4421efbf189773.js","sourcesContent":["var WaterRefractionShader = {\r\n\r\n\tuniforms: {\r\n\r\n\t\t\"color\": {\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t\"time\": {\r\n\t\t\tvalue: 0\r\n\t\t},\r\n\r\n\t\t\"tDiffuse\": {\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t\"tDudv\": {\r\n\t\t\tvalue: null\r\n\t\t},\r\n\r\n\t\t\"textureMatrix\": {\r\n\t\t\tvalue: null\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tvertexShader: [\r\n\r\n\t\t\"uniform mat4 textureMatrix;\",\r\n\r\n\t\t\"varying vec2 vUv;\",\r\n\t\t\"varying vec4 vUvRefraction;\",\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\"\tvUv = uv;\",\r\n\r\n\t\t\"\tvUvRefraction = textureMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" ),\r\n\r\n\tfragmentShader: [\r\n\r\n\t\t\"uniform vec3 color;\",\r\n\t\t\"uniform float time;\",\r\n\t\t\"uniform sampler2D tDiffuse;\",\r\n\t\t\"uniform sampler2D tDudv;\",\r\n\r\n\t\t\"varying vec2 vUv;\",\r\n\t\t\"varying vec4 vUvRefraction;\",\r\n\r\n\t\t\"float blendOverlay( float base, float blend ) {\",\r\n\r\n\t\t\"\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\",\r\n\r\n\t\t\"}\",\r\n\r\n\t\t\"vec3 blendOverlay( vec3 base, vec3 blend ) {\",\r\n\r\n\t\t\"\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );\",\r\n\r\n\t\t\"}\",\r\n\r\n\t\t\"void main() {\",\r\n\r\n\t\t\" float waveStrength = 0.1;\",\r\n\t\t\" float waveSpeed = 0.03;\",\r\n\r\n\t\t// simple distortion (ripple) via dudv map (see https://www.youtube.com/watch?v=6B7IF6GOu7s)\r\n\r\n\t\t\"\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;\",\r\n\t\t\"\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );\",\r\n\t\t\"\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;\",\r\n\r\n\t\t// new uv coords\r\n\r\n\t\t\" vec4 uv = vec4( vUvRefraction );\",\r\n\t\t\" uv.xy += distortion;\",\r\n\r\n\t\t\"\tvec4 base = texture2DProj( tDiffuse, uv );\",\r\n\r\n\t\t\"\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\",\r\n\r\n\t\t\"}\"\r\n\r\n\t].join( \"\\n\" )\r\n};\r\n\r\nexport { WaterRefractionShader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/shaders/WaterRefractionShader.js","<template>\r\n    <div class=\"webglRefraction-container\">\r\n        <div id=\"container\"></div>\r\n\t\t<div id=\"info\">\r\n\t\t\t<a href=\"https://threejs.org\" target=\"_blank\" rel=\"noopener noreferrer\">three.js</a> - refraction\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { OrbitControls } from '@/components/jsm/controls/OrbitControls.js'\r\nimport { Refractor } from '@/components/jsm/objects/Refractor.js'\r\nimport { WaterRefractionShader } from '@/components/jsm/shaders/WaterRefractionShader.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            scene: null,\r\n            camera: null,\r\n            clock: null,\r\n            renderer: null,\r\n            refractor: null,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.init()\r\n    },\r\n    methods: {\r\n        init() {\r\n            // scene\r\n            this.scene = new this.$THREE.Scene()\r\n            // camera\r\n            this.camera = new this.$THREE.PerspectiveCamera(45, this.$webglInnerWidth / window.innerHeight, 0.1, 200)\r\n            this.camera.position.set(- 10, 0, 15)\r\n            this.camera.lookAt(this.scene.position)\r\n            // clock\r\n            this.clock = new this.$THREE.Clock()\r\n            // mesh\r\n            var geometry = new this.$THREE.TorusKnotBufferGeometry(3, 1, 256, 32)\r\n            var material = new this.$THREE.MeshStandardMaterial({ color: 0x6083c2 })\r\n            var mesh = new this.$THREE.Mesh(geometry, material)\r\n            this.scene.add(mesh)\r\n            // refractor\r\n            var refractorGeometry = new this.$THREE.PlaneBufferGeometry(10, 10)\r\n            this.refractor = new Refractor(refractorGeometry, {\r\n                color: 0x999999,\r\n                textureWidth: 1024,\r\n                textureHeight: 1024,\r\n                shader: WaterRefractionShader\r\n            })\r\n            this.refractor.position.set(0, 0, 5)\r\n            this.scene.add(this.refractor)\r\n            // load dudv map for distortion effect\r\n            var dudvMap = new this.$THREE.TextureLoader().load('static/textures/waterdudv.jpg', () => {\r\n                this.animate()\r\n            })\r\n            dudvMap.wrapS = dudvMap.wrapT = this.$THREE.RepeatWrapping\r\n            this.refractor.material.uniforms[ \"tDudv\" ].value = dudvMap\r\n            // light\r\n            var ambientLight = new this.$THREE.AmbientLight(0xcccccc, 0.4)\r\n            this.scene.add(ambientLight)\r\n            var pointLight = new this.$THREE.PointLight(0xffffff, 0.8)\r\n            this.camera.add(pointLight)\r\n            this.scene.add(this.camera)\r\n            // renderer\r\n            this.renderer = new this.$THREE.WebGLRenderer({ antialias: true })\r\n            this.renderer.setSize(this.$webglInnerWidth, window.innerHeight)\r\n            this.renderer.setClearColor(0x20252f)\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            document.getElementsByClassName('webglRefraction-container')[0].appendChild(this.renderer.domElement)\r\n            //\r\n            var controls = new OrbitControls(this.camera, this.renderer.domElement)\r\n            controls.minDistance = 10\r\n            controls.maxDistance = 100\r\n            //\r\n            window.addEventListener('resize', this.onResize, false)\r\n        },\r\n        onResize() {\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n        },\r\n        animate() {\r\n            requestAnimationFrame(this.animate)\r\n            this.render()\r\n        },\r\n        render() {\r\n            this.refractor.material.uniforms[ \"time\" ].value += this.clock.getDelta()\r\n            this.renderer.render(this.scene, this.camera)\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglRefraction-container {\r\n    width: 100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/refraction/webglRefraction.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglRefraction-container\"},[_c('div',{attrs:{\"id\":\"container\"}}),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"info\"}},[_c('a',{attrs:{\"href\":\"https://threejs.org\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}},[_vm._v(\"three.js\")]),_vm._v(\" - refraction\\n\\t\\t\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-12569806\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/refraction/webglRefraction.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-12569806\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglRefraction.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglRefraction.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglRefraction.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-12569806\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglRefraction.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-12569806\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/refraction/webglRefraction.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}