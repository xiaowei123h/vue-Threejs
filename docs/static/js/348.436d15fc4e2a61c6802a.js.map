{"version":3,"sources":["webpack:///./src/components/jsm/loaders/PRWMLoader.js","webpack:///src/views/loader/webglLoaderPrwm.vue","webpack:///./src/views/loader/webglLoaderPrwm.vue?85a3","webpack:///./src/views/loader/webglLoaderPrwm.vue"],"names":["PRWMLoader","bigEndianPlatform","isBigEndianPlatform","buffer","ArrayBuffer","uint8Array","Uint8Array","uint16Array","Uint16Array","InvertedEncodingTypes","Float32Array","Int8Array","Int16Array","Int32Array","Uint32Array","getMethods","Float64Array","copyFromBuffer","sourceArrayBuffer","viewType","position","length","fromBigEndian","result","bytesPerElement","BYTES_PER_ELEMENT","readView","DataView","getMethod","name","littleEndian","i","manager","Loader","call","this","prototype","Object","assign","create","constructor","load","url","onLoad","onProgress","onError","scope","loader","FileLoader","setPath","path","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","replace","arrayBuffer","parse","e","console","error","itemError","attribute","data","array","version","flags","indexedGeometry","indicesType","bigEndian","attributesNumber","valuesNumber","indicesNumber","Error","attributeName","char","attributeType","cardinality","arrayType","values","indices","pos","attributes","String","fromCharCode","Math","ceil","type","decodePrwm","attributesKey","keys","bufferGeometry","BufferGeometry","setAttribute","BufferAttribute","normalized","setIndex","webglLoaderPrwm","camera","scene","renderer","mouseX","mouseY","windowHalfX","windowHalfY","mounted","$webglInnerWidth","window","innerHeight","init","animate","methods","document","getElementById","innerHTML","PRWMLoader_PRWMLoader","container","createElement","getElementsByClassName","appendChild","$THREE","PerspectiveCamera","z","Scene","ambient","AmbientLight","add","directionalLight","DirectionalLight","set","material","MeshPhongMaterial","busy","mesh","xhr","lengthComputable","percentComplete","loaded","total","log","round","toFixed","timeEnd","that","loadGeometry","remove","geometry","dispose","time","Mesh","scale","index","count","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setSize","domElement","addEventListener","onDocumentMouseMove","querySelectorAll","forEach","anchor","preventDefault","href","onWindowResize","innerWidth","$onWindowResize","event","clientX","clientY","requestAnimationFrame","render","x","y","lookAt","loader_webglLoaderPrwm","$createElement","_self","_c","_m","staticRenderFns","_vm","_h","staticClass","attrs","id","_v","target","rel","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"4IAWIA,EAAe,WAElB,IAAIC,EAAoB,KAMxB,SAASC,IAER,GAA2B,OAAtBD,EAA6B,CAEjC,IAAIE,EAAS,IAAIC,YAAa,GAC7BC,EAAa,IAAIC,WAAYH,GAC7BI,EAAc,IAAIC,YAAaL,GAEhCE,EAAY,GAAM,IAClBA,EAAY,GAAM,IAClBJ,EAA2C,QAArBM,EAAa,GAIpC,OAAON,EAKR,IAAIQ,GACH,KACAC,aACA,KACAC,UACAC,WACA,KACAC,WACAP,WACAE,YACA,KACAM,aAIGC,GACHP,YAAa,YACbM,YAAa,YACbF,WAAY,WACZC,WAAY,WACZH,aAAc,aACdM,aAAc,cAIf,SAASC,EAAgBC,EAAmBC,EAAUC,EAAUC,EAAQC,GAEvE,IACCC,EADGC,EAAkBL,EAASM,kBAG/B,GAAKH,IAAkBpB,KAA6C,IAApBsB,EAE/CD,EAAS,IAAIJ,EAAUD,EAAmBE,EAAUC,OAE9C,CAEN,IAAIK,EAAW,IAAIC,SAAUT,EAAmBE,EAAUC,EAASG,GAClEI,EAAYb,EAAYI,EAASU,MACjCC,GAAiBR,EACjBS,EAAI,EAIL,IAFAR,EAAS,IAAIJ,EAAUE,GAEfU,EAAIV,EAAQU,IAEnBR,EAAQQ,GAAML,EAAUE,GAAaG,EAAIP,EAAiBM,GAM5D,OAAOP,EA6IR,SAASvB,EAAYgC,GAEpBC,SAAOC,KAAMC,KAAMH,GA+EpB,OA3EAhC,EAAWoC,UAAYC,OAAOC,OAAQD,OAAOE,OAAQN,SAAOG,YAE3DI,YAAaxC,EAEbyC,KAAM,SAAWC,EAAKC,EAAQC,EAAYC,GAEzC,IAAIC,EAAQX,KAERY,EAAS,IAAIC,aAAYF,EAAMd,SACnCe,EAAOE,QAASH,EAAMI,MACtBH,EAAOI,gBAAiB,eACxBJ,EAAOK,iBAAkBN,EAAMO,eAC/BN,EAAOO,mBAAoBR,EAAMS,iBAEjCb,EAAMA,EAAIc,QAAS,MAAOtD,IAAwB,KAAO,MAEzD6C,EAAON,KAAMC,EAAK,SAAWe,GAE5B,IAECd,EAAQG,EAAMY,MAAOD,IAEpB,MAAQE,GAEJd,EAEJA,EAASc,GAITC,QAAQC,MAAOF,GAIhBb,EAAMd,QAAQ8B,UAAWpB,KAIxBE,EAAYC,IAIhBa,MAAO,SAAWD,GAEjB,IAGCM,EACAhC,EAJGiC,EA1LN,SAAqB7D,GAEpB,IAAI8D,EAAQ,IAAI3D,WAAYH,GAC3B+D,EAAUD,EAAO,GACjBE,EAAQF,EAAO,GACfG,KAAuBD,GAAS,EAAI,GACpCE,EAAcF,GAAS,EAAI,EAC3BG,EAAsC,IAAxBH,GAAS,EAAI,GAC3BI,EAA2B,GAARJ,EACnBK,EAAe,EACfC,EAAgB,EAgBjB,GAdKH,GAEJE,GAAiBP,EAAO,IAAO,KAASA,EAAO,IAAO,GAAMA,EAAO,GACnEQ,GAAkBR,EAAO,IAAO,KAASA,EAAO,IAAO,GAAMA,EAAO,KAIpEO,EAAeP,EAAO,IAAQA,EAAO,IAAO,IAAQA,EAAO,IAAO,IAClEQ,EAAgBR,EAAO,IAAQA,EAAO,IAAO,IAAQA,EAAO,IAAO,KAMnD,IAAZC,EAEJ,MAAM,IAAIQ,MAAO,2CAEX,GAAiB,IAAZR,EAEX,MAAM,IAAIQ,MAAO,6CAA+CR,GAIjE,IAAOE,EAAkB,CAExB,GAAqB,IAAhBC,EAEJ,MAAM,IAAIK,MAAO,0EAEX,GAAuB,IAAlBD,EAEX,MAAM,IAAIC,MAAO,+EAQnB,IAGCC,EACAC,EACAC,EACAC,EAEAC,EACAC,EACAC,EACAlD,EAXGmD,EAAM,EAENC,KAWJ,IAAMpD,EAAI,EAAGA,EAAIwC,EAAkBxC,IAAO,CAIzC,IAFA4C,EAAgB,GAERO,EAAMjB,EAAM5C,SAEnBuD,EAAOX,EAAOiB,GACdA,IAEc,IAATN,IAMJD,GAAiBS,OAAOC,aAAcT,GAQxCC,GAFAV,EAAQF,EAAOiB,KAEU,EAAI,EAC7BJ,EAAsC,GAAtBX,GAAS,EAAI,GAI7Be,IAKAF,EAAS/D,EAAgBd,EAPzB4E,EAAYtE,EADW,GAAR0D,GAMfe,EAA6B,EAAvBI,KAAKC,KAAML,EAAM,GAE0BJ,EAAcN,EAAcF,GAE7EY,GAAOH,EAAUtD,kBAAoBqD,EAAcN,EAEnDW,EAAYR,IACXa,KAAMX,EACNC,YAAaA,EACbE,OAAQA,GAqBV,OAhBAE,EAA6B,EAAvBI,KAAKC,KAAML,EAAM,GAEvBD,EAAU,KAELb,IAEJa,EAAUhE,EACTd,EACgB,IAAhBkE,EAAoBvD,YAAcN,YAClC0E,EACAT,EACAH,KAMDJ,QAASA,EACTiB,WAAYA,EACZF,QAASA,GAyDEQ,CAAYhC,GACtBiC,EAAgBrD,OAAOsD,KAAM3B,EAAKmB,YAClCS,EAAiB,IAAIC,iBAItB,IAAM9D,EAAI,EAAGA,EAAI2D,EAAcrE,OAAQU,IAEtCgC,EAAYC,EAAKmB,WAAYO,EAAe3D,IAC5C6D,EAAeE,aAAcJ,EAAe3D,GAAK,IAAIgE,kBAAiBhC,EAAUiB,OAAQjB,EAAUe,YAAaf,EAAUiC,aAU1H,OANsB,OAAjBhC,EAAKiB,SAETW,EAAeK,SAAU,IAAIF,kBAAiB/B,EAAKiB,QAAS,IAItDW,KAMT5F,EAAWE,oBAAsB,WAEhC,OAAOA,KAIDF,EA5SW,GCQnBkG,GACAlC,KADA,WAEA,OACAmC,OAAA,KACAC,MAAA,KACAC,SAAA,KACAC,OAAA,EACAC,OAAA,EACAC,YAAA,KACAC,YAAA,OAGAC,QAZA,WAaAvE,KAAAqE,YAAArE,KAAAwE,iBAAA,EACAxE,KAAAsE,YAAAG,OAAAC,YAAA,EACA1E,KAAA2E,OACA3E,KAAA4E,WAEAC,SACAF,KADA,WAEAG,SAAAC,eAAA,cAAAC,UAAAC,EAAAlH,sBAAA,6BACA,IAAAmH,EAAAJ,SAAAK,cAAA,OACAL,SAAAM,uBAAA,gCAAAC,YAAAH,GACAlF,KAAAgE,OAAA,IAAAhE,KAAAsF,OAAAC,kBAAA,GAAAvF,KAAAwE,iBAAAC,OAAAC,YAAA,OACA1E,KAAAgE,OAAA/E,SAAAuG,EAAA,IAEAxF,KAAAiE,MAAA,IAAAjE,KAAAsF,OAAAG,MACA,IAAAC,EAAA,IAAA1F,KAAAsF,OAAAK,aAAA,SACA3F,KAAAiE,MAAA2B,IAAAF,GACA,IAAAG,EAAA,IAAA7F,KAAAsF,OAAAQ,iBAAA,UACAD,EAAA5G,SAAA8G,IAAA,OACA/F,KAAAiE,MAAA2B,IAAAC,GAEA,IAAAjF,EAAA,IAAAqE,EACAe,EAAA,IAAAhG,KAAAsF,OAAAW,sBACAC,GAAA,EACAC,EAAA,KACA1F,EAAA,SAAA2F,GACA,GAAAA,EAAAC,iBAAA,CACA,IAAAC,EAAAF,EAAAG,OAAAH,EAAAI,MAAA,IACA/E,QAAAgF,IAAAtD,KAAAuD,MAAAJ,EAAA,mBACAF,EAAAG,SAAAH,EAAAI,QACA/E,QAAAgF,IAAA,eAAAL,EAAAI,MAAA,MAAAG,QAAA,SACAlF,QAAAmF,QAAA,eAIAlG,EAAA,WACAwF,GAAA,GAEAW,EAAA7G,KACA,SAAA8G,EAAAvG,GACA2F,IACAA,GAAA,EACA,OAAAC,IACAU,EAAA5C,MAAA8C,OAAAZ,GACAA,EAAAa,SAAAC,WAEAxF,QAAAgF,IAAA,aAAAlG,GACAkB,QAAAyF,KAAA,YACAtG,EAAAN,KAAAC,EAAA,SAAAyG,IACAb,EAAA,IAAAU,EAAAvB,OAAA6B,KAAAH,EAAAhB,IACAoB,MAAArB,IAAA,UACAc,EAAA5C,MAAA2B,IAAAO,GACA1E,QAAAgF,IAAAO,EAAAK,MAAA,2CACA5F,QAAAgF,IAAA,kBAAAO,EAAAhE,WAAA/D,SAAAqI,OACA7F,QAAAgF,IAAA,mBAAAO,EAAAK,MAAAL,EAAAK,MAAAC,MAAA,EAAAN,EAAAhE,WAAA/D,SAAAqI,MAAA,IACApB,GAAA,GACAzF,EAAAC,IAGAV,KAAAkE,SAAA,IAAAlE,KAAAsF,OAAAiC,eAAAC,WAAA,IACAxH,KAAAkE,SAAAuD,cAAAhD,OAAAiD,kBACA1H,KAAAkE,SAAAyD,QAAA3H,KAAAwE,iBAAAC,OAAAC,aACAQ,EAAAG,YAAArF,KAAAkE,SAAA0D,YACA9C,SAAA+C,iBAAA,YAAA7H,KAAA8H,qBAAA,GAEAhD,SAAAiD,iBAAA,WAAAC,QAAA,SAAAC,GACAA,EAAAJ,iBAAA,iBAAArG,GACAA,EAAA0G,iBACApB,EAAAmB,EAAAE,UAKArB,EAAA,4CACArC,OAAAoD,iBAAA,SAAA7H,KAAAoI,gBAAA,IAEAA,eAtEA,WAuEApI,KAAAqE,YAAAI,OAAA4D,WAAA,MACArI,KAAAsE,YAAAG,OAAAC,YAAA,EACA1E,KAAAsI,gBAAAtI,KAAAgE,OAAAhE,KAAAkE,WAEA4D,oBA3EA,SA2EAS,GACAvI,KAAAmE,QAAAoE,EAAAC,QAAAxI,KAAAqE,aAAA,EACArE,KAAAoE,QAAAmE,EAAAE,QAAAzI,KAAAsE,aAAA,GAEAM,QA/EA,WAgFA8D,sBAAA1I,KAAA4E,SACA5E,KAAA2I,UAEAA,OAnFA,WAoFA3I,KAAAgE,OAAA/E,SAAA2J,GAAA,KAAA5I,KAAAmE,OAAAnE,KAAAgE,OAAA/E,SAAA2J,GACA5I,KAAAgE,OAAA/E,SAAA4J,GAAA,MAAA7I,KAAAoE,OAAApE,KAAAgE,OAAA/E,SAAA4J,GACA7I,KAAAgE,OAAA8E,OAAA9I,KAAAiE,MAAAhF,UACAe,KAAAkE,SAAAyE,OAAA3I,KAAAiE,MAAAjE,KAAAgE,WCzHe+E,GADEJ,OAFjB,WAA0B3I,KAAagJ,eAAbhJ,KAAuCiJ,MAAAC,GAAwB,OAA/DlJ,KAA+DmJ,GAAA,IAExEC,iBADjB,WAAoC,IAAAC,EAAArJ,KAAasJ,EAAAD,EAAAL,eAA0BE,EAAAG,EAAAJ,MAAAC,IAAAI,EAAwB,OAAAJ,EAAA,OAAiBK,YAAA,8BAAwCL,EAAA,OAAYM,OAAOC,GAAA,UAAaP,EAAA,UAAAG,EAAAK,GAAA,YAAAL,EAAAK,GAAA,aAAAR,EAAA,KAA8DK,YAAA,QAAAC,OAA2BrB,KAAA,iDAAsDkB,EAAAK,GAAA,uBAAAL,EAAAK,GAAA,aAAAR,EAAA,KAA4DK,YAAA,QAAAC,OAA2BrB,KAAA,8CAAmDkB,EAAAK,GAAA,oBAAAL,EAAAK,GAAA,aAAAR,EAAA,KAAyDK,YAAA,QAAAC,OAA2BrB,KAAA,+CAAoDkB,EAAAK,GAAA,qBAAAL,EAAAK,GAAA,KAAAR,EAAA,OAAoDK,YAAA,UAAoBF,EAAAK,GAAA,mMAAAR,EAAA,UAAAG,EAAAK,GAAA,OAAAL,EAAAK,GAAA,gCAAAR,EAAA,UAAAG,EAAAK,GAAA,QAAAL,EAAAK,GAAA,QAAAR,EAAA,UAAAG,EAAAK,GAAA,QAAAL,EAAAK,GAAA,0FAAAR,EAAA,KAA8bM,OAAOrB,KAAA,qCAAAwB,OAAA,SAAAC,IAAA,yBAA2FP,EAAAK,GAAA,wCAAAR,EAAA,MAAAA,EAAA,MAAAG,EAAAK,GAAA,0CAAAR,EAAA,UAAiIM,OAAOC,GAAA,gBAAmBJ,EAAAK,GAAA,KAAAR,EAAA,MAAAG,EAAAK,GAAA,0DCEh2C,IAcAG,EAdyBC,EAAQ,OAcjCC,CACEhG,EACAgF,GATF,EAVA,SAAAiB,GACEF,EAAQ,SAaV,kBAEA,MAUeG,EAAA,QAAAJ,EAAiB","file":"static/js/348.436d15fc4e2a61c6802a.js","sourcesContent":["import {\r\n\tBufferAttribute,\r\n\tBufferGeometry,\r\n\tFileLoader,\r\n\tLoader\r\n} from \"@/components/build/three.module.js\";\r\n\r\n/**\r\n * See https://github.com/kchapelier/PRWM for more informations about this file format\r\n */\r\n\r\nvar PRWMLoader = ( function () {\r\n\r\n\tvar bigEndianPlatform = null;\r\n\r\n\t/**\r\n\t * Check if the endianness of the platform is big-endian (most significant bit first)\r\n\t * @returns {boolean} True if big-endian, false if little-endian\r\n\t */\r\n\tfunction isBigEndianPlatform() {\r\n\r\n\t\tif ( bigEndianPlatform === null ) {\r\n\r\n\t\t\tvar buffer = new ArrayBuffer( 2 ),\r\n\t\t\t\tuint8Array = new Uint8Array( buffer ),\r\n\t\t\t\tuint16Array = new Uint16Array( buffer );\r\n\r\n\t\t\tuint8Array[ 0 ] = 0xAA; // set first byte\r\n\t\t\tuint8Array[ 1 ] = 0xBB; // set second byte\r\n\t\t\tbigEndianPlatform = ( uint16Array[ 0 ] === 0xAABB );\r\n\r\n\t\t}\r\n\r\n\t\treturn bigEndianPlatform;\r\n\r\n\t}\r\n\r\n\t// match the values defined in the spec to the TypedArray types\r\n\tvar InvertedEncodingTypes = [\r\n\t\tnull,\r\n\t\tFloat32Array,\r\n\t\tnull,\r\n\t\tInt8Array,\r\n\t\tInt16Array,\r\n\t\tnull,\r\n\t\tInt32Array,\r\n\t\tUint8Array,\r\n\t\tUint16Array,\r\n\t\tnull,\r\n\t\tUint32Array\r\n\t];\r\n\r\n\t// define the method to use on a DataView, corresponding the TypedArray type\r\n\tvar getMethods = {\r\n\t\tUint16Array: 'getUint16',\r\n\t\tUint32Array: 'getUint32',\r\n\t\tInt16Array: 'getInt16',\r\n\t\tInt32Array: 'getInt32',\r\n\t\tFloat32Array: 'getFloat32',\r\n\t\tFloat64Array: 'getFloat64'\r\n\t};\r\n\r\n\r\n\tfunction copyFromBuffer( sourceArrayBuffer, viewType, position, length, fromBigEndian ) {\r\n\r\n\t\tvar bytesPerElement = viewType.BYTES_PER_ELEMENT,\r\n\t\t\tresult;\r\n\r\n\t\tif ( fromBigEndian === isBigEndianPlatform() || bytesPerElement === 1 ) {\r\n\r\n\t\t\tresult = new viewType( sourceArrayBuffer, position, length );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar readView = new DataView( sourceArrayBuffer, position, length * bytesPerElement ),\r\n\t\t\t\tgetMethod = getMethods[ viewType.name ],\r\n\t\t\t\tlittleEndian = ! fromBigEndian,\r\n\t\t\t\ti = 0;\r\n\r\n\t\t\tresult = new viewType( length );\r\n\r\n\t\t\tfor ( ; i < length; i ++ ) {\r\n\r\n\t\t\t\tresult[ i ] = readView[ getMethod ]( i * bytesPerElement, littleEndian );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\r\n\tfunction decodePrwm( buffer ) {\r\n\r\n\t\tvar array = new Uint8Array( buffer ),\r\n\t\t\tversion = array[ 0 ],\r\n\t\t\tflags = array[ 1 ],\r\n\t\t\tindexedGeometry = !! ( flags >> 7 & 0x01 ),\r\n\t\t\tindicesType = flags >> 6 & 0x01,\r\n\t\t\tbigEndian = ( flags >> 5 & 0x01 ) === 1,\r\n\t\t\tattributesNumber = flags & 0x1F,\r\n\t\t\tvaluesNumber = 0,\r\n\t\t\tindicesNumber = 0;\r\n\r\n\t\tif ( bigEndian ) {\r\n\r\n\t\t\tvaluesNumber = ( array[ 2 ] << 16 ) + ( array[ 3 ] << 8 ) + array[ 4 ];\r\n\t\t\tindicesNumber = ( array[ 5 ] << 16 ) + ( array[ 6 ] << 8 ) + array[ 7 ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvaluesNumber = array[ 2 ] + ( array[ 3 ] << 8 ) + ( array[ 4 ] << 16 );\r\n\t\t\tindicesNumber = array[ 5 ] + ( array[ 6 ] << 8 ) + ( array[ 7 ] << 16 );\r\n\r\n\t\t}\r\n\r\n\t\t/** PRELIMINARY CHECKS **/\r\n\r\n\t\tif ( version === 0 ) {\r\n\r\n\t\t\tthrow new Error( 'PRWM decoder: Invalid format version: 0' );\r\n\r\n\t\t} else if ( version !== 1 ) {\r\n\r\n\t\t\tthrow new Error( 'PRWM decoder: Unsupported format version: ' + version );\r\n\r\n\t\t}\r\n\r\n\t\tif ( ! indexedGeometry ) {\r\n\r\n\t\t\tif ( indicesType !== 0 ) {\r\n\r\n\t\t\t\tthrow new Error( 'PRWM decoder: Indices type must be set to 0 for non-indexed geometries' );\r\n\r\n\t\t\t} else if ( indicesNumber !== 0 ) {\r\n\r\n\t\t\t\tthrow new Error( 'PRWM decoder: Number of indices must be set to 0 for non-indexed geometries' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/** PARSING **/\r\n\r\n\t\tvar pos = 8;\r\n\r\n\t\tvar attributes = {},\r\n\t\t\tattributeName,\r\n\t\t\tchar,\r\n\t\t\tattributeType,\r\n\t\t\tcardinality,\r\n\t\t\tencodingType,\r\n\t\t\tarrayType,\r\n\t\t\tvalues,\r\n\t\t\tindices,\r\n\t\t\ti;\r\n\r\n\t\tfor ( i = 0; i < attributesNumber; i ++ ) {\r\n\r\n\t\t\tattributeName = '';\r\n\r\n\t\t\twhile ( pos < array.length ) {\r\n\r\n\t\t\t\tchar = array[ pos ];\r\n\t\t\t\tpos ++;\r\n\r\n\t\t\t\tif ( char === 0 ) {\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tattributeName += String.fromCharCode( char );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tflags = array[ pos ];\r\n\r\n\t\t\tattributeType = flags >> 7 & 0x01;\r\n\t\t\tcardinality = ( flags >> 4 & 0x03 ) + 1;\r\n\t\t\tencodingType = flags & 0x0F;\r\n\t\t\tarrayType = InvertedEncodingTypes[ encodingType ];\r\n\r\n\t\t\tpos ++;\r\n\r\n\t\t\t// padding to next multiple of 4\r\n\t\t\tpos = Math.ceil( pos / 4 ) * 4;\r\n\r\n\t\t\tvalues = copyFromBuffer( buffer, arrayType, pos, cardinality * valuesNumber, bigEndian );\r\n\r\n\t\t\tpos += arrayType.BYTES_PER_ELEMENT * cardinality * valuesNumber;\r\n\r\n\t\t\tattributes[ attributeName ] = {\r\n\t\t\t\ttype: attributeType,\r\n\t\t\t\tcardinality: cardinality,\r\n\t\t\t\tvalues: values\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tpos = Math.ceil( pos / 4 ) * 4;\r\n\r\n\t\tindices = null;\r\n\r\n\t\tif ( indexedGeometry ) {\r\n\r\n\t\t\tindices = copyFromBuffer(\r\n\t\t\t\tbuffer,\r\n\t\t\t\tindicesType === 1 ? Uint32Array : Uint16Array,\r\n\t\t\t\tpos,\r\n\t\t\t\tindicesNumber,\r\n\t\t\t\tbigEndian\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tversion: version,\r\n\t\t\tattributes: attributes,\r\n\t\t\tindices: indices\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t// Define the public interface\r\n\r\n\tfunction PRWMLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tPRWMLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: PRWMLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.setPath( scope.path );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\t\tloader.setRequestHeader( scope.requestHeader );\r\n\t\t\tloader.setWithCredentials( scope.withCredentials );\r\n\r\n\t\t\turl = url.replace( /\\*/g, isBigEndianPlatform() ? 'be' : 'le' );\r\n\r\n\t\t\tloader.load( url, function ( arrayBuffer ) {\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tonLoad( scope.parse( arrayBuffer ) );\r\n\r\n\t\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\t\tif ( onError ) {\r\n\r\n\t\t\t\t\t\tonError( e );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.error( e );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( arrayBuffer ) {\r\n\r\n\t\t\tvar data = decodePrwm( arrayBuffer ),\r\n\t\t\t\tattributesKey = Object.keys( data.attributes ),\r\n\t\t\t\tbufferGeometry = new BufferGeometry(),\r\n\t\t\t\tattribute,\r\n\t\t\t\ti;\r\n\r\n\t\t\tfor ( i = 0; i < attributesKey.length; i ++ ) {\r\n\r\n\t\t\t\tattribute = data.attributes[ attributesKey[ i ] ];\r\n\t\t\t\tbufferGeometry.setAttribute( attributesKey[ i ], new BufferAttribute( attribute.values, attribute.cardinality, attribute.normalized ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.indices !== null ) {\r\n\r\n\t\t\t\tbufferGeometry.setIndex( new BufferAttribute( data.indices, 1 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn bufferGeometry;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tPRWMLoader.isBigEndianPlatform = function () {\r\n\r\n\t\treturn isBigEndianPlatform();\r\n\r\n\t};\r\n\r\n\treturn PRWMLoader;\r\n\r\n} )();\r\n\r\nexport { PRWMLoader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/loaders/PRWMLoader.js","<template>\r\n    <div class=\"webglLoaderPrwm-container\">\r\n        <div id=\"info\">\r\n\t\t\t<strong>Models</strong>:\r\n\t\t\t<a class=\"model\" href=\"static/models/prwm/faceted-nefertiti.*.prwm\">Faceted Nefertiti</a>,\r\n\t\t\t<a class=\"model\" href=\"static/models/prwm/smooth-suzanne.*.prwm\">Smooth Suzanne</a>,\r\n\t\t\t<a class=\"model\" href=\"static/models/prwm/vive-controller.*.prwm\">Vive Controller</a>\r\n\t\t\t<div class=\"notes\">\r\n\t\t\t\tThe parsing of PRWM file is especially fast when the endianness of the file is the same as the endianness of the client platform.\r\n\t\t\t\tThe loader will automatically replace the <strong>*</strong> in the model url by either <strong>le</strong> or <strong>be</strong> depending on the client platform's endianness to download the most appropriate file. <a href=\"https://github.com/kchapelier/PRWM\" target=\"_blank\" rel=\"noopener noreferrer\">Specifications and implementations</a><br><br>\r\n\t\t\t\tThis platform endianness is <strong id=\"endianness\"></strong>.<br>\r\n\t\t\t\tSee your console for stats.\r\n\t\t\t</div>\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { PRWMLoader } from '@/components/jsm/loaders/PRWMLoader.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            camera: null,\r\n            scene: null,\r\n            renderer: null,\r\n            mouseX: 0,\r\n            mouseY: 0,\r\n\t\t\twindowHalfX: null,\r\n\t\t\twindowHalfY: null,\r\n        }\r\n    },\r\n    mounted() {\r\n        this.windowHalfX = this.$webglInnerWidth / 2\r\n        this.windowHalfY = window.innerHeight / 2\r\n        this.init()\r\n        this.animate()\r\n    },\r\n    methods: {\r\n        init() {\r\n            document.getElementById('endianness').innerHTML = PRWMLoader.isBigEndianPlatform() ? 'big-endian' : 'little-endian'\r\n            var container = document.createElement('div')\r\n            document.getElementsByClassName('webglLoaderPrwm-container')[0].appendChild(container)\r\n            this.camera = new this.$THREE.PerspectiveCamera(45, this.$webglInnerWidth / window.innerHeight, 1, 2000)\r\n            this.camera.position.z = 250\r\n            // scene\r\n            this.scene = new this.$THREE.Scene()\r\n            var ambient = new this.$THREE.AmbientLight(0x101030)\r\n            this.scene.add(ambient)\r\n            var directionalLight = new this.$THREE.DirectionalLight(0xffeedd)\r\n            directionalLight.position.set(0, 0, 1)\r\n            this.scene.add(directionalLight)\r\n            // model\r\n            var loader = new PRWMLoader()\r\n            var material = new this.$THREE.MeshPhongMaterial({})\r\n            var busy = false\r\n            var mesh = null\r\n            var onProgress = function (xhr) {\r\n                if (xhr.lengthComputable) {\r\n                    var percentComplete = xhr.loaded / xhr.total * 100\r\n                    console.log(Math.round(percentComplete, 2) + '% downloaded')\r\n                    if (xhr.loaded === xhr.total) {\r\n                        console.log('File size: ' + (xhr.total / 1024).toFixed(2) + 'kB')\r\n                        console.timeEnd('Download')\r\n                    }\r\n                }\r\n            }\r\n            var onError = function () {\r\n                busy = false\r\n            }\r\n            var that = this\r\n            function loadGeometry(url) {\r\n                if (busy) return\r\n                busy = true\r\n                if (mesh !== null) {\r\n                    that.scene.remove(mesh)\r\n                    mesh.geometry.dispose()\r\n                }\r\n                console.log('-- Loading', url)\r\n                console.time('Download')\r\n                loader.load(url, function (geometry) {\r\n                    mesh = new that.$THREE.Mesh(geometry, material)\r\n                    mesh.scale.set(50, 50, 50)\r\n                    that.scene.add(mesh)\r\n                    console.log(geometry.index ? 'indexed geometry' : 'non-indexed geometry')\r\n                    console.log('# of vertices: ' + geometry.attributes.position.count)\r\n                    console.log('# of polygons: ' + (geometry.index ? geometry.index.count / 3 : geometry.attributes.position.count / 3))\r\n                    busy = false\r\n                }, onProgress, onError)\r\n            }\r\n            //\r\n            this.renderer = new this.$THREE.WebGLRenderer({ antialias: true })\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            this.renderer.setSize(this.$webglInnerWidth, window.innerHeight)\r\n            container.appendChild(this.renderer.domElement)\r\n            document.addEventListener('mousemove', this.onDocumentMouseMove, false)\r\n            //\r\n            document.querySelectorAll('a.model').forEach(function (anchor) {\r\n                anchor.addEventListener('click', function (e) {\r\n                    e.preventDefault()\r\n                    loadGeometry(anchor.href)\r\n                })\r\n            })\r\n            //\r\n            // * is automatically replaced by 'le' or 'be' depending on the client platform's endianness\r\n            loadGeometry('static/models/prwm/smooth-suzanne.*.prwm')\r\n            window.addEventListener('resize', this.onWindowResize, false)\r\n        },\r\n        onWindowResize() {\r\n            this.windowHalfX = window.innerWidth - 281 / 2\r\n            this.windowHalfY = window.innerHeight / 2\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n        },\r\n        onDocumentMouseMove(event) {\r\n            this.mouseX = (event.clientX - this.windowHalfX) / 2\r\n            this.mouseY = (event.clientY - this.windowHalfY) / 2\r\n        },\r\n        animate() {\r\n            requestAnimationFrame(this.animate)\r\n            this.render()\r\n        },\r\n        render() {\r\n            this.camera.position.x += (this.mouseX - this.camera.position.x) * .05\r\n            this.camera.position.y += (- this.mouseY - this.camera.position.y) * .05\r\n            this.camera.lookAt(this.scene.position)\r\n            this.renderer.render(this.scene, this.camera)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglLoaderPrwm-container {\r\n    width: 100%;\r\n}\r\n.notes {\r\n    position: fixed;\r\n    text-align: left;\r\n    bottom: 10px;\r\n    font-family: \"Arial\", \"Helvetica Neue\", \"Helvetica\", sans-serif;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/loader/webglLoaderPrwm.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglLoaderPrwm-container\"},[_c('div',{attrs:{\"id\":\"info\"}},[_c('strong',[_vm._v(\"Models\")]),_vm._v(\":\\n\\t\\t\\t\"),_c('a',{staticClass:\"model\",attrs:{\"href\":\"static/models/prwm/faceted-nefertiti.*.prwm\"}},[_vm._v(\"Faceted Nefertiti\")]),_vm._v(\",\\n\\t\\t\\t\"),_c('a',{staticClass:\"model\",attrs:{\"href\":\"static/models/prwm/smooth-suzanne.*.prwm\"}},[_vm._v(\"Smooth Suzanne\")]),_vm._v(\",\\n\\t\\t\\t\"),_c('a',{staticClass:\"model\",attrs:{\"href\":\"static/models/prwm/vive-controller.*.prwm\"}},[_vm._v(\"Vive Controller\")]),_vm._v(\" \"),_c('div',{staticClass:\"notes\"},[_vm._v(\"\\n\\t\\t\\t\\tThe parsing of PRWM file is especially fast when the endianness of the file is the same as the endianness of the client platform.\\n\\t\\t\\t\\tThe loader will automatically replace the \"),_c('strong',[_vm._v(\"*\")]),_vm._v(\" in the model url by either \"),_c('strong',[_vm._v(\"le\")]),_vm._v(\" or \"),_c('strong',[_vm._v(\"be\")]),_vm._v(\" depending on the client platform's endianness to download the most appropriate file. \"),_c('a',{attrs:{\"href\":\"https://github.com/kchapelier/PRWM\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}},[_vm._v(\"Specifications and implementations\")]),_c('br'),_c('br'),_vm._v(\"\\n\\t\\t\\t\\tThis platform endianness is \"),_c('strong',{attrs:{\"id\":\"endianness\"}}),_vm._v(\".\"),_c('br'),_vm._v(\"\\n\\t\\t\\t\\tSee your console for stats.\\n\\t\\t\\t\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-078e140a\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/loader/webglLoaderPrwm.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-078e140a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglLoaderPrwm.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderPrwm.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoaderPrwm.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-078e140a\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglLoaderPrwm.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-078e140a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/loader/webglLoaderPrwm.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}