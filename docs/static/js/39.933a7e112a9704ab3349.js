webpackJsonp([39],{"4CE/":function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return h});var r=n("6+nK"),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=3,a=1024,c=4;function l(e,t,n,r,i,s){var c=e.image.data,l=o*a*s;c[t*o+l+0]=n,c[t*o+l+1]=r,c[t*o+l+2]=i}var f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s(this,e);var i=t.clone(),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=new Float32Array(a*c*e*o),n=new r.DataTexture(t,a,c*e,r.RGBFormat,r.FloatType);return n.wrapS=r.RepeatWrapping,n.wrapY=r.RepeatWrapping,n.magFilter=r.NearestFilter,n.needsUpdate=!0,n}(n),f={spineTexture:{value:l},pathOffset:{type:"f",value:0},pathSegment:{type:"f",value:1},spineOffset:{type:"f",value:161},spineLength:{type:"f",value:400},flow:{type:"i",value:1}};i.traverse(function(e){(e instanceof r.Mesh||e instanceof r.InstancedMesh)&&(e.material=e.material.clone(),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.__ok||(e.__ok=!0,e.onBeforeCompile=function(e){if(!e.__modified){e.__modified=!0,Object.assign(e.uniforms,t);var r=("\n\t\t#define USE_ENVMAP\n\t\tuniform sampler2D spineTexture;\n\t\tuniform float pathOffset;\n\t\tuniform float pathSegment;\n\t\tuniform float spineOffset;\n\t\tuniform float spineLength;\n\t\tuniform int flow;\n\n\t\tfloat textureLayers = "+c*n+".;\n\t\tfloat textureStacks = "+c/4+".;\n\n\t\t"+e.vertexShader+"\n\t\t").replace("#include <defaultnormal_vertex>","\n\t\tvec4 worldPos = modelMatrix * vec4(position, 1.);\n\n\t\tbool bend = flow > 0;\n\t\tfloat xWeight = bend ? 0. : 1.;\n\n\t\t#ifdef USE_INSTANCING\n\t\tfloat pathOffsetFromInstanceMatrix = instanceMatrix[3][2];\n\t\tfloat spineLengthFromInstanceMatrix = instanceMatrix[3][0];\n\t\tfloat spinePortion = bend ? (worldPos.x + spineOffset) / spineLengthFromInstanceMatrix : 0.;\n\t\tfloat mt = (spinePortion * pathSegment + pathOffset + pathOffsetFromInstanceMatrix)*textureStacks;\n\t\t#else\n\t\tfloat spinePortion = bend ? (worldPos.x + spineOffset) / spineLength : 0.;\n\t\tfloat mt = (spinePortion * pathSegment + pathOffset)*textureStacks;\n\t\t#endif\n\n\t\tmt = mod(mt, textureStacks);\n\t\tfloat rowOffset = floor(mt);\n\n\t\t#ifdef USE_INSTANCING\n\t\trowOffset += instanceMatrix[3][1] * "+c+".;\n\t\t#endif\n\n\t\tvec3 spinePos = texture(spineTexture, vec2(mt, (0. + rowOffset + 0.5) / textureLayers)).xyz;\n\t\tvec3 a =        texture(spineTexture, vec2(mt, (1. + rowOffset + 0.5) / textureLayers)).xyz;\n\t\tvec3 b =        texture(spineTexture, vec2(mt, (2. + rowOffset + 0.5) / textureLayers)).xyz;\n\t\tvec3 c =        texture(spineTexture, vec2(mt, (3. + rowOffset + 0.5) / textureLayers)).xyz;\n\t\tmat3 basis = mat3(a, b, c);\n\n\t\tvec3 transformed = basis\n\t\t\t* vec3(worldPos.x * xWeight, worldPos.y * 1., worldPos.z * 1.)\n\t\t\t+ spinePos;\n\n\t\tvec3 transformedNormal = normalMatrix * (basis * objectNormal);\n\t\t").replace("#include <begin_vertex>","").replace("#include <project_vertex>","\n\t\t\tvec4 mvPosition = viewMatrix * vec4( transformed, 1.0 );\n\t\t\t// vec4 mvPosition = viewMatrix * worldPos;\n\t\t\tgl_Position = projectionMatrix * mvPosition;\n\t\t\t");e.vertexShader=r}})}(e.material,f,n))}),this.curveArray=new Array(n),this.curveLengthArray=new Array(n),this.object3D=i,this.splineTexure=l,this.uniforms=f}return i(e,[{key:"updateCurve",value:function(e,t){if(e>=this.curveArray.length)throw Error("Index out of range for Flow");var n=t.getLength();this.uniforms.spineLength.value=n,this.curveLengthArray[e]=n,this.curveArray[e]=t,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.floor(a*(c/4));t.arcLengthDivisions=r/2,t.updateArcLengths();for(var i=t.getSpacedPoints(r),s=t.computeFrenetFrames(r,!0),o=0;o<r;o++){var f=Math.floor(o/a),u=o%a,h=i[o];l(e,u,h.x,h.y,h.z,0+f+c*n),l(e,u,(h=s.tangents[o]).x,h.y,h.z,1+f+c*n),l(e,u,(h=s.normals[o]).x,h.y,h.z,2+f+c*n),l(e,u,(h=s.binormals[o]).x,h.y,h.z,3+f+c*n)}e.needsUpdate=!0}(this.splineTexure,t,e)}},{key:"moveAlongCurve",value:function(e){this.uniforms.pathOffset.value+=e}}]),e}(),u=new r.Matrix4,h=function(e){function t(e,n,i,o){s(this,t);var a=new r.InstancedMesh(i,o,e);a.instanceMatrix.setUsage(r.DynamicDrawUsage);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a,n));return c.offsets=new Array(e).fill(0),c.whichCurve=new Array(e).fill(0),c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,f),i(t,[{key:"writeChanges",value:function(e){u.makeTranslation(this.curveLengthArray[this.whichCurve[e]],this.whichCurve[e],this.offsets[e]),this.object3D.setMatrixAt(e,u),this.object3D.instanceMatrix.needsUpdate=!0}},{key:"moveIndividualAlongCurve",value:function(e,t){this.offsets[e]+=t,this.writeChanges(e)}},{key:"setCurve",value:function(e,t){if(isNaN(t))throw Error("curve index being set is Not a Number (NaN)");this.whichCurve[e]=t,this.writeChanges(e)}}]),t}()},J9qH:function(e,t){},LX73:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Iu6k"),i=n("4CE/"),s={data:function(){return{ACTION_SELECT:1,ACTION_NONE:0,curveHandles:[],mouse:null,stats:null,scene:null,camera:null,renderer:null,rayCaster:null,control:null,flow:null,action:null}},mounted:function(){this.mouse=new this.$THREE.Vector2,this.init(),this.animate()},methods:{init:function(){var e=this;this.scene=new this.$THREE.Scene,this.camera=new this.$THREE.PerspectiveCamera(40,this.$webglInnerWidth/window.innerHeight,1,1e3),this.camera.position.set(2,2,4),this.camera.lookAt(this.scene.position);var t=new this.$THREE.BoxBufferGeometry(.1,.1,.1),n=new this.$THREE.MeshBasicMaterial(10092441),s=[[{x:1,y:-.5,z:-1},{x:1,y:-.5,z:1},{x:-1,y:-.5,z:1},{x:-1,y:-.5,z:-1}],[{x:-1,y:.5,z:-1},{x:-1,y:.5,z:1},{x:1,y:.5,z:1},{x:1,y:.5,z:-1}]].map(function(r){var i=r.map(function(r){var i=new e.$THREE.Mesh(t,n);return i.position.copy(r),e.curveHandles.push(i),e.scene.add(i),i.position}),s=new e.$THREE.CatmullRomCurve3(i);s.curveType="centripetal",s.closed=!0;var o=s.getPoints(50),a=new e.$THREE.LineLoop((new e.$THREE.BufferGeometry).setFromPoints(o),new e.$THREE.LineBasicMaterial({color:65280}));return e.scene.add(a),{curve:s,line:a}}),o=new this.$THREE.DirectionalLight(16755251);o.position.set(-10,10,10),o.intensity=1,this.scene.add(o);var a=new this.$THREE.AmbientLight(14707);a.intensity=1,this.scene.add(a),(new this.$THREE.FontLoader).load("static/fonts/helvetiker_regular.typeface.json",function(t){var n=new e.$THREE.TextBufferGeometry("Hello three.js!",{font:t,size:.2,height:.05,curveSegments:12,bevelEnabled:!0,bevelThickness:.02,bevelSize:.01,bevelOffset:0,bevelSegments:5});n.rotateX(Math.PI);var r=new e.$THREE.MeshStandardMaterial({color:10092543});e.flow=new i.b(8,s.length,n,r),s.forEach(function(t,n){var r=t.curve;e.flow.updateCurve(n,r),e.scene.add(e.flow.object3D)});for(var o=0;o<8;o++){var a=o%s.length;e.flow.setCurve(o,a),e.flow.moveIndividualAlongCurve(o,1*o/8),e.flow.object3D.setColorAt(o,new e.$THREE.Color(16777215*Math.random()))}}),this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),document.getElementsByClassName("webglModifierCurveInstanced-container")[0].appendChild(this.renderer.domElement),this.renderer.domElement.addEventListener("pointerdown",this.onPointerDown,!1),this.rayCaster=new this.$THREE.Raycaster,this.control=new r.a(this.camera,this.renderer.domElement),this.control.addEventListener("dragging-changed",function(t){t.value||s.forEach(function(t,n){var r=t.curve,i=t.line,s=r.getPoints(50);i.geometry.setFromPoints(s),e.flow.updateCurve(n,r)})}),this.stats=new this.$Stats,this.stats.dom.style.left="280px",document.getElementsByClassName("webglModifierCurveInstanced-container")[0].appendChild(this.stats.dom),window.addEventListener("resize",this.onWindowResize,!1)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},onPointerDown:function(e){this.action=this.ACTION_SELECT,this.mouse.x=(e.clientX-281)/(window.innerWidth-281)*2-1,this.mouse.y=-e.clientY/window.innerHeight*2+1},animate:function(){if(requestAnimationFrame(this.animate),this.action===this.ACTION_SELECT){this.rayCaster.setFromCamera(this.mouse,this.camera),this.action=this.ACTION_NONE;var e=this.rayCaster.intersectObjects(this.curveHandles);if(e.length){var t=e[0].object;this.control.attach(t),this.scene.add(this.control)}}this.flow&&this.flow.moveAlongCurve(.001),this.render()},render:function(){this.renderer.render(this.scene,this.camera),this.stats.update()}}},o={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglModifierCurveInstanced-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" webgl - curve modifier - instanced\n\t\t")])])}]};var a=n("VU/8")(s,o,!1,function(e){n("J9qH")},"data-v-644e08f4",null);t.default=a.exports}});
//# sourceMappingURL=39.933a7e112a9704ab3349.js.map