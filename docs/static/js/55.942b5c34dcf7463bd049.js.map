{"version":3,"sources":["webpack:///src/views/loader/webglLoader3mf.vue","webpack:///./src/views/loader/webglLoader3mf.vue?dd95","webpack:///./src/views/loader/webglLoader3mf.vue","webpack:///./src/components/jsm/loaders/3MFLoader.js"],"names":["webglLoader3mf","data","camera","scene","renderer","object","loader","controls","params","assets","gui","mounted","this","asset","init","beforeDestroy","destroy","methods","_this","$THREE","WebGLRenderer","antialias","setPixelRatio","window","devicePixelRatio","setSize","$webglInnerWidth","innerHeight","document","getElementsByClassName","appendChild","domElement","Scene","background","Color","add","AmbientLight","PerspectiveCamera","up","set","position","OrbitControls","addEventListener","render","minDistance","maxDistance","enablePan","update","pointLight","PointLight","manager","LoadingManager","onLoad","center","Box3","setFromObject","getCenter","Vector3","x","y","z","reset","_MFLoader","loadAsset","onWindowResize","dat_gui_module","width","onChange","value","_this2","load","group","traverse","child","material","dispose","map","geometry","remove","$onWindowResize","loader_webglLoader3mf","$createElement","_self","_c","_m","staticRenderFns","_vm","_h","staticClass","attrs","id","href","target","rel","_v","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","d","ThreeMFLoader","__WEBPACK_IMPORTED_MODULE_0__components_build_three_module_js__","__WEBPACK_IMPORTED_MODULE_1__libs_jszip_module_min_js__","Loader","call","availableExtensions","prototype","Object","assign","create","constructor","url","onProgress","onError","scope","FileLoader","setPath","path","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","buffer","parse","e","console","error","itemError","textureLoader","TextureLoader","parseRelsXml","relsFileText","relationships","relsNodes","DOMParser","parseFromString","querySelectorAll","i","length","relsNode","relationship","getAttribute","type","push","parseBasematerialsNode","basematerialsNode","basematerialsData","basematerials","basematerialNodes","basematerialData","parseBasematerialNode","index","parseTextures2DGroupNode","texture2DGroupNode","texture2DGroupData","texid","displaypropertiesid","tex2coordNodes","uvs","tex2coordNode","u","v","parseFloat","Float32Array","parseColorGroupNode","colorGroupNode","colorGroupData","colorNodes","colors","colorObject","color","setStyle","substring","convertSRGBToLinear","r","g","b","parseMetallicDisplaypropertiesNode","metallicDisplaypropetiesNode","metallicDisplaypropertiesData","metallicNodes","metallicData","metallicNode","name","metallicness","roughness","basematerialNode","parseComponentNode","componentNode","componentData","transform","parseTransform","t","split","forEach","s","matrix","Matrix4","parseObjectNode","objectNode","objectData","pid","pindex","thumbnail","partnumber","meshNode","querySelector","meshData","vertices","vertexNodes","vertexNode","triangleProperties","triangles","triangleNodes","triangleNode","v1","v2","v3","p1","p2","p3","triangleProperty","parseInt","keys","Uint32Array","parseMeshNode","componentsNode","components","componentNodes","parseComponentsNode","parseModelNode","modelNode","modelData","unit","metadataNodes","metadataData","metadataNode","indexOf","textContent","parseMetadataNodes","resourcesNode","resourcesData","basematerialsNodes","texture2DNode","textures2DNodes","textures2DNode","texture2DData","contenttype","tilestyleu","tilestylev","filter","colorGroupNodes","pbmetallicdisplaypropertiesNodes","pbmetallicdisplaypropertiesData","textures2DGroupNodes","textures2DGroupData","objectNodes","parseResourcesNode","buildNode","buildData","itemNodes","itemNode","buildItem","objectId","parseBuildNode","buildTexture","texture2dgroup","objects","textureData","texture2d","resources","blob","Blob","sourceURI","URL","createObjectURL","texture","revokeObjectURL","encoding","sRGBEncoding","wrapS","RepeatWrapping","MirroredRepeatWrapping","ClampToEdgeWrapping","wrapT","magFilter","LinearFilter","minFilter","LinearMipmapLinearFilter","NearestFilter","buildBasematerialsMeshes","objectPindex","materialMap","l","undefined","meshes","materialIndex","trianglePropertiesProps","getBuild","buildBasematerial","BufferGeometry","positionData","j","jl","setAttribute","Float32BufferAttribute","mesh","Mesh","buildTexturedMesh","uvData","MeshPhongMaterial","flatShading","buildVertexColorMesh","colorgroup","colorData","vertexColors","buildDefaultMesh","setIndex","BufferAttribute","getResourceType","buildGroup","Group","resourceMap","il","resourceId","newMeshes","buildMeshes","objectPid","analyzeObject","builder","build","materialData","pbmetallicdisplayproperties","MeshStandardMaterial","metalness","displaycolor","opacity","charAt","buildComposite","compositeData","composite","component","buildObject","object3D","clone","applyMatrix4","extensions","modelXml","ns","extension","apply","applyExtensions","data3mf","relsName","modelRelsName","rels","modelRels","zip","file","modelPartNames","printTicketPartNames","texturesPartNames","otherPartNames","modelParts","texturesParts","JSZip","ReferenceError","files","match","relsView","Uint8Array","asArrayBuffer","LoaderUtils","decodeText","modelPart","view","fileText","xmlData","documentElement","nodeName","toLowerCase","attributes","attr","RegExp","$1","texturesPartName","model","printTicket","other","loadDocument","modelsData","modelsKeys","modelRel","textureKey","objectIds","buildObjects","addExtension"],"mappings":"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","file":"static/js/55.942b5c34dcf7463bd049.js","sourcesContent":["<template>\r\n    <div class=\"webglLoader3mf-container\">\r\n        <div id=\"info\">\r\n\t\t\t<a href=\"https://threejs.org\" target=\"_blank\" rel=\"noopener\">three.js</a>\r\n\t\t\t<a href=\"http://3mf.io\" target=\"_blank\" rel=\"noopener\">3MF File format</a>\r\n\t\t\t<div>3MF loader test by <a href=\"https://github.com/technohippy\" target=\"_blank\" rel=\"noopener\">technohippy</a></div>\r\n\t\t\t<div>Files from <a href=\"https://github.com/3MFConsortium/3mf-samples\" target=\"_blank\" rel=\"noopener\">3mf-samples</a></div>\r\n\t\t</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { OrbitControls } from '@/components/jsm/controls/OrbitControls.js'\r\nimport { ThreeMFLoader } from '@/components/jsm/loaders/3MFLoader.js'\r\nimport { GUI } from '@/components/jsm/libs/dat.gui.module.js'\r\nexport default {\r\n    data() {\r\n        return {\r\n            camera: null,\r\n            scene: null,\r\n            renderer: null,\r\n            object: null,\r\n            loader: null,\r\n            controls: null,\r\n\t\t\tparams: null,\r\n            assets: null,\r\n            gui: null\r\n        }\r\n    },\r\n    mounted() {\r\n        this.params = {\r\n            asset: 'cube_gears'\r\n        }\r\n        this.assets = [\r\n            'cube_gears',\r\n            'facecolors',\r\n            'multipletextures',\r\n            'vertexcolors'\r\n        ]\r\n        this.init()\r\n    },\r\n    beforeDestroy() {\r\n        this.gui.destroy()\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.renderer = new this.$THREE.WebGLRenderer({ antialias: true })\r\n            this.renderer.setPixelRatio(window.devicePixelRatio)\r\n            this.renderer.setSize(this.$webglInnerWidth, window.innerHeight)\r\n            document.getElementsByClassName('webglLoader3mf-container')[0].appendChild(this.renderer.domElement)\r\n            this.scene = new this.$THREE.Scene()\r\n            this.scene.background = new this.$THREE.Color(0x333333)\r\n            this.scene.add(new this.$THREE.AmbientLight(0xffffff, 0.2))\r\n            this.camera = new this.$THREE.PerspectiveCamera(35, this.$webglInnerWidth / window.innerHeight, 1, 500)\r\n            // Z is up for objects intended to be 3D printed.\r\n            this.camera.up.set(0, 0, 1)\r\n            this.camera.position.set(- 100, - 250, 100)\r\n            this.scene.add(this.camera)\r\n            this.controls = new OrbitControls(this.camera, this.renderer.domElement)\r\n            this.controls.addEventListener('change', this.render)\r\n            this.controls.minDistance = 50\r\n            this.controls.maxDistance = 400\r\n            this.controls.enablePan = false\r\n            this.controls.update()\r\n            var pointLight = new this.$THREE.PointLight(0xffffff, 0.8)\r\n            this.camera.add(pointLight)\r\n            var manager = new this.$THREE.LoadingManager()\r\n            manager.onLoad = () => {\r\n                var aabb = new this.$THREE.Box3().setFromObject(this.object)\r\n                var center = aabb.getCenter(new this.$THREE.Vector3())\r\n                this.object.position.x += (this.object.position.x - center.x)\r\n                this.object.position.y += (this.object.position.y - center.y)\r\n                this.object.position.z += (this.object.position.z - center.z)\r\n                this.controls.reset()\r\n                this.scene.add(this.object)\r\n                this.render()\r\n            }\r\n            this.loader = new ThreeMFLoader(manager)\r\n            this.loadAsset(this.params.asset)\r\n            window.addEventListener('resize', this.onWindowResize, false)\r\n            //\r\n            this.gui = new GUI({ width: 300 })\r\n            this.gui.add(this.params, 'asset', this.assets).onChange((value) => {\r\n                this.loadAsset(value)\r\n            })\r\n        },\r\n        loadAsset(asset) {\r\n            this.loader.load('static/models/3mf/' + asset + '.3mf', (group) => {\r\n                if (this.object) {\r\n                    this.object.traverse((child) => {\r\n                        if (child.material) child.material.dispose()\r\n                        if (child.material && child.material.map) child.material.map.dispose()\r\n                        if (child.geometry) child.geometry.dispose()\r\n                    })\r\n                    this.scene.remove(this.object)\r\n                }\r\n                //\r\n                this.object = group\r\n            })\r\n        },\r\n        onWindowResize() {\r\n            this.$onWindowResize(this.camera, this.renderer)\r\n            this.render()\r\n        },\r\n        render() {\r\n            this.renderer.render(this.scene, this.camera)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.webglLoader3mf-container {\r\n    width: 100%;\r\n    background-color: #333;\r\n}\r\n#info {\r\n    margin-left: 0;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/loader/webglLoader3mf.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"webglLoader3mf-container\"},[_c('div',{attrs:{\"id\":\"info\"}},[_c('a',{attrs:{\"href\":\"https://threejs.org\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"three.js\")]),_vm._v(\" \"),_c('a',{attrs:{\"href\":\"http://3mf.io\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"3MF File format\")]),_vm._v(\" \"),_c('div',[_vm._v(\"3MF loader test by \"),_c('a',{attrs:{\"href\":\"https://github.com/technohippy\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"technohippy\")])]),_vm._v(\" \"),_c('div',[_vm._v(\"Files from \"),_c('a',{attrs:{\"href\":\"https://github.com/3MFConsortium/3mf-samples\",\"target\":\"_blank\",\"rel\":\"noopener\"}},[_vm._v(\"3mf-samples\")])])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7406e69c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/loader/webglLoader3mf.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7406e69c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./webglLoader3mf.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoader3mf.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./webglLoader3mf.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7406e69c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./webglLoader3mf.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-7406e69c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/loader/webglLoader3mf.vue\n// module id = null\n// module chunks = ","import {\r\n\tBufferAttribute,\r\n\tBufferGeometry,\r\n\tClampToEdgeWrapping,\r\n\tColor,\r\n\tFileLoader,\r\n\tFloat32BufferAttribute,\r\n\tGroup,\r\n\tLinearFilter,\r\n\tLinearMipmapLinearFilter,\r\n\tLoader,\r\n\tLoaderUtils,\r\n\tMatrix4,\r\n\tMesh,\r\n\tMeshPhongMaterial,\r\n\tMeshStandardMaterial,\r\n\tMirroredRepeatWrapping,\r\n\tNearestFilter,\r\n\tRepeatWrapping,\r\n\tTextureLoader,\r\n\tsRGBEncoding\r\n} from \"@/components/build/three.module.js\";\r\nimport { JSZip } from \"../libs/jszip.module.min.js\";\r\n\r\n/**\r\n *\r\n * 3D Manufacturing Format (3MF) specification: https://3mf.io/specification/\r\n *\r\n * The following features from the core specification are supported:\r\n *\r\n * - 3D Models\r\n * - Object Resources (Meshes and Components)\r\n * - Material Resources (Base Materials)\r\n *\r\n * 3MF Materials and Properties Extension are only partially supported.\r\n *\r\n * - Texture 2D\r\n * - Texture 2D Groups\r\n * - Color Groups (Vertex Colors)\r\n * - Metallic Display Properties (PBR)\r\n */\r\n\r\nvar ThreeMFLoader = function ( manager ) {\r\n\r\n\tLoader.call( this, manager );\r\n\r\n\tthis.availableExtensions = [];\r\n\r\n};\r\n\r\nThreeMFLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\tconstructor: ThreeMFLoader,\r\n\r\n\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\t\tvar loader = new FileLoader( scope.manager );\r\n\t\tloader.setPath( scope.path );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\tloader.setRequestHeader( scope.requestHeader );\r\n\t\tloader.setWithCredentials( scope.withCredentials );\r\n\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tonLoad( scope.parse( buffer ) );\r\n\r\n\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\tif ( onError ) {\r\n\r\n\t\t\t\t\tonError( e );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( e );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t},\r\n\r\n\tparse: function ( data ) {\r\n\r\n\t\tvar scope = this;\r\n\t\tvar textureLoader = new TextureLoader( this.manager );\r\n\r\n\t\tfunction loadDocument( data ) {\r\n\r\n\t\t\tvar zip = null;\r\n\t\t\tvar file = null;\r\n\r\n\t\t\tvar relsName;\r\n\t\t\tvar modelRelsName;\r\n\t\t\tvar modelPartNames = [];\r\n\t\t\tvar printTicketPartNames = [];\r\n\t\t\tvar texturesPartNames = [];\r\n\t\t\tvar otherPartNames = [];\r\n\r\n\t\t\tvar rels;\r\n\t\t\tvar modelRels;\r\n\t\t\tvar modelParts = {};\r\n\t\t\tvar printTicketParts = {};\r\n\t\t\tvar texturesParts = {};\r\n\t\t\tvar otherParts = {};\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tzip = new JSZip( data ); // eslint-disable-line no-undef\r\n\r\n\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\tif ( e instanceof ReferenceError ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.3MFLoader: jszip missing and file is compressed.' );\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( file in zip.files ) {\r\n\r\n\t\t\t\tif ( file.match( /\\_rels\\/.rels$/ ) ) {\r\n\r\n\t\t\t\t\trelsName = file;\r\n\r\n\t\t\t\t} else if ( file.match( /3D\\/_rels\\/.*\\.model\\.rels$/ ) ) {\r\n\r\n\t\t\t\t\tmodelRelsName = file;\r\n\r\n\t\t\t\t} else if ( file.match( /^3D\\/.*\\.model$/ ) ) {\r\n\r\n\t\t\t\t\tmodelPartNames.push( file );\r\n\r\n\t\t\t\t} else if ( file.match( /^3D\\/Metadata\\/.*\\.xml$/ ) ) {\r\n\r\n\t\t\t\t\tprintTicketPartNames.push( file );\r\n\r\n\t\t\t\t} else if ( file.match( /^3D\\/Textures?\\/.*/ ) ) {\r\n\r\n\t\t\t\t\ttexturesPartNames.push( file );\r\n\r\n\t\t\t\t} else if ( file.match( /^3D\\/Other\\/.*/ ) ) {\r\n\r\n\t\t\t\t\totherPartNames.push( file );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar relsView = new Uint8Array( zip.file( relsName ).asArrayBuffer() );\r\n\t\t\tvar relsFileText = LoaderUtils.decodeText( relsView );\r\n\t\t\trels = parseRelsXml( relsFileText );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( modelRelsName ) {\r\n\r\n\t\t\t\tvar relsView = new Uint8Array( zip.file( modelRelsName ).asArrayBuffer() );\r\n\t\t\t\tvar relsFileText = LoaderUtils.decodeText( relsView );\r\n\t\t\t\tmodelRels = parseRelsXml( relsFileText );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfor ( var i = 0; i < modelPartNames.length; i ++ ) {\r\n\r\n\t\t\t\tvar modelPart = modelPartNames[ i ];\r\n\t\t\t\tvar view = new Uint8Array( zip.file( modelPart ).asArrayBuffer() );\r\n\r\n\t\t\t\tvar fileText = LoaderUtils.decodeText( view );\r\n\t\t\t\tvar xmlData = new DOMParser().parseFromString( fileText, 'application/xml' );\r\n\r\n\t\t\t\tif ( xmlData.documentElement.nodeName.toLowerCase() !== 'model' ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.3MFLoader: Error loading 3MF - no 3MF document found: ', modelPart );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar modelNode = xmlData.querySelector( 'model' );\r\n\t\t\t\tvar extensions = {};\r\n\r\n\t\t\t\tfor ( var i = 0; i < modelNode.attributes.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar attr = modelNode.attributes[ i ];\r\n\t\t\t\t\tif ( attr.name.match( /^xmlns:(.+)$/ ) ) {\r\n\r\n\t\t\t\t\t\textensions[ attr.value ] = RegExp.$1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar modelData = parseModelNode( modelNode );\r\n\t\t\t\tmodelData[ 'xml' ] = modelNode;\r\n\r\n\t\t\t\tif ( 0 < Object.keys( extensions ).length ) {\r\n\r\n\t\t\t\t\tmodelData[ 'extensions' ] = extensions;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmodelParts[ modelPart ] = modelData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfor ( var i = 0; i < texturesPartNames.length; i ++ ) {\r\n\r\n\t\t\t\tvar texturesPartName = texturesPartNames[ i ];\r\n\t\t\t\ttexturesParts[ texturesPartName ] = zip.file( texturesPartName ).asArrayBuffer();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\trels: rels,\r\n\t\t\t\tmodelRels: modelRels,\r\n\t\t\t\tmodel: modelParts,\r\n\t\t\t\tprintTicket: printTicketParts,\r\n\t\t\t\ttexture: texturesParts,\r\n\t\t\t\tother: otherParts\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseRelsXml( relsFileText ) {\r\n\r\n\t\t\tvar relationships = [];\r\n\r\n\t\t\tvar relsXmlData = new DOMParser().parseFromString( relsFileText, 'application/xml' );\r\n\r\n\t\t\tvar relsNodes = relsXmlData.querySelectorAll( 'Relationship' );\r\n\r\n\t\t\tfor ( var i = 0; i < relsNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar relsNode = relsNodes[ i ];\r\n\r\n\t\t\t\tvar relationship = {\r\n\t\t\t\t\ttarget: relsNode.getAttribute( 'Target' ), //required\r\n\t\t\t\t\tid: relsNode.getAttribute( 'Id' ), //required\r\n\t\t\t\t\ttype: relsNode.getAttribute( 'Type' ) //required\r\n\t\t\t\t};\r\n\r\n\t\t\t\trelationships.push( relationship );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn relationships;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseMetadataNodes( metadataNodes ) {\r\n\r\n\t\t\tvar metadataData = {};\r\n\r\n\t\t\tfor ( var i = 0; i < metadataNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar metadataNode = metadataNodes[ i ];\r\n\t\t\t\tvar name = metadataNode.getAttribute( 'name' );\r\n\t\t\t\tvar validNames = [\r\n\t\t\t\t\t'Title',\r\n\t\t\t\t\t'Designer',\r\n\t\t\t\t\t'Description',\r\n\t\t\t\t\t'Copyright',\r\n\t\t\t\t\t'LicenseTerms',\r\n\t\t\t\t\t'Rating',\r\n\t\t\t\t\t'CreationDate',\r\n\t\t\t\t\t'ModificationDate'\r\n\t\t\t\t];\r\n\r\n\t\t\t\tif ( 0 <= validNames.indexOf( name ) ) {\r\n\r\n\t\t\t\t\tmetadataData[ name ] = metadataNode.textContent;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn metadataData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseBasematerialsNode( basematerialsNode ) {\r\n\r\n\t\t\tvar basematerialsData = {\r\n\t\t\t\tid: basematerialsNode.getAttribute( 'id' ), // required\r\n\t\t\t\tbasematerials: []\r\n\t\t\t};\r\n\r\n\t\t\tvar basematerialNodes = basematerialsNode.querySelectorAll( 'base' );\r\n\r\n\t\t\tfor ( var i = 0; i < basematerialNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar basematerialNode = basematerialNodes[ i ];\r\n\t\t\t\tvar basematerialData = parseBasematerialNode( basematerialNode );\r\n\t\t\t\tbasematerialData.index = i; // the order and count of the material nodes form an implicit 0-based index\r\n\t\t\t\tbasematerialsData.basematerials.push( basematerialData );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn basematerialsData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseTexture2DNode( texture2DNode ) {\r\n\r\n\t\t\tvar texture2dData = {\r\n\t\t\t\tid: texture2DNode.getAttribute( 'id' ), // required\r\n\t\t\t\tpath: texture2DNode.getAttribute( 'path' ), // required\r\n\t\t\t\tcontenttype: texture2DNode.getAttribute( 'contenttype' ), // required\r\n\t\t\t\ttilestyleu: texture2DNode.getAttribute( 'tilestyleu' ),\r\n\t\t\t\ttilestylev: texture2DNode.getAttribute( 'tilestylev' ),\r\n\t\t\t\tfilter: texture2DNode.getAttribute( 'filter' ),\r\n\t\t\t};\r\n\r\n\t\t\treturn texture2dData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseTextures2DGroupNode( texture2DGroupNode ) {\r\n\r\n\t\t\tvar texture2DGroupData = {\r\n\t\t\t\tid: texture2DGroupNode.getAttribute( 'id' ), // required\r\n\t\t\t\ttexid: texture2DGroupNode.getAttribute( 'texid' ), // required\r\n\t\t\t\tdisplaypropertiesid: texture2DGroupNode.getAttribute( 'displaypropertiesid' )\r\n\t\t\t};\r\n\r\n\t\t\tvar tex2coordNodes = texture2DGroupNode.querySelectorAll( 'tex2coord' );\r\n\r\n\t\t\tvar uvs = [];\r\n\r\n\t\t\tfor ( var i = 0; i < tex2coordNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar tex2coordNode = tex2coordNodes[ i ];\r\n\t\t\t\tvar u = tex2coordNode.getAttribute( 'u' );\r\n\t\t\t\tvar v = tex2coordNode.getAttribute( 'v' );\r\n\r\n\t\t\t\tuvs.push( parseFloat( u ), parseFloat( v ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttexture2DGroupData[ 'uvs' ] = new Float32Array( uvs );\r\n\r\n\t\t\treturn texture2DGroupData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseColorGroupNode( colorGroupNode ) {\r\n\r\n\t\t\tvar colorGroupData = {\r\n\t\t\t\tid: colorGroupNode.getAttribute( 'id' ), // required\r\n\t\t\t\tdisplaypropertiesid: colorGroupNode.getAttribute( 'displaypropertiesid' )\r\n\t\t\t};\r\n\r\n\t\t\tvar colorNodes = colorGroupNode.querySelectorAll( 'color' );\r\n\r\n\t\t\tvar colors = [];\r\n\t\t\tvar colorObject = new Color();\r\n\r\n\t\t\tfor ( var i = 0; i < colorNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar colorNode = colorNodes[ i ];\r\n\t\t\t\tvar color = colorNode.getAttribute( 'color' );\r\n\r\n\t\t\t\tcolorObject.setStyle( color.substring( 0, 7 ) );\r\n\t\t\t\tcolorObject.convertSRGBToLinear(); // color is in sRGB\r\n\r\n\t\t\t\tcolors.push( colorObject.r, colorObject.g, colorObject.b );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcolorGroupData[ 'colors' ] = new Float32Array( colors );\r\n\r\n\t\t\treturn colorGroupData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseMetallicDisplaypropertiesNode( metallicDisplaypropetiesNode ) {\r\n\r\n\t\t\tvar metallicDisplaypropertiesData = {\r\n\t\t\t\tid: metallicDisplaypropetiesNode.getAttribute( 'id' ) // required\r\n\t\t\t};\r\n\r\n\t\t\tvar metallicNodes = metallicDisplaypropetiesNode.querySelectorAll( 'pbmetallic' );\r\n\r\n\t\t\tvar metallicData = [];\r\n\r\n\t\t\tfor ( var i = 0; i < metallicNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar metallicNode = metallicNodes[ i ];\r\n\r\n\t\t\t\tmetallicData.push( {\r\n\t\t\t\t\tname: metallicNode.getAttribute( 'name' ), // required\r\n\t\t\t\t\tmetallicness: parseFloat( metallicNode.getAttribute( 'metallicness' ) ), // required\r\n\t\t\t\t\troughness: parseFloat( metallicNode.getAttribute( 'roughness' ) ) // required\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmetallicDisplaypropertiesData.data = metallicData;\r\n\r\n\t\t\treturn metallicDisplaypropertiesData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseBasematerialNode( basematerialNode ) {\r\n\r\n\t\t\tvar basematerialData = {};\r\n\r\n\t\t\tbasematerialData[ 'name' ] = basematerialNode.getAttribute( 'name' ); // required\r\n\t\t\tbasematerialData[ 'displaycolor' ] = basematerialNode.getAttribute( 'displaycolor' ); // required\r\n\t\t\tbasematerialData[ 'displaypropertiesid' ] = basematerialNode.getAttribute( 'displaypropertiesid' );\r\n\r\n\t\t\treturn basematerialData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseMeshNode( meshNode ) {\r\n\r\n\t\t\tvar meshData = {};\r\n\r\n\t\t\tvar vertices = [];\r\n\t\t\tvar vertexNodes = meshNode.querySelectorAll( 'vertices vertex' );\r\n\r\n\t\t\tfor ( var i = 0; i < vertexNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar vertexNode = vertexNodes[ i ];\r\n\t\t\t\tvar x = vertexNode.getAttribute( 'x' );\r\n\t\t\t\tvar y = vertexNode.getAttribute( 'y' );\r\n\t\t\t\tvar z = vertexNode.getAttribute( 'z' );\r\n\r\n\t\t\t\tvertices.push( parseFloat( x ), parseFloat( y ), parseFloat( z ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmeshData[ 'vertices' ] = new Float32Array( vertices );\r\n\r\n\t\t\tvar triangleProperties = [];\r\n\t\t\tvar triangles = [];\r\n\t\t\tvar triangleNodes = meshNode.querySelectorAll( 'triangles triangle' );\r\n\r\n\t\t\tfor ( var i = 0; i < triangleNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar triangleNode = triangleNodes[ i ];\r\n\t\t\t\tvar v1 = triangleNode.getAttribute( 'v1' );\r\n\t\t\t\tvar v2 = triangleNode.getAttribute( 'v2' );\r\n\t\t\t\tvar v3 = triangleNode.getAttribute( 'v3' );\r\n\t\t\t\tvar p1 = triangleNode.getAttribute( 'p1' );\r\n\t\t\t\tvar p2 = triangleNode.getAttribute( 'p2' );\r\n\t\t\t\tvar p3 = triangleNode.getAttribute( 'p3' );\r\n\t\t\t\tvar pid = triangleNode.getAttribute( 'pid' );\r\n\r\n\t\t\t\tvar triangleProperty = {};\r\n\r\n\t\t\t\ttriangleProperty[ 'v1' ] = parseInt( v1, 10 );\r\n\t\t\t\ttriangleProperty[ 'v2' ] = parseInt( v2, 10 );\r\n\t\t\t\ttriangleProperty[ 'v3' ] = parseInt( v3, 10 );\r\n\r\n\t\t\t\ttriangles.push( triangleProperty[ 'v1' ], triangleProperty[ 'v2' ], triangleProperty[ 'v3' ] );\r\n\r\n\t\t\t\t// optional\r\n\r\n\t\t\t\tif ( p1 ) {\r\n\r\n\t\t\t\t\ttriangleProperty[ 'p1' ] = parseInt( p1, 10 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( p2 ) {\r\n\r\n\t\t\t\t\ttriangleProperty[ 'p2' ] = parseInt( p2, 10 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( p3 ) {\r\n\r\n\t\t\t\t\ttriangleProperty[ 'p3' ] = parseInt( p3, 10 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( pid ) {\r\n\r\n\t\t\t\t\ttriangleProperty[ 'pid' ] = pid;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( 0 < Object.keys( triangleProperty ).length ) {\r\n\r\n\t\t\t\t\ttriangleProperties.push( triangleProperty );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmeshData[ 'triangleProperties' ] = triangleProperties;\r\n\t\t\tmeshData[ 'triangles' ] = new Uint32Array( triangles );\r\n\r\n\t\t\treturn meshData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseComponentsNode( componentsNode ) {\r\n\r\n\t\t\tvar components = [];\r\n\r\n\t\t\tvar componentNodes = componentsNode.querySelectorAll( 'component' );\r\n\r\n\t\t\tfor ( var i = 0; i < componentNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar componentNode = componentNodes[ i ];\r\n\t\t\t\tvar componentData = parseComponentNode( componentNode );\r\n\t\t\t\tcomponents.push( componentData );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn components;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseComponentNode( componentNode ) {\r\n\r\n\t\t\tvar componentData = {};\r\n\r\n\t\t\tcomponentData[ 'objectId' ] = componentNode.getAttribute( 'objectid' ); // required\r\n\r\n\t\t\tvar transform = componentNode.getAttribute( 'transform' );\r\n\r\n\t\t\tif ( transform ) {\r\n\r\n\t\t\t\tcomponentData[ 'transform' ] = parseTransform( transform );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn componentData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseTransform( transform ) {\r\n\r\n\t\t\tvar t = [];\r\n\t\t\ttransform.split( ' ' ).forEach( function ( s ) {\r\n\r\n\t\t\t\tt.push( parseFloat( s ) );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tvar matrix = new Matrix4();\r\n\t\t\tmatrix.set(\r\n\t\t\t\tt[ 0 ], t[ 3 ], t[ 6 ], t[ 9 ],\r\n\t\t\t\tt[ 1 ], t[ 4 ], t[ 7 ], t[ 10 ],\r\n\t\t\t\tt[ 2 ], t[ 5 ], t[ 8 ], t[ 11 ],\r\n\t\t\t\t 0.0, 0.0, 0.0, 1.0\r\n\t\t\t);\r\n\r\n\t\t\treturn matrix;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseObjectNode( objectNode ) {\r\n\r\n\t\t\tvar objectData = {\r\n\t\t\t\ttype: objectNode.getAttribute( 'type' )\r\n\t\t\t};\r\n\r\n\t\t\tvar id = objectNode.getAttribute( 'id' );\r\n\r\n\t\t\tif ( id ) {\r\n\r\n\t\t\t\tobjectData[ 'id' ] = id;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar pid = objectNode.getAttribute( 'pid' );\r\n\r\n\t\t\tif ( pid ) {\r\n\r\n\t\t\t\tobjectData[ 'pid' ] = pid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar pindex = objectNode.getAttribute( 'pindex' );\r\n\r\n\t\t\tif ( pindex ) {\r\n\r\n\t\t\t\tobjectData[ 'pindex' ] = pindex;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar thumbnail = objectNode.getAttribute( 'thumbnail' );\r\n\r\n\t\t\tif ( thumbnail ) {\r\n\r\n\t\t\t\tobjectData[ 'thumbnail' ] = thumbnail;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar partnumber = objectNode.getAttribute( 'partnumber' );\r\n\r\n\t\t\tif ( partnumber ) {\r\n\r\n\t\t\t\tobjectData[ 'partnumber' ] = partnumber;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar name = objectNode.getAttribute( 'name' );\r\n\r\n\t\t\tif ( name ) {\r\n\r\n\t\t\t\tobjectData[ 'name' ] = name;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar meshNode = objectNode.querySelector( 'mesh' );\r\n\r\n\t\t\tif ( meshNode ) {\r\n\r\n\t\t\t\tobjectData[ 'mesh' ] = parseMeshNode( meshNode );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar componentsNode = objectNode.querySelector( 'components' );\r\n\r\n\t\t\tif ( componentsNode ) {\r\n\r\n\t\t\t\tobjectData[ 'components' ] = parseComponentsNode( componentsNode );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn objectData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseResourcesNode( resourcesNode ) {\r\n\r\n\t\t\tvar resourcesData = {};\r\n\r\n\t\t\tresourcesData[ 'basematerials' ] = {};\r\n\t\t\tvar basematerialsNodes = resourcesNode.querySelectorAll( 'basematerials' );\r\n\r\n\t\t\tfor ( var i = 0; i < basematerialsNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar basematerialsNode = basematerialsNodes[ i ];\r\n\t\t\t\tvar basematerialsData = parseBasematerialsNode( basematerialsNode );\r\n\t\t\t\tresourcesData[ 'basematerials' ][ basematerialsData[ 'id' ] ] = basematerialsData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tresourcesData[ 'texture2d' ] = {};\r\n\t\t\tvar textures2DNodes = resourcesNode.querySelectorAll( 'texture2d' );\r\n\r\n\t\t\tfor ( var i = 0; i < textures2DNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar textures2DNode = textures2DNodes[ i ];\r\n\t\t\t\tvar texture2DData = parseTexture2DNode( textures2DNode );\r\n\t\t\t\tresourcesData[ 'texture2d' ][ texture2DData[ 'id' ] ] = texture2DData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tresourcesData[ 'colorgroup' ] = {};\r\n\t\t\tvar colorGroupNodes = resourcesNode.querySelectorAll( 'colorgroup' );\r\n\r\n\t\t\tfor ( var i = 0; i < colorGroupNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar colorGroupNode = colorGroupNodes[ i ];\r\n\t\t\t\tvar colorGroupData = parseColorGroupNode( colorGroupNode );\r\n\t\t\t\tresourcesData[ 'colorgroup' ][ colorGroupData[ 'id' ] ] = colorGroupData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tresourcesData[ 'pbmetallicdisplayproperties' ] = {};\r\n\t\t\tvar pbmetallicdisplaypropertiesNodes = resourcesNode.querySelectorAll( 'pbmetallicdisplayproperties' );\r\n\r\n\t\t\tfor ( var i = 0; i < pbmetallicdisplaypropertiesNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar pbmetallicdisplaypropertiesNode = pbmetallicdisplaypropertiesNodes[ i ];\r\n\t\t\t\tvar pbmetallicdisplaypropertiesData = parseMetallicDisplaypropertiesNode( pbmetallicdisplaypropertiesNode );\r\n\t\t\t\tresourcesData[ 'pbmetallicdisplayproperties' ][ pbmetallicdisplaypropertiesData[ 'id' ] ] = pbmetallicdisplaypropertiesData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tresourcesData[ 'texture2dgroup' ] = {};\r\n\t\t\tvar textures2DGroupNodes = resourcesNode.querySelectorAll( 'texture2dgroup' );\r\n\r\n\t\t\tfor ( var i = 0; i < textures2DGroupNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar textures2DGroupNode = textures2DGroupNodes[ i ];\r\n\t\t\t\tvar textures2DGroupData = parseTextures2DGroupNode( textures2DGroupNode );\r\n\t\t\t\tresourcesData[ 'texture2dgroup' ][ textures2DGroupData[ 'id' ] ] = textures2DGroupData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tresourcesData[ 'object' ] = {};\r\n\t\t\tvar objectNodes = resourcesNode.querySelectorAll( 'object' );\r\n\r\n\t\t\tfor ( var i = 0; i < objectNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar objectNode = objectNodes[ i ];\r\n\t\t\t\tvar objectData = parseObjectNode( objectNode );\r\n\t\t\t\tresourcesData[ 'object' ][ objectData[ 'id' ] ] = objectData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn resourcesData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseBuildNode( buildNode ) {\r\n\r\n\t\t\tvar buildData = [];\r\n\t\t\tvar itemNodes = buildNode.querySelectorAll( 'item' );\r\n\r\n\t\t\tfor ( var i = 0; i < itemNodes.length; i ++ ) {\r\n\r\n\t\t\t\tvar itemNode = itemNodes[ i ];\r\n\t\t\t\tvar buildItem = {\r\n\t\t\t\t\tobjectId: itemNode.getAttribute( 'objectid' )\r\n\t\t\t\t};\r\n\t\t\t\tvar transform = itemNode.getAttribute( 'transform' );\r\n\r\n\t\t\t\tif ( transform ) {\r\n\r\n\t\t\t\t\tbuildItem[ 'transform' ] = parseTransform( transform );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbuildData.push( buildItem );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buildData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction parseModelNode( modelNode ) {\r\n\r\n\t\t\tvar modelData = { unit: modelNode.getAttribute( 'unit' ) || 'millimeter' };\r\n\t\t\tvar metadataNodes = modelNode.querySelectorAll( 'metadata' );\r\n\r\n\t\t\tif ( metadataNodes ) {\r\n\r\n\t\t\t\tmodelData[ 'metadata' ] = parseMetadataNodes( metadataNodes );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar resourcesNode = modelNode.querySelector( 'resources' );\r\n\r\n\t\t\tif ( resourcesNode ) {\r\n\r\n\t\t\t\tmodelData[ 'resources' ] = parseResourcesNode( resourcesNode );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar buildNode = modelNode.querySelector( 'build' );\r\n\r\n\t\t\tif ( buildNode ) {\r\n\r\n\t\t\t\tmodelData[ 'build' ] = parseBuildNode( buildNode );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn modelData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildTexture( texture2dgroup, objects, modelData, textureData ) {\r\n\r\n\t\t\tvar texid = texture2dgroup.texid;\r\n\t\t\tvar texture2ds = modelData.resources.texture2d;\r\n\t\t\tvar texture2d = texture2ds[ texid ];\r\n\r\n\t\t\tif ( texture2d ) {\r\n\r\n\t\t\t\tvar data = textureData[ texture2d.path ];\r\n\t\t\t\tvar type = texture2d.contenttype;\r\n\r\n\t\t\t\tvar blob = new Blob( [ data ], { type: type } );\r\n\t\t\t\tvar sourceURI = URL.createObjectURL( blob );\r\n\r\n\t\t\t\tvar texture = textureLoader.load( sourceURI, function () {\r\n\r\n\t\t\t\t\tURL.revokeObjectURL( sourceURI );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\ttexture.encoding = sRGBEncoding;\r\n\r\n\t\t\t\t// texture parameters\r\n\r\n\t\t\t\tswitch ( texture2d.tilestyleu ) {\r\n\r\n\t\t\t\t\tcase 'wrap':\r\n\t\t\t\t\t\ttexture.wrapS = RepeatWrapping;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'mirror':\r\n\t\t\t\t\t\ttexture.wrapS = MirroredRepeatWrapping;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'none':\r\n\t\t\t\t\tcase 'clamp':\r\n\t\t\t\t\t\ttexture.wrapS = ClampToEdgeWrapping;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\ttexture.wrapS = RepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch ( texture2d.tilestylev ) {\r\n\r\n\t\t\t\t\tcase 'wrap':\r\n\t\t\t\t\t\ttexture.wrapT = RepeatWrapping;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'mirror':\r\n\t\t\t\t\t\ttexture.wrapT = MirroredRepeatWrapping;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'none':\r\n\t\t\t\t\tcase 'clamp':\r\n\t\t\t\t\t\ttexture.wrapT = ClampToEdgeWrapping;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\ttexture.wrapT = RepeatWrapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch ( texture2d.filter ) {\r\n\r\n\t\t\t\t\tcase 'auto':\r\n\t\t\t\t\t\ttexture.magFilter = LinearFilter;\r\n\t\t\t\t\t\ttexture.minFilter = LinearMipmapLinearFilter;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'linear':\r\n\t\t\t\t\t\ttexture.magFilter = LinearFilter;\r\n\t\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'nearest':\r\n\t\t\t\t\t\ttexture.magFilter = NearestFilter;\r\n\t\t\t\t\t\ttexture.minFilter = NearestFilter;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\ttexture.magFilter = LinearFilter;\r\n\t\t\t\t\t\ttexture.minFilter = LinearMipmapLinearFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn texture;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildBasematerialsMeshes( basematerials, triangleProperties, modelData, meshData, textureData, objectData ) {\r\n\r\n\t\t\tvar objectPindex = objectData.pindex;\r\n\r\n\t\t\tvar materialMap = {};\r\n\r\n\t\t\tfor ( var i = 0, l = triangleProperties.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar triangleProperty = triangleProperties[ i ];\r\n\t\t\t\tvar pindex = ( triangleProperty.p1 !== undefined ) ? triangleProperty.p1 : objectPindex;\r\n\r\n\t\t\t\tif ( materialMap[ pindex ] === undefined ) materialMap[ pindex ] = [];\r\n\r\n\t\t\t\tmaterialMap[ pindex ].push( triangleProperty );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar keys = Object.keys( materialMap );\r\n\t\t\tvar meshes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = keys.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar materialIndex = keys[ i ];\r\n\t\t\t\tvar trianglePropertiesProps = materialMap[ materialIndex ];\r\n\t\t\t\tvar basematerialData = basematerials.basematerials[ materialIndex ];\r\n\t\t\t\tvar material = getBuild( basematerialData, objects, modelData, textureData, objectData, buildBasematerial );\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\t\t\tvar positionData = [];\r\n\r\n\t\t\t\tvar vertices = meshData.vertices;\r\n\r\n\t\t\t\tfor ( var j = 0, jl = trianglePropertiesProps.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar triangleProperty = trianglePropertiesProps[ j ];\r\n\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v1 * 3 ) + 0 ] );\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v1 * 3 ) + 1 ] );\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v1 * 3 ) + 2 ] );\r\n\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v2 * 3 ) + 0 ] );\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v2 * 3 ) + 1 ] );\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v2 * 3 ) + 2 ] );\r\n\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v3 * 3 ) + 0 ] );\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v3 * 3 ) + 1 ] );\r\n\t\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v3 * 3 ) + 2 ] );\r\n\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positionData, 3 ) );\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar mesh = new Mesh( geometry, material );\r\n\t\t\t\tmeshes.push( mesh );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn meshes;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildTexturedMesh( texture2dgroup, triangleProperties, modelData, meshData, textureData, objectData ) {\r\n\r\n\t\t\t// geometry\r\n\r\n\t\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\t\tvar positionData = [];\r\n\t\t\tvar uvData = [];\r\n\r\n\t\t\tvar vertices = meshData.vertices;\r\n\t\t\tvar uvs = texture2dgroup.uvs;\r\n\r\n\t\t\tfor ( var i = 0, l = triangleProperties.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar triangleProperty = triangleProperties[ i ];\r\n\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v1 * 3 ) + 0 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v1 * 3 ) + 1 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v1 * 3 ) + 2 ] );\r\n\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v2 * 3 ) + 0 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v2 * 3 ) + 1 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v2 * 3 ) + 2 ] );\r\n\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v3 * 3 ) + 0 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v3 * 3 ) + 1 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( triangleProperty.v3 * 3 ) + 2 ] );\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tuvData.push( uvs[ ( triangleProperty.p1 * 2 ) + 0 ] );\r\n\t\t\t\tuvData.push( uvs[ ( triangleProperty.p1 * 2 ) + 1 ] );\r\n\r\n\t\t\t\tuvData.push( uvs[ ( triangleProperty.p2 * 2 ) + 0 ] );\r\n\t\t\t\tuvData.push( uvs[ ( triangleProperty.p2 * 2 ) + 1 ] );\r\n\r\n\t\t\t\tuvData.push( uvs[ ( triangleProperty.p3 * 2 ) + 0 ] );\r\n\t\t\t\tuvData.push( uvs[ ( triangleProperty.p3 * 2 ) + 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positionData, 3 ) );\r\n\t\t\tgeometry.setAttribute( 'uv', new Float32BufferAttribute( uvData, 2 ) );\r\n\r\n\t\t\t// material\r\n\r\n\t\t\tvar texture = getBuild( texture2dgroup, objects, modelData, textureData, objectData, buildTexture );\r\n\r\n\t\t\tvar material = new MeshPhongMaterial( { map: texture, flatShading: true } );\r\n\r\n\t\t\t// mesh\r\n\r\n\t\t\tvar mesh = new Mesh( geometry, material );\r\n\r\n\t\t\treturn mesh;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildVertexColorMesh( colorgroup, triangleProperties, modelData, meshData, objectData ) {\r\n\r\n\t\t\t// geometry\r\n\r\n\t\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\t\tvar positionData = [];\r\n\t\t\tvar colorData = [];\r\n\r\n\t\t\tvar vertices = meshData.vertices;\r\n\t\t\tvar colors = colorgroup.colors;\r\n\r\n\t\t\tfor ( var i = 0, l = triangleProperties.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar triangleProperty = triangleProperties[ i ];\r\n\r\n\t\t\t\tvar v1 = triangleProperty.v1;\r\n\t\t\t\tvar v2 = triangleProperty.v2;\r\n\t\t\t\tvar v3 = triangleProperty.v3;\r\n\r\n\t\t\t\tpositionData.push( vertices[ ( v1 * 3 ) + 0 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( v1 * 3 ) + 1 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( v1 * 3 ) + 2 ] );\r\n\r\n\t\t\t\tpositionData.push( vertices[ ( v2 * 3 ) + 0 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( v2 * 3 ) + 1 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( v2 * 3 ) + 2 ] );\r\n\r\n\t\t\t\tpositionData.push( vertices[ ( v3 * 3 ) + 0 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( v3 * 3 ) + 1 ] );\r\n\t\t\t\tpositionData.push( vertices[ ( v3 * 3 ) + 2 ] );\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar p1 = ( triangleProperty.p1 !== undefined ) ? triangleProperty.p1 : objectData.pindex;\r\n\t\t\t\tvar p2 = ( triangleProperty.p2 !== undefined ) ? triangleProperty.p2 : p1;\r\n\t\t\t\tvar p3 = ( triangleProperty.p3 !== undefined ) ? triangleProperty.p3 : p1;\r\n\r\n\t\t\t\tcolorData.push( colors[ ( p1 * 3 ) + 0 ] );\r\n\t\t\t\tcolorData.push( colors[ ( p1 * 3 ) + 1 ] );\r\n\t\t\t\tcolorData.push( colors[ ( p1 * 3 ) + 2 ] );\r\n\r\n\t\t\t\tcolorData.push( colors[ ( p2 * 3 ) + 0 ] );\r\n\t\t\t\tcolorData.push( colors[ ( p2 * 3 ) + 1 ] );\r\n\t\t\t\tcolorData.push( colors[ ( p2 * 3 ) + 2 ] );\r\n\r\n\t\t\t\tcolorData.push( colors[ ( p3 * 3 ) + 0 ] );\r\n\t\t\t\tcolorData.push( colors[ ( p3 * 3 ) + 1 ] );\r\n\t\t\t\tcolorData.push( colors[ ( p3 * 3 ) + 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positionData, 3 ) );\r\n\t\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colorData, 3 ) );\r\n\r\n\t\t\t// material\r\n\r\n\t\t\tvar material = new MeshPhongMaterial( { vertexColors: true, flatShading: true } );\r\n\r\n\t\t\t// mesh\r\n\r\n\t\t\tvar mesh = new Mesh( geometry, material );\r\n\r\n\t\t\treturn mesh;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildDefaultMesh( meshData ) {\r\n\r\n\t\t\tvar geometry = new BufferGeometry();\r\n\t\t\tgeometry.setIndex( new BufferAttribute( meshData[ 'triangles' ], 1 ) );\r\n\t\t\tgeometry.setAttribute( 'position', new BufferAttribute( meshData[ 'vertices' ], 3 ) );\r\n\r\n\t\t\tvar material = new MeshPhongMaterial( { color: 0xaaaaff, flatShading: true } );\r\n\r\n\t\t\tvar mesh = new Mesh( geometry, material );\r\n\r\n\t\t\treturn mesh;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildMeshes( resourceMap, modelData, meshData, textureData, objectData ) {\r\n\r\n\t\t\tvar keys = Object.keys( resourceMap );\r\n\t\t\tvar meshes = [];\r\n\r\n\t\t\tfor ( var i = 0, il = keys.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar resourceId = keys[ i ];\r\n\t\t\t\tvar triangleProperties = resourceMap[ resourceId ];\r\n\t\t\t\tvar resourceType = getResourceType( resourceId, modelData );\r\n\r\n\t\t\t\tswitch ( resourceType ) {\r\n\r\n\t\t\t\t\tcase 'material':\r\n\t\t\t\t\t\tvar basematerials = modelData.resources.basematerials[ resourceId ];\r\n\t\t\t\t\t\tvar newMeshes = buildBasematerialsMeshes( basematerials, triangleProperties, modelData, meshData, textureData, objectData );\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = newMeshes.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tmeshes.push( newMeshes[ j ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'texture':\r\n\t\t\t\t\t\tvar texture2dgroup = modelData.resources.texture2dgroup[ resourceId ];\r\n\t\t\t\t\t\tmeshes.push( buildTexturedMesh( texture2dgroup, triangleProperties, modelData, meshData, textureData, objectData ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'vertexColors':\r\n\t\t\t\t\t\tvar colorgroup = modelData.resources.colorgroup[ resourceId ];\r\n\t\t\t\t\t\tmeshes.push( buildVertexColorMesh( colorgroup, triangleProperties, modelData, meshData, objectData ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'default':\r\n\t\t\t\t\t\tmeshes.push( buildDefaultMesh( meshData ) );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'THREE.3MFLoader: Unsupported resource type.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn meshes;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getResourceType( pid, modelData ) {\r\n\r\n\t\t\tif ( modelData.resources.texture2dgroup[ pid ] !== undefined ) {\r\n\r\n\t\t\t\treturn 'texture';\r\n\r\n\t\t\t} else if ( modelData.resources.basematerials[ pid ] !== undefined ) {\r\n\r\n\t\t\t\treturn 'material';\r\n\r\n\t\t\t} else if ( modelData.resources.colorgroup[ pid ] !== undefined ) {\r\n\r\n\t\t\t\treturn 'vertexColors';\r\n\r\n\t\t\t} else if ( pid === 'default' ) {\r\n\r\n\t\t\t\treturn 'default';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction analyzeObject( modelData, meshData, objectData ) {\r\n\r\n\t\t\tvar resourceMap = {};\r\n\r\n\t\t\tvar triangleProperties = meshData[ 'triangleProperties' ];\r\n\r\n\t\t\tvar objectPid = objectData.pid;\r\n\r\n\t\t\tfor ( var i = 0, l = triangleProperties.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar triangleProperty = triangleProperties[ i ];\r\n\t\t\t\tvar pid = ( triangleProperty.pid !== undefined ) ? triangleProperty.pid : objectPid;\r\n\r\n\t\t\t\tif ( pid === undefined ) pid = 'default';\r\n\r\n\t\t\t\tif ( resourceMap[ pid ] === undefined ) resourceMap[ pid ] = [];\r\n\r\n\t\t\t\tresourceMap[ pid ].push( triangleProperty );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn resourceMap;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildGroup( meshData, objects, modelData, textureData, objectData ) {\r\n\r\n\t\t\tvar group = new Group();\r\n\r\n\t\t\tvar resourceMap = analyzeObject( modelData, meshData, objectData );\r\n\t\t\tvar meshes = buildMeshes( resourceMap, modelData, meshData, textureData, objectData );\r\n\r\n\t\t\tfor ( var i = 0, l = meshes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tgroup.add( meshes[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn group;\r\n\r\n\t\t}\r\n\r\n\t\tfunction applyExtensions( extensions, meshData, modelXml ) {\r\n\r\n\t\t\tif ( ! extensions ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar availableExtensions = [];\r\n\t\t\tvar keys = Object.keys( extensions );\r\n\r\n\t\t\tfor ( var i = 0; i < keys.length; i ++ ) {\r\n\r\n\t\t\t\tvar ns = keys[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0; j < scope.availableExtensions.length; j ++ ) {\r\n\r\n\t\t\t\t\tvar extension = scope.availableExtensions[ j ];\r\n\r\n\t\t\t\t\tif ( extension.ns === ns ) {\r\n\r\n\t\t\t\t\t\tavailableExtensions.push( extension );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < availableExtensions.length; i ++ ) {\r\n\r\n\t\t\t\tvar extension = availableExtensions[ i ];\r\n\t\t\t\textension.apply( modelXml, extensions[ extension[ 'ns' ] ], meshData );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getBuild( data, objects, modelData, textureData, objectData, builder ) {\r\n\r\n\t\t\tif ( data.build !== undefined ) return data.build;\r\n\r\n\t\t\tdata.build = builder( data, objects, modelData, textureData, objectData );\r\n\r\n\t\t\treturn data.build;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildBasematerial( materialData, objects, modelData ) {\r\n\r\n\t\t\tvar material;\r\n\r\n\t\t\tvar displaypropertiesid = materialData.displaypropertiesid;\r\n\t\t\tvar pbmetallicdisplayproperties = modelData.resources.pbmetallicdisplayproperties;\r\n\r\n\t\t\tif ( displaypropertiesid !== null && pbmetallicdisplayproperties[ displaypropertiesid ] !== undefined ) {\r\n\r\n\t\t\t\t// metallic display property, use StandardMaterial\r\n\r\n\t\t\t\tvar pbmetallicdisplayproperty = pbmetallicdisplayproperties[ displaypropertiesid ];\r\n\t\t\t\tvar metallicData = pbmetallicdisplayproperty.data[ materialData.index ];\r\n\r\n\t\t\t\tmaterial = new MeshStandardMaterial( { flatShading: true, roughness: metallicData.roughness, metalness: metallicData.metallicness } );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// otherwise use PhongMaterial\r\n\r\n\t\t\t\tmaterial = new MeshPhongMaterial( { flatShading: true } );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterial.name = materialData.name;\r\n\r\n\t\t\t// displaycolor MUST be specified with a value of a 6 or 8 digit hexadecimal number, e.g. \"#RRGGBB\" or \"#RRGGBBAA\"\r\n\r\n\t\t\tvar displaycolor = materialData.displaycolor;\r\n\r\n\t\t\tvar color = displaycolor.substring( 0, 7 );\r\n\t\t\tmaterial.color.setStyle( color );\r\n\t\t\tmaterial.color.convertSRGBToLinear(); // displaycolor is in sRGB\r\n\r\n\t\t\t// process alpha if set\r\n\r\n\t\t\tif ( displaycolor.length === 9 ) {\r\n\r\n\t\t\t\tmaterial.opacity = parseInt( displaycolor.charAt( 7 ) + displaycolor.charAt( 8 ), 16 ) / 255;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildComposite( compositeData, objects, modelData, textureData ) {\r\n\r\n\t\t\tvar composite = new Group();\r\n\r\n\t\t\tfor ( var j = 0; j < compositeData.length; j ++ ) {\r\n\r\n\t\t\t\tvar component = compositeData[ j ];\r\n\t\t\t\tvar build = objects[ component.objectId ];\r\n\r\n\t\t\t\tif ( build === undefined ) {\r\n\r\n\t\t\t\t\tbuildObject( component.objectId, objects, modelData, textureData );\r\n\t\t\t\t\tbuild = objects[ component.objectId ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar object3D = build.clone();\r\n\r\n\t\t\t\t// apply component transform\r\n\r\n\t\t\t\tvar transform = component.transform;\r\n\r\n\t\t\t\tif ( transform ) {\r\n\r\n\t\t\t\t\tobject3D.applyMatrix4( transform );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcomposite.add( object3D );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn composite;\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildObject( objectId, objects, modelData, textureData ) {\r\n\r\n\t\t\tvar objectData = modelData[ 'resources' ][ 'object' ][ objectId ];\r\n\r\n\t\t\tif ( objectData[ 'mesh' ] ) {\r\n\r\n\t\t\t\tvar meshData = objectData[ 'mesh' ];\r\n\r\n\t\t\t\tvar extensions = modelData[ 'extensions' ];\r\n\t\t\t\tvar modelXml = modelData[ 'xml' ];\r\n\r\n\t\t\t\tapplyExtensions( extensions, meshData, modelXml );\r\n\r\n\t\t\t\tobjects[ objectData.id ] = getBuild( meshData, objects, modelData, textureData, objectData, buildGroup );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar compositeData = objectData[ 'components' ];\r\n\r\n\t\t\t\tobjects[ objectData.id ] = getBuild( compositeData, objects, modelData, textureData, objectData, buildComposite );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction buildObjects( data3mf ) {\r\n\r\n\t\t\tvar modelsData = data3mf.model;\r\n\t\t\tvar modelRels = data3mf.modelRels;\r\n\t\t\tvar objects = {};\r\n\t\t\tvar modelsKeys = Object.keys( modelsData );\r\n\t\t\tvar textureData = {};\r\n\r\n\t\t\t// evaluate model relationships to textures\r\n\r\n\t\t\tif ( modelRels ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = modelRels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar modelRel = modelRels[ i ];\r\n\t\t\t\t\tvar textureKey = modelRel.target.substring( 1 );\r\n\r\n\t\t\t\t\tif ( data3mf.texture[ textureKey ] ) {\r\n\r\n\t\t\t\t\t\ttextureData[ modelRel.target ] = data3mf.texture[ textureKey ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// start build\r\n\r\n\t\t\tfor ( var i = 0; i < modelsKeys.length; i ++ ) {\r\n\r\n\t\t\t\tvar modelsKey = modelsKeys[ i ];\r\n\t\t\t\tvar modelData = modelsData[ modelsKey ];\r\n\r\n\t\t\t\tvar objectIds = Object.keys( modelData[ 'resources' ][ 'object' ] );\r\n\r\n\t\t\t\tfor ( var j = 0; j < objectIds.length; j ++ ) {\r\n\r\n\t\t\t\t\tvar objectId = objectIds[ j ];\r\n\r\n\t\t\t\t\tbuildObject( objectId, objects, modelData, textureData );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn objects;\r\n\r\n\t\t}\r\n\r\n\t\tfunction build( objects, data3mf ) {\r\n\r\n\t\t\tvar group = new Group();\r\n\r\n\t\t\tvar relationship = data3mf[ 'rels' ][ 0 ];\r\n\t\t\tvar buildData = data3mf.model[ relationship[ 'target' ].substring( 1 ) ][ 'build' ];\r\n\r\n\t\t\tfor ( var i = 0; i < buildData.length; i ++ ) {\r\n\r\n\t\t\t\tvar buildItem = buildData[ i ];\r\n\t\t\t\tvar object3D = objects[ buildItem[ 'objectId' ] ];\r\n\r\n\t\t\t\t// apply transform\r\n\r\n\t\t\t\tvar transform = buildItem[ 'transform' ];\r\n\r\n\t\t\t\tif ( transform ) {\r\n\r\n\t\t\t\t\tobject3D.applyMatrix4( transform );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgroup.add( object3D );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn group;\r\n\r\n\t\t}\r\n\r\n\t\tvar data3mf = loadDocument( data );\r\n\t\tvar objects = buildObjects( data3mf );\r\n\r\n\t\treturn build( objects, data3mf );\r\n\r\n\t},\r\n\r\n\taddExtension: function ( extension ) {\r\n\r\n\t\tthis.availableExtensions.push( extension );\r\n\r\n\t}\r\n\r\n} );\r\n\r\nexport { ThreeMFLoader };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/jsm/loaders/3MFLoader.js"],"sourceRoot":""}