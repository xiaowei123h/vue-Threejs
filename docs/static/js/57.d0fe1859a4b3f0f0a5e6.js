webpackJsonp([57],{"5V+i":function(e,t){},KOGK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("wIBv"),i=r("6+nK");function a(e,t){this.lightProbe=e,this.size=t;var r=new i.ShaderMaterial({type:"LightProbeHelperMaterial",uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\tgl_FragColor = linearToOutputTexel( vec4( outgoingLight, 1.0 ) );","}"].join("\n")}),n=new i.SphereBufferGeometry(1,32,16);i.Mesh.call(this,n,r),this.type="LightProbeHelper",this.onBeforeRender()}a.prototype=Object.create(i.Mesh.prototype),a.prototype.constructor=a,a.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},a.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity};var s=r("RmjB"),o={data:function(){return{renderer:null,scene:null,camera:null,cubeCamera:null,lightProbe:null}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),document.getElementsByClassName("webglLightprobeCubecamera-container")[0].appendChild(this.renderer.domElement),this.renderer.outputEncoding=this.$THREE.sRGBEncoding,this.scene=new this.$THREE.Scene,this.camera=new this.$THREE.PerspectiveCamera(40,this.$webglInnerWidth/window.innerHeight,1,1e3),this.camera.position.set(0,0,30);var t=new this.$THREE.WebGLCubeRenderTarget(256,{encoding:this.$THREE.sRGBEncoding,format:this.$THREE.RGBAFormat});this.cubeCamera=new this.$THREE.CubeCamera(1,1e3,t);var r=new n.b(this.camera,this.renderer.domElement);r.addEventListener("change",this.render),r.minDistance=10,r.maxDistance=50,r.enablePan=!1,this.lightProbe=new this.$THREE.LightProbe,this.scene.add(this.lightProbe);var i,o,c=[(i="static/textures/cube/pisa/")+"px"+(o=".png"),i+"nx"+o,i+"py"+o,i+"ny"+o,i+"pz"+o,i+"nz"+o];(new this.$THREE.CubeTextureLoader).load(c,function(r){r.encoding=e.$THREE.sRGBEncoding,e.scene.background=r,e.cubeCamera.update(e.renderer,e.scene),e.lightProbe.copy(s.a.fromCubeRenderTarget(e.renderer,t)),e.scene.add(new a(e.lightProbe,5)),e.render()}),window.addEventListener("resize",this.onWindowResize,!1)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer),this.render()},render:function(){this.renderer.render(this.scene,this.camera)}}},c={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"webglLightprobeCubecamera-container"},[t("div",{attrs:{id:"info"}},[t("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[this._v("three.js")]),this._v(" webgl - light probe from cubeCamera\n\t\t")])])}]};var h=r("VU/8")(o,c,!1,function(e){r("5V+i")},"data-v-b395d3c6",null);t.default=h.exports},RmjB:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r("6+nK"),i={fromCubeTexture:function(e){for(var t,r,i,s=0,o=new n.Vector3,c=new n.Vector3,h=new n.Color,l=[0,0,0,0,0,0,0,0,0],d=new n.SphericalHarmonics3,u=d.coefficients,m=0;m<6;m++){var f=e.image[m],g=f.width,v=f.height,b=document.createElement("canvas");b.width=g,b.height=v;var p=b.getContext("2d");p.drawImage(f,0,0,g,v);for(var w=p.getImageData(0,0,g,v),y=w.data,R=w.width,E=2/R,C=0,x=y.length;C<x;C+=4){h.setRGB(y[C]/255,y[C+1]/255,y[C+2]/255),a(h,e.encoding);var P=C/4,z=(P%R+.5)*E-1,T=1-(Math.floor(P/R)+.5)*E;switch(m){case 0:o.set(-1,T,-z);break;case 1:o.set(1,T,z);break;case 2:o.set(-z,1,-T);break;case 3:o.set(-z,-1,T);break;case 4:o.set(-z,T,1);break;case 5:o.set(z,T,-1)}r=o.lengthSq(),s+=i=4/(Math.sqrt(r)*r),c.copy(o).normalize(),n.SphericalHarmonics3.getBasisAt(c,l);for(var L=0;L<9;L++)u[L].x+=l[L]*h.r*i,u[L].y+=l[L]*h.g*i,u[L].z+=l[L]*h.b*i}}t=4*Math.PI/s;for(L=0;L<9;L++)u[L].x*=t,u[L].y*=t,u[L].z*=t;return new n.LightProbe(d)},fromCubeRenderTarget:function(e,t){for(var r,i,s,o=0,c=new n.Vector3,h=new n.Vector3,l=new n.Color,d=[0,0,0,0,0,0,0,0,0],u=new n.SphericalHarmonics3,m=u.coefficients,f=0;f<6;f++){var g=t.width,v=new Uint8Array(g*g*4);e.readRenderTargetPixels(t,0,0,g,g,v,f);for(var b=2/g,p=0,w=v.length;p<w;p+=4){l.setRGB(v[p]/255,v[p+1]/255,v[p+2]/255),a(l,t.texture.encoding);var y=p/4,R=(y%g+.5)*b-1,E=1-(Math.floor(y/g)+.5)*b;switch(f){case 0:c.set(1,E,-R);break;case 1:c.set(-1,E,R);break;case 2:c.set(R,1,-E);break;case 3:c.set(R,-1,E);break;case 4:c.set(R,E,1);break;case 5:c.set(-R,E,-1)}i=c.lengthSq(),o+=s=4/(Math.sqrt(i)*i),h.copy(c).normalize(),n.SphericalHarmonics3.getBasisAt(h,d);for(var C=0;C<9;C++)m[C].x+=d[C]*l.r*s,m[C].y+=d[C]*l.g*s,m[C].z+=d[C]*l.b*s}}r=4*Math.PI/o;for(C=0;C<9;C++)m[C].x*=r,m[C].y*=r,m[C].z*=r;return new n.LightProbe(u)}},a=function(e,t){switch(t){case n.sRGBEncoding:e.convertSRGBToLinear();break;case n.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.")}return e}}});
//# sourceMappingURL=57.d0fe1859a4b3f0f0a5e6.js.map