webpackJsonp([61],{eJ0D:function(t,e,i){"use strict";var n=i("6+nK"),r=function(){var t,e,i,r,s=0,o=new n.Vector3;function a(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new u,this.unassigned=new u,this.vertices=[]}function c(){this.normal=new n.Vector3,this.midpoint=new n.Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=s,this.edge=null}function h(t,e){this.vertex=t,this.prev=null,this.next=null,this.twin=null,this.face=e}function l(t){this.point=t,this.prev=null,this.next=null,this.face=null}function u(){this.head=null,this.tail=null}return Object.assign(a.prototype,{setFromPoints:function(t){!0!==Array.isArray(t)&&console.error("THREE.ConvexHull: Points parameter is not an array."),t.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.vertices.push(new l(t[e]));return this.compute(),this},setFromObject:function(t){var e=[];return t.updateMatrixWorld(!0),t.traverse(function(t){var i,r,s,o=t.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(i=0,r=a.length;i<r;i++)(s=a[i].clone()).applyMatrix4(t.matrixWorld),e.push(s)}else if(o.isBufferGeometry){var c=o.attributes.position;if(void 0!==c)for(i=0,r=c.count;i<r;i++)(s=new n.Vector3).fromBufferAttribute(c,i).applyMatrix4(t.matrixWorld),e.push(s)}}),this.setFromPoints(e)},containsPoint:function(t){for(var e=this.faces,i=0,n=e.length;i<n;i++){if(e[i].distanceToPoint(t)>this.tolerance)return!1}return!0},intersectRay:function(t,e){for(var i=this.faces,n=-1/0,r=1/0,s=0,o=i.length;s<o;s++){var a=i[s],c=a.distanceToPoint(t.origin),h=a.normal.dot(t.direction);if(c>0&&h>=0)return null;var l=0!==h?-c/h:0;if(!(l<=0)&&(h>0?r=Math.min(l,r):n=Math.max(l,n),n>r))return null}return n!==-1/0?t.at(n,e):t.at(r,e),e},intersectsRay:function(t){return null!==this.intersectRay(t,o)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(t,e){return t.face=e,null===e.outside?this.assigned.append(t):this.assigned.insertBefore(e.outside,t),e.outside=t,this},removeVertexFromFace:function(t,e){return t===e.outside&&(null!==t.next&&t.next.face===e?e.outside=t.next:e.outside=null),this.assigned.remove(t),this},removeAllVerticesFromFace:function(t){if(null!==t.outside){for(var e=t.outside,i=t.outside;null!==i.next&&i.next.face===t;)i=i.next;return this.assigned.removeSubList(e,i),e.prev=i.next=null,t.outside=null,e}},deleteFaceVertices:function(t,e){var i=this.removeAllVerticesFromFace(t);if(void 0!==i)if(void 0===e)this.unassigned.appendChain(i);else{var n=i;do{var r=n.next;e.distanceToPoint(n.point)>this.tolerance?this.addVertexToFace(n,e):this.unassigned.append(n),n=r}while(null!==n)}return this},resolveUnassignedPoints:function(t){if(!1===this.unassigned.isEmpty()){var e=this.unassigned.first();do{for(var i=e.next,n=this.tolerance,r=null,o=0;o<t.length;o++){var a=t[o];if(a.mark===s){var c=a.distanceToPoint(e.point);if(c>n&&(n=c,r=a),n>1e3*this.tolerance)break}}null!==r&&this.addVertexToFace(e,r),e=i}while(null!==e)}return this},computeExtremes:function(){var t,e,i,r=new n.Vector3,s=new n.Vector3,o=[],a=[];for(t=0;t<3;t++)o[t]=a[t]=this.vertices[0];for(r.copy(this.vertices[0].point),s.copy(this.vertices[0].point),t=0,e=this.vertices.length;t<e;t++){var c=this.vertices[t],h=c.point;for(i=0;i<3;i++)h.getComponent(i)<r.getComponent(i)&&(r.setComponent(i,h.getComponent(i)),o[i]=c);for(i=0;i<3;i++)h.getComponent(i)>s.getComponent(i)&&(s.setComponent(i,h.getComponent(i)),a[i]=c)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(r.x),Math.abs(s.x))+Math.max(Math.abs(r.y),Math.abs(s.y))+Math.max(Math.abs(r.z),Math.abs(s.z))),{min:o,max:a}},computeInitialHull:function(){void 0===t&&(t=new n.Line3,e=new n.Plane,i=new n.Vector3);var r,s,o,a,h,l,u,m,p,d=this.vertices,f=this.computeExtremes(),v=f.min,g=f.max,y=0,w=0;for(l=0;l<3;l++)(p=g[l].point.getComponent(l)-v[l].point.getComponent(l))>y&&(y=p,w=l);for(s=v[w],o=g[w],y=0,t.set(s.point,o.point),l=0,u=this.vertices.length;l<u;l++)(r=d[l])!==s&&r!==o&&(t.closestPointToPoint(r.point,!0,i),(p=i.distanceToSquared(r.point))>y&&(y=p,a=r));for(y=-1,e.setFromCoplanarPoints(s.point,o.point,a.point),l=0,u=this.vertices.length;l<u;l++)(r=d[l])!==s&&r!==o&&r!==a&&(p=Math.abs(e.distanceToPoint(r.point)))>y&&(y=p,h=r);var b=[];if(e.distanceToPoint(h.point)<0)for(b.push(c.create(s,o,a),c.create(h,o,s),c.create(h,a,o),c.create(h,s,a)),l=0;l<3;l++)m=(l+1)%3,b[l+1].getEdge(2).setTwin(b[0].getEdge(m)),b[l+1].getEdge(1).setTwin(b[m+1].getEdge(0));else for(b.push(c.create(s,a,o),c.create(h,s,o),c.create(h,o,a),c.create(h,a,s)),l=0;l<3;l++)m=(l+1)%3,b[l+1].getEdge(2).setTwin(b[0].getEdge((3-l)%3)),b[l+1].getEdge(0).setTwin(b[m+1].getEdge(1));for(l=0;l<4;l++)this.faces.push(b[l]);for(l=0,u=d.length;l<u;l++)if((r=d[l])!==s&&r!==o&&r!==a&&r!==h){y=this.tolerance;var x=null;for(m=0;m<4;m++)(p=this.faces[m].distanceToPoint(r.point))>y&&(y=p,x=this.faces[m]);null!==x&&this.addVertexToFace(r,x)}return this},reindexFaces:function(){for(var t=[],e=0;e<this.faces.length;e++){var i=this.faces[e];i.mark===s&&t.push(i)}return this.faces=t,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var t,e=0,i=this.assigned.first().face,n=i.outside;do{var r=i.distanceToPoint(n.point);r>e&&(e=r,t=n),n=n.next}while(null!==n&&n.face===i);return t}},computeHorizon:function(t,e,i,n){var r;this.deleteFaceVertices(i),i.mark=1,r=null===e?e=i.getEdge(0):e.next;do{var o=r.twin,a=o.face;a.mark===s&&(a.distanceToPoint(t)>this.tolerance?this.computeHorizon(t,o,a,n):n.push(r)),r=r.next}while(r!==e);return this},addAdjoiningFace:function(t,e){var i=c.create(t,e.tail(),e.head());return this.faces.push(i),i.getEdge(-1).setTwin(e.twin),i.getEdge(0)},addNewFaces:function(t,e){this.newFaces=[];for(var i=null,n=null,r=0;r<e.length;r++){var s=e[r],o=this.addAdjoiningFace(t,s);null===i?i=o:o.next.setTwin(n),this.newFaces.push(o.face),n=o}return i.next.setTwin(n),this},addVertexToHull:function(t){var e=[];return this.unassigned.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,e),this.addNewFaces(t,e),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var t;for(this.computeInitialHull();void 0!==(t=this.nextVertexToAdd());)this.addVertexToHull(t);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(c,{create:function(t,e,i){var n=new c,r=new h(t,n),s=new h(e,n),o=new h(i,n);return r.next=o.prev=s,s.next=r.prev=o,o.next=s.prev=r,n.edge=r,n.compute()}}),Object.assign(c.prototype,{getEdge:function(t){for(var e=this.edge;t>0;)e=e.next,t--;for(;t<0;)e=e.prev,t++;return e},compute:function(){void 0===r&&(r=new n.Triangle);var t=this.edge.tail(),e=this.edge.head(),i=this.edge.next.head();return r.set(t.point,e.point,i.point),r.getNormal(this.normal),r.getMidpoint(this.midpoint),this.area=r.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(t){return this.normal.dot(t)-this.constant}}),Object.assign(h.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var t=this.head(),e=this.tail();return null!==e?e.point.distanceTo(t.point):-1},lengthSquared:function(){var t=this.head(),e=this.tail();return null!==e?e.point.distanceToSquared(t.point):-1},setTwin:function(t){return this.twin=t,t.twin=this,this}}),Object.assign(u.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(t,e){return e.prev=t.prev,e.next=t,null===e.prev?this.head=e:e.prev.next=e,t.prev=e,this},insertAfter:function(t,e){return e.prev=t,e.next=t.next,null===e.next?this.tail=e:e.next.prev=e,t.next=e,this},append:function(t){return null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t,this},appendChain:function(t){for(null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail;null!==t.next;)t=t.next;return this.tail=t,this},remove:function(t){return null===t.prev?this.head=t.next:t.prev.next=t.next,null===t.next?this.tail=t.prev:t.next.prev=t.prev,this},removeSubList:function(t,e){return null===t.prev?this.head=e.next:t.prev.next=e.next,null===e.next?this.tail=t.prev:e.next.prev=t.prev,this},isEmpty:function(){return null===this.head}}),a}();i.d(e,"a",function(){return o});var s=function(t){n.Geometry.call(this),this.fromBufferGeometry(new o(t)),this.mergeVertices()};(s.prototype=Object.create(n.Geometry.prototype)).constructor=s;var o=function(t){n.BufferGeometry.call(this);var e=[],i=[];void 0===r&&console.error("THREE.ConvexBufferGeometry: ConvexBufferGeometry relies on ConvexHull");for(var s=(new r).setFromPoints(t).faces,o=0;o<s.length;o++){var a=s[o],c=a.edge;do{var h=c.head().point;e.push(h.x,h.y,h.z),i.push(a.normal.x,a.normal.y,a.normal.z),c=c.next}while(c!==a.edge)}this.setAttribute("position",new n.Float32BufferAttribute(e,3)),this.setAttribute("normal",new n.Float32BufferAttribute(i,3))};o.prototype=Object.create(n.BufferGeometry.prototype),o.prototype.constructor=o},j3GM:function(t,e){},j9eG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r=i("wIBv"),s=i("6+nK"),o=i("eJ0D"),a=function(t,e){this.minSizeForBreak=t||1.4,this.smallDelta=e||1e-4,this.tempLine1=new s.Line3,this.tempPlane1=new s.Plane,this.tempPlane2=new s.Plane,this.tempPlane_Cut=new s.Plane,this.tempCM1=new s.Vector3,this.tempCM2=new s.Vector3,this.tempVector3=new s.Vector3,this.tempVector3_2=new s.Vector3,this.tempVector3_3=new s.Vector3,this.tempVector3_P0=new s.Vector3,this.tempVector3_P1=new s.Vector3,this.tempVector3_P2=new s.Vector3,this.tempVector3_N0=new s.Vector3,this.tempVector3_N1=new s.Vector3,this.tempVector3_AB=new s.Vector3,this.tempVector3_CB=new s.Vector3,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var i=0;i<900;i++)this.segments[i]=!1};a.prototype={constructor:a,prepareBreakableObject:function(t,e,i,n,r){t.geometry.isBufferGeometry||console.error("THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.");var s=t.userData;s.mass=e,s.velocity=i.clone(),s.angularVelocity=n.clone(),s.breakable=r},subdivideByImpact:function(t,e,i,n,r){var s=[],o=this.tempPlane1,a=this.tempPlane2;this.tempVector3.addVectors(e,i),o.setFromCoplanarPoints(e,t.position,this.tempVector3);var c=r+n,h=this;return function r(l,u,m,p){if(Math.random()<.05*p||p>c)s.push(l);else{var d=Math.PI;0===p?(a.normal.copy(o.normal),a.constant=o.constant):p<=n?(d=(m-u)*(.2+.6*Math.random())+u,h.tempVector3_2.copy(t.position).sub(e).applyAxisAngle(i,d).add(e),a.setFromCoplanarPoints(e,h.tempVector3,h.tempVector3_2)):(d=(.5*(1&p)+.2*(2-Math.random()))*Math.PI,h.tempVector3_2.copy(e).sub(l.position).applyAxisAngle(i,d).add(l.position),h.tempVector3_3.copy(i).add(l.position),a.setFromCoplanarPoints(l.position,h.tempVector3_3,h.tempVector3_2)),h.cutByPlane(l,a,h.tempResultObjects);var f=h.tempResultObjects.object1,v=h.tempResultObjects.object2;f&&r(f,u,d,p+1),v&&r(v,d,m,p+1)}}(t,0,2*Math.PI,0),s},cutByPlane:function(t,e,i){var n=t.geometry,r=n.attributes.position.array,c=n.attributes.normal.array,h=r.length/3,l=h/3,u=n.getIndex();function m(t,e){var i=3*t+e;return u?u[i]:i}u&&(l=(u=u.array).length/3);for(var p=[],d=[],f=this.smallDelta,v=h*h,g=0;g<v;g++)this.segments[g]=!1;var y=this.tempVector3_P0,w=this.tempVector3_P1,b=this.tempVector3_N0,x=this.tempVector3_N1;for(g=0;g<l-1;g++){var E=m(g,0),V=m(g,1),T=m(g,2);b.set(c[E],c[E]+1,c[E]+2);for(var R=g+1;R<l;R++){var P=m(R,0),B=m(R,1),M=m(R,2);x.set(c[P],c[P]+1,c[P]+2),1-b.dot(x)<f&&(E===P||E===B||E===M?V===P||V===B||V===M?(this.segments[E*h+V]=!0,this.segments[V*h+E]=!0):(this.segments[T*h+E]=!0,this.segments[E*h+T]=!0):V!==P&&V!==B&&V!==M||(this.segments[T*h+V]=!0,this.segments[V*h+T]=!0))}}var C=this.tempPlane_Cut;t.updateMatrix(),a.transformPlaneToLocalSpace(e,t.matrix,C);for(g=0;g<l;g++)for(var A=m(g,0),j=m(g,1),H=m(g,2),O=0;O<3;O++){var F=0===O?A:1===O?j:H,$=0===O?j:1===O?H:A;if(!this.segments[F*h+$]){this.segments[F*h+$]=!0,this.segments[$*h+F]=!0,y.set(r[3*F],r[3*F+1],r[3*F+2]),w.set(r[3*$],r[3*$+1],r[3*$+2]);var z=0;(k=C.distanceToPoint(y))>f?(z=2,d.push(y.clone())):k<-f?(z=1,p.push(y.clone())):(z=3,p.push(y.clone()),d.push(y.clone()));var k,D=0;if((k=C.distanceToPoint(w))>f?(D=2,d.push(w.clone())):k<-f?(D=1,p.push(w.clone())):(D=3,p.push(w.clone()),d.push(w.clone())),1===z&&2===D||2===z&&1===D){this.tempLine1.start.copy(y),this.tempLine1.end.copy(w);var S=new s.Vector3;if(void 0===(S=C.intersectLine(this.tempLine1,S)))return console.error("Internal error: segment does not intersect plane."),i.segmentedObject1=null,i.segmentedObject2=null,0;p.push(S),d.push(S.clone())}}}var _=.5*t.userData.mass;this.tempCM1.set(0,0,0);var q=0,I=p.length;if(I>0){for(g=0;g<I;g++)this.tempCM1.add(p[g]);this.tempCM1.divideScalar(I);for(g=0;g<I;g++){(G=p[g]).sub(this.tempCM1),q=Math.max(q,G.x,G.y,G.z)}this.tempCM1.add(t.position)}this.tempCM2.set(0,0,0);var L=0,W=d.length;if(W>0){for(g=0;g<W;g++)this.tempCM2.add(d[g]);this.tempCM2.divideScalar(W);for(g=0;g<W;g++){var G;(G=d[g]).sub(this.tempCM2),L=Math.max(L,G.x,G.y,G.z)}this.tempCM2.add(t.position)}var N=null,U=null,J=0;return I>4&&((N=new s.Mesh(new o.a(p),t.material)).position.copy(this.tempCM1),N.quaternion.copy(t.quaternion),this.prepareBreakableObject(N,_,t.userData.velocity,t.userData.angularVelocity,2*q>this.minSizeForBreak),J++),W>4&&((U=new s.Mesh(new o.a(d),t.material)).position.copy(this.tempCM2),U.quaternion.copy(t.quaternion),this.prepareBreakableObject(U,_,t.userData.velocity,t.userData.angularVelocity,2*L>this.minSizeForBreak),J++),i.object1=N,i.object2=U,J}},a.transformFreeVector=function(t,e){var i=t.x,n=t.y,r=t.z,s=e.elements;return t.x=s[0]*i+s[4]*n+s[8]*r,t.y=s[1]*i+s[5]*n+s[9]*r,t.z=s[2]*i+s[6]*n+s[10]*r,t},a.transformFreeVectorInverse=function(t,e){var i=t.x,n=t.y,r=t.z,s=e.elements;return t.x=s[0]*i+s[1]*n+s[2]*r,t.y=s[4]*i+s[5]*n+s[6]*r,t.z=s[8]*i+s[9]*n+s[10]*r,t},a.transformTiedVectorInverse=function(t,e){var i=t.x,n=t.y,r=t.z,s=e.elements;return t.x=s[0]*i+s[1]*n+s[2]*r-s[12],t.y=s[4]*i+s[5]*n+s[6]*r-s[13],t.z=s[8]*i+s[9]*n+s[10]*r-s[14],t},a.transformPlaneToLocalSpace=(n=new s.Vector3,function(t,e,i){i.normal.copy(t.normal),i.constant=t.constant;var r=a.transformTiedVectorInverse(t.coplanarPoint(n),e);a.transformFreeVectorInverse(i.normal,e),i.constant=-r.dot(i.normal)});var c={data:function(){return{container:null,stats:null,camera:null,controls:null,scene:null,renderer:null,textureLoader:null,clock:null,mouseCoords:null,raycaster:null,ballMaterial:null,gravityConstant:7.8,collisionConfiguration:null,dispatcher:null,broadphase:null,solver:null,physicsWorld:null,margin:.05,convexBreaker:null,rigidBodies:[],pos:null,quat:null,transformAux1:null,tempBtVec3_1:null,objectsToRemove:[],numObjectsToRemove:0,impactPoint:null,impactNormal:null}},mounted:function(){var t=this;this.clock=new this.$THREE.Clock,this.mouseCoords=new this.$THREE.Vector2,this.raycaster=new this.$THREE.Raycaster,this.ballMaterial=new this.$THREE.MeshPhongMaterial({color:2105376}),this.convexBreaker=new a,this.pos=new this.$THREE.Vector3,this.quat=new this.$THREE.Quaternion;for(var e=0;e<500;e++)this.objectsToRemove[e]=null;this.impactPoint=new this.$THREE.Vector3,this.impactNormal=new this.$THREE.Vector3,this.$nextTick(function(){Ammo().then(function(e){Ammo=e,t.init(),t.animate()})})},methods:{init:function(){this.initGraphics(),this.initPhysics(),this.createObjects(),this.initInput()},initGraphics:function(){this.container=document.getElementById("container"),this.camera=new this.$THREE.PerspectiveCamera(60,this.$webglInnerWidth/window.innerHeight,.2,2e3),this.scene=new this.$THREE.Scene,this.scene.background=new this.$THREE.Color(12571109),this.camera.position.set(-14,8,16),this.renderer=new this.$THREE.WebGLRenderer,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.container.appendChild(this.renderer.domElement),this.controls=new r.b(this.camera,this.renderer.domElement),this.controls.target.set(0,2,0),this.controls.update(),this.textureLoader=new this.$THREE.TextureLoader;var t=new this.$THREE.AmbientLight(7368816);this.scene.add(t);var e=new this.$THREE.DirectionalLight(16777215,1);e.position.set(-10,18,5),e.castShadow=!0;e.shadow.camera.left=-14,e.shadow.camera.right=14,e.shadow.camera.top=14,e.shadow.camera.bottom=-14,e.shadow.camera.near=2,e.shadow.camera.far=50,e.shadow.mapSize.x=1024,e.shadow.mapSize.y=1024,this.scene.add(e),this.stats=new this.$Stats,this.stats.dom.style.left="280px",this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",this.container.appendChild(this.stats.domElement),window.addEventListener("resize",this.onWindowResize,!1)},initPhysics:function(){this.collisionConfiguration=new Ammo.btDefaultCollisionConfiguration,this.dispatcher=new Ammo.btCollisionDispatcher(this.collisionConfiguration),this.broadphase=new Ammo.btDbvtBroadphase,this.solver=new Ammo.btSequentialImpulseConstraintSolver,this.physicsWorld=new Ammo.btDiscreteDynamicsWorld(this.dispatcher,this.broadphase,this.solver,this.collisionConfiguration),this.physicsWorld.setGravity(new Ammo.btVector3(0,-this.gravityConstant,0)),this.transformAux1=new Ammo.btTransform,this.tempBtVec3_1=new Ammo.btVector3(0,0,0)},createObject:function(t,e,i,n,r){var s=new this.$THREE.Mesh(new this.$THREE.BoxBufferGeometry(2*e.x,2*e.y,2*e.z),r);s.position.copy(i),s.quaternion.copy(n),this.convexBreaker.prepareBreakableObject(s,t,new this.$THREE.Vector3,new this.$THREE.Vector3,!0),this.createDebrisFromBreakableObject(s)},createObjects:function(){var t=this;this.pos.set(0,-.5,0),this.quat.set(0,0,0,1);var e=this.createParalellepipedWithPhysics(40,1,40,0,this.pos,this.quat,new this.$THREE.MeshPhongMaterial({color:16777215}));e.receiveShadow=!0,this.textureLoader.load("static/textures/grid.png",function(i){i.wrapS=t.$THREE.RepeatWrapping,i.wrapT=t.$THREE.RepeatWrapping,i.repeat.set(40,40),e.material.map=i,e.material.needsUpdate=!0});var i=new this.$THREE.Vector3(2,5,2);this.pos.set(-8,5,0),this.quat.set(0,0,0,1),this.createObject(1e3,i,this.pos,this.quat,this.createMaterial(11546644)),this.pos.set(8,5,0),this.quat.set(0,0,0,1),this.createObject(1e3,i,this.pos,this.quat,this.createMaterial(11547156));var n=new this.$THREE.Vector3(7,.2,1.5);this.pos.set(0,10.2,0),this.quat.set(0,0,0,1),this.createObject(100,n,this.pos,this.quat,this.createMaterial(11778149));var r=new this.$THREE.Vector3(1,2,.15);this.quat.set(0,0,0,1);for(var s=0;s<8;s++)this.pos.set(0,2,15*(.5-s/9)),this.createObject(120,r,this.pos,this.quat,this.createMaterial(11579568));var a=new this.$THREE.Vector3(4,5,4);this.pos.set(5,.5*a.y,-7),this.quat.set(0,0,0,1);var c=[];c.push(new this.$THREE.Vector3(a.x,-a.y,a.z)),c.push(new this.$THREE.Vector3(-a.x,-a.y,a.z)),c.push(new this.$THREE.Vector3(a.x,-a.y,-a.z)),c.push(new this.$THREE.Vector3(-a.x,-a.y,-a.z)),c.push(new this.$THREE.Vector3(0,a.y,0));var h=new this.$THREE.Mesh(new o.a(c),this.createMaterial(11548692));h.position.copy(this.pos),h.quaternion.copy(this.quat),this.convexBreaker.prepareBreakableObject(h,860,new this.$THREE.Vector3,new this.$THREE.Vector3,!0),this.createDebrisFromBreakableObject(h)},createParalellepipedWithPhysics:function(t,e,i,n,r,s,o){var a=new this.$THREE.Mesh(new this.$THREE.BoxBufferGeometry(t,e,i,1,1,1),o),c=new Ammo.btBoxShape(new Ammo.btVector3(.5*t,.5*e,.5*i));return c.setMargin(this.margin),this.createRigidBody(a,c,n,r,s),a},createDebrisFromBreakableObject:function(t){t.castShadow=!0,t.receiveShadow=!0;var e=this.createConvexHullPhysicsShape(t.geometry.attributes.position.array);e.setMargin(this.margin);var i=this.createRigidBody(t,e,t.userData.mass,null,null,t.userData.velocity,t.userData.angularVelocity),n=new Ammo.btVector3(0,0,0);n.threeObject=t,i.setUserPointer(n)},removeDebris:function(t){this.scene.remove(t),this.physicsWorld.removeRigidBody(t.userData.physicsBody)},createConvexHullPhysicsShape:function(t){for(var e=new Ammo.btConvexHullShape,i=0,n=t.length;i<n;i+=3){this.tempBtVec3_1.setValue(t[i],t[i+1],t[i+2]);var r=i>=n-3;e.addPoint(this.tempBtVec3_1,r)}return e},createRigidBody:function(t,e,i,n,r,s,o){n?t.position.copy(n):n=t.position,r?t.quaternion.copy(r):r=t.quaternion;var a=new Ammo.btTransform;a.setIdentity(),a.setOrigin(new Ammo.btVector3(n.x,n.y,n.z)),a.setRotation(new Ammo.btQuaternion(r.x,r.y,r.z,r.w));var c=new Ammo.btDefaultMotionState(a),h=new Ammo.btVector3(0,0,0);e.calculateLocalInertia(i,h);var l=new Ammo.btRigidBodyConstructionInfo(i,c,e,h),u=new Ammo.btRigidBody(l);return u.setFriction(.5),s&&u.setLinearVelocity(new Ammo.btVector3(s.x,s.y,s.z)),o&&u.setAngularVelocity(new Ammo.btVector3(o.x,o.y,o.z)),t.userData.physicsBody=u,t.userData.collided=!1,this.scene.add(t),i>0&&(this.rigidBodies.push(t),u.setActivationState(4)),this.physicsWorld.addRigidBody(u),u},createRandomColor:function(){return Math.floor(Math.random()*(1<<24))},createMaterial:function(t){return t=t||createRandomColor(),new this.$THREE.MeshPhongMaterial({color:t})},initInput:function(){var t=this;window.addEventListener("pointerdown",function(e){t.mouseCoords.set(e.clientX/(window.innerWidth+281)*2-1,-e.clientY/window.innerHeight*2+1),t.raycaster.setFromCamera(t.mouseCoords,t.camera);var i=new t.$THREE.Mesh(new t.$THREE.SphereBufferGeometry(.4,14,10),t.ballMaterial);i.castShadow=!0,i.receiveShadow=!0;var n=new Ammo.btSphereShape(.4);n.setMargin(t.margin),t.pos.copy(t.raycaster.ray.direction),t.pos.add(t.raycaster.ray.origin),t.quat.set(0,0,0,1);var r=t.createRigidBody(i,n,35,t.pos,t.quat);t.pos.copy(t.raycaster.ray.direction),t.pos.multiplyScalar(24),r.setLinearVelocity(new Ammo.btVector3(t.pos.x,t.pos.y,t.pos.z))},!1)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate),this.render(),this.stats.update()},render:function(){var t=this.clock.getDelta();this.updatePhysics(t),this.renderer.render(this.scene,this.camera)},updatePhysics:function(t){this.physicsWorld.stepSimulation(t,10);for(var e=0,i=this.rigidBodies.length;e<i;e++){var n=this.rigidBodies[e],r=n.userData.physicsBody.getMotionState();if(r){r.getWorldTransform(this.transformAux1);var s=this.transformAux1.getOrigin(),o=this.transformAux1.getRotation();n.position.set(s.x(),s.y(),s.z()),n.quaternion.set(o.x(),o.y(),o.z(),o.w()),n.userData.collided=!1}}for(e=0,i=this.dispatcher.getNumManifolds();e<i;e++){var a=this.dispatcher.getManifoldByIndexInternal(e),c=Ammo.castObject(a.getBody0(),Ammo.btRigidBody),h=Ammo.castObject(a.getBody1(),Ammo.btRigidBody),l=Ammo.castObject(c.getUserPointer(),Ammo.btVector3).threeObject,u=Ammo.castObject(h.getUserPointer(),Ammo.btVector3).threeObject;if(l||u){var m=l?l.userData:null,p=u?u.userData:null,d=!!m&&m.breakable,f=!!p&&p.breakable,v=!!m&&m.collided,g=!!p&&p.collided;if(!(!d&&!f||v&&g)){for(var y=!1,w=0,b=0,x=a.getNumContacts();b<x;b++){var E=a.getContactPoint(b);if(E.getDistance()<0){y=!0;var V=E.getAppliedImpulse();if(V>w){w=V;var T=E.get_m_positionWorldOnB(),R=E.get_m_normalWorldOnB();this.impactPoint.set(T.x(),T.y(),T.z()),this.impactNormal.set(R.x(),R.y(),R.z())}break}}if(y){if(d&&!v&&w>250){var P=(C=this.convexBreaker.subdivideByImpact(l,this.impactPoint,this.impactNormal,1,2,1.5)).length;for(b=0;b<P;b++){var B=c.getLinearVelocity(),M=c.getAngularVelocity();(A=C[b]).userData.velocity.set(B.x(),B.y(),B.z()),A.userData.angularVelocity.set(M.x(),M.y(),M.z()),this.createDebrisFromBreakableObject(A)}this.objectsToRemove[this.numObjectsToRemove++]=l,m.collided=!0}if(f&&!g&&w>250){var C;for(P=(C=this.convexBreaker.subdivideByImpact(u,this.impactPoint,this.impactNormal,1,2,1.5)).length,b=0;b<P;b++){var A;B=h.getLinearVelocity(),M=h.getAngularVelocity();(A=C[b]).userData.velocity.set(B.x(),B.y(),B.z()),A.userData.angularVelocity.set(M.x(),M.y(),M.z()),this.createDebrisFromBreakableObject(A)}this.objectsToRemove[this.numObjectsToRemove++]=u,p.collided=!0}}}}}for(e=0;e<this.numObjectsToRemove;e++)this.removeDebris(this.objectsToRemove[e]);this.numObjectsToRemove=0}}},h={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"physicsAmmoBreak-container"},[e("div",{attrs:{id:"info"}},[this._v("Physics threejs demo with convex objects breaking in real time"),e("br"),this._v("Press mouse to throw balls and move the camera.")]),this._v(" "),e("div",{attrs:{id:"container"}})])}]};var l=i("VU/8")(c,h,!1,function(t){i("j3GM")},"data-v-14638748",null);e.default=l.exports}});
//# sourceMappingURL=61.9e10f0ef3a860073ae45.js.map