webpackJsonp([76],{g9KI:function(t,i){},nWpj:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});s("Ml+6");function e(t,i){return function(s,e,n){var h=(s-.5)*t,o=(e+.5)*i;n.set(h,o,0)}}function n(t,i,s,e,n,o,a){t=t||10,i=i||10,this.w=t,this.h=i;for(var r=[],l=[],c=0;c<=i;c++)for(var p=0;p<=t;p++)r.push(new h(p/t,c/i,0,s,e,o,a));for(var d=0;d<i;d++)for(var u=0;u<t;u++)l.push([r[g(u,d)],r[g(u,d+1)],n]),l.push([r[g(u,d)],r[g(u+1,d)],n]);for(var m=t,E=0;E<i;E++)l.push([r[g(m,E)],r[g(m,E+1)],n]);for(var w=i,f=0;f<t;f++)l.push([r[g(f,w)],r[g(f+1,w)],n]);function g(i,s){return i+s*(t+1)}this.particles=r,this.constraints=l,this.index=g}function h(t,i,s,e,n,h,o){this.position=new n.Vector3,this.previous=new n.Vector3,this.original=new n.Vector3,this.a=new n.Vector3(0,0,0),this.mass=e,this.DRAG=h,this.invMass=1/e,this.tmp=new n.Vector3,this.tmp2=new n.Vector3,o(t,i,this.position),o(t,i,this.previous),o(t,i,this.original)}h.prototype.addForce=function(t){this.a.add(this.tmp2.copy(t).multiplyScalar(this.invMass))},h.prototype.integrate=function(t){var i=this.tmp.subVectors(this.position,this.previous);i.multiplyScalar(this.DRAG).add(this.position),i.add(this.a.multiplyScalar(t)),this.tmp=this.previous,this.previous=this.position,this.position=i,this.a.set(0,0,0)};var o=s("QEtz"),a=s("wIBv"),r={data:function(){return{params:{enableWind:!0,showBall:!1,togglePins:this.togglePins},DAMPING:.03,DRAG:null,MASS:.1,restDistance:25,xSegs:10,ySegs:10,clothFunction:null,cloth:null,GRAVITY:981*1.4,gravity:null,TIMESTEP:.018,TIMESTEP_SQ:null,pins:[],windForce:null,ballPosition:null,ballSize:60,tmpForce:null,pinsFormation:[],diff:null,clothGeometry:null,sphere:null,container:null,stats:null,camera:null,scene:null,renderer:null,object:null,il:null,constraints:null,gui:null}},mounted:function(){this.DRAG=1-this.DAMPING,this.clothFunction=e(this.restDistance*this.xSegs,this.restDistance*this.ySegs),this.cloth=new n(this.xSegs,this.ySegs,this.MASS,this.$THREE,this.restDistance,this.DRAG,this.clothFunction),this.gravity=new this.$THREE.Vector3(0,-this.GRAVITY,0).multiplyScalar(this.MASS),this.TIMESTEP_SQ=this.TIMESTEP*this.TIMESTEP,this.windForce=new this.$THREE.Vector3(0,0,0),this.ballPosition=new this.$THREE.Vector3(0,-45,0),this.tmpForce=new this.$THREE.Vector3,this.diff=new this.$THREE.Vector3,this.initPinsFormation(),this.init(),this.animate(0)},beforeDestroy:function(){this.gui.destroy()},methods:{init:function(){this.container=document.createElement("div"),document.getElementsByClassName("webglAnimationCloth-container")[0].appendChild(this.container),this.scene=new this.$THREE.Scene,this.scene.background=new this.$THREE.Color(13426943),this.scene.fog=new this.$THREE.Fog(13426943,500,1e4),this.camera=new this.$THREE.PerspectiveCamera(30,this.$webglInnerWidth/window.innerHeight,1,1e4),this.camera.position.set(1e3,50,1500),this.scene.add(new this.$THREE.AmbientLight(6710886));var t=new this.$THREE.DirectionalLight(14674943,1);t.position.set(50,200,100),t.position.multiplyScalar(1.3),t.castShadow=!0,t.shadow.mapSize.width=1024,t.shadow.mapSize.height=1024;var i=300;t.shadow.camera.left=-i,t.shadow.camera.right=i,t.shadow.camera.top=i,t.shadow.camera.bottom=-i,t.shadow.camera.far=1e3,this.scene.add(t);var s=new this.$THREE.TextureLoader,e=s.load("static/textures/patterns/circuit_pattern.png");e.anisotropy=16;var n=new this.$THREE.MeshLambertMaterial({map:e,side:this.$THREE.DoubleSide,alphaTest:.5});this.clothGeometry=new this.$THREE.ParametricBufferGeometry(this.clothFunction,this.cloth.w,this.cloth.h),this.object=new this.$THREE.Mesh(this.clothGeometry,n),this.object.position.set(0,0,0),this.object.castShadow=!0,this.scene.add(this.object),this.object.customDepthMaterial=new this.$THREE.MeshDepthMaterial({depthPacking:this.$THREE.RGBADepthPacking,map:e,alphaTest:.5});var h=new this.$THREE.SphereBufferGeometry(this.ballSize,32,16),r=new this.$THREE.MeshLambertMaterial;this.sphere=new this.$THREE.Mesh(h,r),this.sphere.castShadow=!0,this.sphere.receiveShadow=!0,this.sphere.visible=!1,this.scene.add(this.sphere);var l=s.load("static/textures/terrain/grasslight-big.jpg");l.wrapS=l.wrapT=this.$THREE.RepeatWrapping,l.repeat.set(25,25),l.anisotropy=16,l.encoding=this.$THREE.sRGBEncoding;var c=new this.$THREE.MeshLambertMaterial({map:l}),p=new this.$THREE.Mesh(new this.$THREE.PlaneBufferGeometry(2e4,2e4),c);p.position.y=-250,p.rotation.x=-Math.PI/2,p.receiveShadow=!0,this.scene.add(p);var d=new this.$THREE.BoxBufferGeometry(5,375,5),u=new this.$THREE.MeshLambertMaterial;(p=new this.$THREE.Mesh(d,u)).position.x=-125,p.position.y=-62,p.receiveShadow=!0,p.castShadow=!0,this.scene.add(p),(p=new this.$THREE.Mesh(d,u)).position.x=125,p.position.y=-62,p.receiveShadow=!0,p.castShadow=!0,this.scene.add(p),(p=new this.$THREE.Mesh(new this.$THREE.BoxBufferGeometry(255,5,5),u)).position.y=125,p.position.x=0,p.receiveShadow=!0,p.castShadow=!0,this.scene.add(p);var m=new this.$THREE.BoxBufferGeometry(10,10,10);(p=new this.$THREE.Mesh(m,u)).position.y=-250,p.position.x=125,p.receiveShadow=!0,p.castShadow=!0,this.scene.add(p),(p=new this.$THREE.Mesh(m,u)).position.y=-250,p.position.x=-125,p.receiveShadow=!0,p.castShadow=!0,this.scene.add(p),this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),this.container.appendChild(this.renderer.domElement),this.renderer.outputEncoding=this.$THREE.sRGBEncoding,this.renderer.shadowMap.enabled=!0;var E=new a.a(this.camera,this.renderer.domElement);if(E.maxPolarAngle=.5*Math.PI,E.minDistance=1e3,E.maxDistance=5e3,this.stats=new this.$Stats,this.stats.dom.style.left="280px",this.container.appendChild(this.stats.dom),window.addEventListener("resize",this.onWindowResize,!1),this.gui=new o.a,this.gui.add(this.params,"enableWind").name("Enable wind"),this.gui.add(this.params,"showBall").name("Show ball"),this.gui.add(this.params,"togglePins").name("Toggle pins"),"undefined"!=typeof TESTING)for(var w=0;w<50;w++)this.simulate(500-10*w)},animate:function(t){requestAnimationFrame(this.animate),this.simulate(t),this.render(),this.stats.update()},render:function(){for(var t=this.cloth.particles,i=0,s=t.length;i<s;i++){var e=t[i].position;this.clothGeometry.attributes.position.setXYZ(i,e.x,e.y,e.z)}this.clothGeometry.attributes.position.needsUpdate=!0,this.clothGeometry.computeVertexNormals(),this.sphere.position.copy(this.ballPosition),this.renderer.render(this.scene,this.camera)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},initPinsFormation:function(){this.pins=[6],this.pinsFormation.push(this.pins),this.pins=[0,1,2,3,4,5,6,7,8,9,10],this.pinsFormation.push(this.pins),this.pins=[0],this.pinsFormation.push(this.pins),this.pins=[],this.pinsFormation.push(this.pins),this.pins=[0,this.cloth.w],this.pinsFormation.push(this.pins),this.pins=this.pinsFormation[1]},togglePins:function(){this.pins=this.pinsFormation[~~(Math.random()*this.pinsFormation.length)]},satisfyConstraints:function(t,i,s){this.diff.subVectors(i.position,t.position);var e=this.diff.length();if(0!==e){var n=this.diff.multiplyScalar(1-s/e).multiplyScalar(.5);t.position.add(n),i.position.sub(n)}},simulate:function(t){var i=20*Math.cos(t/7e3)+40;this.windForce.set(Math.sin(t/2e3),Math.cos(t/3e3),Math.sin(t/1e3)),this.windForce.normalize(),this.windForce.multiplyScalar(i);var s=this.cloth.particles,e=this.il;if(this.params.enableWind){var n=void 0,h=new this.$THREE.Vector3,o=this.clothGeometry.index,a=this.clothGeometry.attributes.normal,r=0;for(e=o.count;r<e;r+=3)for(var l=0;l<3;l++)n=o.getX(r+l),h.fromBufferAttribute(a,n),this.tmpForce.copy(h).normalize().multiplyScalar(h.dot(this.windForce)),s[n].addForce(this.tmpForce)}for(var c=0,p=s.length;c<p;c++){var d=s[c];d.addForce(this.gravity),d.integrate(this.TIMESTEP_SQ)}this.constraints=this.cloth.constraints,this.il=this.constraints.length;for(var u=this.il,m=0;m<u;m++){var E=this.constraints[m];this.satisfyConstraints(E[0],E[1],E[2])}if(this.ballPosition.z=90*-Math.sin(t/600),this.ballPosition.x=70*Math.cos(t/400),this.params.showBall){this.sphere.visible=!0;for(var w=0,f=s.length;w<f;w++){var g=s[w].position;this.diff.subVectors(g,this.ballPosition),this.diff.length()<this.ballSize&&(this.diff.normalize().multiplyScalar(this.ballSize),g.copy(this.ballPosition).add(this.diff))}}else this.sphere.visible=!1;for(r=0,u=s.length;r<u;r++){var v=s[r].position;v.y<-250&&(v.y=-250)}for(r=0,u=this.pins.length;r<u;r++){var S=s[this.pins[r]];S.position.copy(S.original),S.previous.copy(S.original)}}}},l={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"webglAnimationCloth-container"},[i("div",{attrs:{id:"info"}},[this._v("Simple Cloth Simulation"),i("br"),this._v("\n\t\t\tVerlet integration with relaxed constraints"),i("br")])])}]};var c=s("VU/8")(r,l,!1,function(t){s("g9KI")},"data-v-7da2ae68",null);i.default=c.exports}});
//# sourceMappingURL=76.b04b464ce64901e55aab.js.map