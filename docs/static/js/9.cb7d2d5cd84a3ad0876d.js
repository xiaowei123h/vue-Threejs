webpackJsonp([9],{"6+vO":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("JQAX"),r=n("MuRL"),s=n("A9m1"),i={data:function(){return{camera:null,scene:null,renderer:null,controls:null,root:null,objects:[],tmpVec1:null,tmpVec2:null,tmpVec3:null,tmpVec4:null,offset:null,visualizationType:2,MOLECULES:{Ethanol:"ethanol.pdb",Aspirin:"aspirin.pdb",Caffeine:"caffeine.pdb",Nicotine:"nicotine.pdb",LSD:"lsd.pdb",Cocaine:"cocaine.pdb",Cholesterol:"cholesterol.pdb",Lycopene:"lycopene.pdb",Glucose:"glucose.pdb","Aluminium oxide":"Al2O3.pdb",Cubane:"cubane.pdb",Copper:"cu.pdb",Fluorite:"caf2.pdb",Salt:"nacl.pdb","YBCO superconductor":"ybco.pdb",Buckyball:"buckyball.pdb",Graphite:"graphite.pdb"},loader:null,colorSpriteMap:{},baseSprite:null,menu:null}},mounted:function(){this.tmpVec1=new this.$THREE.Vector3,this.tmpVec2=new this.$THREE.Vector3,this.tmpVec3=new this.$THREE.Vector3,this.tmpVec4=new this.$THREE.Vector3,this.offset=new this.$THREE.Vector3,this.loader=new r.a,this.baseSprite=document.createElement("img"),this.menu=document.getElementById("menu"),this.init(),this.animate()},methods:{init:function(){var t=this;this.camera=new this.$THREE.PerspectiveCamera(70,this.$webglInnerWidth/window.innerHeight,1,5e3),this.camera.position.z=1e3,this.scene=new this.$THREE.Scene,this.root=new this.$THREE.Object3D,this.scene.add(this.root),this.renderer=new s.b,this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),document.getElementById("container").appendChild(this.renderer.domElement),this.controls=new o.a(this.camera,this.renderer.domElement),this.controls.rotateSpeed=.5,this.baseSprite.onload=function(){t.loadMolecule("static/models/pdb/caffeine.pdb"),t.createMenu()},this.baseSprite.src="static/textures/sprites/ball.png",window.addEventListener("resize",this.onWindowResize,!1)},generateButtonCallback:function(t){var e=this;return function(){e.loadMolecule(t)}},createMenu:function(){var t=this;for(var e in this.MOLECULES){var n=document.createElement("button");n.innerHTML=e,this.menu.appendChild(n);var o="static/models/pdb/"+this.MOLECULES[e];n.addEventListener("click",this.generateButtonCallback(o),!1)}var r=document.getElementById("b_a"),s=document.getElementById("b_b"),i=document.getElementById("b_ab");r.addEventListener("click",function(){t.visualizationType=0,t.showAtoms()}),s.addEventListener("click",function(){t.visualizationType=1,t.showBonds()}),i.addEventListener("click",function(){t.visualizationType=2,t.showAtomsBonds()})},showAtoms:function(){for(var t=0;t<this.objects.length;t++){var e=this.objects[t];e instanceof s.c?(e.element.style.display="",e.visible=!0):(e.element.style.display="none",e.visible=!1)}},showBonds:function(){for(var t=0;t<this.objects.length;t++){var e=this.objects[t];e instanceof s.c?(e.element.style.display="none",e.visible=!1):(e.element.style.display="",e.element.style.height=e.userData.bondLengthFull,e.visible=!0)}},showAtomsBonds:function(){for(var t=0;t<this.objects.length;t++){var e=this.objects[t];e.element.style.display="",e.visible=!0,e instanceof s.c||(e.element.style.height=e.userData.bondLengthShort)}},colorify:function(t,e,n,o){for(var r=o.r,s=o.g,i=o.b,a=t.getImageData(0,0,e,n),c=a.data,u=0,l=c.length;u<l;u+=4)c[u+0]*=r,c[u+1]*=s,c[u+2]*=i;t.putImageData(a,0,0)},imageToCanvas:function(t){var e=t.width,n=t.height,o=document.createElement("canvas");return o.width=e,o.height=n,o.getContext("2d").drawImage(t,0,0,e,n),o},loadMolecule:function(t){for(var e=this,n=0;n<this.objects.length;n++){var o=this.objects[n];o.parent.remove(o)}this.objects.length=0,this.loader.load(t,function(t){var n=t.geometryAtoms,o=t.geometryBonds,r=t.json;n.computeBoundingBox(),n.boundingBox.getCenter(e.offset).negate(),n.translate(e.offset.x,e.offset.y,e.offset.z),o.translate(e.offset.x,e.offset.y,e.offset.z);for(var i=n.getAttribute("position"),a=n.getAttribute("color"),c=new e.$THREE.Vector3,u=new e.$THREE.Color,l=0;l<i.count;l++){c.fromBufferAttribute(i,l),u.fromBufferAttribute(a,l);var d=r.atoms[l][4];if(!e.colorSpriteMap[d]){var h=e.imageToCanvas(e.baseSprite),p=h.getContext("2d");e.colorify(p,h.width,h.height,u);var m=h.toDataURL();e.colorSpriteMap[d]=m}var b=e.colorSpriteMap[d],f=document.createElement("img");f.src=b,(w=new s.c(f)).position.copy(c),w.position.multiplyScalar(75),w.matrixAutoUpdate=!1,w.updateMatrix(),e.root.add(w),e.objects.push(w)}var v=o.getAttribute("position"),g=new e.$THREE.Vector3,y=new e.$THREE.Vector3;for(l=0;l<v.count;l+=2){g.fromBufferAttribute(v,l),y.fromBufferAttribute(v,l+1),g.multiplyScalar(75),y.multiplyScalar(75),e.tmpVec1.subVectors(y,g);var w,E=e.tmpVec1.length()-50,A=document.createElement("div");A.className="bond",A.style.height=E+"px",(w=new s.a(A)).position.copy(g),w.position.lerp(y,.5),w.userData.bondLengthShort=E+"px",w.userData.bondLengthFull=E+55+"px";var x=e.tmpVec2.set(0,1,0).cross(e.tmpVec1),B=Math.acos(e.tmpVec3.set(0,1,0).dot(e.tmpVec4.copy(e.tmpVec1).normalize())),M=(new e.$THREE.Matrix4).makeRotationAxis(x.normalize(),B);w.matrix.copy(M),w.quaternion.setFromRotationMatrix(w.matrix),w.matrixAutoUpdate=!1,w.updateMatrix(),e.root.add(w),e.objects.push(w),(A=document.createElement("div")).className="bond",A.style.height=E+"px";var C=new e.$THREE.Object3D(A);C.position.copy(g),C.position.lerp(y,.5),C.matrix.copy(M),C.quaternion.setFromRotationMatrix(C.matrix),C.matrixAutoUpdate=!1,C.updateMatrix(),(w=new s.a(A)).rotation.y=Math.PI/2,w.matrixAutoUpdate=!1,w.updateMatrix(),w.userData.bondLengthShort=E+"px",w.userData.bondLengthFull=E+55+"px",w.userData.joint=C,C.add(w),e.root.add(C),e.objects.push(w)}switch(e.visualizationType){case 0:e.showAtoms();break;case 1:e.showBonds();break;case 2:e.showAtomsBonds()}})},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate),this.controls.update();var t=4e-4*Date.now();this.root.rotation.x=t,this.root.rotation.y=.7*t,this.render()},render:function(){this.renderer.render(this.scene,this.camera)}}},a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"css3dMolecules-container"},[n("div",{attrs:{id:"container"}}),t._v(" "),n("div",{attrs:{id:"info"}},[n("a",{attrs:{href:"https://threejs.org",target:"_blank",rel:"noopener"}},[t._v("three.js")]),t._v(" css3d - molecules")]),t._v(" "),n("div",{attrs:{id:"topmenu"}},[n("button",{attrs:{id:"b_a"}},[t._v("Atoms")]),n("button",{attrs:{id:"b_b"}},[t._v("Bonds")]),n("button",{attrs:{id:"b_ab"}},[t._v("Atoms + Bonds")])]),t._v(" "),n("div",{attrs:{id:"menu"}})])}]};var c=n("VU/8")(i,a,!1,function(t){n("6jWF"),n("dgiJ")},"data-v-1b3977f2",null);e.default=c.exports},"6jWF":function(t,e){},MuRL:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n("6+nK"),r=function(t){o.Loader.call(this,t)};r.prototype=Object.assign(Object.create(o.Loader.prototype),{constructor:r,load:function(t,e,n,r){var s=this,i=new o.FileLoader(s.manager);i.setPath(s.path),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(t,function(n){try{e(s.parse(n))}catch(e){r?r(e):console.error(e),s.manager.itemError(t)}},n,r)},parse:function(t){function e(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function n(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}function r(t,e){var n,o,r=parseInt(b[f].substr(t,e));if(r){var s=(n=y,o=r,"s"+Math.min(n,o)+"e"+Math.max(n,o));void 0===p[s]&&(h.push([y-1,r-1,1]),p[s]=h.length-1)}}for(var s,i,a,c,u,l={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},d=[],h=[],p={},m={},b=t.split("\n"),f=0,v=b.length;f<v;f++)if("ATOM"===b[f].substr(0,4)||"HETATM"===b[f].substr(0,6)){s=parseFloat(b[f].substr(30,7)),i=parseFloat(b[f].substr(38,7)),a=parseFloat(b[f].substr(46,7)),c=parseInt(b[f].substr(6,5))-1,""===(u=e(b[f].substr(76,2)).toLowerCase())&&(u=e(b[f].substr(12,2)).toLowerCase());var g=[s,i,a,l[u],n(u)];d.push(g),m[c]=g}else if("CONECT"===b[f].substr(0,6)){var y=parseInt(b[f].substr(6,5));r(11,5),r(16,5),r(21,5),r(26,5)}return function(){var t,e,n,r,s,i={geometryAtoms:new o.BufferGeometry,geometryBonds:new o.BufferGeometry,json:{atoms:d}},a=i.geometryAtoms,c=i.geometryBonds,u=[],l=[],p=[];for(t=0,e=d.length;t<e;t++){var b=d[t];n=b[0],r=b[1],s=b[2],u.push(n,r,s);var f=b[3][0]/255,v=b[3][1]/255,g=b[3][2]/255;l.push(f,v,g)}for(t=0,e=h.length;t<e;t++){var y=h[t],w=y[0],E=y[1],A=m[w],x=m[E];n=A[0],r=A[1],s=A[2],p.push(n,r,s),n=x[0],r=x[1],s=x[2],p.push(n,r,s)}return a.setAttribute("position",new o.Float32BufferAttribute(u,3)),a.setAttribute("color",new o.Float32BufferAttribute(l,3)),c.setAttribute("position",new o.Float32BufferAttribute(p,3)),i}()}})},dgiJ:function(t,e){}});
//# sourceMappingURL=9.cb7d2d5cd84a3ad0876d.js.map