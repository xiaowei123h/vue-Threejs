webpackJsonp([96],{"+uZE":function(t,e){},hmeL:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("6+nK"),r=function(){var t=new i._91;function e(t){var e=t.geometry;if(!e.isBufferGeometry||3!==e.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.weightAttribute=null,this.distribution=null}return e.prototype={constructor:e,setWeightAttribute:function(t){return this.weightAttribute=t?this.geometry.getAttribute(t):null,this},build:function(){for(var e=this.positionAttribute,s=this.weightAttribute,i=new Float32Array(e.count/3),r=0;r<e.count;r+=3){var n=1;s&&(n=s.getX(r)+s.getX(r+1)+s.getX(r+2)),t.a.fromBufferAttribute(e,r),t.b.fromBufferAttribute(e,r+1),t.c.fromBufferAttribute(e,r+2),n*=t.getArea(),i[r/3]=n}this.distribution=new Float32Array(e.count/3);var a=0;for(r=0;r<i.length;r++)a+=i[r],this.distribution[r]=a;return this},setRandomGenerator:function(t){return this.randomFunction=t,this},sample:function(t,e){var s=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*s);return this.sampleFace(i,t,e)},binarySearch:function(t){for(var e=this.distribution,s=0,i=e.length-1,r=-1;s<=i;){var n=Math.ceil((s+i)/2);if(0===n||e[n-1]<=t&&e[n]>t){r=n;break}t<e[n]?i=n-1:s=n+1}return r},sampleFace:function(e,s,i){var r=this.randomFunction(),n=this.randomFunction();return r+n>1&&(r=1-r,n=1-n),t.a.fromBufferAttribute(this.positionAttribute,3*e),t.b.fromBufferAttribute(this.positionAttribute,3*e+1),t.c.fromBufferAttribute(this.positionAttribute,3*e+2),s.set(0,0,0).addScaledVector(t.a,r).addScaledVector(t.b,n).addScaledVector(t.c,1-(r+n)),t.getNormal(i),this}},e}(),n=s("qxm1"),a=s("QEtz");var o={data:function(){return s=null,(e="loader")in(t={camera:null,scene:null,renderer:null,stats:null,api:null,stemMesh:null,blossomMesh:null,stemGeometry:null,blossomGeometry:null,stemMaterial:null,blossomMaterial:null,sampler:null,count:null,ages:null,scales:null,dummy:null,_position:null,_normal:null,_scale:null,surfaceGeometry:null,surfaceMaterial:null,surface:null,loader:null,gui:null})?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t;var t,e,s},mounted:function(){var t=this;this.api={count:2e3,distribution:"random",resample:this.resample,surfaceColor:16775044,backgroundColor:14914665},this.count=this.api.count,this.ages=new Float32Array(this.count),this.scales=new Float32Array(this.count),this.dummy=new this.$THREE.Object3D,this._position=new this.$THREE.Vector3,this._normal=new this.$THREE.Vector3,this._scale=new this.$THREE.Vector3,this.surfaceGeometry=new this.$THREE.TorusKnotBufferGeometry(10,3,100,16).toNonIndexed(),this.surfaceMaterial=new this.$THREE.MeshLambertMaterial({color:this.api.surfaceColor,wireframe:!1}),this.surface=new this.$THREE.Mesh(this.surfaceGeometry,this.surfaceMaterial),this.loader=new n.a,this.loader.load("static/models/gltf/Flower/Flower.glb",function(e){var s=e.scene.getObjectByName("Stem"),i=e.scene.getObjectByName("Blossom");t.stemGeometry=new t.$THREE.InstancedBufferGeometry,t.blossomGeometry=new t.$THREE.InstancedBufferGeometry,t.$THREE.BufferGeometry.prototype.copy.call(t.stemGeometry,s.geometry),t.$THREE.BufferGeometry.prototype.copy.call(t.blossomGeometry,i.geometry);var r=(new t.$THREE.Matrix4).makeRotationX(Math.PI).multiply((new t.$THREE.Matrix4).makeScale(7,7,7));t.stemGeometry.applyMatrix4(r),t.blossomGeometry.applyMatrix4(r),t.stemMaterial=s.material,t.blossomMaterial=i.material;for(var n=new t.$THREE.Color,a=new Float32Array(3*t.count),o=[15861127,15914105,15911033,15904887,15877125],h=0;h<t.count;h++)n.setHex(o[Math.floor(Math.random()*o.length)]),n.toArray(a,3*h);t.blossomGeometry.setAttribute("color",new t.$THREE.InstancedBufferAttribute(a,3)),t.blossomMaterial.vertexColors=!0,t.stemMesh=new t.$THREE.InstancedMesh(t.stemGeometry,t.stemMaterial,t.count),t.blossomMesh=new t.$THREE.InstancedMesh(t.blossomGeometry,t.blossomMaterial,t.count),t.stemMesh.instanceMatrix.setUsage(t.$THREE.DynamicDrawUsage),t.blossomMesh.instanceMatrix.setUsage(t.$THREE.DynamicDrawUsage),t.resample(),t.init(),t.animate()})},beforeDestroy:function(){this.gui.destroy()},methods:{easeOutCubic:function(t){return--t*t*t+1},scaleCurve:function(t){return Math.abs(this.easeOutCubic(2*(t>.5?1-t:t)))},init:function(){var t=this;this.camera=new this.$THREE.PerspectiveCamera(60,this.$webglInnerWidth/window.innerHeight,.1,100),this.camera.position.set(25,25,25),this.camera.lookAt(0,0,0),this.scene=new this.$THREE.Scene,this.scene.background=new this.$THREE.Color(this.api.backgroundColor);var e=new this.$THREE.PointLight(11176089,.75);e.position.set(50,-25,75),this.scene.add(e),this.scene.add(new this.$THREE.HemisphereLight),this.scene.add(this.stemMesh),this.scene.add(this.blossomMesh),this.scene.add(this.surface),this.gui=new a.a,this.gui.add(this.api,"count",0,this.count).onChange(function(){t.stemMesh.count=t.api.count,t.blossomMesh.count=t.api.count}),this.gui.add(this.api,"distribution").options(["random","weighted"]).onChange(this.resample),this.gui.add(this.api,"resample"),this.renderer=new this.$THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.$webglInnerWidth,window.innerHeight),document.getElementsByClassName("webglInstancingScatter-container")[0].appendChild(this.renderer.domElement),this.stats=new this.$Stats,this.stats.dom.style.left="280px",document.getElementsByClassName("webglInstancingScatter-container")[0].appendChild(this.stats.dom),window.addEventListener("resize",this.onWindowResize,!1)},resample:function(){var t=this.surface.geometry.getAttribute("position").count;console.info("Sampling "+this.count+" points from a surface with "+t+" vertices..."),console.time(".build()"),this.sampler=new r(this.surface).setWeightAttribute("weighted"===this.api.distribution?"uv":null).build(),console.timeEnd(".build()"),console.time(".sample()");for(var e=0;e<this.count;e++)this.ages[e]=Math.random(),this.scales[e]=this.scaleCurve(this.ages[e]),this.resampleParticle(e);console.timeEnd(".sample()"),this.stemMesh.instanceMatrix.needsUpdate=!0,this.blossomMesh.instanceMatrix.needsUpdate=!0},resampleParticle:function(t){this.sampler.sample(this._position,this._normal),this._normal.add(this._position),this.dummy.position.copy(this._position),this.dummy.scale.set(this.scales[t],this.scales[t],this.scales[t]),this.dummy.lookAt(this._normal),this.dummy.updateMatrix(),this.stemMesh.setMatrixAt(t,this.dummy.matrix),this.blossomMesh.setMatrixAt(t,this.dummy.matrix)},updateParticle:function(t){if(this.ages[t]+=.005,this.ages[t]>=1)return this.ages[t]=.001,this.scales[t]=this.scaleCurve(this.ages[t]),void this.resampleParticle(t);var e=this.scales[t];this.scales[t]=this.scaleCurve(this.ages[t]),this._scale.set(this.scales[t]/e,this.scales[t]/e,this.scales[t]/e),this.stemMesh.getMatrixAt(t,this.dummy.matrix),this.dummy.matrix.scale(this._scale),this.stemMesh.setMatrixAt(t,this.dummy.matrix),this.blossomMesh.setMatrixAt(t,this.dummy.matrix)},onWindowResize:function(){this.$onWindowResize(this.camera,this.renderer)},animate:function(){requestAnimationFrame(this.animate),this.render(),this.stats.update()},render:function(){if(this.stemMesh&&this.blossomMesh){var t=.001*Date.now();this.scene.rotation.x=Math.sin(t/4),this.scene.rotation.y=Math.sin(t/2);for(var e=0;e<this.api.count;e++)this.updateParticle(e);this.stemMesh.instanceMatrix.needsUpdate=!0,this.blossomMesh.instanceMatrix.needsUpdate=!0}this.renderer.render(this.scene,this.camera)}}},h={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"webglInstancingScatter-container"})},staticRenderFns:[]};var l=s("VU/8")(o,h,!1,function(t){s("+uZE")},"data-v-6597459a",null);e.default=l.exports}});
//# sourceMappingURL=96.0296e3ac2bafc215c117.js.map